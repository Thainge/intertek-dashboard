/*! For license information please see main.c1f670f6.js.LICENSE.txt */
!function(){var e={643:function(e,t,r){"use strict";var n=r(85),o=r(767),i=r(621),a="localStorage"in r.g&&r.g.localStorage?r.g.localStorage:n;function s(e,t){return 1===arguments.length?c(e):l(e,t)}function c(e){var t=a.getItem(e);return o(t)}function l(e,t){try{return a.setItem(e,JSON.stringify(t)),!0}catch(r){return!1}}s.set=l,s.get=c,s.remove=function(e){return a.removeItem(e)},s.clear=function(){return a.clear()},s.backend=function(e){return e&&(a=e),a},s.on=i.on,s.off=i.off,e.exports=s},767:function(e){"use strict";e.exports=function(e){var t=function(e){try{return JSON.parse(e)}catch(t){return e}}(e);return void 0===t?null:t}},85:function(e){"use strict";var t={};e.exports={getItem:function(e){return e in t?t[e]:null},setItem:function(e,r){return t[e]=r,!0},removeItem:function(e){return!!(e in t)&&delete t[e]},clear:function(){return t={},!0}}},621:function(e,t,r){"use strict";var n=r(767),o={};function i(e){e||(e=r.g.event);var t=o[e.key];t&&t.forEach((function(t){t(n(e.newValue),n(e.oldValue),e.url||e.uri)}))}e.exports={on:function(e,t){o[e]?o[e].push(t):o[e]=[t],r.g.addEventListener?r.g.addEventListener("storage",i,!1):r.g.attachEvent?r.g.attachEvent("onstorage",i):r.g.onstorage=i},off:function(e,t){var r=o[e];r.length>1?r.splice(r.indexOf(t),1):o[e]=[]}}},888:function(e,t,r){"use strict";var n=r(47);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,i,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return r.PropTypes=r,r}},7:function(e,t,r){e.exports=r(888)()},47:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},463:function(e,t,r){"use strict";var n=r(791),o=r(296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},h={};function g(e,t,r,n,o,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function y(e,t,r,n){var o=v.hasOwnProperty(t)?v[t]:null;(null!==o?0!==o.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,o,n)&&(r=null),n||null===o?function(e){return!!d.call(h,e)||!d.call(f,e)&&(p.test(e)?h[e]=!0:(f[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=null===r?3!==o.type&&"":r:(t=o.attributeName,n=o.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(o=o.type)||4===o&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,b);v[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,b);v[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,b);v[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var k=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),x=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),I=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var M,U=Object.assign;function F(e){if(void 0===M)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var z=!1;function H(e,t){if(!e||z)return"";z=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var n=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){n=l}e.call(t.prototype)}else{try{throw Error()}catch(l){n=l}e()}}catch(l){if(l&&n&&"string"===typeof l.stack){for(var o=l.stack.split("\n"),i=n.stack.split("\n"),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||o[a]!==i[s]){var c="\n"+o[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=a&&0<=s);break}}}finally{z=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?F(e):""}function B(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 1:return e=H(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case C:return"Fragment";case x:return"Portal";case _:return"Profiler";case T:return"StrictMode";case A:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return q(e(t))}catch(r){}}return null}function j(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var o=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=V(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function W(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var r=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Y(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=G(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Z(e,t){X(e,t);var r=G(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&W(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&n&&(e[r].defaultSelected=!0)}else{for(r=""+G(r),t=null,o=0;o<e.length;o++){if(e[o].value===r)return e[o].selected=!0,void(n&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(i(92));if(te(r)){if(1<r.length)throw Error(i(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:G(r)}}function ie(e,t){var r=G(t.value),n=G(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function pe(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function ge(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ve(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),o=ge(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,o):e[r]=o}}Object.keys(fe).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var me=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ke=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Ce=null,Te=null;function _e(e){if(e=ko(e)){if("function"!==typeof xe)throw Error(i(280));var t=e.stateNode;t&&(t=xo(t),xe(e.stateNode,e.type,t))}}function Se(e){Ce?Te?Te.push(e):Te=[e]:Ce=e}function Ie(){if(Ce){var e=Ce,t=Te;if(Te=Ce=null,_e(e),t)for(e=0;e<t.length;e++)_e(t[e])}}function Ee(e,t){return e(t)}function Ae(){}var Re=!1;function Pe(e,t,r){if(Re)return e(t,r);Re=!0;try{return Ee(e,t,r)}finally{Re=!1,(null!==Ce||null!==Te)&&(Ae(),Ie())}}function Oe(e,t){var r=e.stateNode;if(null===r)return null;var n=xo(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(i(231,t,typeof r));return r}var Ne=!1;if(u)try{var De={};Object.defineProperty(De,"passive",{get:function(){Ne=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ue){Ne=!1}function Le(e,t,r,n,o,i,a,s,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(r,l)}catch(u){this.onError(u)}}var Me=!1,Ue=null,Fe=!1,ze=null,He={onError:function(e){Me=!0,Ue=e}};function Be(e,t,r,n,o,i,a,s,c){Me=!1,Ue=null,Le.apply(He,arguments)}function qe(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(qe(e)!==e)throw Error(i(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(i(188));return t!==e?null:e}for(var r=e,n=t;;){var o=r.return;if(null===o)break;var a=o.alternate;if(null===a){if(null!==(n=o.return)){r=n;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===r)return Ge(o),e;if(a===n)return Ge(o),t;a=a.sibling}throw Error(i(188))}if(r.return!==n.return)r=o,n=a;else{for(var s=!1,c=o.child;c;){if(c===r){s=!0,r=o,n=a;break}if(c===n){s=!0,n=o,r=a;break}c=c.sibling}if(!s){for(c=a.child;c;){if(c===r){s=!0,r=a,n=o;break}if(c===n){s=!0,n=a,r=o;break}c=c.sibling}if(!s)throw Error(i(189))}}if(r.alternate!==n)throw Error(i(190))}if(3!==r.tag)throw Error(i(188));return r.stateNode.current===r?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Qe=o.unstable_scheduleCallback,We=o.unstable_cancelCallback,Je=o.unstable_shouldYield,Ye=o.unstable_requestPaint,Xe=o.unstable_now,Ze=o.unstable_getCurrentPriorityLevel,$e=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,rt=o.unstable_LowPriority,nt=o.unstable_IdlePriority,ot=null,it=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ct|0)|0},st=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,o=e.suspendedLanes,i=e.pingedLanes,a=268435455&r;if(0!==a){var s=a&~o;0!==s?n=dt(s):0!==(i&=a)&&(n=dt(i))}else 0!==(a=r&~o)?n=dt(a):0!==i&&(n=dt(i));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&o)&&((o=n&-n)>=(i=t&-t)||16===o&&0!==(4194240&i)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)o=1<<(r=31-at(t)),n|=e[r],t&=~o;return n}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function vt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function mt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=r}function bt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-at(r),o=1<<n;o&t|e[n]&t&&(e[n]|=t),r&=~o}}var yt=0;function kt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,xt,Ct,Tt,_t,St=!1,It=[],Et=null,At=null,Rt=null,Pt=new Map,Ot=new Map,Nt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Mt(e,t,r,n,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[o]},null!==t&&(null!==(t=ko(t))&&xt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Ut(e){var t=yo(e.target);if(null!==t){var r=qe(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=je(r)))return e.blockedOn=t,void _t(e.priority,(function(){Ct(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=ko(r))&&xt(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);ke=n,r.target.dispatchEvent(n),ke=null,t.shift()}return!0}function zt(e,t,r){Ft(e)&&r.delete(t)}function Ht(){St=!1,null!==Et&&Ft(Et)&&(Et=null),null!==At&&Ft(At)&&(At=null),null!==Rt&&Ft(Rt)&&(Rt=null),Pt.forEach(zt),Ot.forEach(zt)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Ht)))}function qt(e){function t(t){return Bt(t,e)}if(0<It.length){Bt(It[0],e);for(var r=1;r<It.length;r++){var n=It[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Et&&Bt(Et,e),null!==At&&Bt(At,e),null!==Rt&&Bt(Rt,e),Pt.forEach(t),Ot.forEach(t),r=0;r<Nt.length;r++)(n=Nt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Nt.length&&null===(r=Nt[0]).blockedOn;)Ut(r),null===r.blockedOn&&Nt.shift()}var jt=k.ReactCurrentBatchConfig,Gt=!0;function Vt(e,t,r,n){var o=yt,i=jt.transition;jt.transition=null;try{yt=1,Qt(e,t,r,n)}finally{yt=o,jt.transition=i}}function Kt(e,t,r,n){var o=yt,i=jt.transition;jt.transition=null;try{yt=4,Qt(e,t,r,n)}finally{yt=o,jt.transition=i}}function Qt(e,t,r,n){if(Gt){var o=Jt(e,t,r,n);if(null===o)Gn(e,t,n,Wt,r),Lt(e,n);else if(function(e,t,r,n,o){switch(t){case"focusin":return Et=Mt(Et,e,t,r,n,o),!0;case"dragenter":return At=Mt(At,e,t,r,n,o),!0;case"mouseover":return Rt=Mt(Rt,e,t,r,n,o),!0;case"pointerover":var i=o.pointerId;return Pt.set(i,Mt(Pt.get(i)||null,e,t,r,n,o)),!0;case"gotpointercapture":return i=o.pointerId,Ot.set(i,Mt(Ot.get(i)||null,e,t,r,n,o)),!0}return!1}(o,e,t,r,n))n.stopPropagation();else if(Lt(e,n),4&t&&-1<Dt.indexOf(e)){for(;null!==o;){var i=ko(o);if(null!==i&&wt(i),null===(i=Jt(e,t,r,n))&&Gn(e,t,n,Wt,r),i===o)break;o=i}null!==o&&n.stopPropagation()}else Gn(e,t,n,null,r)}}var Wt=null;function Jt(e,t,r,n){if(Wt=null,null!==(e=yo(e=we(n))))if(null===(t=qe(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=je(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Wt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case $e:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Xt=null,Zt=null,$t=null;function er(){if($t)return $t;var e,t,r=Zt,n=r.length,o="value"in Xt?Xt.value:Xt.textContent,i=o.length;for(e=0;e<n&&r[e]===o[e];e++);var a=n-e;for(t=1;t<=a&&r[n-t]===o[i-t];t++);return $t=o.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function or(e){function t(t,r,n,o,i){for(var a in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ir,ar,sr,cr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lr=or(cr),ur=U({},cr,{view:0,detail:0}),dr=or(ur),pr=U({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sr&&(sr&&"mousemove"===e.type?(ir=e.screenX-sr.screenX,ar=e.screenY-sr.screenY):ar=ir=0,sr=e),ir)},movementY:function(e){return"movementY"in e?e.movementY:ar}}),fr=or(pr),hr=or(U({},pr,{dataTransfer:0})),gr=or(U({},ur,{relatedTarget:0})),vr=or(U({},cr,{animationName:0,elapsedTime:0,pseudoElement:0})),mr=U({},cr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),br=or(mr),yr=or(U({},cr,{data:0})),kr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xr[e])&&!!t[e]}function Tr(){return Cr}var _r=U({},ur,{key:function(e){if(e.key){var t=kr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sr=or(_r),Ir=or(U({},pr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Er=or(U({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tr})),Ar=or(U({},cr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rr=U({},pr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pr=or(Rr),Or=[9,13,27,32],Nr=u&&"CompositionEvent"in window,Dr=null;u&&"documentMode"in document&&(Dr=document.documentMode);var Lr=u&&"TextEvent"in window&&!Dr,Mr=u&&(!Nr||Dr&&8<Dr&&11>=Dr),Ur=String.fromCharCode(32),Fr=!1;function zr(e,t){switch(e){case"keyup":return-1!==Or.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Br=!1;var qr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qr[e.type]:"textarea"===t}function Gr(e,t,r,n){Se(n),0<(t=Kn(t,"onChange")).length&&(r=new lr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Vr=null,Kr=null;function Qr(e){Fn(e,0)}function Wr(e){if(Q(wo(e)))return e}function Jr(e,t){if("change"===e)return t}var Yr=!1;if(u){var Xr;if(u){var Zr="oninput"in document;if(!Zr){var $r=document.createElement("div");$r.setAttribute("oninput","return;"),Zr="function"===typeof $r.oninput}Xr=Zr}else Xr=!1;Yr=Xr&&(!document.documentMode||9<document.documentMode)}function en(){Vr&&(Vr.detachEvent("onpropertychange",tn),Kr=Vr=null)}function tn(e){if("value"===e.propertyName&&Wr(Kr)){var t=[];Gr(t,Kr,e,we(e)),Pe(Qr,t)}}function rn(e,t,r){"focusin"===e?(en(),Kr=r,(Vr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Wr(Kr)}function on(e,t){if("click"===e)return Wr(t)}function an(e,t){if("input"===e||"change"===e)return Wr(t)}var sn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cn(e,t){if(sn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var o=r[n];if(!d.call(t,o)||!sn(e[o],t[o]))return!1}return!0}function ln(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var r,n=ln(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ln(n)}}function dn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pn(){for(var e=window,t=W();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=W((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hn(e){var t=pn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&dn(r.ownerDocument.documentElement,r)){if(null!==n&&fn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=r.textContent.length,i=Math.min(n.start,o);n=void 0===n.end?i:Math.min(n.end,o),!e.extend&&i>n&&(o=n,n=i,i=o),o=un(r,i);var a=un(r,n);o&&a&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gn=u&&"documentMode"in document&&11>=document.documentMode,vn=null,mn=null,bn=null,yn=!1;function kn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;yn||null==vn||vn!==W(n)||("selectionStart"in(n=vn)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},bn&&cn(bn,n)||(bn=n,0<(n=Kn(mn,"onSelect")).length&&(t=new lr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=vn)))}function wn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var xn={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},Cn={},Tn={};function _n(e){if(Cn[e])return Cn[e];if(!xn[e])return e;var t,r=xn[e];for(t in r)if(r.hasOwnProperty(t)&&t in Tn)return Cn[e]=r[t];return e}u&&(Tn=document.createElement("div").style,"AnimationEvent"in window||(delete xn.animationend.animation,delete xn.animationiteration.animation,delete xn.animationstart.animation),"TransitionEvent"in window||delete xn.transitionend.transition);var Sn=_n("animationend"),In=_n("animationiteration"),En=_n("animationstart"),An=_n("transitionend"),Rn=new Map,Pn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function On(e,t){Rn.set(e,t),c(t,[e])}for(var Nn=0;Nn<Pn.length;Nn++){var Dn=Pn[Nn];On(Dn.toLowerCase(),"on"+(Dn[0].toUpperCase()+Dn.slice(1)))}On(Sn,"onAnimationEnd"),On(In,"onAnimationIteration"),On(En,"onAnimationStart"),On("dblclick","onDoubleClick"),On("focusin","onFocus"),On("focusout","onBlur"),On(An,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ln="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ln));function Un(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,o,a,s,c,l){if(Be.apply(this,arguments),Me){if(!Me)throw Error(i(198));var u=Ue;Me=!1,Ue=null,Fe||(Fe=!0,ze=u)}}(n,t,void 0,e),e.currentTarget=null}function Fn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],o=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var a=n.length-1;0<=a;a--){var s=n[a],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==i&&o.isPropagationStopped())break e;Un(o,s,l),i=c}else for(a=0;a<n.length;a++){if(c=(s=n[a]).instance,l=s.currentTarget,s=s.listener,c!==i&&o.isPropagationStopped())break e;Un(o,s,l),i=c}}}if(Fe)throw e=ze,Fe=!1,ze=null,e}function zn(e,t){var r=t[vo];void 0===r&&(r=t[vo]=new Set);var n=e+"__bubble";r.has(n)||(jn(t,e,2,!1),r.add(n))}function Hn(e,t,r){var n=0;t&&(n|=4),jn(r,e,n,t)}var Bn="_reactListening"+Math.random().toString(36).slice(2);function qn(e){if(!e[Bn]){e[Bn]=!0,a.forEach((function(t){"selectionchange"!==t&&(Mn.has(t)||Hn(t,!1,e),Hn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bn]||(t[Bn]=!0,Hn("selectionchange",!1,t))}}function jn(e,t,r,n){switch(Yt(t)){case 1:var o=Vt;break;case 4:o=Kt;break;default:o=Qt}r=o.bind(null,t,r,e),o=void 0,!Ne||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),n?void 0!==o?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):void 0!==o?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function Gn(e,t,r,n,o){var i=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var a=n.tag;if(3===a||4===a){var s=n.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===a)for(a=n.return;null!==a;){var c=a.tag;if((3===c||4===c)&&((c=a.stateNode.containerInfo)===o||8===c.nodeType&&c.parentNode===o))return;a=a.return}for(;null!==s;){if(null===(a=yo(s)))return;if(5===(c=a.tag)||6===c){n=i=a;continue e}s=s.parentNode}}n=n.return}Pe((function(){var n=i,o=we(r),a=[];e:{var s=Rn.get(e);if(void 0!==s){var c=lr,l=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":c=Sr;break;case"focusin":l="focus",c=gr;break;case"focusout":l="blur",c=gr;break;case"beforeblur":case"afterblur":c=gr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=fr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=hr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Er;break;case Sn:case In:case En:c=vr;break;case An:c=Ar;break;case"scroll":c=dr;break;case"wheel":c=Pr;break;case"copy":case"cut":case"paste":c=br;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Ir}var u=0!==(4&t),d=!u&&"scroll"===e,p=u?null!==s?s+"Capture":null:s;u=[];for(var f,h=n;null!==h;){var g=(f=h).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==p&&(null!=(g=Oe(h,p))&&u.push(Vn(h,g,f)))),d)break;h=h.return}0<u.length&&(s=new c(s,l,null,r,o),a.push({event:s,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||r===ke||!(l=r.relatedTarget||r.fromElement)||!yo(l)&&!l[go])&&(c||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=n,null!==(l=(l=r.relatedTarget||r.toElement)?yo(l):null)&&(l!==(d=qe(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=n),c!==l)){if(u=fr,g="onMouseLeave",p="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(u=Ir,g="onPointerLeave",p="onPointerEnter",h="pointer"),d=null==c?s:wo(c),f=null==l?s:wo(l),(s=new u(g,h+"leave",c,r,o)).target=d,s.relatedTarget=f,g=null,yo(o)===n&&((u=new u(p,h+"enter",l,r,o)).target=f,u.relatedTarget=d,g=u),d=g,c&&l)e:{for(p=l,h=0,f=u=c;f;f=Qn(f))h++;for(f=0,g=p;g;g=Qn(g))f++;for(;0<h-f;)u=Qn(u),h--;for(;0<f-h;)p=Qn(p),f--;for(;h--;){if(u===p||null!==p&&u===p.alternate)break e;u=Qn(u),p=Qn(p)}u=null}else u=null;null!==c&&Wn(a,s,c,u,!1),null!==l&&null!==d&&Wn(a,d,l,u,!0)}if("select"===(c=(s=n?wo(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var v=Jr;else if(jr(s))if(Yr)v=an;else{v=nn;var m=rn}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(v=on);switch(v&&(v=v(e,n))?Gr(a,v,r,o):(m&&m(e,s,n),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ee(s,"number",s.value)),m=n?wo(n):window,e){case"focusin":(jr(m)||"true"===m.contentEditable)&&(vn=m,mn=n,bn=null);break;case"focusout":bn=mn=vn=null;break;case"mousedown":yn=!0;break;case"contextmenu":case"mouseup":case"dragend":yn=!1,kn(a,r,o);break;case"selectionchange":if(gn)break;case"keydown":case"keyup":kn(a,r,o)}var b;if(Nr)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Br?zr(e,r)&&(y="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(y="onCompositionStart");y&&(Mr&&"ko"!==r.locale&&(Br||"onCompositionStart"!==y?"onCompositionEnd"===y&&Br&&(b=er()):(Zt="value"in(Xt=o)?Xt.value:Xt.textContent,Br=!0)),0<(m=Kn(n,y)).length&&(y=new yr(y,e,null,r,o),a.push({event:y,listeners:m}),b?y.data=b:null!==(b=Hr(r))&&(y.data=b))),(b=Lr?function(e,t){switch(e){case"compositionend":return Hr(t);case"keypress":return 32!==t.which?null:(Fr=!0,Ur);case"textInput":return(e=t.data)===Ur&&Fr?null:e;default:return null}}(e,r):function(e,t){if(Br)return"compositionend"===e||!Nr&&zr(e,t)?(e=er(),$t=Zt=Xt=null,Br=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Kn(n,"onBeforeInput")).length&&(o=new yr("onBeforeInput","beforeinput",null,r,o),a.push({event:o,listeners:n}),o.data=b))}Fn(a,t)}))}function Vn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Kn(e,t){for(var r=t+"Capture",n=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=Oe(e,r))&&n.unshift(Vn(e,i,o)),null!=(i=Oe(e,t))&&n.push(Vn(e,i,o))),e=e.return}return n}function Qn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Wn(e,t,r,n,o){for(var i=t._reactName,a=[];null!==r&&r!==n;){var s=r,c=s.alternate,l=s.stateNode;if(null!==c&&c===n)break;5===s.tag&&null!==l&&(s=l,o?null!=(c=Oe(r,i))&&a.unshift(Vn(r,c,s)):o||null!=(c=Oe(r,i))&&a.push(Vn(r,c,s))),r=r.return}0!==a.length&&e.push({event:t,listeners:a})}var Jn=/\r\n?/g,Yn=/\u0000|\uFFFD/g;function Xn(e){return("string"===typeof e?e:""+e).replace(Jn,"\n").replace(Yn,"")}function Zn(e,t,r){if(t=Xn(t),Xn(e)!==t&&r)throw Error(i(425))}function $n(){}var eo=null,to=null;function ro(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var no="function"===typeof setTimeout?setTimeout:void 0,oo="function"===typeof clearTimeout?clearTimeout:void 0,io="function"===typeof Promise?Promise:void 0,ao="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof io?function(e){return io.resolve(null).then(e).catch(so)}:no;function so(e){setTimeout((function(){throw e}))}function co(e,t){var r=t,n=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&8===o.nodeType)if("/$"===(r=o.data)){if(0===n)return e.removeChild(o),void qt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=o}while(r);qt(t)}function lo(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function uo(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var po=Math.random().toString(36).slice(2),fo="__reactFiber$"+po,ho="__reactProps$"+po,go="__reactContainer$"+po,vo="__reactEvents$"+po,mo="__reactListeners$"+po,bo="__reactHandles$"+po;function yo(e){var t=e[fo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[go]||r[fo]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=uo(e);null!==e;){if(r=e[fo])return r;e=uo(e)}return t}r=(e=r).parentNode}return null}function ko(e){return!(e=e[fo]||e[go])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wo(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function xo(e){return e[ho]||null}var Co=[],To=-1;function _o(e){return{current:e}}function So(e){0>To||(e.current=Co[To],Co[To]=null,To--)}function Io(e,t){To++,Co[To]=e.current,e.current=t}var Eo={},Ao=_o(Eo),Ro=_o(!1),Po=Eo;function Oo(e,t){var r=e.type.contextTypes;if(!r)return Eo;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in r)i[o]=t[o];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function No(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Do(){So(Ro),So(Ao)}function Lo(e,t,r){if(Ao.current!==Eo)throw Error(i(168));Io(Ao,t),Io(Ro,r)}function Mo(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var o in n=n.getChildContext())if(!(o in t))throw Error(i(108,j(e)||"Unknown",o));return U({},r,n)}function Uo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Eo,Po=Ao.current,Io(Ao,e),Io(Ro,Ro.current),!0}function Fo(e,t,r){var n=e.stateNode;if(!n)throw Error(i(169));r?(e=Mo(e,t,Po),n.__reactInternalMemoizedMergedChildContext=e,So(Ro),So(Ao),Io(Ao,e)):So(Ro),Io(Ro,r)}var zo=null,Ho=!1,Bo=!1;function qo(e){null===zo?zo=[e]:zo.push(e)}function jo(){if(!Bo&&null!==zo){Bo=!0;var e=0,t=yt;try{var r=zo;for(yt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}zo=null,Ho=!1}catch(o){throw null!==zo&&(zo=zo.slice(e+1)),Qe($e,jo),o}finally{yt=t,Bo=!1}}return null}var Go=[],Vo=0,Ko=null,Qo=0,Wo=[],Jo=0,Yo=null,Xo=1,Zo="";function $o(e,t){Go[Vo++]=Qo,Go[Vo++]=Ko,Ko=e,Qo=t}function ei(e,t,r){Wo[Jo++]=Xo,Wo[Jo++]=Zo,Wo[Jo++]=Yo,Yo=e;var n=Xo;e=Zo;var o=32-at(n)-1;n&=~(1<<o),r+=1;var i=32-at(t)+o;if(30<i){var a=o-o%5;i=(n&(1<<a)-1).toString(32),n>>=a,o-=a,Xo=1<<32-at(t)+o|r<<o|n,Zo=i+e}else Xo=1<<i|r<<o|n,Zo=e}function ti(e){null!==e.return&&($o(e,1),ei(e,1,0))}function ri(e){for(;e===Ko;)Ko=Go[--Vo],Go[Vo]=null,Qo=Go[--Vo],Go[Vo]=null;for(;e===Yo;)Yo=Wo[--Jo],Wo[Jo]=null,Zo=Wo[--Jo],Wo[Jo]=null,Xo=Wo[--Jo],Wo[Jo]=null}var ni=null,oi=null,ii=!1,ai=null;function si(e,t){var r=Pl(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function ci(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,oi=lo(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,oi=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Yo?{id:Xo,overflow:Zo}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Pl(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ni=e,oi=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ui(e){if(ii){var t=oi;if(t){var r=t;if(!ci(e,t)){if(li(e))throw Error(i(418));t=lo(r.nextSibling);var n=ni;t&&ci(e,t)?si(n,r):(e.flags=-4097&e.flags|2,ii=!1,ni=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,ni=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function pi(e){if(e!==ni)return!1;if(!ii)return di(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ro(e.type,e.memoizedProps)),t&&(t=oi)){if(li(e))throw fi(),Error(i(418));for(;t;)si(e,t),t=lo(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){oi=lo(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}oi=null}}else oi=ni?lo(e.stateNode.nextSibling):null;return!0}function fi(){for(var e=oi;e;)e=lo(e.nextSibling)}function hi(){oi=ni=null,ii=!1}function gi(e){null===ai?ai=[e]:ai.push(e)}var vi=k.ReactCurrentBatchConfig;function mi(e,t){if(e&&e.defaultProps){for(var r in t=U({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var bi=_o(null),yi=null,ki=null,wi=null;function xi(){wi=ki=yi=null}function Ci(e){var t=bi.current;So(bi),e._currentValue=t}function Ti(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function _i(e,t){yi=e,wi=ki=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ks=!0),e.firstContext=null)}function Si(e){var t=e._currentValue;if(wi!==e)if(e={context:e,memoizedValue:t,next:null},null===ki){if(null===yi)throw Error(i(308));ki=e,yi.dependencies={lanes:0,firstContext:e}}else ki=ki.next=e;return t}var Ii=null;function Ei(e){null===Ii?Ii=[e]:Ii.push(e)}function Ai(e,t,r,n){var o=t.interleaved;return null===o?(r.next=r,Ei(t)):(r.next=o.next,o.next=r),t.interleaved=r,Ri(e,n)}function Ri(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Pi=!1;function Oi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ni(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Li(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Ec)){var o=n.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),n.pending=t,Ri(e,r)}return null===(o=n.interleaved)?(t.next=t,Ei(n)):(t.next=o.next,o.next=t),n.interleaved=t,Ri(e,r)}function Mi(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,bt(e,r)}}function Ui(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var o=null,i=null;if(null!==(r=r.firstBaseUpdate)){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===i?o=i=a:i=i.next=a,r=r.next}while(null!==r);null===i?o=i=t:i=i.next=t}else o=i=t;return r={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Fi(e,t,r,n){var o=e.updateQueue;Pi=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var c=s,l=c.next;c.next=null,null===a?i=l:a.next=l,a=c;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(null!==i){var d=o.baseState;for(a=0,u=l=c=null,s=i;;){var p=s.lane,f=s.eventTime;if((n&p)===p){null!==u&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=e,g=s;switch(p=t,f=r,g.tag){case 1:if("function"===typeof(h=g.payload)){d=h.call(f,d,p);break e}d=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(p="function"===typeof(h=g.payload)?h.call(f,d,p):h)||void 0===p)break e;d=U({},d,p);break e;case 2:Pi=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=o.effects)?o.effects=[s]:p.push(s))}else f={eventTime:f,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(l=u=f,c=d):u=u.next=f,a|=p;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(p=s).next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}if(null===u&&(c=d),o.baseState=c,o.firstBaseUpdate=l,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{a|=o.lane,o=o.next}while(o!==t)}else null===i&&(o.shared.lanes=0);Mc|=a,e.lanes=a,e.memoizedState=d}}function zi(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(null!==o){if(n.callback=null,n=r,"function"!==typeof o)throw Error(i(191,o));o.call(n)}}}var Hi=(new n.Component).refs;function Bi(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:U({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var qi={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=el(),o=tl(e),i=Di(n,o);i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=Li(e,i,o))&&(rl(t,e,o,n),Mi(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=el(),o=tl(e),i=Di(n,o);i.tag=1,i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=Li(e,i,o))&&(rl(t,e,o,n),Mi(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=el(),n=tl(e),o=Di(r,n);o.tag=2,void 0!==t&&null!==t&&(o.callback=t),null!==(t=Li(e,o,n))&&(rl(t,e,n,r),Mi(t,e,n))}};function ji(e,t,r,n,o,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!cn(r,n)||!cn(o,i))}function Gi(e,t,r){var n=!1,o=Eo,i=t.contextType;return"object"===typeof i&&null!==i?i=Si(i):(o=No(t)?Po:Ao.current,i=(n=null!==(n=t.contextTypes)&&void 0!==n)?Oo(e,o):Eo),t=new t(r,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=qi,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function Vi(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&qi.enqueueReplaceState(t,t.state,null)}function Ki(e,t,r,n){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs=Hi,Oi(e);var i=t.contextType;"object"===typeof i&&null!==i?o.context=Si(i):(i=No(t)?Po:Ao.current,o.context=Oo(e,i)),o.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Bi(e,t,i,r),o.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(t=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&qi.enqueueReplaceState(o,o.state,null),Fi(e,r,o,n),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4194308)}function Qi(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(i(309));var n=r.stateNode}if(!n)throw Error(i(147,e));var o=n,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=o.refs;t===Hi&&(t=o.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!r._owner)throw Error(i(290,e))}return e}function Wi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ji(e){return(0,e._init)(e._payload)}function Yi(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Nl(e,t)).index=0,e.sibling=null,e}function a(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,r,n){return null===t||6!==t.tag?((t=Ul(r,e.mode,n)).return=e,t):((t=o(t,r)).return=e,t)}function l(e,t,r,n){var i=r.type;return i===C?d(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===O&&Ji(i)===t.type)?((n=o(t,r.props)).ref=Qi(e,t,r),n.return=e,n):((n=Dl(r.type,r.key,r.props,null,e.mode,n)).ref=Qi(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Fl(r,e.mode,n)).return=e,t):((t=o(t,r.children||[])).return=e,t)}function d(e,t,r,n,i){return null===t||7!==t.tag?((t=Ll(r,e.mode,n,i)).return=e,t):((t=o(t,r)).return=e,t)}function p(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ul(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(r=Dl(t.type,t.key,t.props,null,e.mode,r)).ref=Qi(e,null,t),r.return=e,r;case x:return(t=Fl(t,e.mode,r)).return=e,t;case O:return p(e,(0,t._init)(t._payload),r)}if(te(t)||L(t))return(t=Ll(t,e.mode,r,null)).return=e,t;Wi(e,t)}return null}function f(e,t,r,n){var o=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==o?null:c(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===o?l(e,t,r,n):null;case x:return r.key===o?u(e,t,r,n):null;case O:return f(e,t,(o=r._init)(r._payload),n)}if(te(r)||L(r))return null!==o?null:d(e,t,r,n,null);Wi(e,r)}return null}function h(e,t,r,n,o){if("string"===typeof n&&""!==n||"number"===typeof n)return c(t,e=e.get(r)||null,""+n,o);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return l(t,e=e.get(null===n.key?r:n.key)||null,n,o);case x:return u(t,e=e.get(null===n.key?r:n.key)||null,n,o);case O:return h(e,t,r,(0,n._init)(n._payload),o)}if(te(n)||L(n))return d(t,e=e.get(r)||null,n,o,null);Wi(t,n)}return null}function g(o,i,s,c){for(var l=null,u=null,d=i,g=i=0,v=null;null!==d&&g<s.length;g++){d.index>g?(v=d,d=null):v=d.sibling;var m=f(o,d,s[g],c);if(null===m){null===d&&(d=v);break}e&&d&&null===m.alternate&&t(o,d),i=a(m,i,g),null===u?l=m:u.sibling=m,u=m,d=v}if(g===s.length)return r(o,d),ii&&$o(o,g),l;if(null===d){for(;g<s.length;g++)null!==(d=p(o,s[g],c))&&(i=a(d,i,g),null===u?l=d:u.sibling=d,u=d);return ii&&$o(o,g),l}for(d=n(o,d);g<s.length;g++)null!==(v=h(d,o,g,s[g],c))&&(e&&null!==v.alternate&&d.delete(null===v.key?g:v.key),i=a(v,i,g),null===u?l=v:u.sibling=v,u=v);return e&&d.forEach((function(e){return t(o,e)})),ii&&$o(o,g),l}function v(o,s,c,l){var u=L(c);if("function"!==typeof u)throw Error(i(150));if(null==(c=u.call(c)))throw Error(i(151));for(var d=u=null,g=s,v=s=0,m=null,b=c.next();null!==g&&!b.done;v++,b=c.next()){g.index>v?(m=g,g=null):m=g.sibling;var y=f(o,g,b.value,l);if(null===y){null===g&&(g=m);break}e&&g&&null===y.alternate&&t(o,g),s=a(y,s,v),null===d?u=y:d.sibling=y,d=y,g=m}if(b.done)return r(o,g),ii&&$o(o,v),u;if(null===g){for(;!b.done;v++,b=c.next())null!==(b=p(o,b.value,l))&&(s=a(b,s,v),null===d?u=b:d.sibling=b,d=b);return ii&&$o(o,v),u}for(g=n(o,g);!b.done;v++,b=c.next())null!==(b=h(g,o,v,b.value,l))&&(e&&null!==b.alternate&&g.delete(null===b.key?v:b.key),s=a(b,s,v),null===d?u=b:d.sibling=b,d=b);return e&&g.forEach((function(e){return t(o,e)})),ii&&$o(o,v),u}return function e(n,i,a,c){if("object"===typeof a&&null!==a&&a.type===C&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var l=a.key,u=i;null!==u;){if(u.key===l){if((l=a.type)===C){if(7===u.tag){r(n,u.sibling),(i=o(u,a.props.children)).return=n,n=i;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===O&&Ji(l)===u.type){r(n,u.sibling),(i=o(u,a.props)).ref=Qi(n,u,a),i.return=n,n=i;break e}r(n,u);break}t(n,u),u=u.sibling}a.type===C?((i=Ll(a.props.children,n.mode,c,a.key)).return=n,n=i):((c=Dl(a.type,a.key,a.props,null,n.mode,c)).ref=Qi(n,i,a),c.return=n,n=c)}return s(n);case x:e:{for(u=a.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){r(n,i.sibling),(i=o(i,a.children||[])).return=n,n=i;break e}r(n,i);break}t(n,i),i=i.sibling}(i=Fl(a,n.mode,c)).return=n,n=i}return s(n);case O:return e(n,i,(u=a._init)(a._payload),c)}if(te(a))return g(n,i,a,c);if(L(a))return v(n,i,a,c);Wi(n,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==i&&6===i.tag?(r(n,i.sibling),(i=o(i,a)).return=n,n=i):(r(n,i),(i=Ul(a,n.mode,c)).return=n,n=i),s(n)):r(n,i)}}var Xi=Yi(!0),Zi=Yi(!1),$i={},ea=_o($i),ta=_o($i),ra=_o($i);function na(e){if(e===$i)throw Error(i(174));return e}function oa(e,t){switch(Io(ra,t),Io(ta,e),Io(ea,$i),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}So(ea),Io(ea,t)}function ia(){So(ea),So(ta),So(ra)}function aa(e){na(ra.current);var t=na(ea.current),r=ce(t,e.type);t!==r&&(Io(ta,e),Io(ea,r))}function sa(e){ta.current===e&&(So(ea),So(ta))}var ca=_o(0);function la(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ua=[];function da(){for(var e=0;e<ua.length;e++)ua[e]._workInProgressVersionPrimary=null;ua.length=0}var pa=k.ReactCurrentDispatcher,fa=k.ReactCurrentBatchConfig,ha=0,ga=null,va=null,ma=null,ba=!1,ya=!1,ka=0,wa=0;function xa(){throw Error(i(321))}function Ca(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!sn(e[r],t[r]))return!1;return!0}function Ta(e,t,r,n,o,a){if(ha=a,ga=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,pa.current=null===e||null===e.memoizedState?ss:cs,e=r(n,o),ya){a=0;do{if(ya=!1,ka=0,25<=a)throw Error(i(301));a+=1,ma=va=null,t.updateQueue=null,pa.current=ls,e=r(n,o)}while(ya)}if(pa.current=as,t=null!==va&&null!==va.next,ha=0,ma=va=ga=null,ba=!1,t)throw Error(i(300));return e}function _a(){var e=0!==ka;return ka=0,e}function Sa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ma?ga.memoizedState=ma=e:ma=ma.next=e,ma}function Ia(){if(null===va){var e=ga.alternate;e=null!==e?e.memoizedState:null}else e=va.next;var t=null===ma?ga.memoizedState:ma.next;if(null!==t)ma=t,va=e;else{if(null===e)throw Error(i(310));e={memoizedState:(va=e).memoizedState,baseState:va.baseState,baseQueue:va.baseQueue,queue:va.queue,next:null},null===ma?ga.memoizedState=ma=e:ma=ma.next=e}return ma}function Ea(e,t){return"function"===typeof t?t(e):t}function Aa(e){var t=Ia(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=va,o=n.baseQueue,a=r.pending;if(null!==a){if(null!==o){var s=o.next;o.next=a.next,a.next=s}n.baseQueue=o=a,r.pending=null}if(null!==o){a=o.next,n=n.baseState;var c=s=null,l=null,u=a;do{var d=u.lane;if((ha&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=p,s=n):l=l.next=p,ga.lanes|=d,Mc|=d}u=u.next}while(null!==u&&u!==a);null===l?s=n:l.next=c,sn(n,t.memoizedState)||(ks=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(null!==(e=r.interleaved)){o=e;do{a=o.lane,ga.lanes|=a,Mc|=a,o=o.next}while(o!==e)}else null===o&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ra(e){var t=Ia(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=r.dispatch,o=r.pending,a=t.memoizedState;if(null!==o){r.pending=null;var s=o=o.next;do{a=e(a,s.action),s=s.next}while(s!==o);sn(a,t.memoizedState)||(ks=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function Pa(){}function Oa(e,t){var r=ga,n=Ia(),o=t(),a=!sn(n.memoizedState,o);if(a&&(n.memoizedState=o,ks=!0),n=n.queue,Ga(La.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||null!==ma&&1&ma.memoizedState.tag){if(r.flags|=2048,za(9,Da.bind(null,r,n,o,t),void 0,null),null===Ac)throw Error(i(349));0!==(30&ha)||Na(r,t,o)}return o}function Na(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ga.updateQueue)?(t={lastEffect:null,stores:null},ga.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Da(e,t,r,n){t.value=r,t.getSnapshot=n,Ma(t)&&Ua(e)}function La(e,t,r){return r((function(){Ma(t)&&Ua(e)}))}function Ma(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!sn(e,r)}catch(n){return!0}}function Ua(e){var t=Ri(e,1);null!==t&&rl(t,e,1,-1)}function Fa(e){var t=Sa();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ea,lastRenderedState:e},t.queue=e,e=e.dispatch=rs.bind(null,ga,e),[t.memoizedState,e]}function za(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=ga.updateQueue)?(t={lastEffect:null,stores:null},ga.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Ha(){return Ia().memoizedState}function Ba(e,t,r,n){var o=Sa();ga.flags|=e,o.memoizedState=za(1|t,r,void 0,void 0===n?null:n)}function qa(e,t,r,n){var o=Ia();n=void 0===n?null:n;var i=void 0;if(null!==va){var a=va.memoizedState;if(i=a.destroy,null!==n&&Ca(n,a.deps))return void(o.memoizedState=za(t,r,i,n))}ga.flags|=e,o.memoizedState=za(1|t,r,i,n)}function ja(e,t){return Ba(8390656,8,e,t)}function Ga(e,t){return qa(2048,8,e,t)}function Va(e,t){return qa(4,2,e,t)}function Ka(e,t){return qa(4,4,e,t)}function Qa(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Wa(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,qa(4,4,Qa.bind(null,t,e),r)}function Ja(){}function Ya(e,t){var r=Ia();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Ca(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Xa(e,t){var r=Ia();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Ca(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Za(e,t,r){return 0===(21&ha)?(e.baseState&&(e.baseState=!1,ks=!0),e.memoizedState=r):(sn(r,t)||(r=gt(),ga.lanes|=r,Mc|=r,e.baseState=!0),t)}function $a(e,t){var r=yt;yt=0!==r&&4>r?r:4,e(!0);var n=fa.transition;fa.transition={};try{e(!1),t()}finally{yt=r,fa.transition=n}}function es(){return Ia().memoizedState}function ts(e,t,r){var n=tl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ns(e))os(t,r);else if(null!==(r=Ai(e,t,r,n))){rl(r,e,n,el()),is(r,t,n)}}function rs(e,t,r){var n=tl(e),o={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ns(e))os(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=i(a,r);if(o.hasEagerState=!0,o.eagerState=s,sn(s,a)){var c=t.interleaved;return null===c?(o.next=o,Ei(t)):(o.next=c.next,c.next=o),void(t.interleaved=o)}}catch(l){}null!==(r=Ai(e,t,o,n))&&(rl(r,e,n,o=el()),is(r,t,n))}}function ns(e){var t=e.alternate;return e===ga||null!==t&&t===ga}function os(e,t){ya=ba=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function is(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,bt(e,r)}}var as={readContext:Si,useCallback:xa,useContext:xa,useEffect:xa,useImperativeHandle:xa,useInsertionEffect:xa,useLayoutEffect:xa,useMemo:xa,useReducer:xa,useRef:xa,useState:xa,useDebugValue:xa,useDeferredValue:xa,useTransition:xa,useMutableSource:xa,useSyncExternalStore:xa,useId:xa,unstable_isNewReconciler:!1},ss={readContext:Si,useCallback:function(e,t){return Sa().memoizedState=[e,void 0===t?null:t],e},useContext:Si,useEffect:ja,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Ba(4194308,4,Qa.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ba(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ba(4,2,e,t)},useMemo:function(e,t){var r=Sa();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Sa();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ts.bind(null,ga,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Sa().memoizedState=e},useState:Fa,useDebugValue:Ja,useDeferredValue:function(e){return Sa().memoizedState=e},useTransition:function(){var e=Fa(!1),t=e[0];return e=$a.bind(null,e[1]),Sa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ga,o=Sa();if(ii){if(void 0===r)throw Error(i(407));r=r()}else{if(r=t(),null===Ac)throw Error(i(349));0!==(30&ha)||Na(n,t,r)}o.memoizedState=r;var a={value:r,getSnapshot:t};return o.queue=a,ja(La.bind(null,n,a,e),[e]),n.flags|=2048,za(9,Da.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Sa(),t=Ac.identifierPrefix;if(ii){var r=Zo;t=":"+t+"R"+(r=(Xo&~(1<<32-at(Xo)-1)).toString(32)+r),0<(r=ka++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=wa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},cs={readContext:Si,useCallback:Ya,useContext:Si,useEffect:Ga,useImperativeHandle:Wa,useInsertionEffect:Va,useLayoutEffect:Ka,useMemo:Xa,useReducer:Aa,useRef:Ha,useState:function(){return Aa(Ea)},useDebugValue:Ja,useDeferredValue:function(e){return Za(Ia(),va.memoizedState,e)},useTransition:function(){return[Aa(Ea)[0],Ia().memoizedState]},useMutableSource:Pa,useSyncExternalStore:Oa,useId:es,unstable_isNewReconciler:!1},ls={readContext:Si,useCallback:Ya,useContext:Si,useEffect:Ga,useImperativeHandle:Wa,useInsertionEffect:Va,useLayoutEffect:Ka,useMemo:Xa,useReducer:Ra,useRef:Ha,useState:function(){return Ra(Ea)},useDebugValue:Ja,useDeferredValue:function(e){var t=Ia();return null===va?t.memoizedState=e:Za(t,va.memoizedState,e)},useTransition:function(){return[Ra(Ea)[0],Ia().memoizedState]},useMutableSource:Pa,useSyncExternalStore:Oa,useId:es,unstable_isNewReconciler:!1};function us(e,t){try{var r="",n=t;do{r+=B(n),n=n.return}while(n);var o=r}catch(i){o="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:o,digest:null}}function ds(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function ps(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}var fs="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,r){(r=Di(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Gc||(Gc=!0,Vc=n),ps(0,t)},r}function gs(e,t,r){(r=Di(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var o=t.value;r.payload=function(){return n(o)},r.callback=function(){ps(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(r.callback=function(){ps(0,t),"function"!==typeof n&&(null===Kc?Kc=new Set([this]):Kc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function vs(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new fs;var o=new Set;n.set(t,o)}else void 0===(o=n.get(t))&&(o=new Set,n.set(t,o));o.has(r)||(o.add(r),e=_l.bind(null,e,t,r),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bs(e,t,r,n,o){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Di(-1,1)).tag=2,Li(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var ys=k.ReactCurrentOwner,ks=!1;function ws(e,t,r,n){t.child=null===e?Zi(t,null,r,n):Xi(t,e.child,r,n)}function xs(e,t,r,n,o){r=r.render;var i=t.ref;return _i(t,o),n=Ta(e,t,r,n,i,o),r=_a(),null===e||ks?(ii&&r&&ti(t),t.flags|=1,ws(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Gs(e,t,o))}function Cs(e,t,r,n,o){if(null===e){var i=r.type;return"function"!==typeof i||Ol(i)||void 0!==i.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Dl(r.type,null,n,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ts(e,t,i,n,o))}if(i=e.child,0===(e.lanes&o)){var a=i.memoizedProps;if((r=null!==(r=r.compare)?r:cn)(a,n)&&e.ref===t.ref)return Gs(e,t,o)}return t.flags|=1,(e=Nl(i,n)).ref=t.ref,e.return=t,t.child=e}function Ts(e,t,r,n,o){if(null!==e){var i=e.memoizedProps;if(cn(i,n)&&e.ref===t.ref){if(ks=!1,t.pendingProps=n=i,0===(e.lanes&o))return t.lanes=e.lanes,Gs(e,t,o);0!==(131072&e.flags)&&(ks=!0)}}return Is(e,t,r,n,o)}function _s(e,t,r){var n=t.pendingProps,o=n.children,i=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Io(Nc,Oc),Oc|=r;else{if(0===(1073741824&r))return e=null!==i?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Io(Nc,Oc),Oc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==i?i.baseLanes:r,Io(Nc,Oc),Oc|=n}else null!==i?(n=i.baseLanes|r,t.memoizedState=null):n=r,Io(Nc,Oc),Oc|=n;return ws(e,t,o,r),t.child}function Ss(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Is(e,t,r,n,o){var i=No(r)?Po:Ao.current;return i=Oo(t,i),_i(t,o),r=Ta(e,t,r,n,i,o),n=_a(),null===e||ks?(ii&&n&&ti(t),t.flags|=1,ws(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Gs(e,t,o))}function Es(e,t,r,n,o){if(No(r)){var i=!0;Uo(t)}else i=!1;if(_i(t,o),null===t.stateNode)js(e,t),Gi(t,r,n),Ki(t,r,n,o),n=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var c=a.context,l=r.contextType;"object"===typeof l&&null!==l?l=Si(l):l=Oo(t,l=No(r)?Po:Ao.current);var u=r.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==n||c!==l)&&Vi(t,a,n,l),Pi=!1;var p=t.memoizedState;a.state=p,Fi(t,n,a,o),c=t.memoizedState,s!==n||p!==c||Ro.current||Pi?("function"===typeof u&&(Bi(t,r,u,n),c=t.memoizedState),(s=Pi||ji(t,r,s,n,p,c,l))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=l,n=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,Ni(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:mi(t.type,s),a.props=l,d=t.pendingProps,p=a.context,"object"===typeof(c=r.contextType)&&null!==c?c=Si(c):c=Oo(t,c=No(r)?Po:Ao.current);var f=r.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==d||p!==c)&&Vi(t,a,n,c),Pi=!1,p=t.memoizedState,a.state=p,Fi(t,n,a,o);var h=t.memoizedState;s!==d||p!==h||Ro.current||Pi?("function"===typeof f&&(Bi(t,r,f,n),h=t.memoizedState),(l=Pi||ji(t,r,l,n,p,h,c)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(n,h,c),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,h,c)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=h),a.props=n,a.state=h,a.context=c,n=l):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return As(e,t,r,n,i,o)}function As(e,t,r,n,o,i){Ss(e,t);var a=0!==(128&t.flags);if(!n&&!a)return o&&Fo(t,r,!1),Gs(e,t,i);n=t.stateNode,ys.current=t;var s=a&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&a?(t.child=Xi(t,e.child,null,i),t.child=Xi(t,null,s,i)):ws(e,t,s,i),t.memoizedState=n.state,o&&Fo(t,r,!0),t.child}function Rs(e){var t=e.stateNode;t.pendingContext?Lo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Lo(0,t.context,!1),oa(e,t.containerInfo)}function Ps(e,t,r,n,o){return hi(),gi(o),t.flags|=256,ws(e,t,r,n),t.child}var Os,Ns,Ds,Ls={dehydrated:null,treeContext:null,retryLane:0};function Ms(e){return{baseLanes:e,cachePool:null,transitions:null}}function Us(e,t,r){var n,o=t.pendingProps,a=ca.current,s=!1,c=0!==(128&t.flags);if((n=c)||(n=(null===e||null!==e.memoizedState)&&0!==(2&a)),n?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Io(ca,1&a),null===e)return ui(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=o.children,e=o.fallback,s?(o=t.mode,s=t.child,c={mode:"hidden",children:c},0===(1&o)&&null!==s?(s.childLanes=0,s.pendingProps=c):s=Ml(c,o,0,null),e=Ll(e,o,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ms(r),t.memoizedState=Ls,e):Fs(t,c));if(null!==(a=e.memoizedState)&&null!==(n=a.dehydrated))return function(e,t,r,n,o,a,s){if(r)return 256&t.flags?(t.flags&=-257,zs(e,t,s,n=ds(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=n.fallback,o=t.mode,n=Ml({mode:"visible",children:n.children},o,0,null),(a=Ll(a,o,s,null)).flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,0!==(1&t.mode)&&Xi(t,e.child,null,s),t.child.memoizedState=Ms(s),t.memoizedState=Ls,a);if(0===(1&t.mode))return zs(e,t,s,null);if("$!"===o.data){if(n=o.nextSibling&&o.nextSibling.dataset)var c=n.dgst;return n=c,zs(e,t,s,n=ds(a=Error(i(419)),n,void 0))}if(c=0!==(s&e.childLanes),ks||c){if(null!==(n=Ac)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(n.suspendedLanes|s))?0:o)&&o!==a.retryLane&&(a.retryLane=o,Ri(e,o),rl(n,e,o,-1))}return gl(),zs(e,t,s,n=ds(Error(i(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Il.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,oi=lo(o.nextSibling),ni=t,ii=!0,ai=null,null!==e&&(Wo[Jo++]=Xo,Wo[Jo++]=Zo,Wo[Jo++]=Yo,Xo=e.id,Zo=e.overflow,Yo=t),t=Fs(t,n.children),t.flags|=4096,t)}(e,t,c,o,n,a,r);if(s){s=o.fallback,c=t.mode,n=(a=e.child).sibling;var l={mode:"hidden",children:o.children};return 0===(1&c)&&t.child!==a?((o=t.child).childLanes=0,o.pendingProps=l,t.deletions=null):(o=Nl(a,l)).subtreeFlags=14680064&a.subtreeFlags,null!==n?s=Nl(n,s):(s=Ll(s,c,r,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,c=null===(c=e.child.memoizedState)?Ms(r):{baseLanes:c.baseLanes|r,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=e.childLanes&~r,t.memoizedState=Ls,o}return e=(s=e.child).sibling,o=Nl(s,{mode:"visible",children:o.children}),0===(1&t.mode)&&(o.lanes=r),o.return=t,o.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=o,t.memoizedState=null,o}function Fs(e,t){return(t=Ml({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zs(e,t,r,n){return null!==n&&gi(n),Xi(t,e.child,null,r),(e=Fs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Hs(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ti(e.return,t,r)}function Bs(e,t,r,n,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=o)}function qs(e,t,r){var n=t.pendingProps,o=n.revealOrder,i=n.tail;if(ws(e,t,n.children,r),0!==(2&(n=ca.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Hs(e,r,t);else if(19===e.tag)Hs(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Io(ca,n),0===(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(r=t.child,o=null;null!==r;)null!==(e=r.alternate)&&null===la(e)&&(o=r),r=r.sibling;null===(r=o)?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),Bs(t,!1,o,r,i);break;case"backwards":for(r=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===la(e)){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}Bs(t,!0,r,null,i);break;case"together":Bs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function js(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Mc|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(r=Nl(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Nl(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Vs(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ks(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var o=e.child;null!==o;)r|=o.lanes|o.childLanes,n|=14680064&o.subtreeFlags,n|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags,n|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Qs(e,t,r){var n=t.pendingProps;switch(ri(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ks(t),null;case 1:case 17:return No(t.type)&&Do(),Ks(t),null;case 3:return n=t.stateNode,ia(),So(Ro),So(Ao),da(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(pi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ai&&(al(ai),ai=null))),Ks(t),null;case 5:sa(t);var o=na(ra.current);if(r=t.type,null!==e&&null!=t.stateNode)Ns(e,t,r,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(i(166));return Ks(t),null}if(e=na(ea.current),pi(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[fo]=t,n[ho]=a,e=0!==(1&t.mode),r){case"dialog":zn("cancel",n),zn("close",n);break;case"iframe":case"object":case"embed":zn("load",n);break;case"video":case"audio":for(o=0;o<Ln.length;o++)zn(Ln[o],n);break;case"source":zn("error",n);break;case"img":case"image":case"link":zn("error",n),zn("load",n);break;case"details":zn("toggle",n);break;case"input":Y(n,a),zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},zn("invalid",n);break;case"textarea":oe(n,a),zn("invalid",n)}for(var c in be(r,a),o=null,a)if(a.hasOwnProperty(c)){var l=a[c];"children"===c?"string"===typeof l?n.textContent!==l&&(!0!==a.suppressHydrationWarning&&Zn(n.textContent,l,e),o=["children",l]):"number"===typeof l&&n.textContent!==""+l&&(!0!==a.suppressHydrationWarning&&Zn(n.textContent,l,e),o=["children",""+l]):s.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&zn("scroll",n)}switch(r){case"input":K(n),$(n,a,!0);break;case"textarea":K(n),ae(n);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(n.onclick=$n)}n=o,t.updateQueue=n,null!==n&&(t.flags|=4)}else{c=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=c.createElement(r,{is:n.is}):(e=c.createElement(r),"select"===r&&(c=e,n.multiple?c.multiple=!0:n.size&&(c.size=n.size))):e=c.createElementNS(e,r),e[fo]=t,e[ho]=n,Os(e,t),t.stateNode=e;e:{switch(c=ye(r,n),r){case"dialog":zn("cancel",e),zn("close",e),o=n;break;case"iframe":case"object":case"embed":zn("load",e),o=n;break;case"video":case"audio":for(o=0;o<Ln.length;o++)zn(Ln[o],e);o=n;break;case"source":zn("error",e),o=n;break;case"img":case"image":case"link":zn("error",e),zn("load",e),o=n;break;case"details":zn("toggle",e),o=n;break;case"input":Y(e,n),o=J(e,n),zn("invalid",e);break;case"option":default:o=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=U({},n,{value:void 0}),zn("invalid",e);break;case"textarea":oe(e,n),o=ne(e,n),zn("invalid",e)}for(a in be(r,o),l=o)if(l.hasOwnProperty(a)){var u=l[a];"style"===a?ve(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==r||""!==u)&&pe(e,u):"number"===typeof u&&pe(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=u&&"onScroll"===a&&zn("scroll",e):null!=u&&y(e,a,u,c))}switch(r){case"input":K(e),$(e,n,!1);break;case"textarea":K(e),ae(e);break;case"option":null!=n.value&&e.setAttribute("value",""+G(n.value));break;case"select":e.multiple=!!n.multiple,null!=(a=n.value)?re(e,!!n.multiple,a,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=$n)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ks(t),null;case 6:if(e&&null!=t.stateNode)Ds(0,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(i(166));if(r=na(ra.current),na(ea.current),pi(t)){if(n=t.stateNode,r=t.memoizedProps,n[fo]=t,(a=n.nodeValue!==r)&&null!==(e=ni))switch(e.tag){case 3:Zn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zn(n.nodeValue,r,0!==(1&e.mode))}a&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[fo]=t,t.stateNode=n}return Ks(t),null;case 13:if(So(ca),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==oi&&0!==(1&t.mode)&&0===(128&t.flags))fi(),hi(),t.flags|=98560,a=!1;else if(a=pi(t),null!==n&&null!==n.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[fo]=t}else hi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ks(t),a=!1}else null!==ai&&(al(ai),ai=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ca.current)?0===Dc&&(Dc=3):gl())),null!==t.updateQueue&&(t.flags|=4),Ks(t),null);case 4:return ia(),null===e&&qn(t.stateNode.containerInfo),Ks(t),null;case 10:return Ci(t.type._context),Ks(t),null;case 19:if(So(ca),null===(a=t.memoizedState))return Ks(t),null;if(n=0!==(128&t.flags),null===(c=a.rendering))if(n)Vs(a,!1);else{if(0!==Dc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=la(e))){for(t.flags|=128,Vs(a,!1),null!==(n=c.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(a=r).flags&=14680066,null===(c=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,e=c.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Io(ca,1&ca.current|2),t.child}e=e.sibling}null!==a.tail&&Xe()>qc&&(t.flags|=128,n=!0,Vs(a,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=la(c))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Vs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!c.alternate&&!ii)return Ks(t),null}else 2*Xe()-a.renderingStartTime>qc&&1073741824!==r&&(t.flags|=128,n=!0,Vs(a,!1),t.lanes=4194304);a.isBackwards?(c.sibling=t.child,t.child=c):(null!==(r=a.last)?r.sibling=c:t.child=c,a.last=c)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Xe(),t.sibling=null,r=ca.current,Io(ca,n?1&r|2:1&r),t):(Ks(t),null);case 22:case 23:return dl(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Oc)&&(Ks(t),6&t.subtreeFlags&&(t.flags|=8192)):Ks(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ws(e,t){switch(ri(t),t.tag){case 1:return No(t.type)&&Do(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ia(),So(Ro),So(Ao),da(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return sa(t),null;case 13:if(So(ca),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));hi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return So(ca),null;case 4:return ia(),null;case 10:return Ci(t.type._context),null;case 22:case 23:return dl(),null;default:return null}}Os=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Ns=function(e,t,r,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,na(ea.current);var i,a=null;switch(r){case"input":o=J(e,o),n=J(e,n),a=[];break;case"select":o=U({},o,{value:void 0}),n=U({},n,{value:void 0}),a=[];break;case"textarea":o=ne(e,o),n=ne(e,n),a=[];break;default:"function"!==typeof o.onClick&&"function"===typeof n.onClick&&(e.onclick=$n)}for(u in be(r,n),r=null,o)if(!n.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var c=o[u];for(i in c)c.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var l=n[u];if(c=null!=o?o[u]:void 0,n.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(i in c)!c.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&c[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(u,r)),r=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(a=a||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(a=a||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&zn("scroll",e),a||c===l||(a=[])):(a=a||[]).push(u,l))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Ds=function(e,t,r,n){r!==n&&(t.flags|=4)};var Js=!1,Ys=!1,Xs="function"===typeof WeakSet?WeakSet:Set,Zs=null;function $s(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){Tl(e,t,n)}else r.current=null}function ec(e,t,r){try{r()}catch(n){Tl(e,t,n)}}var tc=!1;function rc(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var o=n=n.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&ec(t,r,i)}o=o.next}while(o!==n)}}function nc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function oc(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function ic(e){var t=e.alternate;null!==t&&(e.alternate=null,ic(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fo],delete t[ho],delete t[vo],delete t[mo],delete t[bo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ac(e){return 5===e.tag||3===e.tag||4===e.tag}function sc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ac(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=$n));else if(4!==n&&null!==(e=e.child))for(cc(e,t,r),e=e.sibling;null!==e;)cc(e,t,r),e=e.sibling}function lc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(lc(e,t,r),e=e.sibling;null!==e;)lc(e,t,r),e=e.sibling}var uc=null,dc=!1;function pc(e,t,r){for(r=r.child;null!==r;)fc(e,t,r),r=r.sibling}function fc(e,t,r){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(ot,r)}catch(s){}switch(r.tag){case 5:Ys||$s(r,t);case 6:var n=uc,o=dc;uc=null,pc(e,t,r),dc=o,null!==(uc=n)&&(dc?(e=uc,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):uc.removeChild(r.stateNode));break;case 18:null!==uc&&(dc?(e=uc,r=r.stateNode,8===e.nodeType?co(e.parentNode,r):1===e.nodeType&&co(e,r),qt(e)):co(uc,r.stateNode));break;case 4:n=uc,o=dc,uc=r.stateNode.containerInfo,dc=!0,pc(e,t,r),uc=n,dc=o;break;case 0:case 11:case 14:case 15:if(!Ys&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){o=n=n.next;do{var i=o,a=i.destroy;i=i.tag,void 0!==a&&(0!==(2&i)||0!==(4&i))&&ec(r,t,a),o=o.next}while(o!==n)}pc(e,t,r);break;case 1:if(!Ys&&($s(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){Tl(r,t,s)}pc(e,t,r);break;case 21:pc(e,t,r);break;case 22:1&r.mode?(Ys=(n=Ys)||null!==r.memoizedState,pc(e,t,r),Ys=n):pc(e,t,r);break;default:pc(e,t,r)}}function hc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Xs),t.forEach((function(t){var n=El.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function gc(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var o=r[n];try{var a=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 5:uc=c.stateNode,dc=!1;break e;case 3:case 4:uc=c.stateNode.containerInfo,dc=!0;break e}c=c.return}if(null===uc)throw Error(i(160));fc(a,s,o),uc=null,dc=!1;var l=o.alternate;null!==l&&(l.return=null),o.return=null}catch(u){Tl(o,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vc(t,e),t=t.sibling}function vc(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gc(t,e),mc(e),4&n){try{rc(3,e,e.return),nc(3,e)}catch(v){Tl(e,e.return,v)}try{rc(5,e,e.return)}catch(v){Tl(e,e.return,v)}}break;case 1:gc(t,e),mc(e),512&n&&null!==r&&$s(r,r.return);break;case 5:if(gc(t,e),mc(e),512&n&&null!==r&&$s(r,r.return),32&e.flags){var o=e.stateNode;try{pe(o,"")}catch(v){Tl(e,e.return,v)}}if(4&n&&null!=(o=e.stateNode)){var a=e.memoizedProps,s=null!==r?r.memoizedProps:a,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===a.type&&null!=a.name&&X(o,a),ye(c,s);var u=ye(c,a);for(s=0;s<l.length;s+=2){var d=l[s],p=l[s+1];"style"===d?ve(o,p):"dangerouslySetInnerHTML"===d?de(o,p):"children"===d?pe(o,p):y(o,d,p,u)}switch(c){case"input":Z(o,a);break;case"textarea":ie(o,a);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var h=a.value;null!=h?re(o,!!a.multiple,h,!1):f!==!!a.multiple&&(null!=a.defaultValue?re(o,!!a.multiple,a.defaultValue,!0):re(o,!!a.multiple,a.multiple?[]:"",!1))}o[ho]=a}catch(v){Tl(e,e.return,v)}}break;case 6:if(gc(t,e),mc(e),4&n){if(null===e.stateNode)throw Error(i(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(v){Tl(e,e.return,v)}}break;case 3:if(gc(t,e),mc(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(v){Tl(e,e.return,v)}break;case 4:default:gc(t,e),mc(e);break;case 13:gc(t,e),mc(e),8192&(o=e.child).flags&&(a=null!==o.memoizedState,o.stateNode.isHidden=a,!a||null!==o.alternate&&null!==o.alternate.memoizedState||(Bc=Xe())),4&n&&hc(e);break;case 22:if(d=null!==r&&null!==r.memoizedState,1&e.mode?(Ys=(u=Ys)||d,gc(t,e),Ys=u):gc(t,e),mc(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Zs=e,d=e.child;null!==d;){for(p=Zs=d;null!==Zs;){switch(h=(f=Zs).child,f.tag){case 0:case 11:case 14:case 15:rc(4,f,f.return);break;case 1:$s(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){n=f,r=f.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(v){Tl(n,r,v)}}break;case 5:$s(f,f.return);break;case 22:if(null!==f.memoizedState){wc(p);continue}}null!==h?(h.return=f,Zs=h):wc(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{o=p.stateNode,u?"function"===typeof(a=o.style).setProperty?a.setProperty("display","none","important"):a.display="none":(c=p.stateNode,s=void 0!==(l=p.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=ge("display",s))}catch(v){Tl(e,e.return,v)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(v){Tl(e,e.return,v)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:gc(t,e),mc(e),4&n&&hc(e);case 21:}}function mc(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(ac(r)){var n=r;break e}r=r.return}throw Error(i(160))}switch(n.tag){case 5:var o=n.stateNode;32&n.flags&&(pe(o,""),n.flags&=-33),lc(e,sc(e),o);break;case 3:case 4:var a=n.stateNode.containerInfo;cc(e,sc(e),a);break;default:throw Error(i(161))}}catch(s){Tl(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bc(e,t,r){Zs=e,yc(e,t,r)}function yc(e,t,r){for(var n=0!==(1&e.mode);null!==Zs;){var o=Zs,i=o.child;if(22===o.tag&&n){var a=null!==o.memoizedState||Js;if(!a){var s=o.alternate,c=null!==s&&null!==s.memoizedState||Ys;s=Js;var l=Ys;if(Js=a,(Ys=c)&&!l)for(Zs=o;null!==Zs;)c=(a=Zs).child,22===a.tag&&null!==a.memoizedState?xc(o):null!==c?(c.return=a,Zs=c):xc(o);for(;null!==i;)Zs=i,yc(i,t,r),i=i.sibling;Zs=o,Js=s,Ys=l}kc(e)}else 0!==(8772&o.subtreeFlags)&&null!==i?(i.return=o,Zs=i):kc(e)}}function kc(e){for(;null!==Zs;){var t=Zs;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ys||nc(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ys)if(null===r)n.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:mi(t.type,r.memoizedProps);n.componentDidUpdate(o,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&zi(t,a,n);break;case 3:var s=t.updateQueue;if(null!==s){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}zi(t,s,r)}break;case 5:var c=t.stateNode;if(null===r&&4&t.flags){r=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&qt(p)}}}break;default:throw Error(i(163))}Ys||512&t.flags&&oc(t)}catch(f){Tl(t,t.return,f)}}if(t===e){Zs=null;break}if(null!==(r=t.sibling)){r.return=t.return,Zs=r;break}Zs=t.return}}function wc(e){for(;null!==Zs;){var t=Zs;if(t===e){Zs=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Zs=r;break}Zs=t.return}}function xc(e){for(;null!==Zs;){var t=Zs;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nc(4,t)}catch(c){Tl(t,r,c)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var o=t.return;try{n.componentDidMount()}catch(c){Tl(t,o,c)}}var i=t.return;try{oc(t)}catch(c){Tl(t,i,c)}break;case 5:var a=t.return;try{oc(t)}catch(c){Tl(t,a,c)}}}catch(c){Tl(t,t.return,c)}if(t===e){Zs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Zs=s;break}Zs=t.return}}var Cc,Tc=Math.ceil,_c=k.ReactCurrentDispatcher,Sc=k.ReactCurrentOwner,Ic=k.ReactCurrentBatchConfig,Ec=0,Ac=null,Rc=null,Pc=0,Oc=0,Nc=_o(0),Dc=0,Lc=null,Mc=0,Uc=0,Fc=0,zc=null,Hc=null,Bc=0,qc=1/0,jc=null,Gc=!1,Vc=null,Kc=null,Qc=!1,Wc=null,Jc=0,Yc=0,Xc=null,Zc=-1,$c=0;function el(){return 0!==(6&Ec)?Xe():-1!==Zc?Zc:Zc=Xe()}function tl(e){return 0===(1&e.mode)?1:0!==(2&Ec)&&0!==Pc?Pc&-Pc:null!==vi.transition?(0===$c&&($c=gt()),$c):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rl(e,t,r,n){if(50<Yc)throw Yc=0,Xc=null,Error(i(185));mt(e,r,n),0!==(2&Ec)&&e===Ac||(e===Ac&&(0===(2&Ec)&&(Uc|=r),4===Dc&&sl(e,Pc)),nl(e,n),1===r&&0===Ec&&0===(1&t.mode)&&(qc=Xe()+500,Ho&&jo()))}function nl(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-at(i),s=1<<a,c=o[a];-1===c?0!==(s&r)&&0===(s&n)||(o[a]=ft(s,t)):c<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var n=pt(e,e===Ac?Pc:0);if(0===n)null!==r&&We(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&We(r),1===t)0===e.tag?function(e){Ho=!0,qo(e)}(cl.bind(null,e)):qo(cl.bind(null,e)),ao((function(){0===(6&Ec)&&jo()})),r=null;else{switch(kt(n)){case 1:r=$e;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Al(r,ol.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ol(e,t){if(Zc=-1,$c=0,0!==(6&Ec))throw Error(i(327));var r=e.callbackNode;if(xl()&&e.callbackNode!==r)return null;var n=pt(e,e===Ac?Pc:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=vl(e,n);else{t=n;var o=Ec;Ec|=2;var a=hl();for(Ac===e&&Pc===t||(jc=null,qc=Xe()+500,pl(e,t));;)try{bl();break}catch(c){fl(e,c)}xi(),_c.current=a,Ec=o,null!==Rc?t=0:(Ac=null,Pc=0,t=Dc)}if(0!==t){if(2===t&&(0!==(o=ht(e))&&(n=o,t=il(e,o))),1===t)throw r=Lc,pl(e,0),sl(e,n),nl(e,Xe()),r;if(6===t)sl(e,n);else{if(o=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var o=r[n],i=o.getSnapshot;o=o.value;try{if(!sn(i(),o))return!1}catch(s){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=vl(e,n))&&(0!==(a=ht(e))&&(n=a,t=il(e,a))),1===t))throw r=Lc,pl(e,0),sl(e,n),nl(e,Xe()),r;switch(e.finishedWork=o,e.finishedLanes=n,t){case 0:case 1:throw Error(i(345));case 2:case 5:wl(e,Hc,jc);break;case 3:if(sl(e,n),(130023424&n)===n&&10<(t=Bc+500-Xe())){if(0!==pt(e,0))break;if(((o=e.suspendedLanes)&n)!==n){el(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=no(wl.bind(null,e,Hc,jc),t);break}wl(e,Hc,jc);break;case 4:if(sl(e,n),(4194240&n)===n)break;for(t=e.eventTimes,o=-1;0<n;){var s=31-at(n);a=1<<s,(s=t[s])>o&&(o=s),n&=~a}if(n=o,10<(n=(120>(n=Xe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Tc(n/1960))-n)){e.timeoutHandle=no(wl.bind(null,e,Hc,jc),n);break}wl(e,Hc,jc);break;default:throw Error(i(329))}}}return nl(e,Xe()),e.callbackNode===r?ol.bind(null,e):null}function il(e,t){var r=zc;return e.current.memoizedState.isDehydrated&&(pl(e,t).flags|=256),2!==(e=vl(e,t))&&(t=Hc,Hc=r,null!==t&&al(t)),e}function al(e){null===Hc?Hc=e:Hc.push.apply(Hc,e)}function sl(e,t){for(t&=~Fc,t&=~Uc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-at(t),n=1<<r;e[r]=-1,t&=~n}}function cl(e){if(0!==(6&Ec))throw Error(i(327));xl();var t=pt(e,0);if(0===(1&t))return nl(e,Xe()),null;var r=vl(e,t);if(0!==e.tag&&2===r){var n=ht(e);0!==n&&(t=n,r=il(e,n))}if(1===r)throw r=Lc,pl(e,0),sl(e,t),nl(e,Xe()),r;if(6===r)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wl(e,Hc,jc),nl(e,Xe()),null}function ll(e,t){var r=Ec;Ec|=1;try{return e(t)}finally{0===(Ec=r)&&(qc=Xe()+500,Ho&&jo())}}function ul(e){null!==Wc&&0===Wc.tag&&0===(6&Ec)&&xl();var t=Ec;Ec|=1;var r=Ic.transition,n=yt;try{if(Ic.transition=null,yt=1,e)return e()}finally{yt=n,Ic.transition=r,0===(6&(Ec=t))&&jo()}}function dl(){Oc=Nc.current,So(Nc)}function pl(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,oo(r)),null!==Rc)for(r=Rc.return;null!==r;){var n=r;switch(ri(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Do();break;case 3:ia(),So(Ro),So(Ao),da();break;case 5:sa(n);break;case 4:ia();break;case 13:case 19:So(ca);break;case 10:Ci(n.type._context);break;case 22:case 23:dl()}r=r.return}if(Ac=e,Rc=e=Nl(e.current,null),Pc=Oc=t,Dc=0,Lc=null,Fc=Uc=Mc=0,Hc=zc=null,null!==Ii){for(t=0;t<Ii.length;t++)if(null!==(n=(r=Ii[t]).interleaved)){r.interleaved=null;var o=n.next,i=r.pending;if(null!==i){var a=i.next;i.next=o,n.next=a}r.pending=n}Ii=null}return e}function fl(e,t){for(;;){var r=Rc;try{if(xi(),pa.current=as,ba){for(var n=ga.memoizedState;null!==n;){var o=n.queue;null!==o&&(o.pending=null),n=n.next}ba=!1}if(ha=0,ma=va=ga=null,ya=!1,ka=0,Sc.current=null,null===r||null===r.return){Dc=1,Lc=t,Rc=null;break}e:{var a=e,s=r.return,c=r,l=t;if(t=Pc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,d=c,p=d.tag;if(0===(1&d.mode)&&(0===p||11===p||15===p)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=ms(s);if(null!==h){h.flags&=-257,bs(h,s,c,0,t),1&h.mode&&vs(a,u,t),l=u;var g=(t=h).updateQueue;if(null===g){var v=new Set;v.add(l),t.updateQueue=v}else g.add(l);break e}if(0===(1&t)){vs(a,u,t),gl();break e}l=Error(i(426))}else if(ii&&1&c.mode){var m=ms(s);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),bs(m,s,c,0,t),gi(us(l,c));break e}}a=l=us(l,c),4!==Dc&&(Dc=2),null===zc?zc=[a]:zc.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Ui(a,hs(0,l,t));break e;case 1:c=l;var b=a.type,y=a.stateNode;if(0===(128&a.flags)&&("function"===typeof b.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Kc||!Kc.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t,Ui(a,gs(a,c,t));break e}}a=a.return}while(null!==a)}kl(r)}catch(k){t=k,Rc===r&&null!==r&&(Rc=r=r.return);continue}break}}function hl(){var e=_c.current;return _c.current=as,null===e?as:e}function gl(){0!==Dc&&3!==Dc&&2!==Dc||(Dc=4),null===Ac||0===(268435455&Mc)&&0===(268435455&Uc)||sl(Ac,Pc)}function vl(e,t){var r=Ec;Ec|=2;var n=hl();for(Ac===e&&Pc===t||(jc=null,pl(e,t));;)try{ml();break}catch(o){fl(e,o)}if(xi(),Ec=r,_c.current=n,null!==Rc)throw Error(i(261));return Ac=null,Pc=0,Dc}function ml(){for(;null!==Rc;)yl(Rc)}function bl(){for(;null!==Rc&&!Je();)yl(Rc)}function yl(e){var t=Cc(e.alternate,e,Oc);e.memoizedProps=e.pendingProps,null===t?kl(e):Rc=t,Sc.current=null}function kl(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=Qs(r,t,Oc)))return void(Rc=r)}else{if(null!==(r=Ws(r,t)))return r.flags&=32767,void(Rc=r);if(null===e)return Dc=6,void(Rc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rc=t);Rc=t=e}while(null!==t);0===Dc&&(Dc=5)}function wl(e,t,r){var n=yt,o=Ic.transition;try{Ic.transition=null,yt=1,function(e,t,r,n){do{xl()}while(null!==Wc);if(0!==(6&Ec))throw Error(i(327));r=e.finishedWork;var o=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-at(r),i=1<<o;t[o]=0,n[o]=-1,e[o]=-1,r&=~i}}(e,a),e===Ac&&(Rc=Ac=null,Pc=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||Qc||(Qc=!0,Al(tt,(function(){return xl(),null}))),a=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||a){a=Ic.transition,Ic.transition=null;var s=yt;yt=1;var c=Ec;Ec|=4,Sc.current=null,function(e,t){if(eo=Gt,fn(e=pn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var o=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch(w){r=null;break e}var s=0,c=-1,l=-1,u=0,d=0,p=e,f=null;t:for(;;){for(var h;p!==r||0!==o&&3!==p.nodeType||(c=s+o),p!==a||0!==n&&3!==p.nodeType||(l=s+n),3===p.nodeType&&(s+=p.nodeValue.length),null!==(h=p.firstChild);)f=p,p=h;for(;;){if(p===e)break t;if(f===r&&++u===o&&(c=s),f===a&&++d===n&&(l=s),null!==(h=p.nextSibling))break;f=(p=f).parentNode}p=h}r=-1===c||-1===l?null:{start:c,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(to={focusedElem:e,selectionRange:r},Gt=!1,Zs=t;null!==Zs;)if(e=(t=Zs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zs=e;else for(;null!==Zs;){t=Zs;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var v=g.memoizedProps,m=g.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?v:mi(t.type,v),m);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var k=t.stateNode.containerInfo;1===k.nodeType?k.textContent="":9===k.nodeType&&k.documentElement&&k.removeChild(k.documentElement);break;default:throw Error(i(163))}}catch(w){Tl(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Zs=e;break}Zs=t.return}g=tc,tc=!1}(e,r),vc(r,e),hn(to),Gt=!!eo,to=eo=null,e.current=r,bc(r,e,o),Ye(),Ec=c,yt=s,Ic.transition=a}else e.current=r;if(Qc&&(Qc=!1,Wc=e,Jc=o),a=e.pendingLanes,0===a&&(Kc=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(ot,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),nl(e,Xe()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)o=t[r],n(o.value,{componentStack:o.stack,digest:o.digest});if(Gc)throw Gc=!1,e=Vc,Vc=null,e;0!==(1&Jc)&&0!==e.tag&&xl(),a=e.pendingLanes,0!==(1&a)?e===Xc?Yc++:(Yc=0,Xc=e):Yc=0,jo()}(e,t,r,n)}finally{Ic.transition=o,yt=n}return null}function xl(){if(null!==Wc){var e=kt(Jc),t=Ic.transition,r=yt;try{if(Ic.transition=null,yt=16>e?16:e,null===Wc)var n=!1;else{if(e=Wc,Wc=null,Jc=0,0!==(6&Ec))throw Error(i(331));var o=Ec;for(Ec|=4,Zs=e.current;null!==Zs;){var a=Zs,s=a.child;if(0!==(16&Zs.flags)){var c=a.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Zs=u;null!==Zs;){var d=Zs;switch(d.tag){case 0:case 11:case 15:rc(8,d,a)}var p=d.child;if(null!==p)p.return=d,Zs=p;else for(;null!==Zs;){var f=(d=Zs).sibling,h=d.return;if(ic(d),d===u){Zs=null;break}if(null!==f){f.return=h,Zs=f;break}Zs=h}}}var g=a.alternate;if(null!==g){var v=g.child;if(null!==v){g.child=null;do{var m=v.sibling;v.sibling=null,v=m}while(null!==v)}}Zs=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Zs=s;else e:for(;null!==Zs;){if(0!==(2048&(a=Zs).flags))switch(a.tag){case 0:case 11:case 15:rc(9,a,a.return)}var b=a.sibling;if(null!==b){b.return=a.return,Zs=b;break e}Zs=a.return}}var y=e.current;for(Zs=y;null!==Zs;){var k=(s=Zs).child;if(0!==(2064&s.subtreeFlags)&&null!==k)k.return=s,Zs=k;else e:for(s=y;null!==Zs;){if(0!==(2048&(c=Zs).flags))try{switch(c.tag){case 0:case 11:case 15:nc(9,c)}}catch(x){Tl(c,c.return,x)}if(c===s){Zs=null;break e}var w=c.sibling;if(null!==w){w.return=c.return,Zs=w;break e}Zs=c.return}}if(Ec=o,jo(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(ot,e)}catch(x){}n=!0}return n}finally{yt=r,Ic.transition=t}}return!1}function Cl(e,t,r){e=Li(e,t=hs(0,t=us(r,t),1),1),t=el(),null!==e&&(mt(e,1,t),nl(e,t))}function Tl(e,t,r){if(3===e.tag)Cl(e,e,r);else for(;null!==t;){if(3===t.tag){Cl(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Kc||!Kc.has(n))){t=Li(t,e=gs(t,e=us(r,e),1),1),e=el(),null!==t&&(mt(t,1,e),nl(t,e));break}}t=t.return}}function _l(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&r,Ac===e&&(Pc&r)===r&&(4===Dc||3===Dc&&(130023424&Pc)===Pc&&500>Xe()-Bc?pl(e,0):Fc|=r),nl(e,t)}function Sl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var r=el();null!==(e=Ri(e,t))&&(mt(e,t,r),nl(e,r))}function Il(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Sl(e,r)}function El(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,o=e.memoizedState;null!==o&&(r=o.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(i(314))}null!==n&&n.delete(t),Sl(e,r)}function Al(e,t){return Qe(e,t)}function Rl(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pl(e,t,r,n){return new Rl(e,t,r,n)}function Ol(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Nl(e,t){var r=e.alternate;return null===r?((r=Pl(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Dl(e,t,r,n,o,a){var s=2;if(n=e,"function"===typeof e)Ol(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case C:return Ll(r.children,o,a,t);case T:s=8,o|=8;break;case _:return(e=Pl(12,r,t,2|o)).elementType=_,e.lanes=a,e;case A:return(e=Pl(13,r,t,o)).elementType=A,e.lanes=a,e;case R:return(e=Pl(19,r,t,o)).elementType=R,e.lanes=a,e;case N:return Ml(r,o,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:s=10;break e;case I:s=9;break e;case E:s=11;break e;case P:s=14;break e;case O:s=16,n=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Pl(s,r,t,o)).elementType=e,t.type=n,t.lanes=a,t}function Ll(e,t,r,n){return(e=Pl(7,e,n,t)).lanes=r,e}function Ml(e,t,r,n){return(e=Pl(22,e,n,t)).elementType=N,e.lanes=r,e.stateNode={isHidden:!1},e}function Ul(e,t,r){return(e=Pl(6,e,null,t)).lanes=r,e}function Fl(e,t,r){return(t=Pl(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zl(e,t,r,n,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=n,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Hl(e,t,r,n,o,i,a,s,c){return e=new zl(e,t,r,s,c),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Pl(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oi(i),e}function Bl(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}function ql(e){if(!e)return Eo;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(No(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var r=e.type;if(No(r))return Mo(e,r,t)}return t}function jl(e,t,r,n,o,i,a,s,c){return(e=Hl(r,n,!0,e,0,i,0,s,c)).context=ql(null),r=e.current,(i=Di(n=el(),o=tl(r))).callback=void 0!==t&&null!==t?t:null,Li(r,i,o),e.current.lanes=o,mt(e,o,n),nl(e,n),e}function Gl(e,t,r,n){var o=t.current,i=el(),a=tl(o);return r=ql(r),null===t.context?t.context=r:t.pendingContext=r,(t=Di(i,a)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Li(o,t,a))&&(rl(e,o,a,i),Mi(e,o,a)),a}function Vl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Ql(e,t){Kl(e,t),(e=e.alternate)&&Kl(e,t)}Cc=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ro.current)ks=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return ks=!1,function(e,t,r){switch(t.tag){case 3:Rs(t),hi();break;case 5:aa(t);break;case 1:No(t.type)&&Uo(t);break;case 4:oa(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,o=t.memoizedProps.value;Io(bi,n._currentValue),n._currentValue=o;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Io(ca,1&ca.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Us(e,t,r):(Io(ca,1&ca.current),null!==(e=Gs(e,t,r))?e.sibling:null);Io(ca,1&ca.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return qs(e,t,r);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Io(ca,ca.current),n)break;return null;case 22:case 23:return t.lanes=0,_s(e,t,r)}return Gs(e,t,r)}(e,t,r);ks=0!==(131072&e.flags)}else ks=!1,ii&&0!==(1048576&t.flags)&&ei(t,Qo,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;js(e,t),e=t.pendingProps;var o=Oo(t,Ao.current);_i(t,r),o=Ta(null,t,n,e,o,r);var a=_a();return t.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,No(n)?(a=!0,Uo(t)):a=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Oi(t),o.updater=qi,t.stateNode=o,o._reactInternals=t,Ki(t,n,e,r),t=As(null,t,n,!0,a,r)):(t.tag=0,ii&&a&&ti(t),ws(null,t,o,r),t=t.child),t;case 16:n=t.elementType;e:{switch(js(e,t),e=t.pendingProps,n=(o=n._init)(n._payload),t.type=n,o=t.tag=function(e){if("function"===typeof e)return Ol(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===P)return 14}return 2}(n),e=mi(n,e),o){case 0:t=Is(null,t,n,e,r);break e;case 1:t=Es(null,t,n,e,r);break e;case 11:t=xs(null,t,n,e,r);break e;case 14:t=Cs(null,t,n,mi(n.type,e),r);break e}throw Error(i(306,n,""))}return t;case 0:return n=t.type,o=t.pendingProps,Is(e,t,n,o=t.elementType===n?o:mi(n,o),r);case 1:return n=t.type,o=t.pendingProps,Es(e,t,n,o=t.elementType===n?o:mi(n,o),r);case 3:e:{if(Rs(t),null===e)throw Error(i(387));n=t.pendingProps,o=(a=t.memoizedState).element,Ni(e,t),Fi(t,n,null,r);var s=t.memoizedState;if(n=s.element,a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ps(e,t,n,r,o=us(Error(i(423)),t));break e}if(n!==o){t=Ps(e,t,n,r,o=us(Error(i(424)),t));break e}for(oi=lo(t.stateNode.containerInfo.firstChild),ni=t,ii=!0,ai=null,r=Zi(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(hi(),n===o){t=Gs(e,t,r);break e}ws(e,t,n,r)}t=t.child}return t;case 5:return aa(t),null===e&&ui(t),n=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,s=o.children,ro(n,o)?s=null:null!==a&&ro(n,a)&&(t.flags|=32),Ss(e,t),ws(e,t,s,r),t.child;case 6:return null===e&&ui(t),null;case 13:return Us(e,t,r);case 4:return oa(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Xi(t,null,n,r):ws(e,t,n,r),t.child;case 11:return n=t.type,o=t.pendingProps,xs(e,t,n,o=t.elementType===n?o:mi(n,o),r);case 7:return ws(e,t,t.pendingProps,r),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,o=t.pendingProps,a=t.memoizedProps,s=o.value,Io(bi,n._currentValue),n._currentValue=s,null!==a)if(sn(a.value,s)){if(a.children===o.children&&!Ro.current){t=Gs(e,t,r);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var c=a.dependencies;if(null!==c){s=a.child;for(var l=c.firstContext;null!==l;){if(l.context===n){if(1===a.tag){(l=Di(-1,r&-r)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}a.lanes|=r,null!==(l=a.alternate)&&(l.lanes|=r),Ti(a.return,r,t),c.lanes|=r;break}l=l.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(i(341));s.lanes|=r,null!==(c=s.alternate)&&(c.lanes|=r),Ti(s,r,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}ws(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,n=t.pendingProps.children,_i(t,r),n=n(o=Si(o)),t.flags|=1,ws(e,t,n,r),t.child;case 14:return o=mi(n=t.type,t.pendingProps),Cs(e,t,n,o=mi(n.type,o),r);case 15:return Ts(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:mi(n,o),js(e,t),t.tag=1,No(n)?(e=!0,Uo(t)):e=!1,_i(t,r),Gi(t,n,o),Ki(t,n,o,r),As(null,t,n,!0,e,r);case 19:return qs(e,t,r);case 22:return _s(e,t,r)}throw Error(i(156,t.tag))};var Wl="function"===typeof reportError?reportError:function(e){console.error(e)};function Jl(e){this._internalRoot=e}function Yl(e){this._internalRoot=e}function Xl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $l(){}function eu(e,t,r,n,o){var i=r._reactRootContainer;if(i){var a=i;if("function"===typeof o){var s=o;o=function(){var e=Vl(a);s.call(e)}}Gl(t,a,e,o)}else a=function(e,t,r,n,o){if(o){if("function"===typeof n){var i=n;n=function(){var e=Vl(a);i.call(e)}}var a=jl(t,n,e,0,null,!1,0,"",$l);return e._reactRootContainer=a,e[go]=a.current,qn(8===e.nodeType?e.parentNode:e),ul(),a}for(;o=e.lastChild;)e.removeChild(o);if("function"===typeof n){var s=n;n=function(){var e=Vl(c);s.call(e)}}var c=Hl(e,0,!1,null,0,!1,0,"",$l);return e._reactRootContainer=c,e[go]=c.current,qn(8===e.nodeType?e.parentNode:e),ul((function(){Gl(t,c,r,n)})),c}(r,t,e,o,n);return Vl(a)}Yl.prototype.render=Jl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Gl(e,t,null,null)},Yl.prototype.unmount=Jl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ul((function(){Gl(null,e,null,null)})),t[go]=null}},Yl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Nt.length&&0!==t&&t<Nt[r].priority;r++);Nt.splice(r,0,e),0===r&&Ut(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=dt(t.pendingLanes);0!==r&&(bt(t,1|r),nl(t,Xe()),0===(6&Ec)&&(qc=Xe()+500,jo()))}break;case 13:ul((function(){var t=Ri(e,1);if(null!==t){var r=el();rl(t,e,1,r)}})),Ql(e,1)}},xt=function(e){if(13===e.tag){var t=Ri(e,134217728);if(null!==t)rl(t,e,134217728,el());Ql(e,134217728)}},Ct=function(e){if(13===e.tag){var t=tl(e),r=Ri(e,t);if(null!==r)rl(r,e,t,el());Ql(e,t)}},Tt=function(){return yt},_t=function(e,t){var r=yt;try{return yt=e,t()}finally{yt=r}},xe=function(e,t,r){switch(t){case"input":if(Z(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var o=xo(n);if(!o)throw Error(i(90));Q(n),Z(n,o)}}}break;case"textarea":ie(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ee=ll,Ae=ul;var tu={usingClientEntryPoint:!1,Events:[ko,wo,xo,Se,Ie,ll]},ru={findFiberByHostInstance:yo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nu={bundleType:ru.bundleType,version:ru.version,rendererPackageName:ru.rendererPackageName,rendererConfig:ru.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:ru.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ou.isDisabled&&ou.supportsFiber)try{ot=ou.inject(nu),it=ou}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xl(t))throw Error(i(200));return Bl(e,t,null,r)},t.createRoot=function(e,t){if(!Xl(e))throw Error(i(299));var r=!1,n="",o=Wl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Hl(e,1,!1,null,0,r,0,n,o),e[go]=t.current,qn(8===e.nodeType?e.parentNode:e),new Jl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return ul(e)},t.hydrate=function(e,t,r){if(!Zl(t))throw Error(i(200));return eu(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Xl(e))throw Error(i(405));var n=null!=r&&r.hydratedSources||null,o=!1,a="",s=Wl;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(o=!0),void 0!==r.identifierPrefix&&(a=r.identifierPrefix),void 0!==r.onRecoverableError&&(s=r.onRecoverableError)),t=jl(t,null,e,1,null!=r?r:null,o,0,a,s),e[go]=t.current,qn(e),n)for(e=0;e<n.length;e++)o=(o=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new Yl(t)},t.render=function(e,t,r){if(!Zl(t))throw Error(i(200));return eu(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Zl(e))throw Error(i(40));return!!e._reactRootContainer&&(ul((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[go]=null}))})),!0)},t.unstable_batchedUpdates=ll,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Zl(r))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return eu(e,t,r,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},250:function(e,t,r){"use strict";var n=r(164);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},164:function(e,t,r){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(463)},645:function(e,t,r){"use strict";function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e,t){var r=t.left,n=t.right,o=t.up,i=t.down,a=t.top,s=t.bottom,c=t.mirror,l=t.opposite,d=(r?1:0)|(n?2:0)|(a||i?4:0)|(s||o?8:0)|(c?16:0)|(l?32:0)|(e?64:0);if(p.hasOwnProperty(d))return p[d];if(!c!=!(e&&l)){var f=[n,r,s,a,i,o];r=f[0],n=f[1],a=f[2],s=f[3],o=f[4],i=f[5]}var h,g=r||n,v=a||s||o||i,m=void 0,b=void 0,y=void 0,k=void 0,w=void 0,x=void 0,C=void 0,T=void 0,_=void 0,S=void 0,I=void 0,E=void 0,A=void 0;return e?(y=g?(n?"-":"")+"20px":0,k=v?(o||s?"":"-")+"10px":"0",w=(i||a?"":"-")+"20px",E=g?(r?"-":"")+"2000px":"0",A=v?(i||a?"-":"")+"2000px":"0"):(m=g?(r?"-":"")+"3000px":"0",b=v?(i||a?"-":"")+"3000px":"0",x=g?(n?"-":"")+"25px":"0",C=v?(o||s?"-":"")+"25px":"0",T=g?(r?"-":"")+"10px":"0",_=v?(i||a?"-":"")+"10px":"0",S=g?(n?"-":"")+"5px":"0",I=v?(o||s?"-":"")+"5px":"0"),h=g||v?e?"\n        20% {\n          transform: translate3d("+y+", "+k+", 0);\n          }\n        "+(v?"40%, 45% {\n            opacity: 1;\n            transform: translate3d(0, "+w+", 0);\n          }":"")+"\n          to {\n            opacity: 0;\n            transform: translate3d("+E+", "+A+", 0);\n        }\n      ":"from, 60%, 75%, 90%, to {\n        animation-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);\n      }\n      from {\n        opacity: 0;\n        transform: translate3d("+m+", "+b+", 0);\n      }\n      60% {\n        opacity: 1;\n        transform: translate3d("+x+", "+C+", 0);\n      }\n      75% {\n        transform: translate3d("+T+", "+_+", 0);\n      }\n      90% {\n        transform: translate3d("+S+", "+I+", 0);\n      }\n      to {\n        transform: none;\n      }":e?"20% {\n          transform: scale3d(.9, .9, .9);\n        }\n        50%, 55% {\n          opacity: 1;\n          transform: scale3d(1.1, 1.1, 1.1);\n        }\n        to {\n          opacity: 0;\n          transform: scale3d(.3, .3, .3);\n      }":"from, 20%, 40%, 60%, 80%, to {\n        animation-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);\n      }\n      0% {\n        opacity: 0;\n        transform: scale3d(.3, .3, .3);\n      }\n      20% {\n        transform: scale3d(1.1, 1.1, 1.1);\n      }\n      40% {\n        transform: scale3d(.9, .9, .9);\n      }\n      60% {\n        opacity: 1;\n        transform: scale3d(1.03, 1.03, 1.03);\n      }\n      80% {\n        transform: scale3d(.97, .97, .97);\n      }\n      to {\n        opacity: 1;\n        transform: scale3d(1, 1, 1);\n      }",p[d]=(0,u.animation)(h),p[d]}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.defaults,t=e.children,r=(e.out,e.forever),i=e.timeout,a=e.duration,s=void 0===a?u.defaults.duration:a,c=e.delay,d=void 0===c?u.defaults.delay:c,p=e.count,f=void 0===p?u.defaults.count:p,h=n(e,["children","out","forever","timeout","duration","delay","count"]),g={make:o,duration:void 0===i?s:i,delay:d,forever:r,count:f,style:{animationFillMode:"both"},reverse:h.left};return(0,l.default)(h,g,g,t)}Object.defineProperty(t,"__esModule",{value:!0});var a,s=r(7),c=r(208),l=(a=c)&&a.__esModule?a:{default:a},u=r(6),d={out:s.bool,left:s.bool,right:s.bool,top:s.bool,bottom:s.bool,mirror:s.bool,opposite:s.bool,duration:s.number,timeout:s.number,delay:s.number,count:s.number,forever:s.bool},p={};i.propTypes=d,t.default=i,e.exports=t.default},75:function(e,t,r){"use strict";function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e,t){var r=t.distance,n=t.left,o=t.right,i=t.up,a=t.down,s=t.top,l=t.bottom,u=t.big,d=t.mirror,f=t.opposite,h=(r?r.toString():0)+((n?1:0)|(o?2:0)|(s||a?4:0)|(l||i?8:0)|(d?16:0)|(f?32:0)|(e?64:0)|(u?128:0));if(p.hasOwnProperty(h))return p[h];var g=n||o||i||a||s||l,v=void 0,m=void 0;if(g){if(!d!=!(e&&f)){var b=[o,n,l,s,a,i];n=b[0],o=b[1],s=b[2],l=b[3],i=b[4],a=b[5]}var y=r||(u?"2000px":"100%");v=n?"-"+y:o?y:"0",m=a||s?"-"+y:i||l?y:"0"}return p[h]=(0,c.animation)((e?"to":"from")+" {opacity: 0;"+(g?" transform: translate3d("+v+", "+m+", 0);":"")+"}\n     "+(e?"from":"to")+" {opacity: 1;transform: none;} "),p[h]}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.defaults,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.children,i=(e.out,e.forever),a=e.timeout,s=e.duration,l=void 0===s?c.defaults.duration:s,d=e.delay,p=void 0===d?c.defaults.delay:d,f=e.count,h=void 0===f?c.defaults.count:f,g=n(e,["children","out","forever","timeout","duration","delay","count"]),v={make:o,duration:void 0===a?l:a,delay:p,forever:i,count:h,style:{animationFillMode:"both"},reverse:g.left};return t?(0,u.default)(g,v,v,r):v}Object.defineProperty(t,"__esModule",{value:!0});var a,s=r(7),c=r(6),l=r(208),u=(a=l)&&a.__esModule?a:{default:a},d={out:s.bool,left:s.bool,right:s.bool,top:s.bool,bottom:s.bool,big:s.bool,mirror:s.bool,opposite:s.bool,duration:s.number,timeout:s.number,distance:s.string,delay:s.number,count:s.number,forever:s.bool},p={};i.propTypes=d,t.default=i,e.exports=t.default},154:function(e,t,r){"use strict";function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e,t){var r=t.left,n=t.right,o=t.top,i=t.bottom,a=t.x,s=t.y,c=t.mirror,l=t.opposite,d=(r?1:0)|(n||s?2:0)|(o||a?4:0)|(i?8:0)|(c?16:0)|(l?32:0)|(e?64:0);if(p.hasOwnProperty(d))return p[d];if(!c!=!(e&&l)){var f=[n,r,i,o,s,a];r=f[0],n=f[1],o=f[2],i=f[3],a=f[4],s=f[5]}var h=void 0;if(a||s||r||n||o||i){var g=a||o||i?(i?"-":"")+"1":"0",v=s||n||r?(r?"-":"")+"1":"0";h=e?"from {\n          transform: perspective(400px);\n        }\n        30% {\n          transform: perspective(400px) rotate3d("+g+", "+v+", 0, -15deg);\n          opacity: 1;\n        }\n        to {\n          transform: perspective(400px) rotate3d("+g+", "+v+", 0, 90deg);\n          opacity: 0;\n        }":"from {\n          transform: perspective(400px) rotate3d("+g+", "+v+", 0, 90deg);\n          animation-timing-function: ease-in;\n          opacity: 0;\n        }\n        40% {\n          transform: perspective(400px) rotate3d("+g+", "+v+", 0, -20deg);\n          animation-timing-function: ease-in;\n        }\n        60% {\n          transform: perspective(400px) rotate3d("+g+", "+v+", 0, 10deg);\n          opacity: 1;\n        }\n        80% {\n          transform: perspective(400px) rotate3d("+g+", "+v+", 0, -5deg);\n        }\n        to {\n          transform: perspective(400px);\n        }"}else h="from {\n          transform: perspective(400px) rotate3d(0, 1, 0, -360deg);\n          animation-timing-function: ease-out;\n          opacity: "+(e?"1":"0")+";\n        }\n        40% {\n          transform: perspective(400px) translate3d(0, 0, 150px) rotate3d(0, 1, 0, -190deg);\n          animation-timing-function: ease-out;\n        }\n        50% {\n          transform: perspective(400px) translate3d(0, 0, 150px) rotate3d(0, 1, 0, -170deg);\n          animation-timing-function: ease-in;\n        }\n        to {\n          transform: perspective(400px);\n          animation-timing-function: ease-in;\n          opacity: "+(e?"0":"1")+";\n        }";return p[d]=(0,u.animation)(h),p[d]}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.defaults,t=e.children,r=(e.out,e.forever),i=e.timeout,a=e.duration,s=void 0===a?u.defaults.duration:a,c=e.delay,d=void 0===c?u.defaults.delay:c,p=e.count,f=void 0===p?u.defaults.count:p,h=n(e,["children","out","forever","timeout","duration","delay","count"]),g={make:o,duration:void 0===i?s:i,delay:d,forever:r,count:f,style:{animationFillMode:"both",backfaceVisibility:"visible"}};return(0,l.default)(h,g,g,t)}Object.defineProperty(t,"__esModule",{value:!0});var a,s=r(7),c=r(208),l=(a=c)&&a.__esModule?a:{default:a},u=r(6),d={out:s.bool,left:s.bool,right:s.bool,top:s.bool,bottom:s.bool,mirror:s.bool,opposite:s.bool,duration:s.number,timeout:s.number,delay:s.number,count:s.number,forever:s.bool},p={};i.propTypes=d,t.default=i,e.exports=t.default},970:function(e,t,r){"use strict";function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e,t){var r=t.left,n=t.right,o=t.mirror,i=t.opposite,a=(r?1:0)|(n?2:0)|(o?16:0)|(i?32:0)|(e?64:0);if(p.hasOwnProperty(a))return p[a];if(!o!=!(e&&i)){var s=[n,r];r=s[0],n=s[1]}var c=r?"-100%":n?"100%":"0",l=e?"from {\n        opacity: 1;\n      }\n      to {\n        transform: translate3d("+c+", 0, 0) skewX(30deg);\n        opacity: 0;\n      }\n    ":"from {\n        transform: translate3d("+c+", 0, 0) skewX(-30deg);\n        opacity: 0;\n      }\n      60% {\n        transform: skewX(20deg);\n        opacity: 1;\n      }\n      80% {\n        transform: skewX(-5deg);\n        opacity: 1;\n      }\n      to {\n        transform: none;\n        opacity: 1;\n      }";return p[a]=(0,u.animation)(l),p[a]}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.defaults,t=e.children,r=(e.out,e.forever),i=e.timeout,a=e.duration,s=void 0===a?u.defaults.duration:a,l=e.delay,d=void 0===l?u.defaults.delay:l,p=e.count,f=void 0===p?u.defaults.count:p,h=n(e,["children","out","forever","timeout","duration","delay","count"]),g={make:o,duration:void 0===i?s:i,delay:d,forever:r,count:f,style:{animationFillMode:"both"}};return h.left,h.right,h.mirror,h.opposite,(0,c.default)(h,g,g,t)}Object.defineProperty(t,"__esModule",{value:!0});var a,s=r(208),c=(a=s)&&a.__esModule?a:{default:a},l=r(7),u=r(6),d={out:l.bool,left:l.bool,right:l.bool,mirror:l.bool,opposite:l.bool,duration:l.number,timeout:l.number,delay:l.number,count:l.number,forever:l.bool},p={};i.propTypes=d,t.default=i,e.exports=t.default},461:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){function t(e){return e?h?{duration:l,delay:u,count:d,forever:p,className:h,style:{}}:v:f?{duration:void 0===n?o:n,delay:i,count:a,forever:s,className:f,style:{}}:g}var r=e.children,n=e.timeout,o=e.duration,i=e.delay,a=e.count,s=e.forever,l=e.durationOut,u=e.delayOut,d=e.countOut,p=e.foreverOut,f=e.effect,h=e.effectOut,g=e.inEffect,v=e.outEffect,m=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["children","timeout","duration","delay","count","forever","durationOut","delayOut","countOut","foreverOut","effect","effectOut","inEffect","outEffect"]);return(0,c.default)(m,t(!1),t(!0),r)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=r(7),s=r(6),c=n(r(208)),l=n(r(75)),u={in:a.object,out:(0,a.oneOfType)([a.object,(0,a.oneOf)([!1])]),effect:a.string,effectOut:a.string,duration:a.number,timeout:a.number,delay:a.number,count:a.number,forever:a.bool,durationOut:a.number,delayOut:a.number,countOut:a.number,foreverOut:a.bool},d=i({},s.defaults,{durationOut:s.defaults.duration,delayOut:s.defaults.delay,countOut:s.defaults.count,foreverOut:s.defaults.forever,inEffect:(0,l.default)(s.defaults),outEffect:(0,l.default)(i({out:!0},s.defaults))});o.propTypes=u,o.defaultProps=d,t.default=o,e.exports=t.default},866:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(791),l=(n=c)&&n.__esModule?n:{default:n},u=r(7),d=r(6),p=(0,u.shape)({make:u.func,duration:u.number.isRequired,delay:u.number.isRequired,forever:u.bool,count:u.number.isRequired,style:u.object.isRequired,reverse:u.bool}),f={collapse:u.bool,collapseEl:u.element,cascade:u.bool,wait:u.number,force:u.bool,disabled:u.bool,appear:u.bool,enter:u.bool,exit:u.bool,fraction:u.number,refProp:u.string,innerRef:u.func,onReveal:u.func,unmountOnExit:u.bool,mountOnEnter:u.bool,inEffect:p.isRequired,outEffect:(0,u.oneOfType)([p,(0,u.oneOf)([!1])]).isRequired,ssrReveal:u.bool,collapseOnly:u.bool,ssrFadeout:u.bool},h={transitionGroup:u.object},g=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return n.isOn=void 0===e.when||!!e.when,n.state={collapse:e.collapse?t.getInitialCollapseStyle(e):void 0,style:{opacity:n.isOn&&!e.ssrReveal||!e.outEffect?void 0:0}},n.savedChild=!1,n.isShown=!1,d.observerMode?n.handleObserve=n.handleObserve.bind(n):(n.revealHandler=n.makeHandler(n.reveal),n.resizeHandler=n.makeHandler(n.resize)),n.saveRef=n.saveRef.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"saveRef",value:function(e){this.childRef&&this.childRef(e),this.props.innerRef&&this.props.innerRef(e),this.el!==e&&(this.el=e&&"offsetHeight"in e?e:void 0,this.observe(this.props,!0))}},{key:"invisible",value:function(){this&&this.el&&(this.savedChild=!1,this.isShown||(this.setState({hasExited:!0,collapse:this.props.collapse?a({},this.state.collapse,{visibility:"hidden"}):null,style:{opacity:0}}),!d.observerMode&&this.props.collapse&&window.document.dispatchEvent(d.collapseend)))}},{key:"animationEnd",value:function(e,t,r){var n=this,o=r.forever,i=r.count,a=r.delay,s=r.duration;if(!o){this.animationEndTimeout=window.setTimeout((function(){n&&n.el&&(n.animationEndTimeout=void 0,e.call(n))}),a+(s+(t?s:0)*i))}}},{key:"getDimensionValue",value:function(){return this.el.offsetHeight+parseInt(window.getComputedStyle(this.el,null).getPropertyValue("margin-top"),10)+parseInt(window.getComputedStyle(this.el,null).getPropertyValue("margin-bottom"),10)}},{key:"collapse",value:function(e,t,r){var n=r.duration+(t.cascade?r.duration:0),o=this.isOn?this.getDimensionValue():0,i=void 0,a=void 0;if(t.collapseOnly)i=r.duration/3,a=r.delay;else{var s=n>>2,c=s>>1;i=s,a=r.delay+(this.isOn?0:n-s-c),e.style.animationDuration=n-s+(this.isOn?c:-c)+"ms",e.style.animationDelay=r.delay+(this.isOn?s-c:0)+"ms"}return e.collapse={height:o,transition:"height "+i+"ms ease "+a+"ms",overflow:t.collapseOnly?"hidden":void 0},e}},{key:"animate",value:function(e){if(this&&this.el&&(this.unlisten(),this.isShown!==this.isOn)){this.isShown=this.isOn;var t=!this.isOn&&e.outEffect,r=e[t?"outEffect":"inEffect"],n="style"in r&&r.style.animationName||void 0,o=void 0;e.collapseOnly?o={hasAppeared:!0,hasExited:!1,style:{opacity:1}}:((e.outEffect||this.isOn)&&r.make&&(n=r.make),o={hasAppeared:!0,hasExited:!1,collapse:void 0,style:a({},r.style,{animationDuration:r.duration+"ms",animationDelay:r.delay+"ms",animationIterationCount:r.forever?"infinite":r.count,opacity:1,animationName:n}),className:r.className}),this.setState(e.collapse?this.collapse(o,e,r):o),t?(this.savedChild=l.default.cloneElement(this.getChild()),this.animationEnd(this.invisible,e.cascade,r)):this.savedChild=!1,this.onReveal(e)}}},{key:"onReveal",value:function(e){e.onReveal&&this.isOn&&(this.onRevealTimeout&&(this.onRevealTimeout=window.clearTimeout(this.onRevealTimeout)),e.wait?this.onRevealTimeout=window.setTimeout(e.onReveal,e.wait):e.onReveal())}},{key:"componentWillUnmount",value:function(){this.unlisten(),d.ssr&&(0,d.disableSsr)()}},{key:"handleObserve",value:function(e,t){i(e,1)[0].intersectionRatio>0&&(t.disconnect(),this.observer=null,this.reveal(this.props,!0))}},{key:"observe",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.el&&d.observerMode){if(this.observer){if(!t)return;this.observer.disconnect()}else if(t)return;this.observer=new IntersectionObserver(this.handleObserve,{threshold:e.fraction}),this.observer.observe(this.el)}}},{key:"reveal",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];d.globalHide||(0,d.hideAll)(),this&&this.el&&(e||(e=this.props),d.ssr&&(0,d.disableSsr)(),this.isOn&&this.isShown&&void 0!==e.spy?(this.isShown=!1,this.setState({style:{}}),window.setTimeout((function(){return t.reveal(e)}),200)):r||this.inViewport(e)||e.force?this.animate(e):d.observerMode?this.observe(e):this.listen())}},{key:"componentDidMount",value:function(){var e=this;if(this.el&&!this.props.disabled){this.props.collapseOnly||("make"in this.props.inEffect&&this.props.inEffect.make(!1,this.props),void 0!==this.props.when&&this.props.outEffect&&"make"in this.props.outEffect&&this.props.outEffect.make(!0,this.props));var r=this.context.transitionGroup,n=r&&!r.isMounting?!("enter"in this.props&&!1===this.props.enter):this.props.appear;return this.isOn&&((void 0!==this.props.when||void 0!==this.props.spy)&&!n||d.ssr&&!d.fadeOutEnabled&&!this.props.ssrFadeout&&this.props.outEffect&&!this.props.ssrReveal&&t.getTop(this.el)<window.pageYOffset+window.innerHeight)?(this.isShown=!0,this.setState({hasAppeared:!0,collapse:this.props.collapse?{height:this.getDimensionValue()}:this.state.collapse,style:{opacity:1}}),void this.onReveal(this.props)):d.ssr&&(d.fadeOutEnabled||this.props.ssrFadeout)&&this.props.outEffect&&t.getTop(this.el)<window.pageYOffset+window.innerHeight?(this.setState({style:{opacity:0,transition:"opacity 1000ms 1000ms"}}),void window.setTimeout((function(){return e.reveal(e.props,!0)}),2e3)):void(this.isOn&&(this.props.force?this.animate(this.props):this.reveal(this.props)))}}},{key:"cascade",value:function(e){var t=this,r=void 0;r="string"==typeof e?e.split("").map((function(e,t){return l.default.createElement("span",{key:t,style:{display:"inline-block",whiteSpace:"pre"}},e)})):l.default.Children.toArray(e);var n=this.props[this.isOn||!this.props.outEffect?"inEffect":"outEffect"],i=n.duration,s=n.reverse,c=r.length,u=2*i;this.props.collapse&&(u=parseInt(this.state.style.animationDuration,10),i=u/2);var p=s?c:0;return r.map((function(e){return"object"===(void 0===e?"undefined":o(e))&&e?l.default.cloneElement(e,{style:a({},e.props.style,t.state.style,{animationDuration:Math.round((0,d.cascade)(s?p--:p++,0,c,i,u))+"ms"})}):e}))}},{key:"componentWillReceiveProps",value:function(e){void 0!==e.when&&(this.isOn=!!e.when),e.fraction!==this.props.fraction&&this.observe(e,!0),!this.isOn&&e.onExited&&"exit"in e&&!1===e.exit?e.onExited():e.disabled||(e.collapse&&!this.props.collapse&&(this.setState({style:{},collapse:t.getInitialCollapseStyle(e)}),this.isShown=!1),e.when===this.props.when&&e.spy===this.props.spy||this.reveal(e),this.onRevealTimeout&&!this.isOn&&(this.onRevealTimeout=window.clearTimeout(this.onRevealTimeout)))}},{key:"getChild",value:function(){if(this.savedChild&&!this.props.disabled)return this.savedChild;if("object"===o(this.props.children)){var e=l.default.Children.only(this.props.children);return"type"in e&&"string"==typeof e.type||"ref"!==this.props.refProp?e:l.default.createElement("div",null,e)}return l.default.createElement("div",null,this.props.children)}},{key:"render",value:function(){var e;e=this.state.hasAppeared?!this.props.unmountOnExit||!this.state.hasExited||this.isOn:!this.props.mountOnEnter||this.isOn;var t=this.getChild();"function"==typeof t.ref&&(this.childRef=t.ref);var r=!1,n=t.props,o=n.style,i=n.className,s=n.children,c=this.props.disabled?i:(this.props.outEffect?d.namespace:"")+(this.state.className?" "+this.state.className:"")+(i?" "+i:"")||void 0,u=void 0;"function"==typeof this.state.style.animationName&&(this.state.style.animationName=this.state.style.animationName(!this.isOn,this.props)),this.props.cascade&&!this.props.disabled&&s&&this.state.style.animationName?(r=this.cascade(s),u=a({},o,{opacity:1})):u=this.props.disabled?o:a({},o,this.state.style);var p=a({},this.props.props,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({className:c,style:u},this.props.refProp,this.saveRef)),f=l.default.cloneElement(t,p,e?r||s:void 0);return void 0!==this.props.collapse?this.props.collapseEl?l.default.cloneElement(this.props.collapseEl,{style:a({},this.props.collapseEl.style,this.props.disabled?void 0:this.state.collapse),children:f}):l.default.createElement("div",{style:this.props.disabled?void 0:this.state.collapse,children:f}):f}},{key:"makeHandler",value:function(e){var t=this,r=function(){e.call(t,t.props),t.ticking=!1};return function(){t.ticking||((0,d.raf)(r),t.ticking=!0)}}},{key:"inViewport",value:function(e){if(!this.el||window.document.hidden)return!1;var r=this.el.offsetHeight,n=window.pageYOffset-t.getTop(this.el),o=Math.min(r,window.innerHeight)*(d.globalHide?e.fraction:0);return n>o-window.innerHeight&&n<r-o}},{key:"resize",value:function(e){this&&this.el&&this.isOn&&this.inViewport(e)&&(this.unlisten(),this.isShown=this.isOn,this.setState({hasExited:!this.isOn,hasAppeared:!0,collapse:void 0,style:{opacity:this.isOn||!e.outEffect?1:0}}),this.onReveal(e))}},{key:"listen",value:function(){d.observerMode||this.isListener||(this.isListener=!0,window.addEventListener("scroll",this.revealHandler,{passive:!0}),window.addEventListener("orientationchange",this.revealHandler,{passive:!0}),window.document.addEventListener("visibilitychange",this.revealHandler,{passive:!0}),window.document.addEventListener("collapseend",this.revealHandler,{passive:!0}),window.addEventListener("resize",this.resizeHandler,{passive:!0}))}},{key:"unlisten",value:function(){!d.observerMode&&this.isListener&&(window.removeEventListener("scroll",this.revealHandler,{passive:!0}),window.removeEventListener("orientationchange",this.revealHandler,{passive:!0}),window.document.removeEventListener("visibilitychange",this.revealHandler,{passive:!0}),window.document.removeEventListener("collapseend",this.revealHandler,{passive:!0}),window.removeEventListener("resize",this.resizeHandler,{passive:!0}),this.isListener=!1),this.onRevealTimeout&&(this.onRevealTimeout=window.clearTimeout(this.onRevealTimeout)),this.animationEndTimeout&&(this.animationEndTimeout=window.clearTimeout(this.animationEndTimeout))}}],[{key:"getInitialCollapseStyle",value:function(e){return{height:0,visibility:e.when?void 0:"hidden"}}},{key:"getTop",value:function(e){for(;void 0===e.offsetTop;)e=e.parentNode;for(var t=e.offsetTop;e.offsetParent;t+=e.offsetTop)e=e.offsetParent;return t}}]),t}(l.default.Component);g.propTypes=f,g.defaultProps={fraction:.2,refProp:"ref"},g.contextTypes=h,g.displayName="RevealBase",t.default=g,e.exports=t.default},811:function(e,t,r){"use strict";function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e,t){var r=t.left,n=t.right,o=t.up,i=t.down,a=t.top,s=t.bottom,c=t.big,l=t.mirror,d=t.opposite,f=(r?1:0)|(n?2:0)|(a||i?4:0)|(s||o?8:0)|(l?16:0)|(d?32:0)|(e?64:0)|(c?128:0);if(p.hasOwnProperty(f))return p[f];if(!l!=!(e&&d)){var h=[n,r,s,a,i,o];r=h[0],n=h[1],a=h[2],s=h[3],o=h[4],i=h[5]}var g=c?"2000px":"100%",v=r?"-"+g:n?g:"0",m=i||a?"-"+g:o||s?g:"0";return p[f]=(0,u.animation)("\n    "+(e?"to":"from")+" {opacity: 0;transform: translate3d("+v+", "+m+", 0) rotate3d(0, 0, 1, -120deg);}\n\t  "+(e?"from":"to")+" {opacity: 1;transform: none}\n  "),p[f]}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.defaults,t=e.children,r=(e.out,e.forever),i=e.timeout,a=e.duration,s=void 0===a?u.defaults.duration:a,l=e.delay,d=void 0===l?u.defaults.delay:l,p=e.count,f=void 0===p?u.defaults.count:p,h=n(e,["children","out","forever","timeout","duration","delay","count"]),g={make:o,duration:void 0===i?s:i,delay:d,forever:r,count:f,style:{animationFillMode:"both"}};return(0,c.default)(h,g,g,t)}Object.defineProperty(t,"__esModule",{value:!0});var a,s=r(208),c=(a=s)&&a.__esModule?a:{default:a},l=r(7),u=r(6),d={out:l.bool,left:l.bool,right:l.bool,top:l.bool,bottom:l.bool,big:l.bool,mirror:l.bool,opposite:l.bool,duration:l.number,timeout:l.number,delay:l.number,count:l.number,forever:l.bool},p={};i.propTypes=d,t.default=i,e.exports=t.default},125:function(e,t,r){"use strict";function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e,t){var r=t.left,n=t.right,o=t.up,i=t.down,a=t.top,s=t.bottom,c=t.mirror,l=t.opposite,d=(r?1:0)|(n?2:0)|(a||i?4:0)|(s||o?8:0)|(c?16:0)|(l?32:0)|(e?64:0);if(p.hasOwnProperty(d))return p[d];if(!c!=!(e&&l)){var f=[n,r,s,a,i,o];r=f[0],n=f[1],a=f[2],s=f[3],o=f[4],i=f[5]}var h="-200deg",g="center";return(i||a)&&r&&(h="-45deg"),((i||a)&&n||(o||s)&&r)&&(h="45deg"),(o||s)&&n&&(h="-90deg"),(r||n)&&(g=(r?"left":"right")+" bottom"),p[d]=(0,u.animation)("\n    "+(e?"to":"from")+" { opacity: 0; transform-origin: "+g+"; transform: rotate3d(0, 0, 1, "+h+");}\n    "+(e?"from":"to")+" { opacity: 1; transform-origin: "+g+"; transform: none;}\n  "),p[d]}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.defaults,t=e.children,r=(e.out,e.forever),i=e.timeout,a=e.duration,s=void 0===a?u.defaults.duration:a,c=e.delay,d=void 0===c?u.defaults.delay:c,p=e.count,f=void 0===p?u.defaults.count:p,h=n(e,["children","out","forever","timeout","duration","delay","count"]),g={make:o,duration:void 0===i?s:i,delay:d,forever:r,count:f,style:{animationFillMode:"both"}};return(0,l.default)(h,g,g,t)}Object.defineProperty(t,"__esModule",{value:!0});var a,s=r(7),c=r(208),l=(a=c)&&a.__esModule?a:{default:a},u=r(6),d={out:s.bool,left:s.bool,right:s.bool,top:s.bool,bottom:s.bool,mirror:s.bool,opposite:s.bool,duration:s.number,timeout:s.number,delay:s.number,count:s.number,forever:s.bool},p={};i.propTypes=d,t.default=i,e.exports=t.default},423:function(e,t,r){"use strict";function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e,t){var r=t.left,n=t.right,o=t.up,i=t.down,a=t.top,s=t.bottom,c=t.big,l=t.mirror,d=t.opposite,f=(r?1:0)|(n?2:0)|(a||i?4:0)|(s||o?8:0)|(l?16:0)|(d?32:0)|(e?64:0)|(c?128:0);if(p.hasOwnProperty(f))return p[f];var h=r||n||o||i||a||s,g=void 0,v=void 0;if(h){if(!l!=!(e&&d)){var m=[n,r,s,a,i,o];r=m[0],n=m[1],a=m[2],s=m[3],o=m[4],i=m[5]}var b=c?"2000px":"100%";g=r?"-"+b:n?b:"0",v=i||a?"-"+b:o||s?b:"0"}return p[f]=(0,u.animation)((e?"to":"from")+" {"+(h?" transform: translate3d("+g+", "+v+", 0);":"")+"}\n     "+(e?"from":"to")+" {transform: none;} "),p[f]}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.defaults,t=e.children,r=(e.out,e.forever),i=e.timeout,a=e.duration,s=void 0===a?u.defaults.duration:a,c=e.delay,d=void 0===c?u.defaults.delay:c,p=e.count,f=void 0===p?u.defaults.count:p,h=n(e,["children","out","forever","timeout","duration","delay","count"]),g={make:o,duration:void 0===i?s:i,delay:d,forever:r,count:f,style:{animationFillMode:"both"},reverse:h.left};return(0,l.default)(h,g,g,t)}Object.defineProperty(t,"__esModule",{value:!0});var a,s=r(7),c=r(208),l=(a=c)&&a.__esModule?a:{default:a},u=r(6),d={out:s.bool,left:s.bool,right:s.bool,top:s.bool,bottom:s.bool,big:s.bool,mirror:s.bool,opposite:s.bool,duration:s.number,timeout:s.number,delay:s.number,count:s.number,forever:s.bool},p={};i.propTypes=d,t.default=i,e.exports=t.default},686:function(e,t,r){"use strict";function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e,t){var r=t.left,n=t.right,o=t.up,i=t.down,a=t.top,s=t.bottom,c=t.mirror,l=t.opposite,d=(r?1:0)|(n?2:0)|(a||i?4:0)|(s||o?8:0)|(c?16:0)|(l?32:0)|(e?64:0);if(p.hasOwnProperty(d))return p[d];if(!c!=!(e&&l)){var f=[n,r,s,a,i,o];r=f[0],n=f[1],a=f[2],s=f[3],o=f[4],i=f[5]}var h=r||n,g=a||s||o||i,v=void 0;return h||g?e?v="40% {\n          opacity: 1;\n          transform: scale3d(.475, .475, .475) translate3d("+(h?(r?"":"-")+"42px":"0")+", "+(g?(i||a?"-":"")+"60px":"0")+", 0);\n        }\n        to {\n          opacity: 0;\n          transform: scale(.1) translate3d("+(h?(n?"":"-")+"2000px":"0")+", "+(g?(o||s?"":"-")+"2000px":"0")+", 0);\n          transform-origin: "+(g?"center bottom":(r?"left":"right")+" center")+";\n        }":v="from {\n          opacity: 0;\n          transform: scale3d(.1, .1, .1) translate3d("+(h?(r?"-":"")+"1000px":"0")+", "+(g?(i||a?"-":"")+"1000px":"0")+", 0);\n          animation-timing-function: cubic-bezier(0.550, 0.055, 0.675, 0.190);\n        }\n        60% {\n          opacity: 1;\n          transform: scale3d(.475, .475, .475) translate3d("+(h?(n?"-":"")+"10px":"0")+", "+(g?(o||s?"-":"")+"60px":"0")+", 0);\n          animation-timing-function: cubic-bezier(0.175, 0.885, 0.320, 1);\n        }":v=(e?"to":"from")+" {opacity: 0; transform: scale3d(.1, .1, .1);} "+(e?"from":"to")+" { opacity: 1; transform: none;}",p[d]=(0,u.animation)(v),p[d]}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.defaults,t=e.children,r=(e.out,e.forever),i=e.timeout,a=e.duration,s=void 0===a?u.defaults.duration:a,c=e.delay,d=void 0===c?u.defaults.delay:c,p=e.count,f=void 0===p?u.defaults.count:p,h=n(e,["children","out","forever","timeout","duration","delay","count"]),g={make:o,duration:void 0===i?s:i,delay:d,forever:r,count:f,style:{animationFillMode:"both"},reverse:h.left};return(0,l.default)(h,g,g,t)}Object.defineProperty(t,"__esModule",{value:!0});var a,s=r(7),c=r(208),l=(a=c)&&a.__esModule?a:{default:a},u=r(6),d={out:s.bool,left:s.bool,right:s.bool,top:s.bool,bottom:s.bool,mirror:s.bool,opposite:s.bool,duration:s.number,timeout:s.number,delay:s.number,count:s.number,forever:s.bool},p={};i.propTypes=d,t.default=i,e.exports=t.default},6:function(e,t){"use strict";function r(e){try{return f.insertRule(e,f.cssRules.length)}catch(e){console.warn("react-reveal - animation failed")}}function n(){l||(t.globalHide=l=!0,window.removeEventListener("scroll",n,!0),r("."+o+" { opacity: 0; }"),window.removeEventListener("orientationchange",n,!0),window.document.removeEventListener("visibilitychange",n))}Object.defineProperty(t,"__esModule",{value:!0}),t.insertRule=r,t.cascade=function(e,t,r,n,o){var i=Math.log(n),a=(Math.log(o)-i)/(r-t);return Math.exp(i+a*(e-t))},t.animation=function(e){if(!f)return"";var t="@keyframes "+(h+d)+"{"+e+"}",r=p[e];return r?""+h+r:(f.insertRule(t,f.cssRules.length),p[e]=d,""+h+d++)},t.hideAll=n,t.default=function(e){var r=e.ssrFadeout;t.fadeOutEnabled=r};var o=t.namespace="react-reveal",i=(t.defaults={duration:1e3,delay:0,count:1},t.ssr=!0),a=t.observerMode=!1,s=t.raf=function(e){return window.setTimeout(e,66)},c=t.disableSsr=function(){return t.ssr=i=!1},l=(t.fadeOutEnabled=!1,t.ssrFadeout=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t.fadeOutEnabled=e},t.globalHide=!1),u=(t.ie10=!1,t.collapseend=void 0),d=1,p={},f=!1,h=o+"-"+Math.floor(1e15*Math.random())+"-";if("undefined"!=typeof window&&"nodejs"!==window.name&&window.document&&"undefined"!=typeof navigator){t.observerMode=a="IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype&&/\{\s*\[native code\]\s*\}/.test(""+IntersectionObserver),t.raf=s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||s,t.ssr=i=window.document.querySelectorAll("div[data-reactroot]").length>0,-1!==navigator.appVersion.indexOf("MSIE 10")&&(t.ie10=!0),i&&"performance"in window&&"timing"in window.performance&&"domContentLoadedEventEnd"in window.performance.timing&&window.performance.timing.domLoading&&Date.now()-window.performance.timing.domLoading<300&&(t.ssr=i=!1),i&&window.setTimeout(c,1500),a||(t.collapseend=u=document.createEvent("Event"),u.initEvent("collapseend",!0,!0));var g=document.createElement("style");document.head.appendChild(g),g.sheet&&g.sheet.cssRules&&g.sheet.insertRule&&(f=g.sheet,window.addEventListener("scroll",n,!0),window.addEventListener("orientationchange",n,!0),window.document.addEventListener("visibilitychange",n))}},394:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(461);var i=r(75);Object.defineProperty(t,"pT",{enumerable:!0,get:function(){return n(i).default}});var a=r(645);var s=r(811);var c=r(423);var l=r(154);var u=r(125);var d=r(970);var p=r(686)},208:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.default=function(e,t,r,n){return"in"in e&&(e.when=e.in),i.default.Children.count(n)<2?i.default.createElement(a.default,o({},e,{inEffect:t,outEffect:r,children:n})):(n=i.default.Children.map(n,(function(n){return i.default.createElement(a.default,o({},e,{inEffect:t,outEffect:r,children:n}))})),"Fragment"in i.default?i.default.createElement(i.default.Fragment,null,n):i.default.createElement("span",null,n))};var i=n(r(791)),a=n(r(866));e.exports=t.default},707:function(e,t,r){var n=r(61).default;!function(e,t){"use strict";function r(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function s(e){r(a,o,i,s,c,"next",e)}function c(e){r(a,o,i,s,c,"throw",e)}s(void 0)}))}}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function s(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var c={init:"init"},l=function(e){var t=e.value;return void 0===t?"":t},u=function(){return t.createElement(t.Fragment,null,"\xa0")},d={Cell:l,width:150,minWidth:0,maxWidth:Number.MAX_SAFE_INTEGER};function p(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((function(e,t){var r=t.style,n=t.className;return e=i({},e,{},a(t,["style","className"])),r&&(e.style=e.style?i({},e.style||{},{},r||{}):r),n&&(e.className=e.className?e.className+" "+n:n),""===e.className&&delete e.className,e}),{})}var f=function(e,t){return void 0===t&&(t={}),function(r){return void 0===r&&(r={}),[].concat(e,[r]).reduce((function(e,n){return function e(t,r,n){return"function"==typeof r?e({},r(t,n)):Array.isArray(r)?p.apply(void 0,[t].concat(r)):p(t,r)}(e,n,i({},t,{userProps:r}))}),{})}},h=function(e,t,r,n){return void 0===r&&(r={}),e.reduce((function(e,t){return t(e,r)}),t)},g=function(e,t,r){return void 0===r&&(r={}),e.forEach((function(e){e(t,r)}))};function v(e,t,r,n){e.findIndex((function(e){return e.pluginName===r})),t.forEach((function(t){e.findIndex((function(e){return e.pluginName===t}))}))}function m(e,t){return"function"==typeof e?e(t):e}function b(e){var r=t.useRef();return r.current=e,t.useCallback((function(){return r.current}),[])}var y="undefined"!=typeof document?t.useLayoutEffect:t.useEffect;function k(e,r){var n=t.useRef(!1);y((function(){n.current&&e(),n.current=!0}),r)}function w(e,t,r){return void 0===r&&(r={}),function(n,o){void 0===o&&(o={});var a="string"==typeof n?t[n]:n;if(void 0===a)throw console.info(t),new Error("Renderer Error \u261d\ufe0f");return x(a,i({},e,{column:t},r,{},o))}}function x(e,r){return function(e){return"function"==typeof e&&(t=Object.getPrototypeOf(e)).prototype&&t.prototype.isReactComponent;var t}(n=e)||"function"==typeof n||function(e){return"object"==typeof e&&"symbol"==typeof e.$$typeof&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}(n)?t.createElement(e,r):e;var n}function C(e,t,r){return void 0===r&&(r=0),e.map((function(e){return _(e=i({},e,{parent:t,depth:r})),e.columns&&(e.columns=C(e.columns,e,r+1)),e}))}function T(e){return P(e,"columns")}function _(e){var t=e.id,r=e.accessor,n=e.Header;if("string"==typeof r){t=t||r;var o=r.split(".");r=function(e){return function(e,t,r){if(!t)return e;var n,o="function"==typeof t?t:JSON.stringify(t),i=E.get(o)||function(){var e=function(e){return function e(t,r){if(void 0===r&&(r=[]),Array.isArray(t))for(var n=0;n<t.length;n+=1)e(t[n],r);else r.push(t);return r}(e).map((function(e){return String(e).replace(".","_")})).join(".").replace(U,".").replace(F,"").split(".")}(t);return E.set(o,e),e}();try{n=i.reduce((function(e,t){return e[t]}),e)}catch(e){}return void 0!==n?n:r}(e,o)}}if(!t&&"string"==typeof n&&n&&(t=n),!t&&e.columns)throw console.error(e),new Error('A column ID (or unique "Header" value) is required!');if(!t)throw console.error(e),new Error("A column ID (or string accessor) is required!");return Object.assign(e,{id:t,accessor:r}),e}function S(e,t){if(!t)throw new Error;return Object.assign(e,i({Header:u,Footer:u},d,{},t,{},e)),Object.assign(e,{originalWidth:e.width}),e}function I(e,t,r){void 0===r&&(r=function(){return{}});for(var n=[],o=e,a=0,s=function(){return a++},c=function(){var e={headers:[]},a=[],c=o.some((function(e){return e.parent}));o.forEach((function(n){var o,l=[].concat(a).reverse()[0];c&&(o=n.parent?i({},n.parent,{originalId:n.parent.id,id:n.parent.id+"_"+s(),headers:[n]},r(n)):S(i({originalId:n.id+"_placeholder",id:n.id+"_placeholder_"+s(),placeholderOf:n,headers:[n]},r(n)),t),l&&l.originalId===o.originalId?l.headers.push(n):a.push(o)),e.headers.push(n)})),n.push(e),o=a};o.length;)c();return n.reverse()}var E=new Map;function A(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0;n<t.length;n+=1)if(void 0!==t[n])return t[n]}function R(e){if("function"==typeof e)return e}function P(e,t){var r=[];return function e(n){n.forEach((function(n){n[t]?e(n[t]):r.push(n)}))}(e),r}function O(e,t){var r=t.manualExpandedKey,n=t.expanded,o=t.expandSubRows,i=void 0===o||o,a=[];return e.forEach((function(e){return function e(t,o){void 0===o&&(o=!0),t.isExpanded=t.original&&t.original[r]||n[t.id],t.canExpand=t.subRows&&!!t.subRows.length,o&&a.push(t),t.subRows&&t.subRows.length&&t.isExpanded&&t.subRows.forEach((function(t){return e(t,i)}))}(e)})),a}function N(e,t,r){return R(e)||t[e]||r[e]||r.text}function D(e,t,r){return e?e(t,r):void 0===t}function L(){throw new Error("React-Table: You have not called prepareRow(row) one or more rows you are attempting to render.")}var M=null,U=/\[/g,F=/\]/g,z=function(e){return i({role:"table"},e)},H=function(e){return i({role:"rowgroup"},e)},B=function(e,t){var r=t.column;return i({key:"header_"+r.id,colSpan:r.totalVisibleHeaderCount,role:"columnheader"},e)},q=function(e,t){var r=t.column;return i({key:"footer_"+r.id,colSpan:r.totalVisibleHeaderCount},e)},j=function(e,t){return i({key:"headerGroup_"+t.index,role:"row"},e)},G=function(e,t){return i({key:"footerGroup_"+t.index},e)},V=function(e,t){return i({key:"row_"+t.row.id,role:"row"},e)},K=function(e,t){var r=t.cell;return i({key:"cell_"+r.row.id+"_"+r.column.id,role:"cell"},e)};function Q(){return{useOptions:[],stateReducers:[],useControlledState:[],columns:[],columnsDeps:[],allColumns:[],allColumnsDeps:[],accessValue:[],materializedColumns:[],materializedColumnsDeps:[],useInstanceAfterData:[],visibleColumns:[],visibleColumnsDeps:[],headerGroups:[],headerGroupsDeps:[],useInstanceBeforeDimensions:[],useInstance:[],prepareRow:[],getTableProps:[z],getTableBodyProps:[H],getHeaderGroupProps:[j],getFooterGroupProps:[G],getHeaderProps:[B],getFooterProps:[q],getRowProps:[V],getCellProps:[K],useFinalInstance:[]}}c.resetHiddenColumns="resetHiddenColumns",c.toggleHideColumn="toggleHideColumn",c.setHiddenColumns="setHiddenColumns",c.toggleHideAllColumns="toggleHideAllColumns";var W=function(e){e.getToggleHiddenProps=[J],e.getToggleHideAllColumnsProps=[Y],e.stateReducers.push(X),e.useInstanceBeforeDimensions.push(Z),e.headerGroupsDeps.push((function(e,t){var r=t.instance;return[].concat(e,[r.state.hiddenColumns])})),e.useInstance.push($)};W.pluginName="useColumnVisibility";var J=function(e,t){var r=t.column;return[e,{onChange:function(e){r.toggleHidden(!e.target.checked)},style:{cursor:"pointer"},checked:r.isVisible,title:"Toggle Column Visible"}]},Y=function(e,t){var r=t.instance;return[e,{onChange:function(e){r.toggleHideAllColumns(!e.target.checked)},style:{cursor:"pointer"},checked:!r.allColumnsHidden&&!r.state.hiddenColumns.length,title:"Toggle All Columns Hidden",indeterminate:!r.allColumnsHidden&&r.state.hiddenColumns.length}]};function X(e,t,r,n){if(t.type===c.init)return i({hiddenColumns:[]},e);if(t.type===c.resetHiddenColumns)return i({},e,{hiddenColumns:n.initialState.hiddenColumns||[]});if(t.type===c.toggleHideColumn){var o=(void 0!==t.value?t.value:!e.hiddenColumns.includes(t.columnId))?[].concat(e.hiddenColumns,[t.columnId]):e.hiddenColumns.filter((function(e){return e!==t.columnId}));return i({},e,{hiddenColumns:o})}return t.type===c.setHiddenColumns?i({},e,{hiddenColumns:m(t.value,e.hiddenColumns)}):t.type===c.toggleHideAllColumns?i({},e,{hiddenColumns:(void 0!==t.value?t.value:!e.hiddenColumns.length)?n.allColumns.map((function(e){return e.id})):[]}):void 0}function Z(e){var r=e.headers,n=e.state.hiddenColumns;t.useRef(!1).current;var o=0;r.forEach((function(e){return o+=function e(t,r){t.isVisible=r&&!n.includes(t.id);var o=0;return t.headers&&t.headers.length?t.headers.forEach((function(r){return o+=e(r,t.isVisible)})):o=t.isVisible?1:0,t.totalVisibleHeaderCount=o,o}(e,!0)}))}function $(e){var r=e.columns,n=e.flatHeaders,o=e.dispatch,i=e.allColumns,a=e.getHooks,s=e.state.hiddenColumns,l=e.autoResetHiddenColumns,u=void 0===l||l,d=b(e),p=i.length===s.length,h=t.useCallback((function(e,t){return o({type:c.toggleHideColumn,columnId:e,value:t})}),[o]),g=t.useCallback((function(e){return o({type:c.setHiddenColumns,value:e})}),[o]),v=t.useCallback((function(e){return o({type:c.toggleHideAllColumns,value:e})}),[o]),m=f(a().getToggleHideAllColumnsProps,{instance:d()});n.forEach((function(e){e.toggleHidden=function(t){o({type:c.toggleHideColumn,columnId:e.id,value:t})},e.getToggleHiddenProps=f(a().getToggleHiddenProps,{instance:d(),column:e})}));var y=b(u);k((function(){y()&&o({type:c.resetHiddenColumns})}),[o,r]),Object.assign(e,{allColumnsHidden:p,toggleHideColumn:h,setHiddenColumns:g,toggleHideAllColumns:v,getToggleHideAllColumnsProps:m})}var ee={},te={},re=function(e,t,r){return e},ne=function(e,t){return e.subRows||[]},oe=function(e,t,r){return""+(r?[r.id,t].join("."):t)},ie=function(e){return e};function ae(e){var t=e.initialState,r=void 0===t?ee:t,n=e.defaultColumn,o=void 0===n?te:n,s=e.getSubRows,c=void 0===s?ne:s,l=e.getRowId,u=void 0===l?oe:l,d=e.stateReducer,p=void 0===d?re:d,f=e.useControlledState,h=void 0===f?ie:f;return i({},a(e,["initialState","defaultColumn","getSubRows","getRowId","stateReducer","useControlledState"]),{initialState:r,defaultColumn:o,getSubRows:c,getRowId:u,stateReducer:p,useControlledState:h})}function se(e,t){void 0===t&&(t=0);var r=0,n=0,o=0,i=0;return e.forEach((function(e){var a=e.headers;if(e.totalLeft=t,a&&a.length){var s=se(a,t),c=s[0],l=s[1],u=s[2],d=s[3];e.totalMinWidth=c,e.totalWidth=l,e.totalMaxWidth=u,e.totalFlexWidth=d}else e.totalMinWidth=e.minWidth,e.totalWidth=Math.min(Math.max(e.minWidth,e.width),e.maxWidth),e.totalMaxWidth=e.maxWidth,e.totalFlexWidth=e.canResize?e.totalWidth:0;e.isVisible&&(t+=e.totalWidth,r+=e.totalMinWidth,n+=e.totalWidth,o+=e.totalMaxWidth,i+=e.totalFlexWidth)})),[r,n,o,i]}function ce(e){var t=e.data,r=e.rows,n=e.flatRows,o=e.rowsById,i=e.column,a=e.getRowId,s=e.getSubRows,c=e.accessValueHooks,l=e.getInstance;t.forEach((function(e,u){return function e(r,u,d,p,f){void 0===d&&(d=0);var g=r,v=a(r,u,p),m=o[v];if(m)m.subRows&&m.originalSubRows.forEach((function(t,r){return e(t,r,d+1,m)}));else if((m={id:v,original:g,index:u,depth:d,cells:[{}]}).cells.map=L,m.cells.filter=L,m.cells.forEach=L,m.cells[0].getCellProps=L,m.values={},f.push(m),n.push(m),o[v]=m,m.originalSubRows=s(r,u),m.originalSubRows){var b=[];m.originalSubRows.forEach((function(t,r){return e(t,r,d+1,m,b)})),m.subRows=b}i.accessor&&(m.values[i.id]=i.accessor(r,u,m,f,t)),m.values[i.id]=h(c,m.values[i.id],{row:m,column:i,instance:l()})}(e,u,0,void 0,r)}))}c.resetExpanded="resetExpanded",c.toggleRowExpanded="toggleRowExpanded",c.toggleAllRowsExpanded="toggleAllRowsExpanded";var le=function(e){e.getToggleAllRowsExpandedProps=[ue],e.getToggleRowExpandedProps=[de],e.stateReducers.push(pe),e.useInstance.push(fe),e.prepareRow.push(he)};le.pluginName="useExpanded";var ue=function(e,t){var r=t.instance;return[e,{onClick:function(e){r.toggleAllRowsExpanded()},style:{cursor:"pointer"},title:"Toggle All Rows Expanded"}]},de=function(e,t){var r=t.row;return[e,{onClick:function(){r.toggleRowExpanded()},style:{cursor:"pointer"},title:"Toggle Row Expanded"}]};function pe(e,t,r,n){if(t.type===c.init)return i({expanded:{}},e);if(t.type===c.resetExpanded)return i({},e,{expanded:n.initialState.expanded||{}});if(t.type===c.toggleAllRowsExpanded){var o=t.value,l=n.rowsById,u=Object.keys(l).length===Object.keys(e.expanded).length;if(void 0!==o?o:!u){var d={};return Object.keys(l).forEach((function(e){d[e]=!0})),i({},e,{expanded:d})}return i({},e,{expanded:{}})}if(t.type===c.toggleRowExpanded){var p,f=t.id,h=t.value,g=e.expanded[f],v=void 0!==h?h:!g;if(!g&&v)return i({},e,{expanded:i({},e.expanded,(p={},p[f]=!0,p))});if(g&&!v){var m=e.expanded;return m[f],i({},e,{expanded:a(m,[f].map(s))})}return e}}function fe(e){var r=e.data,n=e.rows,o=e.rowsById,i=e.manualExpandedKey,a=void 0===i?"expanded":i,s=e.paginateExpandedRows,l=void 0===s||s,u=e.expandSubRows,d=void 0===u||u,p=e.autoResetExpanded,h=void 0===p||p,g=e.getHooks,m=e.plugins,y=e.state.expanded,w=e.dispatch;v(m,["useSortBy","useGroupBy","usePivotColumns","useGlobalFilter"],"useExpanded");var x=b(h),C=Boolean(Object.keys(o).length&&Object.keys(y).length);C&&Object.keys(o).some((function(e){return!y[e]}))&&(C=!1),k((function(){x()&&w({type:c.resetExpanded})}),[w,r]);var T=t.useCallback((function(e,t){w({type:c.toggleRowExpanded,id:e,value:t})}),[w]),_=t.useCallback((function(e){return w({type:c.toggleAllRowsExpanded,value:e})}),[w]),S=t.useMemo((function(){return l?O(n,{manualExpandedKey:a,expanded:y,expandSubRows:d}):n}),[l,n,a,y,d]),I=t.useMemo((function(){return function(e){var t=0;return Object.keys(e).forEach((function(e){var r=e.split(".");t=Math.max(t,r.length)})),t}(y)}),[y]),E=b(e),A=f(g().getToggleAllRowsExpandedProps,{instance:E()});Object.assign(e,{preExpandedRows:n,expandedRows:S,rows:S,expandedDepth:I,isAllRowsExpanded:C,toggleRowExpanded:T,toggleAllRowsExpanded:_,getToggleAllRowsExpandedProps:A})}function he(e,t){var r=t.instance.getHooks,n=t.instance;e.toggleRowExpanded=function(t){return n.toggleRowExpanded(e.id,t)},e.getToggleRowExpandedProps=f(r().getToggleRowExpandedProps,{instance:n,row:e})}var ge=function(e,t,r){return e.filter((function(e){return t.some((function(t){var n=e.values[t];return String(n).toLowerCase().includes(String(r).toLowerCase())}))}))};ge.autoRemove=function(e){return!e};var ve=function(e,t,r){return e.filter((function(e){return t.some((function(t){var n=e.values[t];return void 0===n||String(n).toLowerCase()===String(r).toLowerCase()}))}))};ve.autoRemove=function(e){return!e};var me=function(e,t,r){return e.filter((function(e){return t.some((function(t){var n=e.values[t];return void 0===n||String(n)===String(r)}))}))};me.autoRemove=function(e){return!e};var be=function(e,t,r){return e.filter((function(e){return t.some((function(t){return e.values[t].includes(r)}))}))};be.autoRemove=function(e){return!e||!e.length};var ye=function(e,t,r){return e.filter((function(e){return t.some((function(t){var n=e.values[t];return n&&n.length&&r.every((function(e){return n.includes(e)}))}))}))};ye.autoRemove=function(e){return!e||!e.length};var ke=function(e,t,r){return e.filter((function(e){return t.some((function(t){var n=e.values[t];return n&&n.length&&r.some((function(e){return n.includes(e)}))}))}))};ke.autoRemove=function(e){return!e||!e.length};var we=function(e,t,r){return e.filter((function(e){return t.some((function(t){var n=e.values[t];return r.includes(n)}))}))};we.autoRemove=function(e){return!e||!e.length};var xe=function(e,t,r){return e.filter((function(e){return t.some((function(t){return e.values[t]===r}))}))};xe.autoRemove=function(e){return void 0===e};var Ce=function(e,t,r){return e.filter((function(e){return t.some((function(t){return e.values[t]==r}))}))};Ce.autoRemove=function(e){return null==e};var Te=function(e,t,r){var n=r||[],o=n[0],i=n[1];if((o="number"==typeof o?o:-1/0)>(i="number"==typeof i?i:1/0)){var a=o;o=i,i=a}return e.filter((function(e){return t.some((function(t){var r=e.values[t];return r>=o&&r<=i}))}))};Te.autoRemove=function(e){return!e||"number"!=typeof e[0]&&"number"!=typeof e[1]};var _e=Object.freeze({__proto__:null,text:ge,exactText:ve,exactTextCase:me,includes:be,includesAll:ye,includesSome:ke,includesValue:we,exact:xe,equals:Ce,between:Te});c.resetFilters="resetFilters",c.setFilter="setFilter",c.setAllFilters="setAllFilters";var Se=function(e){e.stateReducers.push(Ie),e.useInstance.push(Ee)};function Ie(e,t,r,n){if(t.type===c.init)return i({filters:[]},e);if(t.type===c.resetFilters)return i({},e,{filters:n.initialState.filters||[]});if(t.type===c.setFilter){var o=t.columnId,a=t.filterValue,s=n.allColumns,l=n.filterTypes,u=s.find((function(e){return e.id===o}));if(!u)throw new Error("React-Table: Could not find a column with id: "+o);var d=N(u.filter,l||{},_e),p=e.filters.find((function(e){return e.id===o})),f=m(a,p&&p.value);return D(d.autoRemove,f,u)?i({},e,{filters:e.filters.filter((function(e){return e.id!==o}))}):i({},e,p?{filters:e.filters.map((function(e){return e.id===o?{id:o,value:f}:e}))}:{filters:[].concat(e.filters,[{id:o,value:f}])})}if(t.type===c.setAllFilters){var h=t.filters,g=n.allColumns,v=n.filterTypes;return i({},e,{filters:m(h,e.filters).filter((function(e){var t=g.find((function(t){return t.id===e.id}));return!D(N(t.filter,v||{},_e).autoRemove,e.value,t)}))})}}function Ee(e){var r=e.data,n=e.rows,o=e.flatRows,i=e.rowsById,a=e.allColumns,s=e.filterTypes,l=e.manualFilters,u=e.defaultCanFilter,d=void 0!==u&&u,p=e.disableFilters,f=e.state.filters,h=e.dispatch,g=e.autoResetFilters,v=void 0===g||g,m=t.useCallback((function(e,t){h({type:c.setFilter,columnId:e,filterValue:t})}),[h]),y=t.useCallback((function(e){h({type:c.setAllFilters,filters:e})}),[h]);a.forEach((function(e){var t=e.id,r=e.accessor,n=e.defaultCanFilter,o=e.disableFilters;e.canFilter=r?A(!0!==o&&void 0,!0!==p&&void 0,!0):A(n,d,!1),e.setFilter=function(t){return m(e.id,t)};var i=f.find((function(e){return e.id===t}));e.filterValue=i&&i.value}));var w=t.useMemo((function(){if(l||!f.length)return[n,o,i];var e=[],t={};return[function r(n,o){void 0===o&&(o=0);var i=n;return(i=f.reduce((function(e,t){var r=t.id,n=t.value,i=a.find((function(e){return e.id===r}));if(!i)return e;0===o&&(i.preFilteredRows=e);var c=N(i.filter,s||{},_e);return c?(i.filteredRows=c(e,[r],n),i.filteredRows):(console.warn("Could not find a valid 'column.filter' for column with the ID: "+i.id+"."),e)}),n)).forEach((function(n){e.push(n),t[n.id]=n,n.subRows&&(n.subRows=n.subRows&&n.subRows.length>0?r(n.subRows,o+1):n.subRows)})),i}(n),e,t]}),[l,f,n,o,i,a,s]),x=w[0],C=w[1],T=w[2];t.useMemo((function(){a.filter((function(e){return!f.find((function(t){return t.id===e.id}))})).forEach((function(e){e.preFilteredRows=x,e.filteredRows=x}))}),[x,f,a]);var _=b(v);k((function(){_()&&h({type:c.resetFilters})}),[h,l?null:r]),Object.assign(e,{preFilteredRows:n,preFilteredFlatRows:o,preFilteredRowsById:i,filteredRows:x,filteredFlatRows:C,filteredRowsById:T,rows:x,flatRows:C,rowsById:T,setFilter:m,setAllFilters:y})}Se.pluginName="useFilters",c.resetGlobalFilter="resetGlobalFilter",c.setGlobalFilter="setGlobalFilter";var Ae=function(e){e.stateReducers.push(Re),e.useInstance.push(Pe)};function Re(e,t,r,n){if(t.type===c.resetGlobalFilter)return i({},e,{globalFilter:n.initialState.globalFilter||void 0});if(t.type===c.setGlobalFilter){var o=t.filterValue,s=n.userFilterTypes,l=N(n.globalFilter,s||{},_e),u=m(o,e.globalFilter);return D(l.autoRemove,u)?(e.globalFilter,a(e,["globalFilter"])):i({},e,{globalFilter:u})}}function Pe(e){var r=e.data,n=e.rows,o=e.flatRows,i=e.rowsById,a=e.allColumns,s=e.filterTypes,l=e.globalFilter,u=e.manualGlobalFilter,d=e.state.globalFilter,p=e.dispatch,f=e.autoResetGlobalFilter,h=void 0===f||f,g=e.disableGlobalFilter,v=t.useCallback((function(e){p({type:c.setGlobalFilter,filterValue:e})}),[p]),m=t.useMemo((function(){if(u||void 0===d)return[n,o,i];var e=[],t={},r=N(l,s||{},_e);if(!r)return console.warn("Could not find a valid 'globalFilter' option."),n;a.forEach((function(e){var t=e.disableGlobalFilter;e.canFilter=A(!0!==t&&void 0,!0!==g&&void 0,!0)}));var c=a.filter((function(e){return!0===e.canFilter}));return[function n(o){return(o=r(o,c.map((function(e){return e.id})),d)).forEach((function(r){e.push(r),t[r.id]=r,r.subRows=r.subRows&&r.subRows.length?n(r.subRows):r.subRows})),o}(n),e,t]}),[u,d,l,s,a,n,o,i,g]),y=m[0],w=m[1],x=m[2],C=b(h);k((function(){C()&&p({type:c.resetGlobalFilter})}),[p,u?null:r]),Object.assign(e,{preGlobalFilteredRows:n,preGlobalFilteredFlatRows:o,preGlobalFilteredRowsById:i,globalFilteredRows:y,globalFilteredFlatRows:w,globalFilteredRowsById:x,rows:y,flatRows:w,rowsById:x,setGlobalFilter:v,disableGlobalFilter:g})}function Oe(e,t){return t.reduce((function(e,t){return e+("number"==typeof t?t:0)}),0)}Ae.pluginName="useGlobalFilter";var Ne=Object.freeze({__proto__:null,sum:Oe,min:function(e){var t=e[0]||0;return e.forEach((function(e){"number"==typeof e&&(t=Math.min(t,e))})),t},max:function(e){var t=e[0]||0;return e.forEach((function(e){"number"==typeof e&&(t=Math.max(t,e))})),t},minMax:function(e){var t=e[0]||0,r=e[0]||0;return e.forEach((function(e){"number"==typeof e&&(t=Math.min(t,e),r=Math.max(r,e))})),t+".."+r},average:function(e){return Oe(0,e)/e.length},median:function(e){if(!e.length)return null;var t=Math.floor(e.length/2),r=[].concat(e).sort((function(e,t){return e-t}));return e.length%2!=0?r[t]:(r[t-1]+r[t])/2},unique:function(e){return Array.from(new Set(e).values())},uniqueCount:function(e){return new Set(e).size},count:function(e){return e.length}}),De=[],Le={};c.resetGroupBy="resetGroupBy",c.setGroupBy="setGroupBy",c.toggleGroupBy="toggleGroupBy";var Me=function(e){e.getGroupByToggleProps=[Ue],e.stateReducers.push(Fe),e.visibleColumnsDeps.push((function(e,t){var r=t.instance;return[].concat(e,[r.state.groupBy])})),e.visibleColumns.push(ze),e.useInstance.push(Be),e.prepareRow.push(qe)};Me.pluginName="useGroupBy";var Ue=function(e,t){var r=t.header;return[e,{onClick:r.canGroupBy?function(e){e.persist(),r.toggleGroupBy()}:void 0,style:{cursor:r.canGroupBy?"pointer":void 0},title:"Toggle GroupBy"}]};function Fe(e,t,r,n){if(t.type===c.init)return i({groupBy:[]},e);if(t.type===c.resetGroupBy)return i({},e,{groupBy:n.initialState.groupBy||[]});if(t.type===c.setGroupBy)return i({},e,{groupBy:t.value});if(t.type===c.toggleGroupBy){var o=t.columnId,a=t.value,s=void 0!==a?a:!e.groupBy.includes(o);return i({},e,s?{groupBy:[].concat(e.groupBy,[o])}:{groupBy:e.groupBy.filter((function(e){return e!==o}))})}}function ze(e,t){var r=t.instance.state.groupBy,n=r.map((function(t){return e.find((function(e){return e.id===t}))})).filter(Boolean),o=e.filter((function(e){return!r.includes(e.id)}));return(e=[].concat(n,o)).forEach((function(e){e.isGrouped=r.includes(e.id),e.groupedIndex=r.indexOf(e.id)})),e}var He={};function Be(e){var r=e.data,n=e.rows,o=e.flatRows,a=e.rowsById,s=e.allColumns,l=e.flatHeaders,u=e.groupByFn,d=void 0===u?je:u,p=e.manualGroupBy,h=e.aggregations,g=void 0===h?He:h,m=e.plugins,y=e.state.groupBy,w=e.dispatch,x=e.autoResetGroupBy,C=void 0===x||x,T=e.disableGroupBy,_=e.defaultCanGroupBy,S=e.getHooks;v(m,["useColumnOrder","useFilters"],"useGroupBy");var I=b(e);s.forEach((function(t){var r=t.accessor,n=t.defaultGroupBy,o=t.disableGroupBy;t.canGroupBy=r?A(t.canGroupBy,!0!==o&&void 0,!0!==T&&void 0,!0):A(t.canGroupBy,n,_,!1),t.canGroupBy&&(t.toggleGroupBy=function(){return e.toggleGroupBy(t.id)}),t.Aggregated=t.Aggregated||t.Cell}));var E=t.useCallback((function(e,t){w({type:c.toggleGroupBy,columnId:e,value:t})}),[w]),R=t.useCallback((function(e){w({type:c.setGroupBy,value:e})}),[w]);l.forEach((function(e){e.getGroupByToggleProps=f(S().getGroupByToggleProps,{instance:I(),header:e})}));var O=t.useMemo((function(){if(p||!y.length)return[n,o,a,De,Le,o,a];var e=y.filter((function(e){return s.find((function(t){return t.id===e}))})),t=[],r={},c=[],l={},u=[],f={},h=function n(o,a,p){if(void 0===a&&(a=0),a===e.length)return o.map((function(e){return i({},e,{depth:a})}));var h=e[a],v=d(o,h);return Object.entries(v).map((function(o,i){var d=o[0],v=o[1],m=h+":"+d,b=n(v,a+1,m=p?p+">"+m:m),y=a?P(v,"leafRows"):v,k=function(t,r,n){var o={};return s.forEach((function(i){if(e.includes(i.id))o[i.id]=r[0]?r[0].values[i.id]:null;else{var a="function"==typeof i.aggregate?i.aggregate:g[i.aggregate]||Ne[i.aggregate];if(a){var s=r.map((function(e){return e.values[i.id]})),c=t.map((function(e){var t=e.values[i.id];if(!n&&i.aggregateValue){var r="function"==typeof i.aggregateValue?i.aggregateValue:g[i.aggregateValue]||Ne[i.aggregateValue];if(!r)throw console.info({column:i}),new Error("React Table: Invalid column.aggregateValue option for column listed above");t=r(t,e,i)}return t}));o[i.id]=a(c,s)}else{if(i.aggregate)throw console.info({column:i}),new Error("React Table: Invalid column.aggregate option for column listed above");o[i.id]=null}}})),o}(y,v,a),w={id:m,isGrouped:!0,groupByID:h,groupByVal:d,values:k,subRows:b,leafRows:y,depth:a,index:i};return b.forEach((function(e){t.push(e),r[e.id]=e,e.isGrouped?(c.push(e),l[e.id]=e):(u.push(e),f[e.id]=e)})),w}))}(n);return h.forEach((function(e){t.push(e),r[e.id]=e,e.isGrouped?(c.push(e),l[e.id]=e):(u.push(e),f[e.id]=e)})),[h,t,r,c,l,u,f]}),[p,y,n,o,a,s,g,d]),N=O[0],D=O[1],L=O[2],M=O[3],U=O[4],F=O[5],z=O[6],H=b(C);k((function(){H()&&w({type:c.resetGroupBy})}),[w,p?null:r]),Object.assign(e,{preGroupedRows:n,preGroupedFlatRow:o,preGroupedRowsById:a,groupedRows:N,groupedFlatRows:D,groupedRowsById:L,onlyGroupedFlatRows:M,onlyGroupedRowsById:U,nonGroupedFlatRows:F,nonGroupedRowsById:z,rows:N,flatRows:D,rowsById:L,toggleGroupBy:E,setGroupBy:R})}function qe(e){e.allCells.forEach((function(t){var r;t.isGrouped=t.column.isGrouped&&t.column.id===e.groupByID,t.isPlaceholder=!t.isGrouped&&t.column.isGrouped,t.isAggregated=!t.isGrouped&&!t.isPlaceholder&&(null==(r=e.subRows)?void 0:r.length)}))}function je(e,t){return e.reduce((function(e,r,n){var o=""+r.values[t];return e[o]=Array.isArray(e[o])?e[o]:[],e[o].push(r),e}),{})}var Ge=/([0-9]+)/gm;function Ve(e,t){return e===t?0:e>t?1:-1}function Ke(e,t,r){return[e.values[r],t.values[r]]}function Qe(e){return"number"==typeof e?isNaN(e)||e===1/0||e===-1/0?"":String(e):"string"==typeof e?e:""}var We=Object.freeze({__proto__:null,alphanumeric:function(e,t,r){var n=Ke(e,t,r),o=n[0],i=n[1];for(o=Qe(o),i=Qe(i),o=o.split(Ge).filter(Boolean),i=i.split(Ge).filter(Boolean);o.length&&i.length;){var a=o.shift(),s=i.shift(),c=parseInt(a,10),l=parseInt(s,10),u=[c,l].sort();if(isNaN(u[0])){if(a>s)return 1;if(s>a)return-1}else{if(isNaN(u[1]))return isNaN(c)?-1:1;if(c>l)return 1;if(l>c)return-1}}return o.length-i.length},datetime:function(e,t,r){var n=Ke(e,t,r),o=n[0],i=n[1];return Ve(o=o.getTime(),i=i.getTime())},basic:function(e,t,r){var n=Ke(e,t,r);return Ve(n[0],n[1])},string:function(e,t,r){var n=Ke(e,t,r),o=n[0],i=n[1];for(o=o.split("").filter(Boolean),i=i.split("").filter(Boolean);o.length&&i.length;){var a=o.shift(),s=i.shift(),c=a.toLowerCase(),l=s.toLowerCase();if(c>l)return 1;if(l>c)return-1;if(a>s)return 1;if(s>a)return-1}return o.length-i.length},number:function(e,t,r){var n=Ke(e,t,r),o=n[0],i=n[1],a=/[^0-9.]/gi;return Ve(o=Number(String(o).replace(a,"")),i=Number(String(i).replace(a,"")))}});c.resetSortBy="resetSortBy",c.setSortBy="setSortBy",c.toggleSortBy="toggleSortBy",c.clearSortBy="clearSortBy",d.sortType="alphanumeric",d.sortDescFirst=!1;var Je=function(e){e.getSortByToggleProps=[Ye],e.stateReducers.push(Xe),e.useInstance.push(Ze)};Je.pluginName="useSortBy";var Ye=function(e,t){var r=t.instance,n=t.column,o=r.isMultiSortEvent,i=void 0===o?function(e){return e.shiftKey}:o;return[e,{onClick:n.canSort?function(e){e.persist(),n.toggleSortBy(void 0,!r.disableMultiSort&&i(e))}:void 0,style:{cursor:n.canSort?"pointer":void 0},title:n.canSort?"Toggle SortBy":void 0}]};function Xe(e,t,r,n){if(t.type===c.init)return i({sortBy:[]},e);if(t.type===c.resetSortBy)return i({},e,{sortBy:n.initialState.sortBy||[]});if(t.type===c.clearSortBy)return i({},e,{sortBy:e.sortBy.filter((function(e){return e.id!==t.columnId}))});if(t.type===c.setSortBy)return i({},e,{sortBy:t.sortBy});if(t.type===c.toggleSortBy){var o,a=t.columnId,s=t.desc,l=t.multi,u=n.allColumns,d=n.disableMultiSort,p=n.disableSortRemove,f=n.disableMultiRemove,h=n.maxMultiSortColCount,g=void 0===h?Number.MAX_SAFE_INTEGER:h,v=e.sortBy,m=u.find((function(e){return e.id===a})).sortDescFirst,b=v.find((function(e){return e.id===a})),y=v.findIndex((function(e){return e.id===a})),k=null!=s,w=[];return"toggle"!==(o=!d&&l?b?"toggle":"add":y!==v.length-1||1!==v.length?"replace":b?"toggle":"replace")||p||k||l&&f||!(b&&b.desc&&!m||!b.desc&&m)||(o="remove"),"replace"===o?w=[{id:a,desc:k?s:m}]:"add"===o?(w=[].concat(v,[{id:a,desc:k?s:m}])).splice(0,w.length-g):"toggle"===o?w=v.map((function(e){return e.id===a?i({},e,{desc:k?s:!b.desc}):e})):"remove"===o&&(w=v.filter((function(e){return e.id!==a}))),i({},e,{sortBy:w})}}function Ze(e){var r=e.data,n=e.rows,o=e.flatRows,i=e.allColumns,a=e.orderByFn,s=void 0===a?$e:a,l=e.sortTypes,u=e.manualSortBy,d=e.defaultCanSort,p=e.disableSortBy,h=e.flatHeaders,g=e.state.sortBy,m=e.dispatch,y=e.plugins,w=e.getHooks,x=e.autoResetSortBy,C=void 0===x||x;v(y,["useFilters","useGlobalFilter","useGroupBy","usePivotColumns"],"useSortBy");var T=t.useCallback((function(e){m({type:c.setSortBy,sortBy:e})}),[m]),_=t.useCallback((function(e,t,r){m({type:c.toggleSortBy,columnId:e,desc:t,multi:r})}),[m]),S=b(e);h.forEach((function(e){var t=e.accessor,r=e.canSort,n=e.disableSortBy,o=e.id,i=t?A(!0!==n&&void 0,!0!==p&&void 0,!0):A(d,r,!1);e.canSort=i,e.canSort&&(e.toggleSortBy=function(t,r){return _(e.id,t,r)},e.clearSortBy=function(){m({type:c.clearSortBy,columnId:e.id})}),e.getSortByToggleProps=f(w().getSortByToggleProps,{instance:S(),column:e});var a=g.find((function(e){return e.id===o}));e.isSorted=!!a,e.sortedIndex=g.findIndex((function(e){return e.id===o})),e.isSortedDesc=e.isSorted?a.desc:void 0}));var I=t.useMemo((function(){if(u||!g.length)return[n,o];var e=[],t=g.filter((function(e){return i.find((function(t){return t.id===e.id}))}));return[function r(n){var o=s(n,t.map((function(e){var t=i.find((function(t){return t.id===e.id}));if(!t)throw new Error("React-Table: Could not find a column with id: "+e.id+" while sorting");var r=t.sortType,n=R(r)||(l||{})[r]||We[r];if(!n)throw new Error("React-Table: Could not find a valid sortType of '"+r+"' for column '"+e.id+"'.");return function(t,r){return n(t,r,e.id,e.desc)}})),t.map((function(e){var t=i.find((function(t){return t.id===e.id}));return t&&t.sortInverted?e.desc:!e.desc})));return o.forEach((function(t){e.push(t),t.subRows&&0!==t.subRows.length&&(t.subRows=r(t.subRows))})),o}(n),e]}),[u,g,n,o,i,s,l]),E=I[0],P=I[1],O=b(C);k((function(){O()&&m({type:c.resetSortBy})}),[u?null:r]),Object.assign(e,{preSortedRows:n,preSortedFlatRows:o,sortedRows:E,sortedFlatRows:P,rows:E,flatRows:P,setSortBy:T,toggleSortBy:_})}function $e(e,t,r){return[].concat(e).sort((function(e,n){for(var o=0;o<t.length;o+=1){var i=t[o],a=!1===r[o]||"desc"===r[o],s=i(e,n);if(0!==s)return a?-s:s}return r[0]?e.index-n.index:n.index-e.index}))}c.resetPage="resetPage",c.gotoPage="gotoPage",c.setPageSize="setPageSize";var et=function(e){e.stateReducers.push(tt),e.useInstance.push(rt)};function tt(e,t,r,n){if(t.type===c.init)return i({pageSize:10,pageIndex:0},e);if(t.type===c.resetPage)return i({},e,{pageIndex:n.initialState.pageIndex||0});if(t.type===c.gotoPage){var o=n.pageCount,a=n.page,s=m(t.pageIndex,e.pageIndex),l=!1;return s>e.pageIndex?l=-1===o?a.length>=e.pageSize:s<o:s<e.pageIndex&&(l=s>-1),l?i({},e,{pageIndex:s}):e}if(t.type===c.setPageSize){var u=t.pageSize,d=e.pageSize*e.pageIndex;return i({},e,{pageIndex:Math.floor(d/u),pageSize:u})}}function rt(e){var r=e.rows,n=e.autoResetPage,o=void 0===n||n,i=e.manualExpandedKey,a=void 0===i?"expanded":i,s=e.plugins,l=e.pageCount,u=e.paginateExpandedRows,d=void 0===u||u,p=e.expandSubRows,f=void 0===p||p,h=e.state,g=h.pageSize,m=h.pageIndex,y=h.expanded,w=h.globalFilter,x=h.filters,C=h.groupBy,T=h.sortBy,_=e.dispatch,S=e.data,I=e.manualPagination;v(s,["useGlobalFilter","useFilters","useGroupBy","useSortBy","useExpanded"],"usePagination");var E=b(o);k((function(){E()&&_({type:c.resetPage})}),[_,I?null:S,w,x,C,T]);var A=I?l:Math.ceil(r.length/g),R=t.useMemo((function(){return A>0?[].concat(new Array(A)).fill(null).map((function(e,t){return t})):[]}),[A]),P=t.useMemo((function(){var e;if(I)e=r;else{var t=g*m,n=t+g;e=r.slice(t,n)}return d?e:O(e,{manualExpandedKey:a,expanded:y,expandSubRows:f})}),[f,y,a,I,m,g,d,r]),N=m>0,D=-1===A?P.length>=g:m<A-1,L=t.useCallback((function(e){_({type:c.gotoPage,pageIndex:e})}),[_]),M=t.useCallback((function(){return L((function(e){return e-1}))}),[L]),U=t.useCallback((function(){return L((function(e){return e+1}))}),[L]),F=t.useCallback((function(e){_({type:c.setPageSize,pageSize:e})}),[_]);Object.assign(e,{pageOptions:R,pageCount:A,page:P,canPreviousPage:N,canNextPage:D,gotoPage:L,previousPage:M,nextPage:U,setPageSize:F})}et.pluginName="usePagination",c.resetPivot="resetPivot",c.togglePivot="togglePivot";var nt=function(e){e.getPivotToggleProps=[it],e.stateReducers.push(at),e.useInstanceAfterData.push(st),e.allColumns.push(ct),e.accessValue.push(lt),e.materializedColumns.push(ut),e.materializedColumnsDeps.push(dt),e.visibleColumns.push(pt),e.visibleColumnsDeps.push(ft),e.useInstance.push(ht),e.prepareRow.push(gt)};nt.pluginName="usePivotColumns";var ot=[],it=function(e,t){var r=t.header;return[e,{onClick:r.canPivot?function(e){e.persist(),r.togglePivot()}:void 0,style:{cursor:r.canPivot?"pointer":void 0},title:"Toggle Pivot"}]};function at(e,t,r,n){if(t.type===c.init)return i({pivotColumns:ot},e);if(t.type===c.resetPivot)return i({},e,{pivotColumns:n.initialState.pivotColumns||ot});if(t.type===c.togglePivot){var o=t.columnId,a=t.value,s=void 0!==a?a:!e.pivotColumns.includes(o);return i({},e,s?{pivotColumns:[].concat(e.pivotColumns,[o])}:{pivotColumns:e.pivotColumns.filter((function(e){return e!==o}))})}}function st(e){e.allColumns.forEach((function(t){t.isPivotSource=e.state.pivotColumns.includes(t.id)}))}function ct(e,t){var r=t.instance;return e.forEach((function(e){e.isPivotSource=r.state.pivotColumns.includes(e.id),e.uniqueValues=new Set})),e}function lt(e,t){var r=t.column;return r.uniqueValues&&void 0!==e&&r.uniqueValues.add(e),e}function ut(e,t){var r=t.instance,n=r.allColumns,o=r.state;if(!o.pivotColumns.length||!o.groupBy||!o.groupBy.length)return e;var a=o.pivotColumns.map((function(e){return n.find((function(t){return t.id===e}))})).filter(Boolean),s=n.filter((function(e){return!e.isPivotSource&&!o.groupBy.includes(e.id)&&!o.pivotColumns.includes(e.id)})),c=T(function e(t,r,n){void 0===t&&(t=0),void 0===n&&(n=[]);var o=a[t];return o?Array.from(o.uniqueValues).sort().map((function(a){var s=i({},o,{Header:o.PivotHeader||"string"==typeof o.header?o.Header+": "+a:a,isPivotGroup:!0,parent:r,depth:t,id:r?r.id+"."+o.id+"."+a:o.id+"."+a,pivotValue:a});return s.columns=e(t+1,s,[].concat(n,[function(e){return e.values[o.id]===a}])),s})):s.map((function(e){return i({},e,{canPivot:!1,isPivoted:!0,parent:r,depth:t,id:""+(r?r.id+"."+e.id:e.id),accessor:function(t,r,o){if(n.every((function(e){return e(o)})))return o.values[e.id]}})}))}());return[].concat(e,c)}function dt(e,t){var r=t.instance.state,n=r.pivotColumns,o=r.groupBy;return[].concat(e,[n,o])}function pt(e,t){var r=t.instance.state;return e=e.filter((function(e){return!e.isPivotSource})),r.pivotColumns.length&&r.groupBy&&r.groupBy.length&&(e=e.filter((function(e){return e.isGrouped||e.isPivoted}))),e}function ft(e,t){var r=t.instance;return[].concat(e,[r.state.pivotColumns,r.state.groupBy])}function ht(e){var t=e.columns,r=e.allColumns,n=e.flatHeaders,o=e.getHooks,i=e.plugins,a=e.dispatch,s=e.autoResetPivot,l=void 0===s||s,u=e.manaulPivot,d=e.disablePivot,p=e.defaultCanPivot;v(i,["useGroupBy"],"usePivotColumns");var h=b(e);r.forEach((function(t){var r=t.accessor,n=t.defaultPivot,o=t.disablePivot;t.canPivot=r?A(t.canPivot,!0!==o&&void 0,!0!==d&&void 0,!0):A(t.canPivot,n,p,!1),t.canPivot&&(t.togglePivot=function(){return e.togglePivot(t.id)}),t.Aggregated=t.Aggregated||t.Cell})),n.forEach((function(e){e.getPivotToggleProps=f(o().getPivotToggleProps,{instance:h(),header:e})}));var g=b(l);k((function(){g()&&a({type:c.resetPivot})}),[a,u?null:t]),Object.assign(e,{togglePivot:function(e,t){a({type:c.togglePivot,columnId:e,value:t})}})}function gt(e){e.allCells.forEach((function(e){e.isPivoted=e.column.isPivoted}))}c.resetSelectedRows="resetSelectedRows",c.toggleAllRowsSelected="toggleAllRowsSelected",c.toggleRowSelected="toggleRowSelected",c.toggleAllPageRowsSelected="toggleAllPageRowsSelected";var vt=function(e){e.getToggleRowSelectedProps=[mt],e.getToggleAllRowsSelectedProps=[bt],e.getToggleAllPageRowsSelectedProps=[yt],e.stateReducers.push(kt),e.useInstance.push(wt),e.prepareRow.push(xt)};vt.pluginName="useRowSelect";var mt=function(e,t){var r=t.instance,n=t.row,o=r.manualRowSelectedKey,i=void 0===o?"isSelected":o;return[e,{onChange:function(e){n.toggleRowSelected(e.target.checked)},style:{cursor:"pointer"},checked:!(!n.original||!n.original[i])||n.isSelected,title:"Toggle Row Selected",indeterminate:n.isSomeSelected}]},bt=function(e,t){var r=t.instance;return[e,{onChange:function(e){r.toggleAllRowsSelected(e.target.checked)},style:{cursor:"pointer"},checked:r.isAllRowsSelected,title:"Toggle All Rows Selected",indeterminate:Boolean(!r.isAllRowsSelected&&Object.keys(r.state.selectedRowIds).length)}]},yt=function(e,t){var r=t.instance;return[e,{onChange:function(e){r.toggleAllPageRowsSelected(e.target.checked)},style:{cursor:"pointer"},checked:r.isAllPageRowsSelected,title:"Toggle All Current Page Rows Selected",indeterminate:Boolean(!r.isAllPageRowsSelected&&r.page.some((function(e){var t=e.id;return r.state.selectedRowIds[t]})))}]};function kt(e,t,r,n){if(t.type===c.init)return i({selectedRowIds:{}},e);if(t.type===c.resetSelectedRows)return i({},e,{selectedRowIds:n.initialState.selectedRowIds||{}});if(t.type===c.toggleAllRowsSelected){var o=t.value,a=n.isAllRowsSelected,s=n.rowsById,l=n.nonGroupedRowsById,u=void 0===l?s:l,d=void 0!==o?o:!a,p=Object.assign({},e.selectedRowIds);return d?Object.keys(u).forEach((function(e){p[e]=!0})):Object.keys(u).forEach((function(e){delete p[e]})),i({},e,{selectedRowIds:p})}if(t.type===c.toggleRowSelected){var f=t.id,h=t.value,g=n.rowsById,v=n.selectSubRows,m=void 0===v||v,b=n.getSubRows,y=e.selectedRowIds[f],k=void 0!==h?h:!y;if(y===k)return e;var w=i({},e.selectedRowIds);return function e(t){var r=g[t];if(r&&(r.isGrouped||(k?w[t]=!0:delete w[t]),m&&b(r)))return b(r).forEach((function(t){return e(t.id)}))}(f),i({},e,{selectedRowIds:w})}if(t.type===c.toggleAllPageRowsSelected){var x=t.value,C=n.page,T=n.rowsById,_=n.selectSubRows,S=void 0===_||_,I=n.isAllPageRowsSelected,E=n.getSubRows,A=void 0!==x?x:!I,R=i({},e.selectedRowIds);return C.forEach((function(e){return function e(t){var r=T[t];if(r.isGrouped||(A?R[t]=!0:delete R[t]),S&&E(r))return E(r).forEach((function(t){return e(t.id)}))}(e.id)})),i({},e,{selectedRowIds:R})}return e}function wt(e){var r=e.data,n=e.rows,o=e.getHooks,i=e.plugins,a=e.rowsById,s=e.nonGroupedRowsById,l=void 0===s?a:s,u=e.autoResetSelectedRows,d=void 0===u||u,p=e.state.selectedRowIds,h=e.selectSubRows,g=void 0===h||h,m=e.dispatch,y=e.page,w=e.getSubRows;v(i,["useFilters","useGroupBy","useSortBy","useExpanded","usePagination"],"useRowSelect");var x=t.useMemo((function(){var e=[];return n.forEach((function(t){var r=g?function e(t,r,n){if(r[t.id])return!0;var o=n(t);if(o&&o.length){var i=!0,a=!1;return o.forEach((function(t){a&&!i||(e(t,r,n)?a=!0:i=!1)})),!!i||!!a&&null}return!1}(t,p,w):!!p[t.id];t.isSelected=!!r,t.isSomeSelected=null===r,r&&e.push(t)})),e}),[n,g,p,w]),C=Boolean(Object.keys(l).length&&Object.keys(p).length),T=C;C&&Object.keys(l).some((function(e){return!p[e]}))&&(C=!1),C||y&&y.length&&y.some((function(e){var t=e.id;return!p[t]}))&&(T=!1);var _=b(d);k((function(){_()&&m({type:c.resetSelectedRows})}),[m,r]);var S=t.useCallback((function(e){return m({type:c.toggleAllRowsSelected,value:e})}),[m]),I=t.useCallback((function(e){return m({type:c.toggleAllPageRowsSelected,value:e})}),[m]),E=t.useCallback((function(e,t){return m({type:c.toggleRowSelected,id:e,value:t})}),[m]),A=b(e),R=f(o().getToggleAllRowsSelectedProps,{instance:A()}),P=f(o().getToggleAllPageRowsSelectedProps,{instance:A()});Object.assign(e,{selectedFlatRows:x,isAllRowsSelected:C,isAllPageRowsSelected:T,toggleRowSelected:E,toggleAllRowsSelected:S,getToggleAllRowsSelectedProps:R,getToggleAllPageRowsSelectedProps:P,toggleAllPageRowsSelected:I})}function xt(e,t){var r=t.instance;e.toggleRowSelected=function(t){return r.toggleRowSelected(e.id,t)},e.getToggleRowSelectedProps=f(r.getHooks().getToggleRowSelectedProps,{instance:r,row:e})}var Ct=function(e){return{}},Tt=function(e){return{}};c.setRowState="setRowState",c.setCellState="setCellState",c.resetRowState="resetRowState";var _t=function(e){e.stateReducers.push(St),e.useInstance.push(It),e.prepareRow.push(Et)};function St(e,t,r,n){var o=n.initialRowStateAccessor,a=void 0===o?Ct:o,s=n.initialCellStateAccessor,l=void 0===s?Tt:s,u=n.rowsById;if(t.type===c.init)return i({rowState:{}},e);if(t.type===c.resetRowState)return i({},e,{rowState:n.initialState.rowState||{}});if(t.type===c.setRowState){var d,p=t.rowId,f=t.value,h=void 0!==e.rowState[p]?e.rowState[p]:a(u[p]);return i({},e,{rowState:i({},e.rowState,(d={},d[p]=m(f,h),d))})}if(t.type===c.setCellState){var g,v,b,y,k,w=t.rowId,x=t.columnId,C=t.value,T=void 0!==e.rowState[w]?e.rowState[w]:a(u[w]),_=void 0!==(null==T||null==(g=T.cellState)?void 0:g[x])?T.cellState[x]:l(null==(v=u[w])||null==(b=v.cells)?void 0:b.find((function(e){return e.column.id===x})));return i({},e,{rowState:i({},e.rowState,(k={},k[w]=i({},T,{cellState:i({},T.cellState||{},(y={},y[x]=m(C,_),y))}),k))})}}function It(e){var r=e.autoResetRowState,n=void 0===r||r,o=e.data,i=e.dispatch,a=t.useCallback((function(e,t){return i({type:c.setRowState,rowId:e,value:t})}),[i]),s=t.useCallback((function(e,t,r){return i({type:c.setCellState,rowId:e,columnId:t,value:r})}),[i]),l=b(n);k((function(){l()&&i({type:c.resetRowState})}),[o]),Object.assign(e,{setRowState:a,setCellState:s})}function Et(e,t){var r=t.instance,n=r.initialRowStateAccessor,o=void 0===n?Ct:n,i=r.initialCellStateAccessor,a=void 0===i?Tt:i,s=r.state.rowState;e&&(e.state=void 0!==s[e.id]?s[e.id]:o(e),e.setState=function(t){return r.setRowState(e.id,t)},e.cells.forEach((function(t){e.state.cellState||(e.state.cellState={}),t.state=void 0!==e.state.cellState[t.column.id]?e.state.cellState[t.column.id]:a(t),t.setState=function(n){return r.setCellState(e.id,t.column.id,n)}})))}_t.pluginName="useRowState",c.resetColumnOrder="resetColumnOrder",c.setColumnOrder="setColumnOrder";var At=function(e){e.stateReducers.push(Rt),e.visibleColumnsDeps.push((function(e,t){var r=t.instance;return[].concat(e,[r.state.columnOrder])})),e.visibleColumns.push(Pt),e.useInstance.push(Ot)};function Rt(e,t,r,n){return t.type===c.init?i({columnOrder:[]},e):t.type===c.resetColumnOrder?i({},e,{columnOrder:n.initialState.columnOrder||[]}):t.type===c.setColumnOrder?i({},e,{columnOrder:m(t.columnOrder,e.columnOrder)}):void 0}function Pt(e,t){var r=t.instance.state.columnOrder;if(!r||!r.length)return e;for(var n=[].concat(r),o=[].concat(e),i=[],a=function(){var e=n.shift(),t=o.findIndex((function(t){return t.id===e}));t>-1&&i.push(o.splice(t,1)[0])};o.length&&n.length;)a();return[].concat(i,o)}function Ot(e){var r=e.dispatch;e.setColumnOrder=t.useCallback((function(e){return r({type:c.setColumnOrder,columnOrder:e})}),[r])}At.pluginName="useColumnOrder",d.canResize=!0,c.columnStartResizing="columnStartResizing",c.columnResizing="columnResizing",c.columnDoneResizing="columnDoneResizing",c.resetResize="resetResize";var Nt=function(e){e.getResizerProps=[Dt],e.getHeaderProps.push({style:{position:"relative"}}),e.stateReducers.push(Lt),e.useInstance.push(Ut),e.useInstanceBeforeDimensions.push(Mt)},Dt=function(e,t){var r=t.instance,n=t.header,o=r.dispatch,i=function(e,t){var r=!1;if("touchstart"===e.type){if(e.touches&&e.touches.length>1)return;r=!0}var n,i,a=function(e){var t=[];return function e(r){r.columns&&r.columns.length&&r.columns.map(e),t.push(r)}(e),t}(t).map((function(e){return[e.id,e.totalWidth]})),s=r?Math.round(e.touches[0].clientX):e.clientX,l=function(){window.cancelAnimationFrame(n),n=null,o({type:c.columnDoneResizing})},u=function(){window.cancelAnimationFrame(n),n=null,o({type:c.columnResizing,clientX:i})},d=function(e){i=e,n||(n=window.requestAnimationFrame(u))},p={mouse:{moveEvent:"mousemove",moveHandler:function(e){return d(e.clientX)},upEvent:"mouseup",upHandler:function(e){document.removeEventListener("mousemove",p.mouse.moveHandler),document.removeEventListener("mouseup",p.mouse.upHandler),l()}},touch:{moveEvent:"touchmove",moveHandler:function(e){return e.cancelable&&(e.preventDefault(),e.stopPropagation()),d(e.touches[0].clientX),!1},upEvent:"touchend",upHandler:function(e){document.removeEventListener(p.touch.moveEvent,p.touch.moveHandler),document.removeEventListener(p.touch.upEvent,p.touch.moveHandler),l()}}},f=r?p.touch:p.mouse,h=!!function(){if("boolean"==typeof M)return M;var e=!1;try{var t={get passive(){return e=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return M=e}()&&{passive:!1};document.addEventListener(f.moveEvent,f.moveHandler,h),document.addEventListener(f.upEvent,f.upHandler,h),o({type:c.columnStartResizing,columnId:t.id,columnWidth:t.totalWidth,headerIdWidths:a,clientX:s})};return[e,{onMouseDown:function(e){return e.persist()||i(e,n)},onTouchStart:function(e){return e.persist()||i(e,n)},style:{cursor:"col-resize"},draggable:!1,role:"separator"}]};function Lt(e,t){if(t.type===c.init)return i({columnResizing:{columnWidths:{}}},e);if(t.type===c.resetResize)return i({},e,{columnResizing:{columnWidths:{}}});if(t.type===c.columnStartResizing){var r=t.clientX,n=t.columnId,o=t.columnWidth,a=t.headerIdWidths;return i({},e,{columnResizing:i({},e.columnResizing,{startX:r,headerIdWidths:a,columnWidth:o,isResizingColumn:n})})}if(t.type===c.columnResizing){var s=t.clientX,l=e.columnResizing,u=l.startX,d=l.columnWidth,p=l.headerIdWidths,f=(s-u)/d,h={};return(void 0===p?[]:p).forEach((function(e){var t=e[0],r=e[1];h[t]=Math.max(r+r*f,0)})),i({},e,{columnResizing:i({},e.columnResizing,{columnWidths:i({},e.columnResizing.columnWidths,{},h)})})}return t.type===c.columnDoneResizing?i({},e,{columnResizing:i({},e.columnResizing,{startX:null,isResizingColumn:null})}):void 0}Nt.pluginName="useResizeColumns";var Mt=function(e){var t=e.flatHeaders,r=e.disableResizing,n=e.getHooks,o=e.state.columnResizing,i=b(e);t.forEach((function(e){var t=A(!0!==e.disableResizing&&void 0,!0!==r&&void 0,!0);e.canResize=t,e.width=o.columnWidths[e.id]||e.originalWidth||e.width,e.isResizing=o.isResizingColumn===e.id,t&&(e.getResizerProps=f(n().getResizerProps,{instance:i(),header:e}))}))};function Ut(e){var r=e.plugins,n=e.dispatch,o=e.autoResetResize,i=void 0===o||o,a=e.columns;v(r,["useAbsoluteLayout"],"useResizeColumns");var s=b(i);k((function(){s()&&n({type:c.resetResize})}),[a]);var l=t.useCallback((function(){return n({type:c.resetResize})}),[n]);Object.assign(e,{resetResizing:l})}var Ft={position:"absolute",top:0},zt=function(e){e.getTableBodyProps.push(Ht),e.getRowProps.push(Ht),e.getHeaderGroupProps.push(Ht),e.getFooterGroupProps.push(Ht),e.getHeaderProps.push((function(e,t){var r=t.column;return[e,{style:i({},Ft,{left:r.totalLeft+"px",width:r.totalWidth+"px"})}]})),e.getCellProps.push((function(e,t){var r=t.cell;return[e,{style:i({},Ft,{left:r.column.totalLeft+"px",width:r.column.totalWidth+"px"})}]})),e.getFooterProps.push((function(e,t){var r=t.column;return[e,{style:i({},Ft,{left:r.totalLeft+"px",width:r.totalWidth+"px"})}]}))};zt.pluginName="useAbsoluteLayout";var Ht=function(e,t){return[e,{style:{position:"relative",width:t.instance.totalColumnsWidth+"px"}}]},Bt={display:"inline-block",boxSizing:"border-box"},qt=function(e,t){return[e,{style:{display:"flex",width:t.instance.totalColumnsWidth+"px"}}]},jt=function(e){e.getRowProps.push(qt),e.getHeaderGroupProps.push(qt),e.getFooterGroupProps.push(qt),e.getHeaderProps.push((function(e,t){var r=t.column;return[e,{style:i({},Bt,{width:r.totalWidth+"px"})}]})),e.getCellProps.push((function(e,t){var r=t.cell;return[e,{style:i({},Bt,{width:r.column.totalWidth+"px"})}]})),e.getFooterProps.push((function(e,t){var r=t.column;return[e,{style:i({},Bt,{width:r.totalWidth+"px"})}]}))};function Gt(e){e.getTableProps.push(Vt),e.getRowProps.push(Kt),e.getHeaderGroupProps.push(Kt),e.getFooterGroupProps.push(Kt),e.getHeaderProps.push(Qt),e.getCellProps.push(Wt),e.getFooterProps.push(Jt)}jt.pluginName="useBlockLayout",Gt.pluginName="useFlexLayout";var Vt=function(e,t){return[e,{style:{minWidth:t.instance.totalColumnsMinWidth+"px"}}]},Kt=function(e,t){return[e,{style:{display:"flex",flex:"1 0 auto",minWidth:t.instance.totalColumnsMinWidth+"px"}}]},Qt=function(e,t){var r=t.column;return[e,{style:{boxSizing:"border-box",flex:r.totalFlexWidth?r.totalFlexWidth+" 0 auto":void 0,minWidth:r.totalMinWidth+"px",width:r.totalWidth+"px"}}]},Wt=function(e,t){var r=t.cell;return[e,{style:{boxSizing:"border-box",flex:r.column.totalFlexWidth+" 0 auto",minWidth:r.column.totalMinWidth+"px",width:r.column.totalWidth+"px"}}]},Jt=function(e,t){var r=t.column;return[e,{style:{boxSizing:"border-box",flex:r.totalFlexWidth?r.totalFlexWidth+" 0 auto":void 0,minWidth:r.totalMinWidth+"px",width:r.totalWidth+"px"}}]};function Yt(e){e.stateReducers.push(er),e.getTableProps.push(Xt),e.getHeaderProps.push(Zt),e.getRowProps.push($t)}c.columnStartResizing="columnStartResizing",c.columnResizing="columnResizing",c.columnDoneResizing="columnDoneResizing",c.resetResize="resetResize",Yt.pluginName="useGridLayout";var Xt=function(e,t){var r=t.instance;return[e,{style:{display:"grid",gridTemplateColumns:r.visibleColumns.map((function(e){var t;return r.state.gridLayout.columnWidths[e.id]?r.state.gridLayout.columnWidths[e.id]+"px":(null==(t=r.state.columnResizing)?void 0:t.isResizingColumn)?r.state.gridLayout.startWidths[e.id]+"px":"number"==typeof e.width?e.width+"px":e.width})).join(" ")}}]},Zt=function(e,t){var r=t.column;return[e,{id:"header-cell-"+r.id,style:{position:"sticky",gridColumn:"span "+r.totalVisibleHeaderCount}}]},$t=function(e,t){var r=t.row;return r.isExpanded?[e,{style:{gridColumn:"1 / "+(r.cells.length+1)}}]:[e,{}]};function er(e,t,r,n){if(t.type===c.init)return i({gridLayout:{columnWidths:{}}},e);if(t.type===c.resetResize)return i({},e,{gridLayout:{columnWidths:{}}});if(t.type===c.columnStartResizing){var o=t.columnId,a=t.headerIdWidths,s=tr(o);if(void 0!==s){var l=n.visibleColumns.reduce((function(e,t){var r;return i({},e,((r={})[t.id]=tr(t.id),r))}),{}),u=n.visibleColumns.reduce((function(e,t){var r;return i({},e,((r={})[t.id]=t.minWidth,r))}),{}),d=n.visibleColumns.reduce((function(e,t){var r;return i({},e,((r={})[t.id]=t.maxWidth,r))}),{}),p=a.map((function(e){var t=e[0];return[t,tr(t)]}));return i({},e,{gridLayout:i({},e.gridLayout,{startWidths:l,minWidths:u,maxWidths:d,headerIdGridWidths:p,columnWidth:s})})}return e}if(t.type===c.columnResizing){var f=t.clientX,h=e.columnResizing.startX,g=e.gridLayout,v=g.columnWidth,m=g.minWidths,b=g.maxWidths,y=g.headerIdGridWidths,k=(f-h)/v,w={};return(void 0===y?[]:y).forEach((function(e){var t=e[0],r=e[1];w[t]=Math.min(Math.max(m[t],r+r*k),b[t])})),i({},e,{gridLayout:i({},e.gridLayout,{columnWidths:i({},e.gridLayout.columnWidths,{},w)})})}return t.type===c.columnDoneResizing?i({},e,{gridLayout:i({},e.gridLayout,{startWidths:{},minWidths:{},maxWidths:{}})}):void 0}function tr(e){var t,r=null==(t=document.getElementById("header-cell-"+e))?void 0:t.offsetWidth;if(void 0!==r)return r}e._UNSTABLE_usePivotColumns=nt,e.actions=c,e.defaultColumn=d,e.defaultGroupByFn=je,e.defaultOrderByFn=$e,e.defaultRenderer=l,e.emptyRenderer=u,e.ensurePluginOrder=v,e.flexRender=x,e.functionalUpdate=m,e.loopHooks=g,e.makePropGetter=f,e.makeRenderer=w,e.reduceHooks=h,e.safeUseLayoutEffect=y,e.useAbsoluteLayout=zt,e.useAsyncDebounce=function(e,r){void 0===r&&(r=0);var i=t.useRef({}),a=b(e),s=b(r);return t.useCallback(function(){var e=o(n().mark((function e(){var t,r,c,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=l.length,r=new Array(t),c=0;c<t;c++)r[c]=l[c];return i.current.promise||(i.current.promise=new Promise((function(e,t){i.current.resolve=e,i.current.reject=t}))),i.current.timeout&&clearTimeout(i.current.timeout),i.current.timeout=setTimeout(o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return delete i.current.timeout,e.prev=1,e.t0=i.current,e.next=5,a().apply(void 0,r);case 5:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=12;break;case 9:e.prev=9,e.t2=e.catch(1),i.current.reject(e.t2);case 12:return e.prev=12,delete i.current.promise,e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])}))),s()),e.abrupt("return",i.current.promise);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),[a,s])},e.useBlockLayout=jt,e.useColumnOrder=At,e.useExpanded=le,e.useFilters=Se,e.useFlexLayout=Gt,e.useGetLatest=b,e.useGlobalFilter=Ae,e.useGridLayout=Yt,e.useGroupBy=Me,e.useMountedLayoutEffect=k,e.usePagination=et,e.useResizeColumns=Nt,e.useRowSelect=vt,e.useRowState=_t,e.useSortBy=Je,e.useTable=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];e=ae(e),n=[W].concat(n);var a=b(t.useRef({}).current);Object.assign(a(),i({},e,{plugins:n,hooks:Q()})),n.filter(Boolean).forEach((function(e){e(a().hooks)}));var s=b(a().hooks);a().getHooks=s,delete a().hooks,Object.assign(a(),h(s().useOptions,ae(e)));var l=a(),u=l.data,d=l.columns,p=l.initialState,v=l.defaultColumn,m=l.getSubRows,y=l.getRowId,k=l.stateReducer,x=l.useControlledState,E=b(k),A=t.useCallback((function(e,t){if(!t.type)throw console.info({action:t}),new Error("Unknown Action \ud83d\udc46");return[].concat(s().stateReducers,Array.isArray(E())?E():[E()]).reduce((function(r,n){return n(r,t,e,a())||r}),e)}),[s,E,a]),R=t.useReducer(A,void 0,(function(){return A(p,{type:c.init})})),P=R[0],O=R[1],N=h([].concat(s().useControlledState,[x]),P,{instance:a()});Object.assign(a(),{state:N,dispatch:O});var D=t.useMemo((function(){return C(h(s().columns,d,{instance:a()}))}),[s,a,d].concat(h(s().columnsDeps,[],{instance:a()})));a().columns=D;var L=t.useMemo((function(){return h(s().allColumns,T(D),{instance:a()}).map(_)}),[D,s,a].concat(h(s().allColumnsDeps,[],{instance:a()})));a().allColumns=L;var M=t.useMemo((function(){for(var e=[],t=[],r={},n=[].concat(L);n.length;){var o=n.shift();ce({data:u,rows:e,flatRows:t,rowsById:r,column:o,getRowId:y,getSubRows:m,accessValueHooks:s().accessValue,getInstance:a})}return[e,t,r]}),[L,u,y,m,s,a]),U=M[0],F=M[1],z=M[2];Object.assign(a(),{rows:U,initialRows:[].concat(U),flatRows:F,rowsById:z}),g(s().useInstanceAfterData,a());var H=t.useMemo((function(){return h(s().visibleColumns,L,{instance:a()}).map((function(e){return S(e,v)}))}),[s,L,a,v].concat(h(s().visibleColumnsDeps,[],{instance:a()})));L=t.useMemo((function(){var e=[].concat(H);return L.forEach((function(t){e.find((function(e){return e.id===t.id}))||e.push(t)})),e}),[L,H]),a().allColumns=L;var B=t.useMemo((function(){return h(s().headerGroups,I(H,v),a())}),[s,H,v,a].concat(h(s().headerGroupsDeps,[],{instance:a()})));a().headerGroups=B;var q=t.useMemo((function(){return B.length?B[0].headers:[]}),[B]);a().headers=q,a().flatHeaders=B.reduce((function(e,t){return[].concat(e,t.headers)}),[]),g(s().useInstanceBeforeDimensions,a());var j=H.filter((function(e){return e.isVisible})).map((function(e){return e.id})).sort().join("_");H=t.useMemo((function(){return H.filter((function(e){return e.isVisible}))}),[H,j]),a().visibleColumns=H;var G=se(q),V=G[0],K=G[1],J=G[2];return a().totalColumnsMinWidth=V,a().totalColumnsWidth=K,a().totalColumnsMaxWidth=J,g(s().useInstance,a()),[].concat(a().flatHeaders,a().allColumns).forEach((function(e){e.render=w(a(),e),e.getHeaderProps=f(s().getHeaderProps,{instance:a(),column:e}),e.getFooterProps=f(s().getFooterProps,{instance:a(),column:e})})),a().headerGroups=t.useMemo((function(){return B.filter((function(e,t){return e.headers=e.headers.filter((function(e){return e.headers?function e(t){return t.filter((function(t){return t.headers?e(t.headers):t.isVisible})).length}(e.headers):e.isVisible})),!!e.headers.length&&(e.getHeaderGroupProps=f(s().getHeaderGroupProps,{instance:a(),headerGroup:e,index:t}),e.getFooterGroupProps=f(s().getFooterGroupProps,{instance:a(),headerGroup:e,index:t}),!0)}))}),[B,a,s]),a().footerGroups=[].concat(a().headerGroups).reverse(),a().prepareRow=t.useCallback((function(e){e.getRowProps=f(s().getRowProps,{instance:a(),row:e}),e.allCells=L.map((function(t){var r=e.values[t.id],n={column:t,row:e,value:r};return n.getCellProps=f(s().getCellProps,{instance:a(),cell:n}),n.render=w(a(),t,{row:e,cell:n,value:r}),n})),e.cells=H.map((function(t){return e.allCells.find((function(e){return e.column.id===t.id}))})),g(s().prepareRow,e,{instance:a()})}),[s,a,L,H]),a().getTableProps=f(s().getTableProps,{instance:a()}),a().getTableBodyProps=f(s().getTableBodyProps,{instance:a()}),g(s().useFinalInstance,a()),a()},Object.defineProperty(e,"__esModule",{value:!0})}(t,r(791))},358:function(e,t,r){e.exports=r(707)},374:function(e,t,r){"use strict";var n=r(791),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var n,i={},l=null,u=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,n)&&!c.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:o,type:e,key:l,ref:u,props:i,_owner:s.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},117:function(e,t){"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function m(e,t,r){this.props=e,this.context=t,this.refs=v,this.updater=r||h}function b(){}function y(e,t,r){this.props=e,this.context=t,this.refs=v,this.updater=r||h}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=m.prototype;var k=y.prototype=new b;k.constructor=y,g(k,m.prototype),k.isPureReactComponent=!0;var w=Array.isArray,x=Object.prototype.hasOwnProperty,C={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,n){var o,i={},a=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)x.call(t,o)&&!T.hasOwnProperty(o)&&(i[o]=t[o]);var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(o in c=e.defaultProps)void 0===i[o]&&(i[o]=c[o]);return{$$typeof:r,type:e,key:a,ref:s,props:i,_owner:C.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var I=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,o,i,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case n:c=!0}}if(c)return a=a(c=e),e=""===i?"."+E(c,0):i,w(a)?(o="",null!=e&&(o=e.replace(I,"$&/")+"/"),A(a,t,o,"",(function(e){return e}))):null!=a&&(S(a)&&(a=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,o+(!a.key||c&&c.key===a.key?"":(""+a.key).replace(I,"$&/")+"/")+e)),t.push(a)),1;if(c=0,i=""===i?".":i+":",w(e))for(var l=0;l<e.length;l++){var u=i+E(s=e[l],l);c+=A(s,t,o,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(s=e.next()).done;)c+=A(s=s.value,t,o,u=i+E(s,l++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function R(e,t,r){if(null==e)return e;var n=[],o=0;return A(e,n,"","",(function(e){return t.call(r,e,o++)})),n}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},N={transition:null},D={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:N,ReactCurrentOwner:C};t.Children={map:R,forEach:function(e,t,r){R(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=o,t.Profiler=a,t.PureComponent=y,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=g({},e.props),i=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=C.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)x.call(t,l)&&!T.hasOwnProperty(l)&&(o[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}return{$$typeof:r,type:e.type,key:i,ref:a,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.transition;N.transition={};try{e()}finally{N.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,r){return O.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,r){return O.current.useReducer(e,t,r)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return O.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return O.current.useTransition()},t.version="18.2.0"},791:function(e,t,r){"use strict";e.exports=r(117)},184:function(e,t,r){"use strict";e.exports=r(374)},813:function(e,t){"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,o=e[n];if(!(0<i(o,t)))break e;e[n]=t,e[r]=o,r=n}}function n(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,o=e.length,a=o>>>1;n<a;){var s=2*(n+1)-1,c=e[s],l=s+1,u=e[l];if(0>i(c,r))l<o&&0>i(u,c)?(e[n]=u,e[l]=r,n=l):(e[n]=c,e[s]=r,n=s);else{if(!(l<o&&0>i(u,r)))break e;e[n]=u,e[l]=r,n=l}}}return t}function i(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var l=[],u=[],d=1,p=null,f=3,h=!1,g=!1,v=!1,m="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function k(e){for(var t=n(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,r(l,t)}t=n(u)}}function w(e){if(v=!1,k(e),!g)if(null!==n(l))g=!0,N(x);else{var t=n(u);null!==t&&D(w,t.startTime-e)}}function x(e,r){g=!1,v&&(v=!1,b(S),S=-1),h=!0;var i=f;try{for(k(r),p=n(l);null!==p&&(!(p.expirationTime>r)||e&&!A());){var a=p.callback;if("function"===typeof a){p.callback=null,f=p.priorityLevel;var s=a(p.expirationTime<=r);r=t.unstable_now(),"function"===typeof s?p.callback=s:p===n(l)&&o(l),k(r)}else o(l);p=n(l)}if(null!==p)var c=!0;else{var d=n(u);null!==d&&D(w,d.startTime-r),c=!1}return c}finally{p=null,f=i,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,T=!1,_=null,S=-1,I=5,E=-1;function A(){return!(t.unstable_now()-E<I)}function R(){if(null!==_){var e=t.unstable_now();E=e;var r=!0;try{r=_(!0,e)}finally{r?C():(T=!1,_=null)}}else T=!1}if("function"===typeof y)C=function(){y(R)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,O=P.port2;P.port1.onmessage=R,C=function(){O.postMessage(null)}}else C=function(){m(R,0)};function N(e){_=e,T||(T=!0,C())}function D(e,r){S=m((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||h||(g=!0,N(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,o,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>a?(e.sortIndex=i,r(u,e),null===n(l)&&e===n(u)&&(v?(b(S),S=-1):v=!0,D(w,i-a))):(e.sortIndex=s,r(l,e),g||h||(g=!0,N(x))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},296:function(e,t,r){"use strict";e.exports=r(813)},367:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAA8jAAAPIwAXT4q7QAAA0mSURBVHhe7Z1ZrCxVFYbvvVyccMB5njVO0YhTJOAQNRoHonFI5MHEiMqT1xAfnA1gFMODQ6JR0YDxwSli0MQRNYoSIkSJCDiP6BUQBEX04j33Hv+vT+12d/WueVV1ddf6kj/V3ae7umqtv3bt2rVXn93b29u7iti9e3f2qD5l63NsqZOfqnzsyZad4Ys8+euHiQE88etLZwN48tebTn2A1Gfb9BvqcsTuvRj2iEzh8W2k+0gPlO4l3TPTPaQ7S3fIdEfpttKR0t5syecPSQelrWz5H+mfmW6SbpSula7J9FfpT9J+6YDE5w9ny0OHtrd4PBqqDtDWBsh/zjrxSjZJOkq6fbYkmQ+WHp7podL9JRJ9a2lobpEwBmb4nfRr6VfSH6QbpJulf7GUKTDXSujFAH0kPzu6SXI4ijmiHy09ItMDJBLdXxPTHQKDMTDFL6VfSFdmz2k9rpZuGLKV6N0AXZKfJZ1kP1J6lETCeUzCadY791FGAMn+i0QLgSGuyJY/l67p2wzmBrBIvhLPkfwU6WnSEySa9AdJnKvHfIR3heDRr+A08RvpJ9IF0sUyAi2HOb0ZoE3ylXia+BdKr5AeJt1XonO2yUkvgkDS0aR1+K30BemrMgL9BzNMDdA2+Uo8SX6ZdLLE0X60tAnNuxWcBrja4DTxMelcGYGWYoE28V+pAbJz/FOlM6TjJJ43c8+0IMCY4QfSWyVODfM+QpyrujkwN0CD5N9Fi5Okt0g8dprxd+m90jkyAY9nNDXBSgyg5NOhe5f0aqmeY5wUJOdT0ukyAR3HpYRW5cPUAHVQ8hmc+YDEOd+x4VzpFJngKp7EOetqANOOmJLP5d0bpRNmLzhWvEjap/jeiidx0qsSXIV1T5xr+xdLjLM7dpB44vrk2TNhZQJrAzxTYmy++bnDKYN4ElfiO6fNKTqPtQEYx+funGMPcSW+plgbgFEsbqk69hDXpVHCrq2AtQF+KP1N6tYzcfIQT+LKANESmKBtP8DaAN+Xviut7P73hvJf6XwpaQBo2xKYGCC4T9epzKY5U/qe5K1Ad4ghdwm/Jp2p+DIDaRbvrpd/gc4GCBvCUtep2JAbGm+WzuNlyWkH9wC4IXSO9HYlnzuGC4m3MEHnkcDU5/mczHA/PdwnvU7i7p9TDwLK/EKGfj8qfU7J3x/HOeSF16pyVGUSk6HgEhMwMsj9f1qEJ0pMwnSKIZCcRr8jvV+6RMm/OZV8GI0BoGg9mRFup4fMBXiTxFSv+iueBgSPJp/T5/sk5gMwoXQe11QuRmUAqFqXjHB3PTxRwgwMajDbl2HOqRkiBIoOHud5bvJ8RCLx/9ByIZZZ7B6rh6/R30/ZeXVkBtAGvluLt0nHbh0+ePHsxQTZzjCq9RyJmxycGpgYejeJ1zfZDASbJp5reuoLiNNXpAuU2PkAWj75oJg9SYsfSWfove+YvViDIQ3wHi0wADxeG/nTqnXrM/QJuH3MTSRudDAbmM4jcwUxhPU4xSqgaSfhzP3jSGdGMIm/hNcUp9mMn3ys4tgrThz9l+08mxkgxLmSVRkAnq4NnQ9c1DTDvaWHZKLwg4kl1AOEqp8xny7CDjJoE6qH/ijRm+cSDlFAcnVR0gO55B+vRTwAtGAA1lGWp1UagEGLV2pjv7zzdJGqndf6uIK4q0S/AXE3jNYCYQhaCk4dvGd2n3xA2HgSfb1EsjmyEUnnSOeID7pOMeC9c1L7noq1YsAt4M9IdKIDa2MAoBLmk9KF2uhvzF5JUCcgWj8vUNuHCAiiz0BHEiPQenDawBBB1BnE5WW8n5aGsjPEKYajkaFrrr1ZYtxQ1oXopDEn7zqJhIfzN2VhvI/3/1vi3M7ygPZ1aYfqJh20r8/TgiP/tVL+DuBaGSBAFcw+bfi3d54W02Z79N0kksSyjMUHwjIIUisKX8wyCHOEZazKItC2cdW+0Dn+kESVVIq1NAD8XqI+Do7XTnDEFVK14VU02fYuNNnOCgNfuPNsdqqjD1TEkgGgaN1V28cXDwWVvdQIoP3aacqiCmGH8moCOz6Eyqiz/YrDj7XglBJiU5Z8c4Y0QAwuP0Y7v53pNOmooJ23LJMPaJmGIvXdQTHx/kmnSrN915+ojSQerch/T1OGPAU04XHZEuhFc4SsFYpH6JQGwnV8VxZOAUAOi3JV2UqN1AAxXEZySzSGnvY3s8crR/v+XC24OomhKOYlOw9NSRogBfnbBAOkoJDy9J2HSa5XkD6dPe6M9u1VWsRHc553SlQ+D0FtA9ShsQHy7w/vGdgAVXC9/tmdhyZwA4txhTGwZABoa4JSA9RhpAbYZEwNsKqrAGckuAEmjqUBuOHh08H7hfgu3FjqiqUB+Dm0P+88dHqC+BJnMywNwASHy6XSMX6nNcSVn5hbmm3VpSNvaQDuhfNDBtwudezhdjTxJc5mdDZAcJ8uTbg9yqgdMj1PObN4EtfzsjjP6XwZ33UFgWg8gPl8Z0sMjzo2fEs6Sclf6mONxgAQmYAbIYzEPWP2gtMF6ixPVPKZXbWARe4s+wDx6YC7d1QE8euXXLrYuWwaEC/i9nnphL6SD6YtQCBqCe6kxRsk6gNpFfy3g6qhPoAD6Czpw0r+rFAkYJ2vXgwAkQlCEcjrpWMlfjTStOXZEOjcMfn0IukT0vlK/qwcHHrLk8WKSXbReiIjMJWbac4II+Tvn08ZZhSTeKqE6OlTTzAjFdcQU5PcdV1J2BhQkvdsHT64NFs2MgEzdx8j8TPxL8iWTN2eKkw75+fivy5R/HG54lc6kBbHe1QGUHJ5wFz9A0U7kTMCkx+ZD/d8iVPEVKqGCTj/b4iffCHxlypeVAWXEic+MMYW4INanK0m7LKy9UZGoDiDjiJVPs+WXipRJ7iJnUU6dwzjfkmiPoIKohurjnggXopVsjq4K5YtwLw6WBs5H68uWn/e0fo8HUNaBszwconfGj5GGrrsyxJG8Jj+zhDuFyWSPisqqRv3KL7J6uDO+TM0QDwjaFYdnD2eUdcIAa2PPzBdmsGkZ0l0HCkBo2YQU4R//5ZewTDQ3+EI5ugm2dT7U/xCh45f+eD8fq1isbDzdWIex0WxKKwOHqsBYKE6OFD2fUVmAK2fFoJKYYKBKCWnUJTfH6LvwVUF5uCyM5jE4nKTJIfkclnGkl47dYFco3Nzhv8Q9rNMV2m/lzrCUDfWueRXVgd3oU8DtKoOjikzBOg7aQVoFThtUERJFTGzdxGzdIMpgkJBaDjd8AVsCEcxSUOMwJHkIJLNL3RyNw6F4lDG5Tm65z/skKJN0gPav1rVwV3o0wDQujo4RZUhYrQ9vJmkh2pilrQKJB6F0wdfTtIxAeJoD5W+LG/RtpduYNsYFu2Ptr1RdXAnWEEXBTCAFEq98rpS4lKvktR3FGmVpLanrsogTtIVWdxS4t/IzEmtv4kszpF14J9CnqWNvygTR2ASjoq6R3pqh4rUhNTn82pK2K/Uvikee0Js9PTjUlFpuDlDGQAGrQ7Ok0pikSyou+2Kw3pXB7cM2MZXB+eJ909aj+rgurAR2hnLyiCvDi5moRMIXXI4VgPEeHXwIpMzQAqvDo6YogGq8OrgmmyqATYZUwMMeRnojBA3wMSxNABj6IypO/1BfImzGZYG8Org/hlfdTAdwAyvDu4X4urVwRPGq4MnDPH06uAJ49XBE8argycI8SJuyepg4mx14JoaACITMGuWgtDTJP6dSunkSWcOcSJep0onK46z/x8YUOvKbGgzTE8BMdHpwKuD60HnzquDJ0qj6mBLOhsgJBiUZK8ObsZSdbB0tGLI7ewkcbxNDl4rAyi5PPDq4GoIuFcHg94/+epg6TjpJpngUi2TEC/FyquD1xBG8Lw6GOoaIaD18QevDhaKhVcHa/20EF4dvEYG8Opg0SbpAe2fVwfHVBkiRtvDm0k6JvDq4CJYQRcFMIAUSr3y8urgSGUQJ8mrg+uQ2qEiNSH1+byaEvYrtW+Kh1cH54kDVhS4JqSSWCQL6m674uDVwZJXB7ck9V1N6NwJBDZCO2NZGeTVwcUsdAKhSw7HaoAYrw5eZHIGSOHVwRFTNEAVXh1ck001wCZjaoAhLwOdnuhyELsBJo6lARhDZ0zd6Q/iS5zNsDSAVwf3z1J1cNc+nKUBvDq4X4hrsjq4C5YG8OrgfhlndTDQDOnShMkUXh3cD8RzqTrY5BLeYiUxe/cc6dXB9iSrg0dpAJAJvDrYjmR1sFXeLPsAc7YOH/Tq4G4QL+JWWB1sRS8GAJnAq4PbsRnVwZDdI/Dq4HrQuVvP6uAyMAHICF4dXMz6VgfXITIBk0G9Ovj/NK4OtmYQAwRyRvDq4AbVwX0xqAECkRG8OrhGdXCfrMQAEEwQkBnoGNIyeHXwgKzMAIG8EQIyBH+YbHXwUKzcADFFZoCshZhEdfCQjMoAKSpMsTHVwati9AYoo8Ic/JGkY4JRVgePgbU2QF3KjNKWTYnbJAzgFGPRSXLWGDfAxHEDTJpdu/4HFOhy3eBg86YAAAAASUVORK5CYII="},354:function(e,t,r){"use strict";e.exports=r.p+"static/media/logo.15cd005860809fedf280.png"},424:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAA6KMAAOijAWd586YAAAdfSURBVHhe7Z13iOxUGMWfvfdeUB6Igj5FsaAoNuxiw4IVxYpd7CgoKioW7CjqU6zYsTcUsaEodpFnR/1DRZ/Yez1n8wbC+GVy70wyyc13fvBjs8vuJJt7JuW7uXcmCSGEEEIIIYTwxEwzvor6WQYulS1Wzl/wjWxRtJXF4dvw3xr8BooEqCsECkBC1BECBSAxqg6BApAgVYZAAUiUqkKgACRMFSFQABJn1BAoAB2AIfgQWg1c5tABmHnGV9E8G8PlskXhjf0gy7nWuztEnQIS5jD4N7QaNlQFIFGOh/9Aq1FjVAAS5DRoNeYwKgCJcR60GrLI74yf5VUAEoHPX1wOrUYs8hK4BBxUJ1AAEmAWeB20GrDIs2GPQcUiBaDlzAZvg1bjFXkq7KcoBApAi5kD3gf7G61I3hUcA4uwQuA+AG19tnFu+BjMN9YgWQ84GJaxGMyHwHUAuDNehOtOfNce5oNPw3wDD/JPuDcMhf/3W5B/6zYAi8I3IXfCt3AN2AYWggxlvoEH+TvcGcbSC4HLACwMX4f5Hfk1XAU2CRulf7sG+SvcBg4L1/dMtuiHBeEr0NqhX8AVYRMsDd+B1nZZ/gQ3haMy/4yvLlgAvgStHdrzMzgZjpPl4QfQ2h5LVvfWhyICJj303PoxXBaOgxXgp9DaDsvpcE0oIpgXPg+tHVrke3BJWCe85vgcWuu35ClqVSgimAfyQsfaoWXyfpl3C3XAuw5eeFrrteSpqanrk2RhMeUpaO3QUF+FvHCsEtYdeOtprc/yIzju65LkmQs+Aa0dGiuvHVicqQI+v/cDtNZjOQ1ydLCIYE4YU0YNkZU5HlFGYSv4C7Re35KFKtbvRQTsQHkYWjt0VB+HfP1h2BH+Bq3XtXwZsmAlIpgdPgCtHWr5JdwEvpv7WZl8fXbRxrAHZL3eej3LZ2HrCzRt60Vjo9wJ+U4LgVfgbHxW33jPz50eeqF1F2SjsgeujAPg1ZAPdYTwJOT/8PPEd+GsA/mIuEtmhWwU691kycZfDeZh4/NWy/p9y5tg2eCYI2HMk7s8uvD6ZRjYG2i9Zp22Ar6zbofWBlqy92t1aMH7bBZbrL+z5Du76Eh4ErT+pkgevWJPLXlcBoCNfwu0Ns6S995lZdQpMKZAcyns50xo/W6RN8DQU0QR7gLAw++N0NowS3ag8DwZAqt0MYWacyHh0eBCaP1OkVfCKsZZugoAd1jMU7Lfw/VgDKzWxRRsTodX9f2sTIalqotpNwHgDrsGWhtk+SMctut0Q8ircet1R/UMWCUuAsDG5yHT2hhLPjTBRhyFLWBMASdEXiBWTecDwMa/DFobYsl3Lu/zq2A7+Ae01hMjbwmPgHXQ+QBcBK2NsGS9fTNYJbvCUcbh82/3h3XR6QCcD60NsOSDklvCOtgHDjMen2VgVg7rpLMBOAdaK7fkuXqUp2RD4OCLmOoetym0PD0KnQxATEGFz8dvD8fB0dDahn55KqrraNRP5wIQMwkCL9B2guPkZGhtS0/WEDaC46JTATgFWiu05Pl1F9gEvJe3tolVxHEPN+tMAE6E1soseWW9O2ySC2B+m76CTQwz60QAjoXWiizZ+HvBpmF94grIbeIj3ivDJkg+AEdBayWWvBXbF7YFhoAdQhzk0RRJB4Dz3YXeWrHx6yyopEqyATgEhjY+fy9kEgSPJBkAPi8XWllj4/NIIWySCwDP4TFlVV4jiGKSCgA3NqZjhXcHYjDJBID37TGNfwIU5SQRAHapxgyQYEVQhNH6ALBWH/NQBfsCRDhjDwCLH6Gwl44DNzh0K4SzYBsDwMfL6povwOIT+Fq2WAoDcHO22C62heyqNVNkyP7/tjLsRBPDOhWGMvYjQMiz7BwOfQ8MfeezY0Xn/UQoC8Dm8F4YOpz6YsieQJEIgwLA+evuh6EDHTkP/nHZokiFogDwKRiOcuUULSFwNE3vESuREFYANoAPQc7MFQJH+BwO1fgJ0h8Ajr17BHJOvhCuh4dCNX6i5APAUbePwtCZtDi5wkGQPXwiUXoBWAty8iTOwxvCrZAPdKjxE4cB4MOPbPzQiRTvgL1uYJE4DAALN6FTmd0NWa1S43cEBmA3yKlUy+AHH+0J2Q0sOkKvM4gfccLTwNoT3/2fByEHbrAnsAxOiXpttjg2+Clb72eLpbAvYNT5BmLgLCgHZoulNNoZxAtAay5+ztgZM7MmZ+nqf426DZ03iKgzKGf+NpBz8HAQ5AsT32XwqMAPM2JPoOgg+QAQDoZk799zkLNd8gEQDo0WHaU/AIQTMm0Nd4CcqEF0GCsAhHPzcFy86DhFARBOUACcowA4RwFwjgLgHAXAOQqAcxQA5ygAzlEAnKMAOEcBcI4C4BwFwDkKgHMUAOcoAM5RAJyjADhHAXCOAuAcBcA5CoBzFADnKADOUQCcowA4RwFwjgLgHAXAOQqAcxQA5ygAzlEAnBPzoVGh8AMmpmSLY2Ma5LQ2IawEQyfEroLpkB8cFcIicHK2KIQQQgghhBBCVMykSf8BV4N2KFQVKWsAAAAASUVORK5CYII="},11:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAjGSURBVHhe7Z2/jxtFFMc5Rylo0yDRkOaEKCD9NbTnvwDRUKRJx11DQUEQaSgSRUmXKkUa/gXnH0iFFNEhXUHSUEVIaUJxksP3rd+YOcdrr+e9Nz9230dardfJjXfmfebN7K53ffRRxTx+/PgzrE7fv3//KZbrR0dHN7F8u/pXXVD+b1heofxLLH/z24uzs7PX/HqUVCcABR2BuG0d8CGQFFhdsBCjlKEKAeKejvVxyaD3EcnwdEwiFBOghaBvY2xZoYgAnObvoRG/47eaBHV4hjq8wMtmRcgqQBjf8bKZHj8EFuFuixJkEWCsgY9ZLpf/om73sTQ1RzAVIBrnT9AwTaf7oaCuTU0WzQQYyzifSivDgroAU+z1fbSQDVQFmHqv76PmbHCN12I8+P2gTW6hbW7M5/OXi8XiLb9dBSoCePD3U6sEYgE8+MOpUQLRHKCm4GM/uqt5vLkV7GfRi0sB2lesqpgcJgtQMvgh2Pjsgy7d0j5jdUqv8ffml5j3Qe13fn7+M28WIUmAEsHH55lchAlSkBBYZz1TSXXC5/1YMgscLEDO4FsFvY8SMuCzih4iHiRAruBHgS82RkYymJ/QKinBYAFyBL+GwG+SS4RSEgwSwDr4y+XyHcp+UFPgN+E2ML2iWUKCoQLcwerJakuXUuanYt0ZcrfHjNe9cIVPeFOV1oJP0L7SPtO+81uqsFjdoWoOdmYAK9tRZnVj/aFQ22BlMjfI2TH2CaCe+nNWLgeGnSTLSaLeIcAi9Y8t+ITVkIDyfuAsY0qvANiB25pWjzH4AQsJZrPZxyjvnrUEWwXgDz1ebckZc/ADFhJwBzSdEG4VAJWg3q9yrDuF4AcsJEBZJ5ZZ4AMBNHs/dp4udkwi+AFtCVCWaRb4QADsuFrvBxdTCn4gkoAOd8VYZoErAij3fkr9T3lzcrD4F6stGZZZ4IoAWr2fgz+p1L8N6gDUFrwpwioLrAXQ6v18i9Tkg09oDgUoxyQLxBngFB8i7v0o474H/380hwKIRF9UUWUtgEbhZDoEmOy43we1CdpGYyg41h4GOgEUJ3+TnPXvg4cCeo6ACM7QqsNAyADi9O+9fy8LjSygkaljOgGUCvXevwOtLABUh4GZRvr33j8YcRbQHgYoA2jM/r33D0ArC2gOAzONwlCpcHeOsx/KAqLzAvj76/xSDAkgKowrs1htOfvgTCk6L4AOd1NrHjCjwvh1Kp7+D0SaMfH3avMAEkA0/ksrM1HEw4AW6zOBKXj6T4MyJtpu563s+8Dfq0wEpQK88vSfBjLnJb9MAm2vMhEUCSCtxJSpZeiUCuDjfzqieQDaXuVIQCSAk450HgABVI4EkgVge30C2DgSAXwCOAJ8CChIDZNoF6AgNUyiXYCJ4wJMHBdg4rgABcGRlOr3+1JwAQoCAdS+2JFKsgBapyKdskgEUP1yolMGHwIKQdmTsihvHozWqXgXoByib2NrnYoXCVDDLNaRIc0A6jcrToVaOo9IAJ8IpsGdRnQ3Ftpe5UIS3Rcg+naqDwNJiO/Gwt+rXEgiAaTfTi1+MqM1auo0dF+ANJWc+zxgOBrpn7O2yrexSABRKuFHmtIPKTjDqOpmXK3zAH40MBCN9K81/hMkgPg2JTbajwb2oJH+tZlxKhE/xQoSmT7TdgzQUClN/9xZ1b6N3Q0BGikFZZg/2bplFHu/6t3YYQ6gcreqZ4F+tHo/ylB9FE8ngNYwQFmAKsqbDlNr7yfWRwEawwDjRwQR1BboFPSbQtJDP80YrVkLAGgYED/HjipKFXYJVlBGpMzIm8mgHNXJX2AtAKUW7KjGc+x8KGAUUz9h8iieOAMQKlmAmfRQoJn6qfejHJPnMF4RQDkLTHYoiIIvTv2M2YO4NjMAoZYFqAGmJoF28FGW6VNYPxBAMwsQU5LAoOcTZr2f2JYBCM25wGQkQB1VZvwBlGf+DObe3w5mm3/FDognMQGSCuWN7udkuK3oqOdz1O+b1btyUKb57wf3ZQC1s4Mx1DuoUmPKBFHav6sc/Cy/utYrAEE7QDvCmyqMSYIo+Jpjfkj9WTLlTgF4Qqj2A4iBMUhgFXzGdOIX0zsHiHn06NEvJAJvqsE/MXcfy9NW5gUceBrvj7HfavOjGJSfba50jdc7mc/nf2GnbmCnbvFbKqC861i+prLxGZ9gebNYLN7yP1dH1Ou/x/Ilv60OtTO3yUvr9hiUAQjjlNeB8sl8OgexqCkj5Oj12+D2MM0EgwUgckhA5Kj4EEoFPsa6LQ4SgECj3MHqyWrLjmh+QNfAs2UECjpWp2h4+vZuscDHWEqQIkDoFaonPXaBz6OjkAsrGWoM+iZWEhwsQMDqyGAfGzIQSUK0EPRNLCRIFoAzgfl8YB8kBJbu/kbsy2UkxhUo0FjW9zHi/93EUn3QN0EdVCVIFoAoMRw4uhKIBAg8fPjwi9ls9lOLPapVtCQYdCJoH8+fP38zn89/x06pnyxytkPtTO0tPVmkIgBBO0E74xLkQ0MCNQEIlyA/UglUBSCCBHj5J3bsn6mKgLrT4eofqP9Xq3fskEigMgnso5ZDxdygzt0EjV9nq3/43EMmhqYCENEJl5Oxi4A6hpNU68vbuTvBoRKYCxCIzhk0cdbtELYFPqZmCbIJEBiTCMvl8h3q8KAv8DG1SpBdgEDLImC/d/b4PmqUoJgAAWoUrJq4KJMa+JjaJCguQEzICljoos05PYJu9S/liIKudim6JgmqEiCmVGaggGN5hc8LVxZNvoxSiwTVChATZKDXJASW7rIuKpR8SRdl9F1GzvrtI+xDUQmaEKCPWIwEsgV6F6UlaFqAsVBSAhegEkpJoH4xyEkj95VU+ozus3jbqYTcmcAzQGXkzgQuQIXklMAFqJRcErgAFZNDAhegcqwlcAEawFICF6ARrCRwARrCQgIXoDE0JUAZz3Y+Jcypk+4izlH39DbRI/xQxgsXoFGkEvDfLfxaQOOE70QgoIPuu6DAU8/Hy8XZ2dnr/wC1dxogmLrztAAAAABJRU5ErkJggg=="},897:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxMAAAsTAQCanBgAABlZSURBVHhe7d2xbhxHtgZg05G4Mjcj4eBCiY19BxnCbqaUgHP74ezcgFJlawjWS6wT4l7AIEOaS2ETXpXVs6ZGQ07PTHfXqTrfBxCeJnDvyha7/79O1QyP7u7uPgMAcvl8+CcAkIgCAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkJACAAAJKQAAkNDR3d3d8BJo2evXr3+4vb39ZrgM5fj4+JeXL19+P1wCASgA0IBt4X52dvblkydPng6XIb179+7m8vLyt+FyI0UBlqMAQBAPhXwL4T6lh4qCcgDTUgBgYZuCPlvI72tTOVAMYD8KAMxoPewF/TzWi4FSANspADCh+4Ev7Ou6XwoUAviUAgAHEPjtUAjgYwoA7EDg90MhIDsFALZYhb7A75tCQDYKAKyxyqdYFQJlgF4pAPCeVT6PUQbokQJAWkKffSgD9EIBIBWhz5SUAVqmAJBCCf6Tk5NvhT5zKWXg+vr6J0WAVigAdMtqnxpMBWiFAkB3rPaJwlSAyBQAumC1T2SmAkSkANA0q31aYypAFAoATRL8tE4RoDYFgKYIfnqjCFCLAkB49vfJQBFgaQoAYVntk5EDgyxFASAcwQ8fmAosazVtHC67/62QCgChvHnz5p9Pnz79+3AJvHdzc/Pzixcv/jFcMoOHnj1XV1c/9loCPh/+CVWV5v327dvfhT98qtwX5f4o98nwLSb02MLj/kSgNyYAVGXcD7uxLTCtbVPHi4uLX8/Pz78eLruiAFCF4IfDKAKHG7PlqADARAQ/TEsR2M/Y80Y9FwBnAFjEao//9PT0O+EP0yn3U7mvSqAN32KLseHfOwWA2ZWbTfDDvEqgOSi4nfD/kwLAbFarfjcbLGM1DVAENhP+H1MAmJxxP9RlW+BTwv9TCgCTMu6HOGwLfCD8N1MAmIRxP8SUfRog/B+mAHAwq36IL+M0QPg/TgFgb1b90JZM0wDhv50CwF6s+qFdvU8DhP84CgA7seqHPvQ6DRD+4ykAjGbVD/3paRog/HejALCVVT/0rYdpgPDfnQLAo6z6IY8SoC2WAOG/HwWAB7mpIJ9yz7e0JVD+nJ5T+1EA+ISRP+TW0pZA+fXiw0t2pADwESN/YKUsAiKXgPJn86zanwLAfxn5A+uibgl4Xh1OAcDIH3hUtC0B4T8NBSC5ciMZ+QNjlNCtXQKE/3QUgMTcSMCuapYAz6xpKQBJuZGAfdUoAZ5Z01MAkrHfD0yhPEOWOhwo/OehACRSbiL7/cBUljgcKPznowAk4SYC5lKeLXOUAM+teSkACbiJgLlNXQI8t+anAHTOTQQsZaoS4Lm1DAWgY24iYGmHlgDPreUoAJ1yEwG17FsCPLeWpQB0xtv8gAh2LQHCf3kKQEfKDeRtfkAUY0uA8K9DAeiEGwiIaFsJ8OyqRwHogBsIiOyhEuDZVZcC0Dg3ENCC9RLg2VXf0d3d3fCS1riBgNbc3Nz8XP7ZyrPr4uLi1/Pz86+Hy66YADRK+AMtKs8tz64YFIAGCX8ADqUANEb4AzAFBaAhwh+AqSgAjRD+AExJAWiA8AdgagpAcMIfgDkoAIGVX+wj/AGYgwIQ2MnJybfDSwCYlAIQVBn9+61+AMxFAQjIvj8Ac1MAghH+ACxBAQhE+AOwFAUgCOEPwJIUgACEPwBLUwAq815/AGpQACrzXn8AalAAKiqjf+/1B6AGBaAS+/4A1KQAVCD8AahNAViYQ38ARKAALMyhPwAiUAAW5NAfAFEoAAux7w9AJArAAuz7AxCNArAA+/4ARKMAzMy+PwARKQAzsu8PQFRHd3d3w0umVPb9T09PvxsuIZR3797dXF5e/jZc7uXs7OxL0y16d3Fx8ev5+fnXw2VXFICZvH379ncPR2rYFu7Hx8e/vHz58vvh8iCl6N7e3n4zXH5CSaB1CgA7MfpnKethP2W4T2W9JCgFtEQBYDSjf+bSQtiPpRTQCgWA0Yz+mcr9wG857Me6XwoUAqJQABjF6J9DrUI/Q+BvsyoEygA1KQBsZfTPvoT+dsoAtSgAbGX0zy6E/v6UAZakAPAoo3/GEPrTUwaYmwLAg4z+2aYE//X19U9Cf17lXiy/d0MRYEoKAA8y+mcTq/16TAWYkgLARkb/rLPaj8VUgEP1XAD8MqA9lQeL8GelBP/V1dWPz58//0L4x1H+LsrfSfm7KX9Hw7eB9xSAPfkd/xSCvw2KAHxKAdhDWf0bKeYm+NukCMCfFIA9WP3nJfj7oAiAQ4A7c/AvpxISDvf1y33NQxwC5A8O/uV0c3PzsxV/3168ePEP0wCyUQB2YPSfy2rcX8Jh+BYdsy1ANgrASA7+5bEKfqv+nFZFoEx+hm9BlxSAkaz+czDuZ8W2AL1TAEaw+u+fcT+bmAbQMwVgBKv/vln1s41pAD1SALaw+u+XVT+7MA2gNwrAFlb/fbLqZ1+lMCoB9EABeET5cBCr//6Uh7dVP4ewJUAPFIAH+NCf/hj5MyVbArROAXiA0X9fjPyZiy0BWqUAbODgX1+M/JmbEkCLFIANrP77YOTPksrPmXMBtEQBWGP13wcjf2pwLoCWKABrrP7bZ+RPbbYEaIECcI/Vf/uEP1EoAUSnANxze3v7zfCSBgl/olECiEwBuOfs7OzL4SWNEf5EpQQQlQIwMP5vl/AnOiWAiBSAgcN/bRL+tKL8nP773//+3+ESqlMA3rP6b5PwpyXld4v85S9/+Z/hEqpTAN6z+m+P8KclJfz9bhGiSV8ArP7bI/xpifAnqvQFwOq/LcKflgh/IktdAKz+2yL8aYnwJ7rUBcAH/7RD+NMS4U8LUhcAH/zTBuFPS4Q/rUhbAIz/2yD8aYnwpyVpC4DDf/EJf1oi/GlNygJg9R/fu3fvboQ/rRD+tChlAXD4L77r6+ufhpcQmvCnVSkLgMN/sZXR/8uXL78fLiEs4U/L0hUA4//Y7PvTCuFP69IVAIf/4rLvTyuEPz1IVQCs/mOz708LhD+9SFUAHP6Ly74/LRD+9CRVAXD4Lyb7/rRA+NObNAXA+D8m+/60QPjTozQFwPg/Jvv+RCf86VWaAmD8H499f6IT/vQsRQEw/o/H6J/ohD+9S1EAjP/jMfonMuFPBikKgPF/LEb/RCb8yaL7AmD8H4vRP5EJfzLpvgAY/8di9E9Uwp9sUmwBEENZ/Rv9E5HwJ6PuC4D9/zis/olI+JNV1wXA/n8cDv4RkfAns64LgP3/GBz8IyLhT3ZdFwDj/xiM/olG+EPHBcD4PwYH/4hG+MMH3RYA4/8YrP6JRPjDn7reAqAuq38iEf7wsW4LgP3/+qz+iUL4w6e6LAD2/+uz+icK4Q+bdVkA7P/XZ/VPBMIfHuYMAJOz+icC4Q+P67IA2P+vy+qf2oQ/bNddAbD/X5fVP7UJfxinuwJg/78uq39qEv4wnjMATMbqn5qEP+ymuwJg/7+ey8vL34aXsCjhD7vrqgDY/6/r+Pj4l+ElLEb4w366KgD2/+sx/qeGUvqFP+zHGQAm4fAfNSj9sD8FgINZ/QO0p6sC4ABgHQ7/AbSnmwLgAGA9Dv9Ri5895tbzz9jR3d3d8LJtr169+tezZ8++Gi5ZSBn/P3/+/IvhEhZXyr+zAMyhhH/P25sKAAe5uLj49fz8/OvhEoBGOATIQYxgAdqkALA3p/8B2tVNAfAOgOU5/Q/Qri4KgHcA1GH8D9CuLgqAE8DLM/4HaJszAOzF+B+gbQoAezH+B2ibAsDOjP8B2qcAsDPjf4D2dVEAvAUQAHbTfAHwFsDl2f8HaF/zBcBbAJdl/x+gD84AsBP7/wB9UAAAICEFAAASUgDYiQOAAH1QABjNAUCAfigAjOYAIMCyjo6O/viaQ/MFwIcAAdCru7u7P77m0HQB8CFAAMy1Qu5d0wXAhwAtywFAIKK5Vsi9cwaAURwABOiLAsAoDgACNcx5CC47BQCAsOY8BJedAgDAIqzkY1EAAFiElXwsCgAAJKQAAEBCCgAAJKQAMIoPAQLoiwLAVj4ECKA/CgBb+RAggP4oAACQkAIAAAkpAACQkAIAAAkpAACQkAIAAAkpAACQkAIAAAk1XQB8PO0y/HcG6M9R67+f+fXr1z/c3t5+M1wysRL+PgYYoD/NFwAAYHfOAABAQgoAwBZHR0fDK+iHLQAASMgEAAASUgAAICEFAAASUgCALjioB7tRAIDmlfB3oBl2410AAJCQCQAQRlnJG+XDMkwAgKqM76EOBQAAElIA6Nou42T3ApCJAkATxga5n2ey8qvR59Xjr0ZXAFiMEId5lPA/PT39brhkJldXVz/2VAK8C4CdlBAf87VJCfYxX8BurPyX0dt/ZwUgoU2Bvelrk02BvekLgNgUgEZtCuyHvtZtCuxNXwD0SwGoaFNYP/S1blNgP/QFAOsUgANtCuuHvtZtCuuHvgBgSgrASEIcgJ4oAFusgl+IA9CTgwvAplVxTwQ/AD06qAD0Hv4A0KuDJwBWxwB1nZ2dfTm8hNH2LgCrfXEA6ikfA/zkyZOnwyWMtlcBEP4AMfgYYPZ18BYAANCenQuA1T8AtG+nAiD8AaAPtgAAIKHRBcDqHwD6MaoACH8A6IstAICG+RAg9rW1AFj9A8TkQ4A4xKMFQPgDxOVDgJZ1fHz8y/CyC7YAAGCLd+/e3bx8+fL74bILDxYAq38A+ODy8vK34WU3NhYA4Q8QnwOAHMIWAECDHADkUJ8UAKt/gPgcAORQHxUA4Q8AOfy3AJTwBwBy+GgCYPUP0AYHADnUHwXA6B+gHQ4ALq+3DwEqPjf6B2iLA4DL6vFDgIo/JgBW/wCwWY8fAlR8LvwB2mL/nyl8dAgQgNjs/zMVBQCgIfb/mYoCANAQ43+mogAANML4v44e3wJYKAAAjTD+X16vbwEsFACARhj/L6/XtwAWCgBAA4z/mZoCANAA43+mdtTTBwGVhuwmYS7lIFCve4HE9/bt299NAJZ3cXHx6/n5+dfDZVe6KQAl/E9PT78bLmEWV1dXPyoBLM3zrZ6e7/lutgCs/FmCnzNq8HNXR8/vACicAQAIzun/Onp+B0ChAAAE5vQ/c1EAYAe9fiIYcZ2cnHw7vIRJKQAw0s3Nzc8OALIkq/+6ei/8CgCMUML/xYsX/xguYREO/9XT+wHAQgGALYQ/tTj8V0/vBwALBQAeIfypxfifuSkA8ADhT00O/9WV4cCvAgAbCH9qsvqvK8P+f6EAwBrhT21W/3Vl2P8vFAC4R/hTm9U/S1EAYCD8icDqv74sH/ilAMB7wp8IrP7ry7L/XygApCf8icLqv74s+/+FAkBqwp8orP5ZmgJAWsKfSKz+Y8j0C78UAFIS/kRi9R9Dpv3/QgEgHeFPNFb/MWTa/y8UAFIR/kTz5s2bf1r9x5Bp/F8oAKQh/ImmjP6fPn369+GSirKN/wsFgBSEPxEZ/ceRbfxfKAB0T/gTkYN/1KYA0DXhT1RW/7Fk2/8vFAC6JfyJysG/WDLu/xcKAF0qN7TwJyIH/+LJuP9fKAB06fr6+qfhJYRi9B9PxvF/oQDQnTL6zzjOIz6j/3iyjv8LBYCu2PcnKqP/mLKO/wsFgG4IfyIz+o8p6/i/UADogvAnMqP/mDKP/wsFgOYJfyIr4W/0H1Pm8X+hANA04U9k9v1jyzz+LxQAmiX8ic6+f1zZx/+FAkCThD/R2fePzWeFKAA0SPgTnX3/2Kz+P1AAaIrwJzr7/vFlP/y3ogDQDOFPC+z7x5f98N+KAkAThD8tsO8fn/H/nxQAwhP+tMC+fxsc/vuTAkBowp8WCP82WP1/TAEgLOFPC4R/Oxz++5gCQEjCnxYI/7Y4/PcxBYBwhD8tEP5tMf7/lAJAKMKfFgj/9jj89ykFgDCEPy0Q/u2x+t9MASAE4U8LhH+brP43UwCoTvjTAuHfJqv/hykAVFVuTuFPdMK/XVb/D1MAqOo///nP/w0vISTh3y6r/8cpAFT117/+9W/lATtcQijCv20++OdxCgDVlQesEkA0wr99PvjncQoAISgBRCL822f8v50CQBhKABEI/z44/LedAkAo5cH79u3b31+/fv3D8C1YRPmZKz97wr99Vv/jKACE8+TJk6enp6ffmQawlPKzVn7mys/e8C0aZvU/jgJAWLYEWIKRf1+s/sdTAAjNlgBzMfLvk9X/eAoA4dkSYGpG/n0qHytu9T+eAkAzTAOYgpF/n3ys+O4UAJpiGsC+jPz7ZvS/OwWAJpkGsAsj/745+LcfBYBmmQawjVV/Dlb/+1EAaJ5pAJtY9edg9b8/BYAurKYBigBW/blY/e/v6O7ubnjZtlevXv3r2bNnXw2XJFfeDuREcC4l+E9OTr614s+jrP6fP3/+xXDJjkwA6JJtgVyM+3Oy+j+MCQDdK6uE8qCwT9gfq/68TPkOpwCQhiLQD8Gfm9H/NGwBkIaDgu0rf2/l78+4Pzej/2mYAJCWiUA7rPhZsfqfjgkAaZkIxGfFzzqr/+mYAMDARCAOK342cfBvWgoArClF4PLy8rfj4+NflIHllNC/vb395uzs7EvBzzqj/+nZAoA1JXxKmbQ9sIz7Y/7y3134s4nR//RMAGAEU4FpWe2zC6P/eSgAsCNlYD9Cn30Y/c9HAYADKAOPE/oc6urq6kf31jwUAJiIMvCB0GcqRv/zUgBgBqsyUF73XghWgV9eC32mYvQ/PwUAFnC/EBStloL7YV8IfOZi9D8/BQAqiV4KhD21GP0vQwGAQNZLwX1TFoT1cF8n7KnF6H85CgA05LGCMJZwJzKj/+UoAACEYPS/LB8FDEB1wn95CgAAVZWtLeG/PAUAgKr8op86FAAAqimjf4f+6lAAAKjCvn9dCgAAi7PvX58CAMDi7PvXpwAAsCj7/jEoAAAsxr5/HAoAAIsQ/rEoAADMzqG/eBQAAGbn0F88CgAAs3LoLyYFAIDZ2PePSwEAYBbCPzYFAIDJCf/4FAAAJiX826AAADAZ4d8OBQCASXivf1sUAAAm4b3+bVEAADhYGf17r39bFAAADmLfv00KAAB7E/7tUgAA2Ivwb5sCAMDOhH/7FAAAdiL8+6AAADCa8O+HAgDAKMK/LwoAAFsJ//4oAJWUj8y8urr6sdxUw7cAQhL+fVIAKig30/Pnz78on5pVbiolAIhK+PdLAVjYpptJCQAiEv59UwAW9NjNpAQAUay2KIV/3xSAhYxp0koAUFt5Bq22KIdv0SkFYAFjwn9FCQBq2eVZRfsUgJntc0MpAcDShH8+CsCMDrmhyv9d2YMre3HDtwBmIfxzUgBmMsUNVfbgyl6caQAwF+GflwIwg6lvqPL/SwkApib8c1MAJjbXDaUEAFPxNj8KBWBCc7dpJQA4VHmGeJsfhQIwkbnDf6X8bzgcCOxjqecUbVAAJrD0TeVwILAr4c86BeBANW+q8r+rBACPsd/PQxSAA0Ro1EoA8JDybLDfz0MUgD1FCP+V8udwLgC4L9IzipgUgD1EvLGcCwAKI3/GUgB2FL1Vlz+bEgA5lXvfyJ+xFICRWmrV5c9oSwByib44IZ6ju7u74WXbXr169a9nz559NVxOquUb682bN/98+vTp34dLoDOl6F9fX/9k1c+uTAC2aL1VmwZAv4z8OYQC8IheRmoOCEJfHPRjCgrAA3oJ//vKv48SAG2z6mcqCsAGPYb/Svn3siUA7bHqZ2oOAa7pOfzXvX79+oeTk5Nvnzx58nT4FhBQpucSyzEBuCfbTeZsAMRm1c+cFIBB5oZd/r1tC0As5Zlkr585KQDvGa+ZBkAUVv0sJX0BEP4fMw2AOlbBb9XPUlIfAhT+j3NIEJbhWUQNaScAbrjtbAvAvIz7qSllARD+uyn/rWwLwHSM+4kg3RaA8D+MbQHYXwl+v7iHKFIVAOE/HUUAduP5QzRptgDcfNNanQ+wNQCPs89PVCkmAMJ/fiYC8DHjfqLrpgCUADo9Pf1uuPwv4b8sRYDsBD+t6KYAFCV8bm9vvxkuPzs+Pv7FTViHIkA2gp/WdFUAiEcRoGcl9C8vL3+z2KBFCgCLUAToidU+PVAAWJQiQMsEPz1RAKhidV7j7OzsS2WA6AQ/PVIAqM5UgIjs79M7BYAwTAWIwGqfLBQAQjIVYElW+2SkABCaqQBzstonMwWAZigDTMFqHz5QAGiSMsAuhD58SgGgecoAmwh9eJwCQFeUgdyEPoynANAtZaB/q8Avr4U+7EYBIIVVGSivFYJ2CXwY5+jo6LNt+a4AkJJC0AaBD/NRAOC9+4WgUArqEPiwHAUAHmBKMK/7YV8IfFiWAgAjrU8JCsVgu/WgL4Q91KcAwIE2FYMiWzkQ9FDfmMN/KwoAzOihcrDSQknYFOzrBD20RwGAyraVhJoEO/RLAQCAhD4f/gkAJKIAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAApPPZZ/8P3kzZlPsGEMMAAAAASUVORK5CYII="},914:function(e,t,r){"use strict";e.exports=r.p+"static/media/spinner2.832de5994f3ab60b1fd8.png"},61:function(e,t,r){var n=r(698).default;function o(){"use strict";e.exports=o=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(P){d=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,i=Object.create(o.prototype),s=new E(n||[]);return a(i,"_invoke",{value:T(e,r,s)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(P){return{type:"throw",arg:P}}}t.wrap=p;var h={};function g(){}function v(){}function m(){}var b={};d(b,c,(function(){return this}));var y=Object.getPrototypeOf,k=y&&y(y(A([])));k&&k!==r&&i.call(k,c)&&(b=k);var w=m.prototype=g.prototype=Object.create(b);function x(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var l=f(e[o],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==n(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function T(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return R()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=_(a,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=f(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function _(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=f(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function A(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:R}}function R(){return{value:void 0,done:!0}}return v.prototype=m,a(w,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:v,configurable:!0}),v.displayName=d(m,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,d(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},x(C.prototype),d(C.prototype,l,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(p(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(w),d(w,u,"Generator"),d(w,c,(function(){return this})),d(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:A(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},698:function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};r.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"===typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"===typeof n.then)return n}var i=Object.create(null);r.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){a[e]=function(){return n[e]}}));return a.default=function(){return n},r.d(i,a),i}}(),r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/intertek-dashboard/",function(){"use strict";var e,t=r(791),n=r.t(t,2),o=r(250);function i(e){if(Array.isArray(e))return e}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){if(e){if("string"===typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){return i(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||s(e,t)||c()}function u(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e){return function(e){if(Array.isArray(e))return a(e)}(e)||u(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function h(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===f(t)?t:String(t)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function v(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function b(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function k(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t){if(t&&("object"===f(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}function C(e){var t=k();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return x(this,r)}}function T(e,t,r){return T=k()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&m(o,r.prototype),o},T.apply(null,arguments)}function _(e){var t="function"===typeof Map?new Map:void 0;return _=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return T(e,arguments,y(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),m(n,e)},_(e)}function S(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function I(){return I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));var E,A="popstate";function R(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function P(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function O(e,t){return{usr:e.state,key:e.key,idx:t}}function N(e,t,r,n){return void 0===r&&(r=null),I({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?L(t):t,{state:r,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function D(e){var t=e.pathname,r=void 0===t?"/":t,n=e.search,o=void 0===n?"":n,i=e.hash,a=void 0===i?"":i;return o&&"?"!==o&&(r+="?"===o.charAt(0)?o:"?"+o),a&&"#"!==a&&(r+="#"===a.charAt(0)?a:"#"+a),r}function L(e){var t={};if(e){var r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));var n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function M(t,r,n,o){void 0===o&&(o={});var i=o,a=i.window,s=void 0===a?document.defaultView:a,c=i.v5Compat,l=void 0!==c&&c,u=s.history,d=e.Pop,p=null,f=h();function h(){return(u.state||{idx:null}).idx}function g(){d=e.Pop;var t=h(),r=null==t?null:t-f;f=t,p&&p({action:d,location:m.location,delta:r})}function v(e){var t="null"!==s.location.origin?s.location.origin:s.location.href,r="string"===typeof e?e:D(e);return R(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==f&&(f=0,u.replaceState(I({},u.state,{idx:f}),""));var m={get action(){return d},get location(){return t(s,u)},listen:function(e){if(p)throw new Error("A history only accepts one active listener");return s.addEventListener(A,g),p=e,function(){s.removeEventListener(A,g),p=null}},createHref:function(e){return r(s,e)},createURL:v,encodeLocation:function(e){var t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,r){d=e.Push;var o=N(m.location,t,r);n&&n(o,t);var i=O(o,f=h()+1),a=m.createHref(o);try{u.pushState(i,"",a)}catch(c){s.location.assign(a)}l&&p&&p({action:d,location:m.location,delta:1})},replace:function(t,r){d=e.Replace;var o=N(m.location,t,r);n&&n(o,t);var i=O(o,f=h()),a=m.createHref(o);u.replaceState(i,"",a),l&&p&&p({action:d,location:m.location,delta:0})},go:function(e){return u.go(e)}};return m}function U(e,t,r){void 0===r&&(r="/");var n=K(("string"===typeof t?L(t):t).pathname||"/",r);if(null==n)return null;var o=F(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var r=e.length===t.length&&e.slice(0,-1).every((function(e,r){return e===t[r]}));return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(o);for(var i=null,a=0;null==i&&a<o.length;++a)i=j(o[a],V(n));return i}function F(e,t,r,n){void 0===t&&(t=[]),void 0===r&&(r=[]),void 0===n&&(n="");var o=function(e,o,i){var a={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};a.relativePath.startsWith("/")&&(R(a.relativePath.startsWith(n),'Absolute route path "'+a.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(n.length));var s=X([n,a.relativePath]),c=r.concat(a);e.children&&e.children.length>0&&(R(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),F(e.children,t,c,s)),(null!=e.path||e.index)&&t.push({path:s,score:q(s,e.index),routesMeta:c})};return e.forEach((function(e,t){var r;if(""!==e.path&&null!=(r=e.path)&&r.includes("?")){var n,i=S(z(e.path));try{for(i.s();!(n=i.n()).done;){var a=n.value;o(e,t,a)}}catch(s){i.e(s)}finally{i.f()}}else o(e,t)})),t}function z(e){var t=e.split("/");if(0===t.length)return[];var r,n=i(r=t)||u(r)||s(r)||c(),o=n[0],a=n.slice(1),l=o.endsWith("?"),p=o.replace(/\?$/,"");if(0===a.length)return l?[p,""]:[p];var f=z(a.join("/")),h=[];return h.push.apply(h,d(f.map((function(e){return""===e?p:[p,e].join("/")})))),l&&h.push.apply(h,d(f)),h.map((function(t){return e.startsWith("/")&&""===t?"/":t}))}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(E||(E={}));var H=/^:\w+$/,B=function(e){return"*"===e};function q(e,t){var r=e.split("/"),n=r.length;return r.some(B)&&(n+=-2),t&&(n+=2),r.filter((function(e){return!B(e)})).reduce((function(e,t){return e+(H.test(t)?3:""===t?1:10)}),n)}function j(e,t){for(var r=e.routesMeta,n={},o="/",i=[],a=0;a<r.length;++a){var s=r[a],c=a===r.length-1,l="/"===o?t:t.slice(o.length)||"/",u=G({path:s.relativePath,caseSensitive:s.caseSensitive,end:c},l);if(!u)return null;Object.assign(n,u.params);var d=s.route;i.push({params:n,pathname:X([o,u.pathname]),pathnameBase:Z(X([o,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(o=X([o,u.pathnameBase]))}return i}function G(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var r=function(e,t,r){void 0===t&&(t=!1);void 0===r&&(r=!0);Q("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var n=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(function(e,t){return n.push(t),"/([^\\/]+)"}));e.endsWith("*")?(n.push("*"),o+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":""!==e&&"/"!==e&&(o+="(?:(?=\\/|$))");var i=new RegExp(o,t?void 0:"i");return[i,n]}(e.path,e.caseSensitive,e.end),n=l(r,2),o=n[0],i=n[1],a=t.match(o);if(!a)return null;var s=a[0],c=s.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:i.reduce((function(e,t,r){if("*"===t){var n=u[r]||"";c=s.slice(0,s.length-n.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(r){return Q(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+r+")."),e}}(u[r]||"",t),e}),{}),pathname:s,pathnameBase:c,pattern:e}}function V(e){try{return decodeURI(e)}catch(t){return Q(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function K(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function Q(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function W(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function J(e){return e.filter((function(e,t){return 0===t||e.route.path&&e.route.path.length>0}))}function Y(e,t,r,n){var o;void 0===n&&(n=!1),"string"===typeof e?o=L(e):(R(!(o=I({},e)).pathname||!o.pathname.includes("?"),W("?","pathname","search",o)),R(!o.pathname||!o.pathname.includes("#"),W("#","pathname","hash",o)),R(!o.search||!o.search.includes("#"),W("#","search","hash",o)));var i,a=""===e||""===o.pathname,s=a?"/":o.pathname;if(n||null==s)i=r;else{var c=t.length-1;if(s.startsWith("..")){for(var l=s.split("/");".."===l[0];)l.shift(),c-=1;o.pathname=l.join("/")}i=c>=0?t[c]:"/"}var u=function(e,t){void 0===t&&(t="/");var r="string"===typeof e?L(e):e,n=r.pathname,o=r.search,i=void 0===o?"":o,a=r.hash,s=void 0===a?"":a,c=n?n.startsWith("/")?n:function(e,t){var r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(n,t):t;return{pathname:c,search:$(i),hash:ee(s)}}(o,i),d=s&&"/"!==s&&s.endsWith("/"),p=(a||"."===s)&&r.endsWith("/");return u.pathname.endsWith("/")||!d&&!p||(u.pathname+="/"),u}var X=function(e){return e.join("/").replace(/\/\/+/g,"/")},Z=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},$=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},ee=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},te=function(e){b(r,e);var t=C(r);function r(){return p(this,r),t.apply(this,arguments)}return v(r)}(_(Error));function re(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var ne=["post","put","patch","delete"],oe=(new Set(ne),["get"].concat(ne));new Set(oe),new Set([301,302,303,307,308]),new Set([307,308]),"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;Symbol("deferred");function ie(){return ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ie.apply(this,arguments)}var ae="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},se=t.useState,ce=t.useEffect,le=t.useLayoutEffect,ue=t.useDebugValue;function de(e){var t=e.getSnapshot,r=e.value;try{var n=t();return!ae(r,n)}catch(o){return!0}}"undefined"===typeof window||"undefined"===typeof window.document||window.document.createElement,n.useSyncExternalStore;var pe=t.createContext(null);var fe=t.createContext(null);var he=t.createContext(null);var ge=t.createContext(null);var ve=t.createContext(null);var me=t.createContext({outlet:null,matches:[]});var be=t.createContext(null);function ye(){return null!=t.useContext(ve)}function ke(){return ye()||R(!1),t.useContext(ve).location}function we(){ye()||R(!1);var e=t.useContext(ge),r=e.basename,n=e.navigator,o=t.useContext(me).matches,i=ke().pathname,a=JSON.stringify(J(o).map((function(e){return e.pathnameBase}))),s=t.useRef(!1);return t.useEffect((function(){s.current=!0})),t.useCallback((function(e,t){if(void 0===t&&(t={}),s.current)if("number"!==typeof e){var o=Y(e,JSON.parse(a),i,"path"===t.relative);"/"!==r&&(o.pathname="/"===o.pathname?r:X([r,o.pathname])),(t.replace?n.replace:n.push)(o,t.state,t)}else n.go(e)}),[r,n,a,i])}function xe(e,r){var n=(void 0===r?{}:r).relative,o=t.useContext(me).matches,i=ke().pathname,a=JSON.stringify(J(o).map((function(e){return e.pathnameBase})));return t.useMemo((function(){return Y(e,JSON.parse(a),i,"path"===n)}),[e,a,i,n])}function Ce(){var e=function(){var e,r=t.useContext(be),n=Ae(_e.UseRouteError),o=Re(_e.UseRouteError);if(r)return r;return null==(e=n.errors)?void 0:e[o]}(),r=re(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:o};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},r),n?t.createElement("pre",{style:i},n):null,null)}var Te,_e,Se=function(e){b(n,e);var r=C(n);function n(e){var t;return p(this,n),(t=r.call(this,e)).state={location:e.location,error:e.error},t}return v(n,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return this.state.error?t.createElement(me.Provider,{value:this.props.routeContext},t.createElement(be.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location?{error:e.error,location:e.location}:{error:e.error||t.error,location:t.location}}}]),n}(t.Component);function Ie(e){var r=e.routeContext,n=e.match,o=e.children,i=t.useContext(pe);return i&&i.static&&i.staticContext&&n.route.errorElement&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),t.createElement(me.Provider,{value:r},o)}function Ee(e,r,n){if(void 0===r&&(r=[]),null==e){if(null==n||!n.errors)return null;e=n.matches}var o=e,i=null==n?void 0:n.errors;if(null!=i){var a=o.findIndex((function(e){return e.route.id&&(null==i?void 0:i[e.route.id])}));a>=0||R(!1),o=o.slice(0,Math.min(o.length,a+1))}return o.reduceRight((function(e,a,s){var c=a.route.id?null==i?void 0:i[a.route.id]:null,l=n?a.route.errorElement||t.createElement(Ce,null):null,u=r.concat(o.slice(0,s+1)),d=function(){return t.createElement(Ie,{match:a,routeContext:{outlet:e,matches:u}},c?l:void 0!==a.route.element?a.route.element:e)};return n&&(a.route.errorElement||0===s)?t.createElement(Se,{location:n.location,component:l,error:c,children:d(),routeContext:{outlet:null,matches:u}}):d()}),null)}function Ae(e){var r=t.useContext(fe);return r||R(!1),r}function Re(e){var r=function(e){var r=t.useContext(me);return r||R(!1),r}(),n=r.matches[r.matches.length-1];return n.route.id||R(!1),n.route.id}!function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator"}(Te||(Te={})),function(e){e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"}(_e||(_e={}));var Pe;function Oe(e){R(!1)}function Ne(r){var n=r.basename,o=void 0===n?"/":n,i=r.children,a=void 0===i?null:i,s=r.location,c=r.navigationType,l=void 0===c?e.Pop:c,u=r.navigator,d=r.static,p=void 0!==d&&d;ye()&&R(!1);var f=o.replace(/^\/*/,"/"),h=t.useMemo((function(){return{basename:f,navigator:u,static:p}}),[f,u,p]);"string"===typeof s&&(s=L(s));var g=s,v=g.pathname,m=void 0===v?"/":v,b=g.search,y=void 0===b?"":b,k=g.hash,w=void 0===k?"":k,x=g.state,C=void 0===x?null:x,T=g.key,_=void 0===T?"default":T,S=t.useMemo((function(){var e=K(m,f);return null==e?null:{pathname:e,search:y,hash:w,state:C,key:_}}),[f,m,y,w,C,_]);return null==S?null:t.createElement(ge.Provider,{value:h},t.createElement(ve.Provider,{children:a,value:{location:S,navigationType:l}}))}function De(r){var n=r.children,o=r.location,i=t.useContext(pe);return function(r,n){ye()||R(!1);var o,i=t.useContext(ge).navigator,a=t.useContext(fe),s=t.useContext(me).matches,c=s[s.length-1],l=c?c.params:{},u=(c&&c.pathname,c?c.pathnameBase:"/"),d=(c&&c.route,ke());if(n){var p,f="string"===typeof n?L(n):n;"/"===u||(null==(p=f.pathname)?void 0:p.startsWith(u))||R(!1),o=f}else o=d;var h=o.pathname||"/",g=U(r,{pathname:"/"===u?h:h.slice(u.length)||"/"}),v=Ee(g&&g.map((function(e){return Object.assign({},e,{params:Object.assign({},l,e.params),pathname:X([u,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:X([u,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),s,a||void 0);return n&&v?t.createElement(ve.Provider,{value:{location:ie({pathname:"/",search:"",hash:"",state:null,key:"default"},o),navigationType:e.Pop}},v):v}(i&&!n?i.router.routes:Me(n),o)}!function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(Pe||(Pe={}));var Le=new Promise((function(){}));t.Component;function Me(e,r){void 0===r&&(r=[]);var n=[];return t.Children.forEach(e,(function(e,o){if(t.isValidElement(e))if(e.type!==t.Fragment){e.type!==Oe&&R(!1),e.props.index&&e.props.children&&R(!1);var i=[].concat(d(r),[o]),a={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,hasErrorBoundary:null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle};e.props.children&&(a.children=Me(e.props.children,i)),n.push(a)}else n.push.apply(n,Me(e.props.children,r))})),n}function Ue(){return Ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ue.apply(this,arguments)}function Fe(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}var ze=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function He(e){var r,n=e.basename,o=e.children,i=e.window,a=t.useRef();null==a.current&&(a.current=(void 0===(r={window:i,v5Compat:!0})&&(r={}),M((function(e,t){var r=L(e.location.hash.substr(1)),n=r.pathname,o=void 0===n?"/":n,i=r.search,a=void 0===i?"":i,s=r.hash;return N("",{pathname:o,search:a,hash:void 0===s?"":s},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){var r=e.document.querySelector("base"),n="";if(r&&r.getAttribute("href")){var o=e.location.href,i=o.indexOf("#");n=-1===i?o:o.slice(0,i)}return n+"#"+("string"===typeof t?t:D(t))}),(function(e,t){P("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")}),r)));var s=a.current,c=l(t.useState({action:s.action,location:s.location}),2),u=c[0],d=c[1];return t.useLayoutEffect((function(){return s.listen(d)}),[s]),t.createElement(Ne,{basename:n,children:o,location:u.location,navigationType:u.action,navigator:s})}var Be="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,qe=t.forwardRef((function(e,r){var n=e.onClick,o=e.relative,i=e.reloadDocument,a=e.replace,s=e.state,c=e.target,l=e.to,u=e.preventScrollReset,d=Fe(e,ze),p="string"===typeof l?l:D(l),f=/^[a-z+]+:\/\//i.test(p)||p.startsWith("//"),h=p,g=!1;if(Be&&f){var v=new URL(window.location.href),m=p.startsWith("//")?new URL(v.protocol+p):new URL(p);m.origin===v.origin?h=m.pathname+m.search+m.hash:g=!0}var b=function(e,r){var n=(void 0===r?{}:r).relative;ye()||R(!1);var o=t.useContext(ge),i=o.basename,a=o.navigator,s=xe(e,{relative:n}),c=s.hash,l=s.pathname,u=s.search,d=l;return"/"!==i&&(d="/"===l?i:X([i,l])),a.createHref({pathname:d,search:u,hash:c})}(h,{relative:o}),y=function(e,r){var n=void 0===r?{}:r,o=n.target,i=n.replace,a=n.state,s=n.preventScrollReset,c=n.relative,l=we(),u=ke(),d=xe(e,{relative:c});return t.useCallback((function(t){if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,o)){t.preventDefault();var r=void 0!==i?i:D(u)===D(d);l(e,{replace:r,state:a,preventScrollReset:s,relative:c})}}),[u,l,d,i,a,o,e,s,c])}(h,{replace:a,state:s,target:c,preventScrollReset:u,relative:o});return t.createElement("a",Ue({},d,{href:f?p:b,onClick:g||i?n:function(e){n&&n(e),e.defaultPrevented||y(e)},ref:r,target:c}))}));var je,Ge;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(je||(je={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ge||(Ge={}));var Ve=r(184),Ke=t.createContext();function Qe(){return(0,t.useContext)(Ke)}function We(e){var r=e.children,n=l((0,t.useState)(!1),2),o={user:n[0],setUser:n[1]};return(0,Ve.jsx)(Ke.Provider,{value:o,children:r})}function Je(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(r),!0).forEach((function(t){Je(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ze(){Ze=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(A){c=function(e,t,r){return e[t]=r}}function l(e,t,r,o){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),s=new S(o||[]);return n(a,"_invoke",{value:x(e,r,s)}),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(A){return{type:"throw",arg:A}}}e.wrap=l;var d={};function p(){}function h(){}function g(){}var v={};c(v,i,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(I([])));b&&b!==t&&r.call(b,i)&&(v=b);var y=g.prototype=p.prototype=Object.create(v);function k(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(n,i,a,s){var c=u(e[n],e,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==f(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,a,s)}),(function(e){o("throw",e,a,s)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,s)}))}s(c.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function x(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return E()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=C(a,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=u(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function C(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=u(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function I(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return h.prototype=g,n(y,"constructor",{value:g,configurable:!0}),n(g,"constructor",{value:h,configurable:!0}),h.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},k(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=I,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:I(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function $e(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(l){return void r(l)}s.done?t(c):Promise.resolve(c).then(n,o)}function et(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){$e(i,n,o,a,s,"next",e)}function s(e){$e(i,n,o,a,s,"throw",e)}a(void 0)}))}}var tt="consultants_container__TJiqf",rt="consultants_header__R7wMv",nt="consultants_h1__02o68",ot="consultants_refresh__UEOG0",it="consultants_refreshIcon__0La+z",at=new Set;["https://graph.microsoft.com","https://graph.microsoft.us","https://dod-graph.microsoft.us","https://graph.microsoft.de","https://microsoftgraph.chinacloudapi.cn"].forEach((function(e){return at.add(e)}));var st;function ct(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(st||(st={}));var lt=function(){function e(t){if(p(this,e),this.requests=new Map,"undefined"!==typeof t){var r=e.requestLimit;if(t.length>r){var n=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(r));throw n.name="Limit Exceeded Error",n}var o,i=S(t);try{for(i.s();!(o=i.n()).done;){var a=o.value;this.addRequest(a)}}catch(s){i.e(s)}finally{i.f()}}}return v(e,[{key:"addRequest",value:function(t){var r=e.requestLimit;if(""===t.id){var n=new Error("Id for a request is empty, Please provide an unique id");throw n.name="Empty Id For Request",n}if(this.requests.size===r){var o=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(r));throw o.name="Limit Exceeded Error",o}if(this.requests.has(t.id)){var i=new Error("Adding request with duplicate id ".concat(t.id,", Make the id of the requests unique"));throw i.name="Duplicate RequestId Error",i}return this.requests.set(t.id,t),t.id}},{key:"removeRequest",value:function(e){for(var t=this.requests.delete(e),r=this.requests.entries(),n=r.next();!n.done;){var o=n.value[1].dependsOn;if("undefined"!==typeof o){var i=o.indexOf(e);-1!==i&&o.splice(i,1),0===o.length&&delete n.value[1].dependsOn}n=r.next()}return t}},{key:"getContent",value:function(){return ct(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i,a,s,c,l,u;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={requests:r=[]},o=this.requests.entries(),!(i=o.next()).done){t.next=8;break}throw(a=new Error("No requests added yet, Please add at least one request.")).name="Empty Payload",a;case 8:if(e.validateDependencies(this.requests)){t.next=12;break}throw(s=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.")).name="Invalid Dependency",s;case 12:if(i.done){t.next=27;break}return c=i.value[1],t.next=16,e.getRequestData(c.request);case 16:if(void 0===(l=t.sent).body||void 0!==l.headers&&void 0!==l.headers["content-type"]){t.next=21;break}throw(u=new Error("Content-type header is not mentioned for request #".concat(c.id,", For request having body, Content-type header should be mentioned"))).name="Invalid Content-type header",u;case 21:l.id=c.id,void 0!==c.dependsOn&&c.dependsOn.length>0&&(l.dependsOn=c.dependsOn),r.push(l),i=o.next(),t.next=12;break;case 27:return n.requests=r,t.abrupt("return",n);case 29:case"end":return t.stop()}}),t,this)})))}},{key:"addDependency",value:function(e,t){if(!this.requests.has(e)){var r=new Error("Dependent ".concat(e," does not exists, Please check the id"));throw r.name="Invalid Dependent",r}if("undefined"!==typeof t&&!this.requests.has(t)){var n=new Error("Dependency ".concat(t," does not exists, Please check the id"));throw n.name="Invalid Dependency",n}if("undefined"!==typeof t){var o=this.requests.get(e);if(void 0===o.dependsOn&&(o.dependsOn=[]),-1!==o.dependsOn.indexOf(t)){var i=new Error("Dependency ".concat(t," is already added for the request ").concat(e));throw i.name="Duplicate Dependency",i}o.dependsOn.push(t)}else{for(var a,s=this.requests.entries(),c=s.next();!c.done&&c.value[1].id!==e;)a=c,c=s.next();if("undefined"===typeof a){var l=new Error("Can't add dependency ".concat(t,", There is only a dependent request in the batch"));throw l.name="Invalid Dependency Addition",l}var u=a.value[0];if(void 0===c.value[1].dependsOn&&(c.value[1].dependsOn=[]),-1!==c.value[1].dependsOn.indexOf(u)){var d=new Error("Dependency ".concat(u," is already added for the request ").concat(e));throw d.name="Duplicate Dependency",d}c.value[1].dependsOn.push(u)}}},{key:"removeDependency",value:function(e,t){var r=this.requests.get(e);if("undefined"===typeof r||void 0===r.dependsOn||0===r.dependsOn.length)return!1;if("undefined"!==typeof t){var n=r.dependsOn.indexOf(t);return-1!==n&&(r.dependsOn.splice(n,1),!0)}return delete r.dependsOn,!0}}],[{key:"validateDependencies",value:function(e){if(0===e.size){var t=new Error("Empty requests map, Please provide at least one request.");throw t.name="Empty Requests Error",t}return function(e){for(var t=e.entries(),r=t.next();!r.done;){var n=r.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;r=t.next()}return!0}(e)||function(e){var t=e.entries(),r=t.next(),n=r.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;var o=r;for(r=t.next();!r.done;){var i=r.value[1];if(void 0===i.dependsOn||1!==i.dependsOn.length||i.dependsOn[0]!==o.value[1].id)return!1;o=r,r=t.next()}return!0}(e)||function(e){var t,r=e.entries(),n=r.next(),o=n.value[1];if(void 0===o.dependsOn||0===o.dependsOn.length)t=o.id;else{if(1!==o.dependsOn.length)return!1;var i=o.dependsOn[0];if(i===o.id||!e.has(i))return!1;t=i}for(n=r.next();!n.done;){var a=n.value[1];if((void 0===a.dependsOn||0===a.dependsOn.length)&&t!==a.id)return!1;if(void 0!==a.dependsOn&&0!==a.dependsOn.length){if(1===a.dependsOn.length&&(a.id===t||a.dependsOn[0]!==t))return!1;if(a.dependsOn.length>1)return!1}n=r.next()}return!0}(e)}},{key:"getRequestData",value:function(t){return ct(this,void 0,void 0,Ze().mark((function r(){var n,o,i;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n={url:""},o=new RegExp("^https?://"),n.url=o.test(t.url)?"/"+t.url.split(/.*?\/\/.*?\//)[1]:t.url,n.method=t.method,i={},t.headers.forEach((function(e,t){i[t]=e})),Object.keys(i).length&&(n.headers=i),t.method!==st.PATCH&&t.method!==st.POST&&t.method!==st.PUT){r.next=11;break}return r.next=10,e.getRequestBody(t);case 10:n.body=r.sent;case 11:return r.abrupt("return",n);case 12:case"end":return r.stop()}}),r)})))}},{key:"getRequestBody",value:function(e){return ct(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i,a,s;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=!1,t.prev=1,o=e.clone(),t.next=5,o.json();case 5:n=t.sent,r=!0,t.next=11;break;case 9:t.prev=9,t.t0=t.catch(1);case 11:if(r){t.next=33;break}if(t.prev=12,"undefined"===typeof Blob){t.next=23;break}return t.next=16,e.blob();case 16:return i=t.sent,a=new FileReader,t.next=20,new Promise((function(e){a.addEventListener("load",(function(){var t=a.result,r=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(r[4])}),!1),a.readAsDataURL(i)}));case 20:n=t.sent,t.next=28;break;case 23:if("undefined"===typeof Buffer){t.next=28;break}return t.next=26,e.buffer();case 26:s=t.sent,n=s.toString("base64");case 28:r=!0,t.next=33;break;case 31:t.prev=31,t.t1=t.catch(12);case 33:return t.abrupt("return",n);case 34:case"end":return t.stop()}}),t,null,[[1,9],[12,31]])})))}}]),e}();lt.requestLimit=20;var ut,dt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];p(this,e),this.middlewareOptions=new Map;var r,n=S(t);try{for(n.s();!(r=n.n()).done;){var o=r.value,i=o.constructor;this.middlewareOptions.set(i,o)}}catch(a){n.e(a)}finally{n.f()}}return v(e,[{key:"getMiddlewareOptions",value:function(e){return this.middlewareOptions.get(e)}},{key:"setMiddlewareOptions",value:function(e,t){this.middlewareOptions.set(e,t)}}]),e}(),pt=function(){for(var e="",t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},ft=function(e,t,r){var n=null;if("undefined"!==typeof Request&&e instanceof Request)n=e.headers.get(r);else if("undefined"!==typeof t&&void 0!==t.headers)if("undefined"!==typeof Headers&&t.headers instanceof Headers)n=t.headers.get(r);else if(t.headers instanceof Array){for(var o=t.headers,i=0,a=o.length;i<a;i++)if(o[i][0]===r){n=o[i][1];break}}else void 0!==t.headers[r]&&(n=t.headers[r]);return n},ht=function(e,t,r,n){if("undefined"!==typeof Request&&e instanceof Request)e.headers.set(r,n);else if("undefined"!==typeof t)if(void 0===t.headers)t.headers=new Headers(Je({},r,n));else if("undefined"!==typeof Headers&&t.headers instanceof Headers)t.headers.set(r,n);else if(t.headers instanceof Array){for(var o=0,i=t.headers.length;o<i;o++){var a=t.headers[o];if(a[0]===r){a[1]=n;break}}o===i&&t.headers.push([r,n])}else Object.assign(t.headers,Je({},r,n))},gt=function(e,t,r,n){"undefined"!==typeof Request&&e instanceof Request?e.headers.append(r,n):"undefined"!==typeof t&&(void 0===t.headers?t.headers=new Headers(Je({},r,n)):"undefined"!==typeof Headers&&t.headers instanceof Headers?t.headers.append(r,n):t.headers instanceof Array?t.headers.push([r,n]):void 0===t.headers?t.headers=Je({},r,n):void 0===t.headers[r]?t.headers[r]=n:t.headers[r]+=", ".concat(n))},vt=function(e,t){return ct(undefined,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s,c,l,u,d,p,f,h;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.headers.get("Content-Type")){r.next=6;break}return r.next=3,t.blob();case 3:r.t0=r.sent,r.next=9;break;case 6:return r.next=8,Promise.resolve(void 0);case 8:r.t0=r.sent;case 9:return n=r.t0,o=t.method,i=t.headers,a=t.referrer,s=t.referrerPolicy,c=t.mode,l=t.credentials,u=t.cache,d=t.redirect,p=t.integrity,f=t.keepalive,h=t.signal,r.abrupt("return",new Request(e,{method:o,headers:i,body:n,referrer:a,referrerPolicy:s,mode:c,credentials:l,cache:u,redirect:d,integrity:p,keepalive:f,signal:h}));case 12:case"end":return r.stop()}}),r)})))},mt=v((function e(t,r){p(this,e),this.authenticationProvider=t,this.authenticationProviderOptions=r}));!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(ut||(ut={}));var bt=function(){function e(){p(this,e),this.featureUsage=ut.NONE}return v(e,[{key:"setFeatureUsage",value:function(e){this.featureUsage=this.featureUsage|e}},{key:"getFeatureUsage",value:function(){return this.featureUsage.toString(16)}}],[{key:"updateFeatureUsageFlag",value:function(t,r){var n;t.middlewareControl instanceof dt?n=t.middlewareControl.getMiddlewareOptions(e):t.middlewareControl=new dt,"undefined"===typeof n&&(n=new e,t.middlewareControl.setMiddlewareOptions(e,n)),n.setFeatureUsage(r)}}]),e}(),yt=function(){function e(t){p(this,e),this.authenticationProvider=t}return v(e,[{key:"execute",value:function(t){return ct(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t.middlewareControl instanceof dt&&(n=t.middlewareControl.getMiddlewareOptions(mt)),"undefined"!==typeof n&&(o=n.authenticationProvider,i=n.authenticationProviderOptions),"undefined"===typeof o&&(o=this.authenticationProvider),r.next=6,o.getAccessToken(i);case 6:return a=r.sent,s="Bearer ".concat(a),gt(t.request,t.options,e.AUTHORIZATION_HEADER,s),bt.updateFeatureUsageFlag(t,ut.AUTHENTICATION_HANDLER_ENABLED),r.next=12,this.nextMiddleware.execute(t);case 12:return r.abrupt("return",r.sent);case 15:throw r.prev=15,r.t0=r.catch(0),r.t0;case 18:case"end":return r.stop()}}),r,this,[[0,15]])})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();yt.AUTHORIZATION_HEADER="Authorization";var kt=function(){function e(){p(this,e)}return v(e,[{key:"execute",value:function(e){return ct(this,void 0,void 0,Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e.request,e.options);case 3:return e.response=t.sent,t.abrupt("return");case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))}}]),e}(),wt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_DELAY,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_MAX_RETRIES,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.DEFAULT_SHOULD_RETRY;if(p(this,e),t>e.MAX_DELAY&&r>e.MAX_MAX_RETRIES){var o=new Error("Delay and MaxRetries should not be more than ".concat(e.MAX_DELAY," and ").concat(e.MAX_MAX_RETRIES));throw o.name="MaxLimitExceeded",o}if(t>e.MAX_DELAY){var i=new Error("Delay should not be more than ".concat(e.MAX_DELAY));throw i.name="MaxLimitExceeded",i}if(r>e.MAX_MAX_RETRIES){var a=new Error("MaxRetries should not be more than ".concat(e.MAX_MAX_RETRIES));throw a.name="MaxLimitExceeded",a}if(t<0&&r<0){var s=new Error("Delay and MaxRetries should not be negative");throw s.name="MinExpectationNotMet",s}if(t<0){var c=new Error("Delay should not be negative");throw c.name="MinExpectationNotMet",c}if(r<0){var l=new Error("MaxRetries should not be negative");throw l.name="MinExpectationNotMet",l}this.delay=Math.min(t,e.MAX_DELAY),this.maxRetries=Math.min(r,e.MAX_MAX_RETRIES),this.shouldRetry=n}return v(e,[{key:"getMaxDelay",value:function(){return e.MAX_DELAY}}]),e}();wt.DEFAULT_DELAY=3,wt.DEFAULT_MAX_RETRIES=3,wt.MAX_DELAY=180,wt.MAX_MAX_RETRIES=10,wt.DEFAULT_SHOULD_RETRY=function(){return!0};var xt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wt;p(this,e),this.options=t}return v(e,[{key:"isRetry",value:function(t){return-1!==e.RETRY_STATUS_CODES.indexOf(t.status)}},{key:"isBuffered",value:function(e,t){var r="string"===typeof e?t.method:e.method;if((r===st.PUT||r===st.PATCH||r===st.POST)&&"application/octet-stream"===ft(e,t,"Content-Type"))return!1;return!0}},{key:"getDelay",value:function(t,r,n){var o,i=function(){return Number(Math.random().toFixed(3))},a=void 0!==t.headers?t.headers.get(e.RETRY_AFTER_HEADER):null;return o=null!==a?Number.isNaN(Number(a))?Math.round((new Date(a).getTime()-Date.now())/1e3):Number(a):r>=2?this.getExponentialBackOffTime(r)+n+i():n+i(),Math.min(o,this.options.getMaxDelay()+i())}},{key:"getExponentialBackOffTime",value:function(e){return Math.round(.5*(Math.pow(2,e)-1))}},{key:"sleep",value:function(e){return ct(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=1e3*e,t.abrupt("return",new Promise((function(e){return setTimeout(e,r)})));case 2:case"end":return t.stop()}}),t)})))}},{key:"getOptions",value:function(e){var t;return e.middlewareControl instanceof dt&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),"undefined"===typeof t&&(t=Object.assign(new wt,this.options)),t}},{key:"executeWithRetry",value:function(t,r,n){return ct(this,void 0,void 0,Ze().mark((function o(){var i;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,this.nextMiddleware.execute(t);case 3:if(!(r<n.maxRetries&&this.isRetry(t.response)&&this.isBuffered(t.request,t.options)&&n.shouldRetry(n.delay,r,t.request,t.options,t.response))){o.next=14;break}return++r,ht(t.request,t.options,e.RETRY_ATTEMPT_HEADER,r.toString()),i=this.getDelay(t.response,r,n.delay),o.next=9,this.sleep(i);case 9:return o.next=11,this.executeWithRetry(t,r,n);case 11:return o.abrupt("return",o.sent);case 14:return o.abrupt("return");case 15:o.next=20;break;case 17:throw o.prev=17,o.t0=o.catch(0),o.t0;case 20:case"end":return o.stop()}}),o,this,[[0,17]])})))}},{key:"execute",value:function(e){return ct(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,0,r=this.getOptions(e),bt.updateFeatureUsageFlag(e,ut.RETRY_HANDLER_ENABLED),t.next=6,this.executeWithRetry(e,0,r);case 6:return t.abrupt("return",t.sent);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}}),t,this,[[0,9]])})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();xt.RETRY_STATUS_CODES=[429,503,504],xt.RETRY_ATTEMPT_HEADER="Retry-Attempt",xt.RETRY_AFTER_HEADER="Retry-After";var Ct=v((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_MAX_REDIRECTS,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_SHOULD_RETRY;if(p(this,e),t>e.MAX_MAX_REDIRECTS){var n=new Error("MaxRedirects should not be more than ".concat(e.MAX_MAX_REDIRECTS));throw n.name="MaxLimitExceeded",n}if(t<0){var o=new Error("MaxRedirects should not be negative");throw o.name="MinExpectationNotMet",o}this.maxRedirects=t,this.shouldRedirect=r}));Ct.DEFAULT_MAX_REDIRECTS=5,Ct.MAX_MAX_REDIRECTS=20,Ct.DEFAULT_SHOULD_RETRY=function(){return!0};var Tt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ct;p(this,e),this.options=t}return v(e,[{key:"isRedirect",value:function(t){return-1!==e.REDIRECT_STATUS_CODES.indexOf(t.status)}},{key:"hasLocationHeader",value:function(t){return t.headers.has(e.LOCATION_HEADER)}},{key:"getLocationHeader",value:function(t){return t.headers.get(e.LOCATION_HEADER)}},{key:"isRelativeURL",value:function(e){return-1===e.indexOf("://")}},{key:"shouldDropAuthorizationHeader",value:function(e,t){var r,n,o=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,i=o.exec(e);null!==i&&(r=i[0]);var a=o.exec(t);return null!==a&&(n=a[0]),"undefined"!==typeof r&&"undefined"!==typeof n&&r!==n}},{key:"updateRequestUrl",value:function(e,t){return ct(this,void 0,void 0,Ze().mark((function r(){return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("string"!==typeof t.request){r.next=4;break}r.t0=e,r.next=7;break;case 4:return r.next=6,vt(e,t.request);case 6:r.t0=r.sent;case 7:t.request=r.t0;case 8:case"end":return r.stop()}}),r)})))}},{key:"getOptions",value:function(e){var t;return e.middlewareControl instanceof dt&&(t=e.middlewareControl.getMiddlewareOptions(Ct)),"undefined"===typeof t&&(t=Object.assign(new Ct,this.options)),t}},{key:"executeWithRedirect",value:function(t,r,n){return ct(this,void 0,void 0,Ze().mark((function o(){var i,a;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,this.nextMiddleware.execute(t);case 3:if(i=t.response,!(r<n.maxRedirects&&this.isRedirect(i)&&this.hasLocationHeader(i)&&n.shouldRedirect(i))){o.next=19;break}if(++r,i.status!==e.STATUS_CODE_SEE_OTHER){o.next=11;break}t.options.method=st.GET,delete t.options.body,o.next=15;break;case 11:return a=this.getLocationHeader(i),!this.isRelativeURL(a)&&this.shouldDropAuthorizationHeader(i.url,a)&&delete t.options.headers[e.AUTHORIZATION_HEADER],o.next=15,this.updateRequestUrl(a,t);case 15:return o.next=17,this.executeWithRedirect(t,r,n);case 17:o.next=20;break;case 19:return o.abrupt("return");case 20:o.next=25;break;case 22:throw o.prev=22,o.t0=o.catch(0),o.t0;case 25:case"end":return o.stop()}}),o,this,[[0,22]])})))}},{key:"execute",value:function(t){return ct(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,0,n=this.getOptions(t),t.options.redirect=e.MANUAL_REDIRECT,bt.updateFeatureUsageFlag(t,ut.REDIRECT_HANDLER_ENABLED),r.next=7,this.executeWithRedirect(t,0,n);case 7:return r.abrupt("return",r.sent);case 10:throw r.prev=10,r.t0=r.catch(0),r.t0;case 13:case"end":return r.stop()}}),r,this,[[0,10]])})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();Tt.REDIRECT_STATUS_CODES=[301,302,303,307,308],Tt.STATUS_CODE_SEE_OTHER=303,Tt.LOCATION_HEADER="Location",Tt.AUTHORIZATION_HEADER="Authorization",Tt.MANUAL_REDIRECT="manual";var _t=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn"]),St=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],It=function(e){var t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"===typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(r){throw new Error("Unable to stringify the content")}return e},Et=function(e){if(-1!==(e=e.toLowerCase()).indexOf("https://")){var t=(e=e.replace("https://","")).indexOf(":"),r=e.indexOf("/"),n="";if(-1!==r)return-1!==t&&t<r?(n=e.substring(0,t),_t.has(n)):(n=e.substring(0,r),_t.has(n))}return!1},At=function(){function e(){p(this,e)}return v(e,[{key:"execute",value:function(t){return ct(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n="string"===typeof t.request?t.request:t.request.url,Et(n)?((o=ft(t.request,t.options,e.CLIENT_REQUEST_ID_HEADER))||(o=pt(),ht(t.request,t.options,e.CLIENT_REQUEST_ID_HEADER,o)),i="".concat(e.PRODUCT_NAME,"/").concat("2.2.1"),t.middlewareControl instanceof dt&&(a=t.middlewareControl.getMiddlewareOptions(bt)),a&&(s=a.getFeatureUsage(),i+=" (".concat(e.FEATURE_USAGE_STRING,"=").concat(s,")")),gt(t.request,t.options,e.SDK_VERSION_HEADER,i)):(delete t.options.headers[e.CLIENT_REQUEST_ID_HEADER],delete t.options.headers[e.SDK_VERSION_HEADER]),r.next=5,this.nextMiddleware.execute(t);case 5:return r.abrupt("return",r.sent);case 8:throw r.prev=8,r.t0=r.catch(0),r.t0;case 11:case"end":return r.stop()}}),r,this,[[0,8]])})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();At.CLIENT_REQUEST_ID_HEADER="client-request-id",At.SDK_VERSION_HEADER="SdkVersion",At.PRODUCT_NAME="graph-js",At.FEATURE_USAGE_STRING="featureUsage";var Rt;!function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(Rt||(Rt={}));function Pt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}function Ot(){return Ot="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=Pt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Ot.apply(this,arguments)}var Nt=v((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;p(this,e),this.minValue=t,this.maxValue=r})),Dt=function(){function e(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};p(this,e),this.DEFAULT_FILE_SIZE=5242880,this.client=t,this.file=r,void 0===o.rangeSize&&(o.rangeSize=this.DEFAULT_FILE_SIZE),this.options=o,this.uploadSession=n,this.nextRange=new Nt(0,this.options.rangeSize-1)}return v(e,[{key:"parseRange",value:function(e){var t=e[0];if("undefined"===typeof t||""===t)return new Nt;var r=t.split("-"),n=parseInt(r[0],10),o=parseInt(r[1],10);return Number.isNaN(o)&&(o=this.file.size-1),new Nt(n,o)}},{key:"updateTaskStatus",value:function(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}},{key:"getNextRange",value:function(){if(-1===this.nextRange.minValue)return this.nextRange;var e=this.nextRange.minValue,t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new Nt(e,t)}},{key:"sliceFile",value:function(e){return this.file.content.slice(e.minValue,e.maxValue+1)}},{key:"upload",value:function(){return ct(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0;case 1:if(-1!==(t=this.getNextRange()).maxValue){e.next=7;break}throw(r=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file")).name="Invalid Session",r;case 7:return n=this.sliceFile(t),e.next=10,this.uploadSlice(n,t,this.file.size);case 10:if(void 0===(o=e.sent).id){e.next=15;break}return e.abrupt("return",o);case 15:this.updateTaskStatus(o);case 16:e.next=1;break;case 18:e.next=23;break;case 20:throw e.prev=20,e.t0=e.catch(0),e.t0;case 23:case"end":return e.stop()}}),e,this,[[0,20]])})))}},{key:"uploadSlice",value:function(e,t,r){return ct(this,void 0,void 0,Ze().mark((function n(){return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.client.api(this.uploadSession.url).headers({"Content-Length":"".concat(t.maxValue-t.minValue+1),"Content-Range":"bytes ".concat(t.minValue,"-").concat(t.maxValue,"/").concat(r)}).put(e);case 3:return n.abrupt("return",n.sent);case 6:throw n.prev=6,n.t0=n.catch(0),n.t0;case 9:case"end":return n.stop()}}),n,this,[[0,6]])})))}},{key:"cancel",value:function(){return ct(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.client.api(this.uploadSession.url).delete();case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,this,[[0,6]])})))}},{key:"getStatus",value:function(){return ct(this,void 0,void 0,Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.client.api(this.uploadSession.url).get();case 3:return t=e.sent,this.updateTaskStatus(t),e.abrupt("return",t);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,this,[[0,8]])})))}},{key:"resume",value:function(){return ct(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getStatus();case 3:return e.next=5,this.upload();case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,this,[[0,8]])})))}}],[{key:"createUploadSession",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return ct(this,void 0,void 0,Ze().mark((function o(){var i,a;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,e.api(t).headers(n).post(r);case 3:return i=o.sent,a={url:i.uploadUrl,expiry:new Date(i.expirationDateTime)},o.abrupt("return",a);case 8:throw o.prev=8,o.t0=o.catch(0),o.t0;case 11:case"end":return o.stop()}}),o,null,[[0,8]])})))}}]),e}(),Lt=5242880,Mt=function(e){return e>327680&&(e=320*Math.floor(e/327680)*1024),e},Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt,t=62914560;return e>t&&(e=t),Mt(e)},Ft=function(e){b(r,e);var t=C(r);function r(e,n,o,i){return p(this,r),t.call(this,e,n,o,i)}return v(r,[{key:"commit",value:function(e){return ct(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={name:this.file.name,"@microsoft.graph.conflictBehavior":"rename","@microsoft.graph.sourceUrl":this.uploadSession.url},t.next=4,this.client.api(e).put(r);case 4:return t.abrupt("return",t.sent);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}}],[{key:"constructCreateSessionUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.DEFAULT_UPLOAD_PATH;return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t="/".concat(t)),"/"!==t[t.length-1]&&(t="".concat(t,"/")),"/me/drive/root:".concat(t.split("/").map((function(e){return encodeURIComponent(e)})).join("/")).concat(encodeURIComponent(e),":/createUploadSession")}},{key:"create",value:function(e,t,n){return ct(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u,d,p;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i=n.fileName,"undefined"!==typeof Blob&&t instanceof Blob?(a=new File([t],i),s=a.size):"undefined"!==typeof File&&t instanceof File?s=(a=t).size:"undefined"!==typeof Buffer&&t instanceof Buffer&&(s=(c=t).byteLength-c.byteOffset,a=c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)),o.prev=2,l=r.constructCreateSessionUrl(n.fileName,n.path),o.next=6,r.createUploadSession(e,l,n.fileName);case 6:return u=o.sent,d=Ut(n.rangeSize),p={name:i,content:a,size:s},o.abrupt("return",new r(e,p,u,{rangeSize:d}));case 12:throw o.prev=12,o.t0=o.catch(2),o.t0;case 15:case"end":return o.stop()}}),o,null,[[2,12]])})))}},{key:"createUploadSession",value:function(e,t,n){var o=this,i=Object.create(null,{createUploadSession:{get:function(){return Ot(y(r),"createUploadSession",o)}}});return ct(this,void 0,void 0,Ze().mark((function r(){var o;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o={item:{"@microsoft.graph.conflictBehavior":"rename",name:n}},r.prev=1,r.abrupt("return",i.createUploadSession.call(this,e,t,o));case 5:throw r.prev=5,r.t0=r.catch(1),r.t0;case 8:case"end":return r.stop()}}),r,this,[[1,5]])})))}}]),r}(Dt);Ft.DEFAULT_UPLOAD_PATH="/";var zt,Ht,Bt,qt,jt=function(){function e(t){p(this,e),this.provider=t}return v(e,[{key:"getAccessToken",value:function(){return ct(this,void 0,void 0,Ze().mark((function e(){var t=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){t.provider((function(t,n){n?e(n):r(t)}))})));case 1:case"end":return e.stop()}}),e)})))}}]),e}(),Gt=function(e){b(r,e);var t=C(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,o=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return p(this,r),e=t.call(this,o||i&&i.message),Object.setPrototypeOf(w(e),r.prototype),e.statusCode=n,e.code=null,e.requestId=null,e.date=new Date,e.body=null,e.stack=i?i.stack:e.stack,e}return v(r)}(_(Error)),Vt=function(){function e(){p(this,e)}return v(e,null,[{key:"constructError",value:function(e,t){var r=new Gt(t,"",e);return void 0!==e.name&&(r.code=e.name),r.body=e.toString(),r.date=new Date,r}},{key:"constructErrorFromResponse",value:function(e,t){e=e.error;var r=new Gt(t,e.message);r.code=e.code,void 0!==e.innerError&&(r.requestId=e.innerError["request-id"],r.date=new Date(e.innerError.date));try{r.body=JSON.stringify(e)}catch(e){}return r}},{key:"getError",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0;return ct(this,void 0,void 0,Ze().mark((function o(){var i;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(i=t&&t.error?e.constructErrorFromResponse(t,r):"undefined"!==typeof Error&&t instanceof Error?e.constructError(t,r):new Gt(r),"function"!==typeof n){o.next=5;break}n(i,null),o.next=6;break;case 5:return o.abrupt("return",i);case 6:case"end":return o.stop()}}),o)})))}}]),e}();!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(zt||(zt={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(Ht||(Ht={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(Bt||(Bt={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(qt||(qt={}));var Kt=function(){function e(){p(this,e)}return v(e,null,[{key:"parseDocumentResponse",value:function(e,t){try{return"undefined"!==typeof DOMParser?new Promise((function(r,n){e.text().then((function(e){try{var o=(new DOMParser).parseFromString(e,t);r(o)}catch(i){n(i)}}))})):Promise.resolve(e.body)}catch(r){throw r}}},{key:"convertResponse",value:function(t,r){return ct(this,void 0,void 0,Ze().mark((function n(){var o,i,a;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(204!==t.status){n.next=2;break}return n.abrupt("return",Promise.resolve());case 2:n.prev=2,n.t0=r,n.next=n.t0===zt.ARRAYBUFFER?6:n.t0===zt.BLOB?10:n.t0===zt.DOCUMENT?14:n.t0===zt.JSON?18:n.t0===zt.STREAM?22:n.t0===zt.TEXT?26:30;break;case 6:return n.next=8,t.arrayBuffer();case 8:return o=n.sent,n.abrupt("break",60);case 10:return n.next=12,t.blob();case 12:return o=n.sent,n.abrupt("break",60);case 14:return n.next=16,e.parseDocumentResponse(t,Ht.TEXT_XML);case 16:return o=n.sent,n.abrupt("break",60);case 18:return n.next=20,t.json();case 20:return o=n.sent,n.abrupt("break",60);case 22:return n.next=24,Promise.resolve(t.body);case 24:return o=n.sent,n.abrupt("break",60);case 26:return n.next=28,t.text();case 28:return o=n.sent,n.abrupt("break",60);case 30:if(null===(i=t.headers.get("Content-type"))){n.next=58;break}if(a=i.split(";")[0],!new RegExp(qt.DOCUMENT).test(a)){n.next=39;break}return n.next=36,e.parseDocumentResponse(t,a);case 36:o=n.sent,n.next=56;break;case 39:if(!new RegExp(qt.IMAGE).test(a)){n.next=43;break}o=t.blob(),n.next=56;break;case 43:if(a!==Bt.TEXT_PLAIN){n.next=49;break}return n.next=46,t.text();case 46:o=n.sent,n.next=56;break;case 49:if(a!==Bt.APPLICATION_JSON){n.next=55;break}return n.next=52,t.json();case 52:o=n.sent,n.next=56;break;case 55:o=Promise.resolve(t.body);case 56:n.next=59;break;case 58:o=Promise.resolve(t.body);case 59:return n.abrupt("break",60);case 60:n.next=65;break;case 62:throw n.prev=62,n.t1=n.catch(2),n.t1;case 65:return n.abrupt("return",o);case 66:case"end":return n.stop()}}),n,null,[[2,62]])})))}},{key:"getResponse",value:function(t,r,n){return ct(this,void 0,void 0,Ze().mark((function o(){var i;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,r!==zt.RAW){o.next=5;break}return o.abrupt("return",Promise.resolve(t));case 5:return o.next=7,e.convertResponse(t,r);case 7:if(i=o.sent,!t.ok){o.next=16;break}if("function"!==typeof n){o.next=13;break}n(null,i),o.next=14;break;case 13:return o.abrupt("return",i);case 14:o.next=17;break;case 16:throw i;case 17:o.next=22;break;case 19:throw o.prev=19,o.t0=o.catch(0),o.t0;case 22:case"end":return o.stop()}}),o,null,[[0,19]])})))}}]),e}(),Qt=function(){function e(t,r,n){var o=this;p(this,e),this.parsePath=function(e){if(-1!==e.indexOf("https://")){var t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(o.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));var r=e.indexOf("/");-1!==r&&(o.urlComponents.version=e.substring(0,r),e=e.substring(r+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));var n=e.indexOf("?");if(-1===n)o.urlComponents.path=e;else{o.urlComponents.path=e.substr(0,n);var i,a=S(e.substring(n+1,e.length).split("&"));try{for(a.s();!(i=a.n()).done;){var s=i.value;o.parseQueryParameter(s)}}catch(c){a.e(c)}finally{a.f()}}},this.httpClient=t,this.config=r,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(n)}return v(e,[{key:"addCsvQueryParameter",value:function(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";var n=[];r.length>1&&"string"===typeof t?n=Array.prototype.slice.call(r):"string"===typeof t?n.push(t):n=n.concat(t),this.urlComponents.oDataQueryParams[e]+=n.join(",")}},{key:"buildFullUrl",value:function(){var e=function(e){var t=function(e){return e.replace(/^\/+/,"")};return Array.prototype.slice.call(e).reduce((function(e,r){return[(n=e,n.replace(/\/+$/,"")),t(r)].join("/");var n}))}([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}},{key:"createQueryString",value:function(){var e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(var r in e.oDataQueryParams)e.oDataQueryParams.hasOwnProperty(r)&&t.push(r+"="+e.oDataQueryParams[r]);if(0!==Object.keys(e.otherURLQueryParams).length)for(var n in e.otherURLQueryParams)e.otherURLQueryParams.hasOwnProperty(n)&&t.push(n+"="+e.otherURLQueryParams[n]);if(0!==e.otherURLQueryOptions.length){var o,i=S(e.otherURLQueryOptions);try{for(i.s();!(o=i.n()).done;){var a=o.value;t.push(a)}}catch(s){i.e(s)}finally{i.f()}}return t.length>0?"?"+t.join("&"):""}},{key:"parseQueryParameter",value:function(e){if("string"===typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){var t,r=S(e.split("&"));try{for(r.s();!(t=r.n()).done;){var n=t.value;this.parseQueryParamenterString(n)}}catch(i){r.e(i)}finally{r.f()}}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(var o in e)e.hasOwnProperty(o)&&this.setURLComponentsQueryParamater(o,e[o]);return this}},{key:"parseQueryParamenterString",value:function(e){if(this.isValidQueryKeyValuePair(e)){var t=e.indexOf("="),r=e.substring(0,t),n=e.substring(t+1);this.setURLComponentsQueryParamater(r,n)}else this.urlComponents.otherURLQueryOptions.push(e)}},{key:"setURLComponentsQueryParamater",value:function(e,t){if(-1!==St.indexOf(e)){var r=this.urlComponents.oDataQueryParams[e],n=r&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=n?r+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}},{key:"isValidQueryKeyValuePair",value:function(e){var t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}},{key:"updateRequestOptions",value:function(e){var t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){var r=Object.assign({},this.config.fetchOptions);Object.assign(e,r),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}},{key:"send",value:function(e,t,r){return ct(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=new dt(this._middlewareOptions),this.updateRequestOptions(t),n.prev=2,n.next=5,this.httpClient.sendRequest({request:e,options:t,middlewareControl:i});case 5:return a=n.sent,o=a.response,n.next=9,Kt.getResponse(o,this._responseType,r);case 9:return s=n.sent,n.abrupt("return",s);case 13:return n.prev=13,n.t0=n.catch(2),"undefined"!==typeof o&&(c=o.status),n.next=18,Vt.getError(n.t0,c,r);case 18:throw n.sent;case 20:case"end":return n.stop()}}),n,this,[[2,13]])})))}},{key:"setHeaderContentType",value:function(){if(this._headers){for(var e=0,t=Object.keys(this._headers);e<t.length;e++){if("content-type"===t[e].toLowerCase())return}this.header("Content-Type","application/json")}else this.header("Content-Type","application/json")}},{key:"header",value:function(e,t){return this._headers[e]=t,this}},{key:"headers",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this._headers[t]=e[t]);return this}},{key:"option",value:function(e,t){return this._options[e]=t,this}},{key:"options",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this._options[t]=e[t]);return this}},{key:"middlewareOptions",value:function(e){return this._middlewareOptions=e,this}},{key:"version",value:function(e){return this.urlComponents.version=e,this}},{key:"responseType",value:function(e){return this._responseType=e,this}},{key:"select",value:function(e){return this.addCsvQueryParameter("$select",e,arguments),this}},{key:"expand",value:function(e){return this.addCsvQueryParameter("$expand",e,arguments),this}},{key:"orderby",value:function(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}},{key:"filter",value:function(e){return this.urlComponents.oDataQueryParams.$filter=e,this}},{key:"search",value:function(e){return this.urlComponents.oDataQueryParams.$search=e,this}},{key:"top",value:function(e){return this.urlComponents.oDataQueryParams.$top=e,this}},{key:"skip",value:function(e){return this.urlComponents.oDataQueryParams.$skip=e,this}},{key:"skipToken",value:function(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}},{key:"count",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.urlComponents.oDataQueryParams.$count=e.toString(),this}},{key:"query",value:function(e){return this.parseQueryParameter(e)}},{key:"get",value:function(e){return ct(this,void 0,void 0,Ze().mark((function t(){var r,n,o;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.buildFullUrl(),n={method:st.GET},t.prev=2,t.next=5,this.send(r,n,e);case 5:return o=t.sent,t.abrupt("return",o);case 9:throw t.prev=9,t.t0=t.catch(2),t.t0;case 12:case"end":return t.stop()}}),t,this,[[2,9]])})))}},{key:"post",value:function(e,t){return ct(this,void 0,void 0,Ze().mark((function r(){var n,o,i;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),o={method:st.POST,body:It(e)},"FormData"===(e&&e.constructor&&e.constructor.name)?o.headers={}:(this.setHeaderContentType(),o.headers=this._headers),r.prev=4,r.next=7,this.send(n,o,t);case 7:return i=r.sent,r.abrupt("return",i);case 11:throw r.prev=11,r.t0=r.catch(4),r.t0;case 14:case"end":return r.stop()}}),r,this,[[4,11]])})))}},{key:"create",value:function(e,t){return ct(this,void 0,void 0,Ze().mark((function r(){return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.post(e,t);case 3:return r.abrupt("return",r.sent);case 6:throw r.prev=6,r.t0=r.catch(0),r.t0;case 9:case"end":return r.stop()}}),r,this,[[0,6]])})))}},{key:"put",value:function(e,t){return ct(this,void 0,void 0,Ze().mark((function r(){var n,o,i;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),this.setHeaderContentType(),o={method:st.PUT,body:It(e)},r.prev=3,r.next=6,this.send(n,o,t);case 6:return i=r.sent,r.abrupt("return",i);case 10:throw r.prev=10,r.t0=r.catch(3),r.t0;case 13:case"end":return r.stop()}}),r,this,[[3,10]])})))}},{key:"patch",value:function(e,t){return ct(this,void 0,void 0,Ze().mark((function r(){var n,o,i;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),this.setHeaderContentType(),o={method:st.PATCH,body:It(e)},r.prev=3,r.next=6,this.send(n,o,t);case 6:return i=r.sent,r.abrupt("return",i);case 10:throw r.prev=10,r.t0=r.catch(3),r.t0;case 13:case"end":return r.stop()}}),r,this,[[3,10]])})))}},{key:"update",value:function(e,t){return ct(this,void 0,void 0,Ze().mark((function r(){return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.patch(e,t);case 3:return r.abrupt("return",r.sent);case 6:throw r.prev=6,r.t0=r.catch(0),r.t0;case 9:case"end":return r.stop()}}),r,this,[[0,6]])})))}},{key:"delete",value:function(e){return ct(this,void 0,void 0,Ze().mark((function t(){var r,n,o;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.buildFullUrl(),n={method:st.DELETE},t.prev=2,t.next=5,this.send(r,n,e);case 5:return o=t.sent,t.abrupt("return",o);case 9:throw t.prev=9,t.t0=t.catch(2),t.t0;case 12:case"end":return t.stop()}}),t,this,[[2,9]])})))}},{key:"del",value:function(e){return ct(this,void 0,void 0,Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.delete(e);case 3:return t.abrupt("return",t.sent);case 6:throw t.prev=6,t.t0=t.catch(0),t.t0;case 9:case"end":return t.stop()}}),t,this,[[0,6]])})))}},{key:"getStream",value:function(e){return ct(this,void 0,void 0,Ze().mark((function t(){var r,n,o;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.buildFullUrl(),n={method:st.GET},this.responseType(zt.STREAM),t.prev=3,t.next=6,this.send(r,n,e);case 6:return o=t.sent,t.abrupt("return",o);case 10:throw t.prev=10,t.t0=t.catch(3),t.t0;case 13:case"end":return t.stop()}}),t,this,[[3,10]])})))}},{key:"putStream",value:function(e,t){return ct(this,void 0,void 0,Ze().mark((function r(){var n,o,i;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),o={method:st.PUT,headers:{"Content-Type":"application/octet-stream"},body:e},r.prev=2,r.next=5,this.send(n,o,t);case 5:return i=r.sent,r.abrupt("return",i);case 9:throw r.prev=9,r.t0=r.catch(2),r.t0;case 12:case"end":return r.stop()}}),r,this,[[2,9]])})))}}]),e}(),Wt=function(){function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(p(this,e),!r||!r.length){var o=new Error;throw o.name="InvalidMiddlewareChain",o.message="Please provide a default middleware chain or custom middleware chain",o}this.setMiddleware.apply(this,r)}return v(e,[{key:"setMiddleware",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.length>1?this.parseMiddleWareArray(t):this.middleware=t[0]}},{key:"parseMiddleWareArray",value:function(e){e.forEach((function(t,r){r<e.length-1&&t.setNext(e[r+1])})),this.middleware=e[0]}},{key:"sendRequest",value:function(e){return ct(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"string"!==typeof e.request||void 0!==e.options){t.next=6;break}throw(r=new Error).name="InvalidRequestOptions",r.message="Unable to execute the middleware, Please provide valid options for a request",r;case 6:return t.next=8,this.middleware.execute(e);case 8:return t.abrupt("return",e);case 11:throw t.prev=11,t.t0=t.catch(0),t.t0;case 14:case"end":return t.stop()}}),t,this,[[0,11]])})))}}]),e}(),Jt=function(){function e(){p(this,e)}return v(e,null,[{key:"createWithAuthenticationProvider",value:function(t){var r=new yt(t),n=new xt(new wt),o=new At,i=new kt;if(r.setNext(n),"object"===typeof process){var a=new Tt(new Ct);n.setNext(a),a.setNext(o)}else n.setNext(o);return o.setNext(i),e.createWithMiddleware(r)}},{key:"createWithMiddleware",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return T(Wt,t)}}]),e}(),Yt=function(){function e(t){p(this,e),this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"};try{!function(){if("undefined"===typeof Promise&&"undefined"===typeof fetch){var e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"===typeof Promise){var t=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}if("undefined"===typeof fetch){var r=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}}()}catch(o){throw o}for(var r in t)t.hasOwnProperty(r)&&(this.config[r]=t[r]);var n;if(void 0!==t.authProvider&&void 0!==t.middleware){var o=new Error;throw o.name="AmbiguityInInitialization",o.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",o}if(void 0!==t.authProvider)n=Jt.createWithAuthenticationProvider(t.authProvider);else{if(void 0===t.middleware){var i=new Error;throw i.name="InvalidMiddlewareChain",i.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",i}n=T(Wt,d([].concat(t.middleware)))}this.httpClient=n}return v(e,[{key:"api",value:function(e){return new Qt(this.httpClient,this.config,e)}}],[{key:"init",value:function(t){var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]="authProvider"===n?new jt(t[n]):t[n]);return e.initWithMiddleware(r)}},{key:"initWithMiddleware",value:function(t){try{return new e(t)}catch(r){throw r}}}]),e}(),Xt=v((function e(){p(this,e)}));function Zt(e){return new Promise((function(t){setTimeout(t,e)}))}function $t(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n={scopes:t};return Pn.globalProvider.isIncrementalConsentDisabled?[]:[new mt(void 0,n)]}function er(){for(var e=arguments.length<=0?void 0:arguments[0],t=e,r=1;r<arguments.length;++r){var n=r<0||arguments.length<=r?void 0:arguments[r];t.setNext&&t.setNext(n),t=n}return e}function tr(e){try{var t=new URL(e).origin;if(at.has(t))return t}catch(r){return}}var rr=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},nr=v((function e(t,r,n,o){p(this,e),"/"!==n.charAt(0)&&(n="/"+n),this.resource=n,this.method=o,this.index=t,this.id=r})),or=function(){function e(t){p(this,e),this.graph=t,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}return v(e,[{key:"hasRequests",get:function(){return this.requestsQueue.length>0}},{key:"get",value:function(e,t,r,n){var o=this.nextIndex++,i=new nr(o,e,t,"GET");i.headers=n,this.allRequests.push(i),this.requestsQueue.push(o),r&&(this.scopes=this.scopes.concat(r))}},{key:"executeNext",value:function(){return rr(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i,a,s,c,l,u,p,f,h,g,v,m,b=this;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=new Map,!this.retryAfter){t.next=5;break}return t.next=4,Zt(1e3*this.retryAfter);case 4:this.retryAfter=0;case 5:if(this.hasRequests){t.next=7;break}return t.abrupt("return",r);case 7:n=this.requestsQueue.splice(0,20),o=new lt,i=S(n.map((function(e){return b.allRequests[e]})));try{for(i.s();!(a=i.n()).done;)s=a.value,o.addRequest({id:s.index.toString(),request:new Request(e.baseUrl+s.resource,{method:s.method,headers:s.headers})})}catch(y){i.e(y)}finally{i.f()}return c=this.scopes.length?$t.apply(void 0,d(this.scopes)):[],l=this.graph.api("$batch").middlewareOptions(c),t.next=15,o.getContent();case 15:return u=t.sent,t.next=18,l.post(u);case 18:p=t.sent,f=S(p.responses),t.prev=20,f.s();case 22:if((h=f.n()).done){t.next=38;break}if(g=h.value,v=new Xt,m=this.allRequests[g.id],v.id=m.id,v.index=m.index,v.headers=g.headers,200===g.status){t.next=34;break}return 429===g.status&&(this.requestsQueue.unshift(g.id),this.retryAfter=Math.max(this.retryAfter,parseInt(g.headers["Retry-After"],10)||1)),t.abrupt("continue",36);case 34:g.headers["Content-Type"].includes("image/jpeg")?v.content="data:image/jpeg;base64,"+g.body:g.headers["Content-Type"].includes("image/pjpeg")?v.content="data:image/pjpeg;base64,"+g.body:g.headers["Content-Type"].includes("image/png")?v.content="data:image/png;base64,"+g.body:v.content=g.body;case 35:r.set(m.id,v);case 36:t.next=22;break;case 38:t.next=43;break;case 40:t.prev=40,t.t0=t.catch(20),f.e(t.t0);case 43:return t.prev=43,f.f(),t.finish(43);case 46:return t.abrupt("return",r);case 47:case"end":return t.stop()}}),t,this,[[20,40,43,46]])})))}},{key:"executeAll",value:function(){return rr(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a,s;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new Map;case 1:if(!this.hasRequests){e.next=9;break}return e.next=4,this.executeNext();case 4:r=e.sent,n=S(r);try{for(n.s();!(o=n.n()).done;)i=l(o.value,2),a=i[0],s=i[1],t.set(a,s)}catch(c){n.e(c)}finally{n.f()}e.next=1;break;case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e,this)})))}}]),e}();or.baseUrl="https://graph.microsoft.com";var ir=v((function e(t){p(this,e),this.componentName="string"===typeof t?t:t.tagName.toLowerCase()})),ar=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},sr=function(){function e(t,r){p(this,e),this._packageVersion=t,this._providerName=r}return v(e,[{key:"execute",value:function(e){var t;return ar(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s,c;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:try{"string"===typeof e.request&&(tr(e.request)?(n=[],(o=e.middlewareControl.getMiddlewareOptions(ir))&&(i="".concat(o.componentName,"/").concat(this._packageVersion),n.push(i)),this._providerName&&(a="".concat(this._providerName,"/").concat(this._packageVersion),n.push(a)),s="mgt/".concat(this._packageVersion),n.push(s),n.push(ft(e.request,e.options,"SdkVersion")),c=n.join(", "),ht(e.request,e.options,"SdkVersion",c)):null===(t=null===e||void 0===e?void 0:e.options)||void 0===t||delete t.headers.SdkVersion)}catch(l){}return r.next=3,this._nextMiddleware.execute(e);case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r,this)})))}},{key:"setNext",value:function(e){this._nextMiddleware=e}}]),e}(),cr="2.9.0",lr="v1.0",ur=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lr;p(this,e),this._client=t,this._version=r}return v(e,[{key:"client",get:function(){return this._client}},{key:"componentName",get:function(){return this._componentName}},{key:"version",get:function(){return this._version}},{key:"forComponent",value:function(t){var r=new e(this._client,this._version);return r.setComponent(t),r}},{key:"api",value:function(e){var t=this._client.api(e).version(this._version);return this._componentName&&(t.middlewareOptions=function(e){var r=t;return r._middlewareOptions=r._middlewareOptions.concat(e),t},t=t.middlewareOptions([new ir(this._componentName)])),t}},{key:"createBatch",value:function(){return new or(this)}},{key:"setComponent",value:function(e){this._componentName=e instanceof Element?e.tagName:e}}]),e}();function dr(e,t,r){var n=[new yt(e),new xt(new wt),new At,new sr(cr,e.name),new kt],o=Yt.initWithMiddleware({middleware:er.apply(void 0,n)}),i=new ur(o,t);return r?i.forComponent(r):i}var pr="beta",fr=function(e){b(r,e);var t=C(r);function r(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pr;return p(this,r),t.call(this,e,n)}return v(r,[{key:"forComponent",value:function(e){var t=new r(this.client);return this.setComponent(e),t}}],[{key:"fromGraph",value:function(e){var t=new r(e.client);return t.setComponent(e.componentName),t}}]),r}(ur),hr="undefined"!==typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,gr=function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t!==r;){var n=t.nextSibling;e.removeChild(t),t=n}},vr="{{lit-".concat(String(Math.random()).slice(2),"}}"),mr="\x3c!--".concat(vr,"--\x3e"),br=new RegExp("".concat(vr,"|").concat(mr)),yr="$lit$",kr=v((function e(t,r){p(this,e),this.parts=[],this.element=r;for(var n=[],o=[],i=document.createTreeWalker(r.content,133,null,!1),a=0,s=-1,c=0,l=t.strings,u=t.values.length;c<u;){var d=i.nextNode();if(null!==d){if(s++,1===d.nodeType){if(d.hasAttributes()){for(var f=d.attributes,h=f.length,g=0,v=0;v<h;v++)wr(f[v].name,yr)&&g++;for(;g-- >0;){var m=l[c],b=Tr.exec(m)[2],y=b.toLowerCase()+yr,k=d.getAttribute(y);d.removeAttribute(y);var w=k.split(br);this.parts.push({type:"attribute",index:s,name:b,strings:w}),c+=w.length-1}}"TEMPLATE"===d.tagName&&(o.push(d),i.currentNode=d.content)}else if(3===d.nodeType){var x=d.data;if(x.indexOf(vr)>=0){for(var C=d.parentNode,T=x.split(br),_=T.length-1,S=0;S<_;S++){var I=void 0,E=T[S];if(""===E)I=Cr();else{var A=Tr.exec(E);null!==A&&wr(A[2],yr)&&(E=E.slice(0,A.index)+A[1]+A[2].slice(0,-yr.length)+A[3]),I=document.createTextNode(E)}C.insertBefore(I,d),this.parts.push({type:"node",index:++s})}""===T[_]?(C.insertBefore(Cr(),d),n.push(d)):d.data=T[_],c+=_}}else if(8===d.nodeType)if(d.data===vr){var R=d.parentNode;null!==d.previousSibling&&s!==a||(s++,R.insertBefore(Cr(),d)),a=s,this.parts.push({type:"node",index:s}),null===d.nextSibling?d.data="":(n.push(d),s--),c++}else for(var P=-1;-1!==(P=d.data.indexOf(vr,P+1));)this.parts.push({type:"node",index:-1}),c++}else i.currentNode=o.pop()}for(var O=0,N=n;O<N.length;O++){var D=N[O];D.parentNode.removeChild(D)}})),wr=function(e,t){var r=e.length-t.length;return r>=0&&e.slice(r)===t},xr=function(e){return-1!==e.index},Cr=function(){return document.createComment("")},Tr=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/,_r=133;function Sr(e,t){for(var r=e.element.content,n=e.parts,o=document.createTreeWalker(r,_r,null,!1),i=Er(n),a=n[i],s=-1,c=0,l=[],u=null;o.nextNode();){s++;var d=o.currentNode;for(d.previousSibling===u&&(u=null),t.has(d)&&(l.push(d),null===u&&(u=d)),null!==u&&c++;void 0!==a&&a.index===s;)a.index=null!==u?-1:a.index-c,a=n[i=Er(n,i)]}l.forEach((function(e){return e.parentNode.removeChild(e)}))}var Ir=function(e){for(var t=11===e.nodeType?0:1,r=document.createTreeWalker(e,_r,null,!1);r.nextNode();)t++;return t},Er=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=t+1;r<e.length;r++){var n=e[r];if(xr(n))return r}return-1};var Ar=new WeakMap,Rr=function(e){return function(){var t=e.apply(void 0,arguments);return Ar.set(t,!0),t}},Pr=function(e){return"function"===typeof e&&Ar.has(e)},Or={},Nr={},Dr=function(){function e(t,r,n){p(this,e),this.__parts=[],this.template=t,this.processor=r,this.options=n}return v(e,[{key:"update",value:function(e){var t,r=0,n=S(this.__parts);try{for(n.s();!(t=n.n()).done;){var o=t.value;void 0!==o&&o.setValue(e[r]),r++}}catch(c){n.e(c)}finally{n.f()}var i,a=S(this.__parts);try{for(a.s();!(i=a.n()).done;){var s=i.value;void 0!==s&&s.commit()}}catch(c){a.e(c)}finally{a.f()}}},{key:"_clone",value:function(){for(var e,t=hr?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),r=[],n=this.template.parts,o=document.createTreeWalker(t,133,null,!1),i=0,a=0,s=o.nextNode();i<n.length;)if(e=n[i],xr(e)){for(;a<e.index;)a++,"TEMPLATE"===s.nodeName&&(r.push(s),o.currentNode=s.content),null===(s=o.nextNode())&&(o.currentNode=r.pop(),s=o.nextNode());if("node"===e.type){var c=this.processor.handleTextExpression(this.options);c.insertAfterNode(s.previousSibling),this.__parts.push(c)}else{var l;(l=this.__parts).push.apply(l,d(this.processor.handleAttributeExpressions(s,e.name,e.strings,this.options)))}i++}else this.__parts.push(void 0),i++;return hr&&(document.adoptNode(t),customElements.upgrade(t)),t}}]),e}(),Lr=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:function(e){return e}}),Mr=" ".concat(vr," "),Ur=function(){function e(t,r,n,o){p(this,e),this.strings=t,this.values=r,this.type=n,this.processor=o}return v(e,[{key:"getHTML",value:function(){for(var e=this.strings.length-1,t="",r=!1,n=0;n<e;n++){var o=this.strings[n],i=o.lastIndexOf("\x3c!--");r=(i>-1||r)&&-1===o.indexOf("--\x3e",i+1);var a=Tr.exec(o);t+=null===a?o+(r?Mr:mr):o.substr(0,a.index)+a[1]+a[2]+yr+a[3]+vr}return t+=this.strings[e]}},{key:"getTemplateElement",value:function(){var e=document.createElement("template"),t=this.getHTML();return void 0!==Lr&&(t=Lr.createHTML(t)),e.innerHTML=t,e}}]),e}(),Fr=function(e){return null===e||!("object"===typeof e||"function"===typeof e)},zr=function(e){return Array.isArray(e)||!(!e||!e[Symbol.iterator])},Hr=function(){function e(t,r,n){p(this,e),this.dirty=!0,this.element=t,this.name=r,this.strings=n,this.parts=[];for(var o=0;o<n.length-1;o++)this.parts[o]=this._createPart()}return v(e,[{key:"_createPart",value:function(){return new Br(this)}},{key:"_getValue",value:function(){var e=this.strings,t=e.length-1,r=this.parts;if(1===t&&""===e[0]&&""===e[1]){var n=r[0].value;if("symbol"===typeof n)return String(n);if("string"===typeof n||!zr(n))return n}for(var o="",i=0;i<t;i++){o+=e[i];var a=r[i];if(void 0!==a){var s=a.value;if(Fr(s)||!zr(s))o+="string"===typeof s?s:String(s);else{var c,l=S(s);try{for(l.s();!(c=l.n()).done;){var u=c.value;o+="string"===typeof u?u:String(u)}}catch(d){l.e(d)}finally{l.f()}}}}return o+=e[t]}},{key:"commit",value:function(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}]),e}(),Br=function(){function e(t){p(this,e),this.value=void 0,this.committer=t}return v(e,[{key:"setValue",value:function(e){e===Or||Fr(e)&&e===this.value||(this.value=e,Pr(e)||(this.committer.dirty=!0))}},{key:"commit",value:function(){for(;Pr(this.value);){var e=this.value;this.value=Or,e(this)}this.value!==Or&&this.committer.commit()}}]),e}(),qr=function(){function e(t){p(this,e),this.value=void 0,this.__pendingValue=void 0,this.options=t}return v(e,[{key:"appendInto",value:function(e){this.startNode=e.appendChild(Cr()),this.endNode=e.appendChild(Cr())}},{key:"insertAfterNode",value:function(e){this.startNode=e,this.endNode=e.nextSibling}},{key:"appendIntoPart",value:function(e){e.__insert(this.startNode=Cr()),e.__insert(this.endNode=Cr())}},{key:"insertAfterPart",value:function(e){e.__insert(this.startNode=Cr()),this.endNode=e.endNode,e.endNode=this.startNode}},{key:"setValue",value:function(e){this.__pendingValue=e}},{key:"commit",value:function(){if(null!==this.startNode.parentNode){for(;Pr(this.__pendingValue);){var e=this.__pendingValue;this.__pendingValue=Or,e(this)}var t=this.__pendingValue;t!==Or&&(Fr(t)?t!==this.value&&this.__commitText(t):t instanceof Ur?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):zr(t)?this.__commitIterable(t):t===Nr?(this.value=Nr,this.clear()):this.__commitText(t))}}},{key:"__insert",value:function(e){this.endNode.parentNode.insertBefore(e,this.endNode)}},{key:"__commitNode",value:function(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}},{key:"__commitText",value:function(e){var t=this.startNode.nextSibling,r="string"===typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=r:this.__commitNode(document.createTextNode(r)),this.value=e}},{key:"__commitTemplateResult",value:function(e){var t=this.options.templateFactory(e);if(this.value instanceof Dr&&this.value.template===t)this.value.update(e.values);else{var r=new Dr(t,e.processor,this.options),n=r._clone();r.update(e.values),this.__commitNode(n),this.value=r}}},{key:"__commitIterable",value:function(t){Array.isArray(this.value)||(this.value=[],this.clear());var r,n,o=this.value,i=0,a=S(t);try{for(a.s();!(n=a.n()).done;){var s=n.value;void 0===(r=o[i])&&(r=new e(this.options),o.push(r),0===i?r.appendIntoPart(this):r.insertAfterPart(o[i-1])),r.setValue(s),r.commit(),i++}}catch(c){a.e(c)}finally{a.f()}i<o.length&&(o.length=i,this.clear(r&&r.endNode))}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.startNode;gr(this.startNode.parentNode,e.nextSibling,this.endNode)}}]),e}(),jr=function(){function e(t,r,n){if(p(this,e),this.value=void 0,this.__pendingValue=void 0,2!==n.length||""!==n[0]||""!==n[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=r,this.strings=n}return v(e,[{key:"setValue",value:function(e){this.__pendingValue=e}},{key:"commit",value:function(){for(;Pr(this.__pendingValue);){var e=this.__pendingValue;this.__pendingValue=Or,e(this)}if(this.__pendingValue!==Or){var t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=Or}}}]),e}(),Gr=function(e){b(r,e);var t=C(r);function r(e,n,o){var i;return p(this,r),(i=t.call(this,e,n,o)).single=2===o.length&&""===o[0]&&""===o[1],i}return v(r,[{key:"_createPart",value:function(){return new Vr(this)}},{key:"_getValue",value:function(){return this.single?this.parts[0].value:Ot(y(r.prototype),"_getValue",this).call(this)}},{key:"commit",value:function(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}]),r}(Hr),Vr=function(e){b(r,e);var t=C(r);function r(){return p(this,r),t.apply(this,arguments)}return v(r)}(Br),Kr=!1;!function(){try{var e={get capture(){return Kr=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(t){}}();var Qr=function(){function e(t,r,n){var o=this;p(this,e),this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=r,this.eventContext=n,this.__boundHandleEvent=function(e){return o.handleEvent(e)}}return v(e,[{key:"setValue",value:function(e){this.__pendingValue=e}},{key:"commit",value:function(){for(;Pr(this.__pendingValue);){var e=this.__pendingValue;this.__pendingValue=Or,e(this)}if(this.__pendingValue!==Or){var t=this.__pendingValue,r=this.value,n=null==t||null!=r&&(t.capture!==r.capture||t.once!==r.once||t.passive!==r.passive),o=null!=t&&(null==r||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),o&&(this.__options=Wr(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=Or}}},{key:"handleEvent",value:function(e){"function"===typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}]),e}(),Wr=function(e){return e&&(Kr?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)};function Jr(e){var t=Yr.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},Yr.set(e.type,t));var r=t.stringsArray.get(e.strings);if(void 0!==r)return r;var n=e.strings.join(vr);return void 0===(r=t.keyString.get(n))&&(r=new kr(e,e.getTemplateElement()),t.keyString.set(n,r)),t.stringsArray.set(e.strings,r),r}var Yr=new Map,Xr=new WeakMap,Zr=function(){function e(){p(this,e)}return v(e,[{key:"handleAttributeExpressions",value:function(e,t,r,n){var o=t[0];return"."===o?new Gr(e,t.slice(1),r).parts:"@"===o?[new Qr(e,t.slice(1),n.eventContext)]:"?"===o?[new jr(e,t.slice(1),r)]:new Hr(e,t,r).parts}},{key:"handleTextExpression",value:function(e){return new qr(e)}}]),e}(),$r=new Zr;"undefined"!==typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");var en=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return new Ur(e,r,"html",$r)},tn=function(e,t){return"".concat(e,"--").concat(t)},rn=!0;"undefined"===typeof window.ShadyCSS?rn=!1:"undefined"===typeof window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),rn=!1);var nn=function(e){return function(t){var r=tn(t.type,e),n=Yr.get(r);void 0===n&&(n={stringsArray:new WeakMap,keyString:new Map},Yr.set(r,n));var o=n.stringsArray.get(t.strings);if(void 0!==o)return o;var i=t.strings.join(vr);if(void 0===(o=n.keyString.get(i))){var a=t.getTemplateElement();rn&&window.ShadyCSS.prepareTemplateDom(a,e),o=new kr(t,a),n.keyString.set(i,o)}return n.stringsArray.set(t.strings,o),o}},on=["html","svg"],an=new Set,sn=function(e,t,r){an.add(e);var n=r?r.element:document.createElement("template"),o=t.querySelectorAll("style"),i=o.length;if(0!==i){for(var a=document.createElement("style"),s=0;s<i;s++){var c=o[s];c.parentNode.removeChild(c),a.textContent+=c.textContent}!function(e){on.forEach((function(t){var r=Yr.get(tn(t,e));void 0!==r&&r.keyString.forEach((function(e){var t=e.element.content,r=new Set;Array.from(t.querySelectorAll("style")).forEach((function(e){r.add(e)})),Sr(e,r)}))}))}(e);var l=n.content;r?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.element.content,o=e.parts;if(null!==r&&void 0!==r)for(var i=document.createTreeWalker(n,_r,null,!1),a=Er(o),s=0,c=-1;i.nextNode();){for(c++,i.currentNode===r&&(s=Ir(t),r.parentNode.insertBefore(t,r));-1!==a&&o[a].index===c;){if(s>0){for(;-1!==a;)o[a].index+=s,a=Er(o,a);return}a=Er(o,a)}}else n.appendChild(t)}(r,a,l.firstChild):l.insertBefore(a,l.firstChild),window.ShadyCSS.prepareTemplateStyles(n,e);var u=l.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==u)t.insertBefore(u.cloneNode(!0),t.firstChild);else if(r){l.insertBefore(a,l.firstChild);var d=new Set;d.add(a),Sr(r,d)}}else window.ShadyCSS.prepareTemplateStyles(n,e)};window.JSCompiler_renameProperty=function(e,t){return e};var cn={toAttribute:function(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute:function(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},ln=function(e,t){return t!==e&&(t===t||e===e)},un={attribute:!0,type:String,converter:cn,reflect:!1,hasChanged:ln},dn="finalized",pn=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this)).initialize(),e}return v(r,[{key:"initialize",value:function(){var e=this;this._updateState=0,this._updatePromise=new Promise((function(t){return e._enableUpdatingResolver=t})),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}},{key:"_saveInstanceProperties",value:function(){var e=this;this.constructor._classProperties.forEach((function(t,r){if(e.hasOwnProperty(r)){var n=e[r];delete e[r],e._instanceProperties||(e._instanceProperties=new Map),e._instanceProperties.set(r,n)}}))}},{key:"_applyInstanceProperties",value:function(){var e=this;this._instanceProperties.forEach((function(t,r){return e[r]=t})),this._instanceProperties=void 0}},{key:"connectedCallback",value:function(){this.enableUpdating()}},{key:"enableUpdating",value:function(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}},{key:"disconnectedCallback",value:function(){}},{key:"attributeChangedCallback",value:function(e,t,r){t!==r&&this._attributeToProperty(e,r)}},{key:"_propertyToAttribute",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:un,n=this.constructor,o=n._attributeNameForProperty(e,r);if(void 0!==o){var i=n._propertyValueToAttribute(t,r);if(void 0===i)return;this._updateState=8|this._updateState,null==i?this.removeAttribute(o):this.setAttribute(o,i),this._updateState=-9&this._updateState}}},{key:"_attributeToProperty",value:function(e,t){if(!(8&this._updateState)){var r=this.constructor,n=r._attributeToPropertyMap.get(e);if(void 0!==n){var o=r.getPropertyOptions(n);this._updateState=16|this._updateState,this[n]=r._propertyValueFromAttribute(t,o),this._updateState=-17&this._updateState}}}},{key:"requestUpdateInternal",value:function(e,t,r){var n=!0;if(void 0!==e){var o=this.constructor;r=r||o.getPropertyOptions(e),o._valueHasChanged(this[e],t,r.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==r.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,r))):n=!1}!this._hasRequestedUpdate&&n&&(this._updatePromise=this._enqueueUpdate())}},{key:"requestUpdate",value:function(e,t){return this.requestUpdateInternal(e,t),this.updateComplete}},{key:"_enqueueUpdate",value:function(){var e=et(Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._updateState=4|this._updateState,e.prev=1,e.next=4,this._updatePromise;case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:if(null==(t=this.performUpdate())){e.next=12;break}return e.next=12,t;case 12:return e.abrupt("return",!this._hasRequestedUpdate);case 13:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"_hasRequestedUpdate",get:function(){return 4&this._updateState}},{key:"hasUpdated",get:function(){return 1&this._updateState}},{key:"performUpdate",value:function(){if(this._hasRequestedUpdate){this._instanceProperties&&this._applyInstanceProperties();var e=!1,t=this._changedProperties;try{(e=this.shouldUpdate(t))?this.update(t):this._markUpdated()}catch(r){throw e=!1,this._markUpdated(),r}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}}},{key:"_markUpdated",value:function(){this._changedProperties=new Map,this._updateState=-5&this._updateState}},{key:"updateComplete",get:function(){return this._getUpdateComplete()}},{key:"_getUpdateComplete",value:function(){return this.getUpdateComplete()}},{key:"getUpdateComplete",value:function(){return this._updatePromise}},{key:"shouldUpdate",value:function(e){return!0}},{key:"update",value:function(e){var t=this;void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((function(e,r){return t._propertyToAttribute(r,t[r],e)})),this._reflectingProperties=void 0),this._markUpdated()}},{key:"updated",value:function(e){}},{key:"firstUpdated",value:function(e){}}],[{key:"observedAttributes",get:function(){var e=this;this.finalize();var t=[];return this._classProperties.forEach((function(r,n){var o=e._attributeNameForProperty(n,r);void 0!==o&&(e._attributeToPropertyMap.set(o,n),t.push(o))})),t}},{key:"_ensureClassProperties",value:function(){var e=this;if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;var t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach((function(t,r){return e._classProperties.set(r,t)}))}}},{key:"createProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:un;if(this._ensureClassProperties(),this._classProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){var r="symbol"===typeof e?Symbol():"__".concat(e),n=this.getPropertyDescriptor(e,r,t);void 0!==n&&Object.defineProperty(this.prototype,e,n)}}},{key:"getPropertyDescriptor",value:function(e,t,r){return{get:function(){return this[t]},set:function(n){var o=this[e];this[t]=n,this.requestUpdateInternal(e,o,r)},configurable:!0,enumerable:!0}}},{key:"getPropertyOptions",value:function(e){return this._classProperties&&this._classProperties.get(e)||un}},{key:"finalize",value:function(){var e=Object.getPrototypeOf(this);if(e.hasOwnProperty(dn)||e.finalize(),this[dn]=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){var t,r=this.properties,n=S([].concat(d(Object.getOwnPropertyNames(r)),d("function"===typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(r):[])));try{for(n.s();!(t=n.n()).done;){var o=t.value;this.createProperty(o,r[o])}}catch(i){n.e(i)}finally{n.f()}}}},{key:"_attributeNameForProperty",value:function(e,t){var r=t.attribute;return!1===r?void 0:"string"===typeof r?r:"string"===typeof e?e.toLowerCase():void 0}},{key:"_valueHasChanged",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ln;return r(e,t)}},{key:"_propertyValueFromAttribute",value:function(e,t){var r=t.type,n=t.converter||cn,o="function"===typeof n?n:n.fromAttribute;return o?o(e,r):e}},{key:"_propertyValueToAttribute",value:function(e,t){if(void 0!==t.reflect){var r=t.type,n=t.converter;return(n&&n.toAttribute||cn.toAttribute)(e,r)}}}]),r}(_(HTMLElement));pn[dn]=!0;var fn=function(e){return function(t){return"function"===typeof t?function(e,t){return window.customElements.define(e,t),t}(e,t):function(e,t){return{kind:t.kind,elements:t.elements,finisher:function(t){window.customElements.define(e,t)}}}(e,t)}};function hn(e){return function(t,r){return void 0!==r?function(e,t,r){t.constructor.createProperty(r,e)}(e,t,r):function(e,t){return"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?Object.assign(Object.assign({},t),{finisher:function(r){r.createProperty(t.key,e)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer:function(){"function"===typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher:function(r){r.createProperty(t.key,e)}}}(e,t)}}function gn(e){return hn({attribute:!1,hasChanged:null===e||void 0===e?void 0:e.hasChanged})}var vn=function(e){return gn(e)};var mn=Element.prototype;mn.msMatchesSelector||mn.webkitMatchesSelector;var bn=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,yn=Symbol(),kn=function(){function e(t,r){if(p(this,e),r!==yn)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}return v(e,[{key:"styleSheet",get:function(){return void 0===this._styleSheet&&(bn?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}},{key:"toString",value:function(){return this.cssText}}]),e}(),wn=function(e){if(e instanceof kn)return e.cssText;if("number"===typeof e)return e;throw new Error("Value passed to 'css' function must be a 'css' function result: ".concat(e,". Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security."))},xn=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=r.reduce((function(t,r,n){return t+wn(r)+e[n+1]}),e[0]);return new kn(o,yn)};(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");var Cn={},Tn=function(e){b(r,e);var t=C(r);function r(){return p(this,r),t.apply(this,arguments)}return v(r,[{key:"initialize",value:function(){Ot(y(r.prototype),"initialize",this).call(this),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}},{key:"createRenderRoot",value:function(){return this.attachShadow(this.constructor.shadowRootOptions)}},{key:"adoptStyles",value:function(){var e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?bn?this.renderRoot.adoptedStyleSheets=e.map((function(e){return e instanceof CSSStyleSheet?e:e.styleSheet})):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map((function(e){return e.cssText})),this.localName))}},{key:"connectedCallback",value:function(){Ot(y(r.prototype),"connectedCallback",this).call(this),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}},{key:"update",value:function(e){var t=this,n=this.render();Ot(y(r.prototype),"update",this).call(this,e),n!==Cn&&this.constructor.render(n,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach((function(e){var r=document.createElement("style");r.textContent=e.cssText,t.renderRoot.appendChild(r)})))}},{key:"render",value:function(){return Cn}}],[{key:"getStyles",value:function(){return this.styles}},{key:"_getUniqueStyles",value:function(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_styles",this))){var e=this.getStyles();if(Array.isArray(e)){var t=function e(t,r){return t.reduceRight((function(t,r){return Array.isArray(r)?e(r,t):(t.add(r),t)}),r)}(e,new Set),r=[];t.forEach((function(e){return r.unshift(e)})),this._styles=r}else this._styles=void 0===e?[]:[e];this._styles=this._styles.map((function(e){if(e instanceof CSSStyleSheet&&!bn){var t=Array.prototype.slice.call(e.cssRules).reduce((function(e,t){return e+t.cssText}),"");return new kn(String(t),yn)}return e}))}}}]),r}(pn);Tn.finalized=!0,Tn.render=function(e,t,r){if(!r||"object"!==typeof r||!r.scopeName)throw new Error("The `scopeName` option is required.");var n=r.scopeName,o=Xr.has(t),i=rn&&11===t.nodeType&&!!t.host,a=i&&!an.has(n),s=a?document.createDocumentFragment():t;if(function(e,t,r){var n=Xr.get(t);void 0===n&&(gr(t,t.firstChild),Xr.set(t,n=new qr(Object.assign({templateFactory:Jr},r))),n.appendInto(t)),n.setValue(e),n.commit()}(e,s,Object.assign({templateFactory:nn(n)},r)),a){var c=Xr.get(s);Xr.delete(s);var l=c.value instanceof Dr?c.value.template:void 0;sn(n,s,l),gr(t,t.firstChild),t.appendChild(s),Xr.set(t,c)}!o&&i&&window.ShadyCSS.styleElement(t.host)},Tn.shadowRootOptions={mode:"open"};var _n,Sn,In=function(){function e(){p(this,e),this.eventHandlers=[]}return v(e,[{key:"fire",value:function(e){var t,r=S(this.eventHandlers);try{for(r.s();!(t=r.n()).done;){(0,t.value)(e)}}catch(n){r.e(n)}finally{r.f()}}},{key:"add",value:function(e){this.eventHandlers.push(e)}},{key:"remove",value:function(e){for(var t=0;t<this.eventHandlers.length;t++)this.eventHandlers[t]===e&&(this.eventHandlers.splice(t,1),t--)}}]),e}(),En=function(){function e(){p(this,e),this.isMultipleAccountDisabled=!0,this._loginChangedDispatcher=new In,this._activeAccountChangedDispatcher=new In,this._isIncrementalConsentDisabled=!1,this._state=Sn.Loading}return v(e,[{key:"state",get:function(){return this._state}},{key:"isIncrementalConsentDisabled",get:function(){return this._isIncrementalConsentDisabled},set:function(e){this._isIncrementalConsentDisabled=e}},{key:"name",get:function(){return"MgtIProvider"}},{key:"setState",value:function(e){e!==this._state&&(this._state=e,this._loginChangedDispatcher.fire({}))}},{key:"onStateChanged",value:function(e){this._loginChangedDispatcher.add(e)}},{key:"removeStateChangedHandler",value:function(e){this._loginChangedDispatcher.remove(e)}},{key:"setActiveAccount",value:function(e){this.fireActiveAccountChanged()}},{key:"onActiveAccountChanged",value:function(e){this._activeAccountChangedDispatcher.add(e)}},{key:"removeActiveAccountChangedHandler",value:function(e){this._activeAccountChangedDispatcher.remove(e)}},{key:"fireActiveAccountChanged",value:function(){this._activeAccountChangedDispatcher.fire({})}},{key:"getAccessTokenForScopes",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.getAccessToken({scopes:t})}}]),e}();!function(e){e[e.Popup=0]="Popup",e[e.Redirect=1]="Redirect"}(_n||(_n={})),function(e){e[e.Loading=0]="Loading",e[e.SignedOut=1]="SignedOut",e[e.SignedIn=2]="SignedIn"}(Sn||(Sn={}));var An,Rn=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Pn=function(){function e(){p(this,e)}return v(e,null,[{key:"globalProvider",get:function(){return this._globalProvider},set:function(e){e!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),e&&(e.onStateChanged(this.handleProviderStateChanged),e.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=e,this._eventDispatcher.fire(An.ProviderChanged))}},{key:"onProviderUpdated",value:function(e){this._eventDispatcher.add(e)}},{key:"removeProviderUpdatedListener",value:function(e){this._eventDispatcher.remove(e)}},{key:"onActiveAccountChanged",value:function(e){this._activeAccountChangedDispatcher.add(e)}},{key:"removeActiveAccountChangedListener",value:function(e){this._activeAccountChangedDispatcher.remove(e)}},{key:"me",value:function(){return Rn(this,void 0,void 0,Ze().mark((function e(){var t,r;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._me){e.next=12;break}if(!(t=this.client)){e.next=12;break}return e.prev=3,e.next=6,t.api("me").get();case 6:(r=e.sent)&&r.id&&(this._me=r),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(3);case 12:return e.abrupt("return",this._me);case 13:case"end":return e.stop()}}),e,this,[[3,10]])})))}},{key:"client",get:function(){return e.globalProvider&&e.globalProvider.state===Sn.SignedIn?e.globalProvider.graph.client:null}},{key:"handleProviderStateChanged",value:function(){e.globalProvider&&e.globalProvider.state===Sn.SignedIn||(e._me=null),e._eventDispatcher.fire(An.ProviderStateChanged)}},{key:"handleActiveAccountChanged",value:function(){e._activeAccountChangedDispatcher.fire(null)}}]),e}();Pn._eventDispatcher=new In,Pn._activeAccountChangedDispatcher=new In,function(e){e[e.ProviderChanged=0]="ProviderChanged",e[e.ProviderStateChanged=1]="ProviderStateChanged"}(An||(An={}));var On=function(){function e(){p(this,e)}return v(e,null,[{key:"strings",get:function(){return this._strings},set:function(e){this._strings=e,this._stringsEventDispatcher.fire(null)}},{key:"getDocumentDirection",value:function(){var e,t;return(null===(e=document.body)||void 0===e?void 0:e.getAttribute("dir"))||(null===(t=document.documentElement)||void 0===t?void 0:t.getAttribute("dir"))}},{key:"onStringsUpdated",value:function(e){this._stringsEventDispatcher.add(e)}},{key:"removeOnStringsUpdated",value:function(e){this._stringsEventDispatcher.remove(e)}},{key:"onDirectionUpdated",value:function(e){this._directionEventDispatcher.add(e),this.initDirection()}},{key:"removeOnDirectionUpdated",value:function(e){this._directionEventDispatcher.remove(e)}},{key:"initDirection",value:function(){var e=this;if(!this._isDirectionInit){this._isDirectionInit=!0,this.mutationObserver=new MutationObserver((function(t){t.forEach((function(t){"dir"==t.attributeName&&e._directionEventDispatcher.fire(null)}))}));var t={attributes:!0,attributeFilter:["dir"]};this.mutationObserver.observe(document.body,t),this.mutationObserver.observe(document.documentElement,t)}}},{key:"updateStringsForTag",value:function(e,t){if((e=e.toLowerCase()).startsWith("mgt-")&&(e=e.substring(4)),this._strings&&t){for(var r=0,n=Object.entries(t);r<n.length;r++){var o=n[r];this._strings[o[0]]&&(t[o[0]]=this._strings[o[0]])}if(this._strings._components&&this._strings._components[e])for(var i=this._strings._components[e],a=0,s=Object.keys(i);a<s.length;a++){var c=s[a];t[c]&&(t[c]=i[c])}}return t}}]),e}();On._stringsEventDispatcher=new In,On._directionEventDispatcher=new In,On._isDirectionInit=!1;var Nn,Dn=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Ln=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Mn=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};!function(e){e.mobile="",e.tablet="tablet",e.desktop="desktop"}(Nn||(Nn={}));var Un=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this)).direction="ltr",e._isLoadingState=!1,e._isFirstUpdated=!1,e.handleLocalizationChanged=e.handleLocalizationChanged.bind(w(e)),e.handleDirectionChanged=e.handleDirectionChanged.bind(w(e)),e.handleProviderUpdates=e.handleProviderUpdates.bind(w(e)),e.handleActiveAccountUpdates=e.handleActiveAccountUpdates.bind(w(e)),e.handleDirectionChanged(),e.handleLocalizationChanged(),e}return v(r,[{key:"mediaQuery",get:function(){return this.offsetWidth<768?Nn.mobile:this.offsetWidth<1200?Nn.tablet:Nn.desktop}},{key:"isLoadingState",get:function(){return this._isLoadingState}},{key:"isFirstUpdated",get:function(){return this._isFirstUpdated}},{key:"strings",get:function(){return{}}},{key:"connectedCallback",value:function(){Ot(y(r.prototype),"connectedCallback",this).call(this),On.onStringsUpdated(this.handleLocalizationChanged),On.onDirectionUpdated(this.handleDirectionChanged)}},{key:"disconnectedCallback",value:function(){Ot(y(r.prototype),"disconnectedCallback",this).call(this),On.removeOnStringsUpdated(this.handleLocalizationChanged),On.removeOnDirectionUpdated(this.handleDirectionChanged),Pn.removeProviderUpdatedListener(this.handleProviderUpdates),Pn.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}},{key:"firstUpdated",value:function(e){Ot(y(r.prototype),"firstUpdated",this).call(this,e),this._isFirstUpdated=!0,Pn.onProviderUpdated(this.handleProviderUpdates),Pn.onActiveAccountChanged(this.handleActiveAccountUpdates),this.requestStateUpdate()}},{key:"loadState",value:function(){return Promise.resolve()}},{key:"clearState",value:function(){}},{key:"fireCustomEvent",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=new CustomEvent(e,{bubbles:r,cancelable:n,detail:t});return this.dispatchEvent(o)}},{key:"updated",value:function(e){Ot(y(r.prototype),"updated",this).call(this,e);var t=new CustomEvent("updated",{bubbles:!0,cancelable:!0});this.dispatchEvent(t)}},{key:"requestStateUpdate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Mn(this,void 0,void 0,Ze().mark((function t(){var r,n,o=this;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isFirstUpdated){t.next=2;break}return t.abrupt("return");case 2:if(!this.isLoadingState||e){t.next=5;break}return t.next=5,this._currentLoadStatePromise;case 5:if(r=Pn.globalProvider){t.next=8;break}return t.abrupt("return",Promise.resolve());case 8:if(r.state!==Sn.SignedOut){t.next=13;break}return this.clearState(),t.abrupt("return");case 13:if(r.state!==Sn.Loading){t.next=17;break}return t.abrupt("return",Promise.resolve());case 17:n=new Promise((function(t,r){return Mn(o,void 0,void 0,Ze().mark((function o(){return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,this.setLoadingState(!0),this.fireCustomEvent("loadingInitiated"),o.next=5,this.loadState();case 5:this.setLoadingState(!1),this.fireCustomEvent("loadingCompleted"),t(),o.next=16;break;case 10:o.prev=10,o.t0=o.catch(0),this.clearState(),this.setLoadingState(!1),this.fireCustomEvent("loadingFailed"),r(o.t0);case 16:return o.abrupt("return",this._currentLoadStatePromise=this.isLoadingState&&this._currentLoadStatePromise&&e?this._currentLoadStatePromise.then((function(){return n})):n);case 17:case"end":return o.stop()}}),o,this,[[0,10]])})))}));case 18:case"end":return t.stop()}}),t,this)})))}},{key:"setLoadingState",value:function(e){this._isLoadingState!==e&&(this._isLoadingState=e,this.requestUpdate("isLoadingState"))}},{key:"handleProviderUpdates",value:function(){this.requestStateUpdate()}},{key:"handleActiveAccountUpdates",value:function(){return Mn(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.clearState(),this.requestStateUpdate();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"handleLocalizationChanged",value:function(){On.updateStringsForTag(this.tagName,this.strings),this.requestUpdate()}},{key:"handleDirectionChanged",value:function(){this.direction=On.getDocumentDirection()}}]),r}(Tn);Dn([gn(),Ln("design:type",Object)],Un.prototype,"direction",void 0);var Fn=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},zn=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Hn=function(e){b(r,e);var t=C(r);function r(){return p(this,r),t.apply(this,arguments)}return v(r,[{key:"provider",get:function(){return this._provider},set:function(e){var t=this;this._provider&&this.provider.removeStateChangedHandler((function(){return t.stateChangedHandler})),this._provider=e,this._provider&&this.provider.onStateChanged((function(){return t.stateChangedHandler}))}},{key:"isAvailable",get:function(){return!0}},{key:"firstUpdated",value:function(e){Ot(y(r.prototype),"firstUpdated",this).call(this,e);var t=!1;if(this.dependsOn)for(var n=this.dependsOn;n;){if(n.isAvailable){t=!0;break}n=n.dependsOn}!t&&this.isAvailable&&this.initializeProvider()}},{key:"initializeProvider",value:function(){}},{key:"stateChangedHandler",value:function(){this.fireCustomEvent("onStateChanged",this.provider.state)}}]),r}(Un);function Bn(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function qn(e,t){return jn(e,t,new Set)}function jn(e,t,r){var n=Object.prototype.toString.call(e),o=Object.prototype.toString.call(t);if(n===o&&"[object Object]"===n&&!r.has(e)){for(var i in r.add(e),e)if(!jn(e[i],t[i],r))return!1;for(var a in t)if(!e.hasOwnProperty(a))return!1;return!0}if(n===o&&"[object Array]"===n&&!r.has(e)){if(r.add(e),e.length!==t.length)return!1;for(var s=0;s<e.length;s++)if(!jn(e[s],t[s],r))return!1;return!0}return e===t}function Gn(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;if(0===e.length)return!0;var r,n=new Set(e),o=S(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(!n.has(i))return!1}}catch(a){o.e(a)}finally{o.f()}return!0}Fn([hn({attribute:"depends-on",converter:function(e){return document.querySelector(e)},type:String}),zn("design:type",Hn)],Hn.prototype,"dependsOn",void 0);var Vn,Kn=function(){function e(){p(this,e)}return v(e,null,[{key:"renderTemplate",value:function(e,t,r){var n;if(t.$parentTemplateContext&&(r=Object.assign(Object.assign({},r),{$parent:t.$parentTemplateContext})),t.content&&t.content.childNodes.length){var o=t.content.cloneNode(!0);n=this.renderNode(o,e,r)}else if(t.childNodes.length){for(var i=document.createElement("div"),a=0;a<t.childNodes.length;a++)i.appendChild(this.simpleCloneNode(t.childNodes[a]));n=this.renderNode(i,e,r)}n&&e.appendChild(n)}},{key:"setBindingSyntax",value:function(e,t){this._startExpression=e,this._endExpression=t;var r=this.escapeRegex(this._startExpression),n=this.escapeRegex(this._endExpression);this._expression=new RegExp("".concat(r,"\\s*([$\\w\\.,'\"\\s()\\[\\]]+)\\s*").concat(n),"g")}},{key:"globalContext",get:function(){return this._globalContext}},{key:"expression",get:function(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}},{key:"escapeRegex",value:function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},{key:"simpleCloneNode",value:function(e){if(!e)return null;for(var t=e.cloneNode(!1),r=0;r<e.childNodes.length;r++){var n=this.simpleCloneNode(e.childNodes[r]);n&&t.appendChild(n)}return t}},{key:"expandExpressionsAsString",value:function(e,t){var r=this;return e.replace(this.expression,(function(e,n){var o=r.evalInContext(n||r.trimExpression(e),t);return o?"object"===typeof o?JSON.stringify(o):o.toString():""}))}},{key:"renderNode",value:function(e,t,r){var n=this;if("#text"===e.nodeName)return e.textContent=this.expandExpressionsAsString(e.textContent,r),e;if("TEMPLATE"===e.nodeName)return e.$parentTemplateContext=r,e;var o=e;if(o.attributes)for(var i=0;i<o.attributes.length;i++){var a=o.attributes[i];if("data-props"===a.name){var s,c=S(this.trimExpression(a.value).split(","));try{var l=function(){var e=s.value.trim().split(":");if(2===e.length){var i=e[0].trim(),a=n.evalInContext(e[1].trim(),r);i.startsWith("@")?"function"===typeof a&&o.addEventListener(i.substring(1),(function(e){return a(e,r,t)})):o[i]=a}};for(c.s();!(s=c.n()).done;)l()}catch(N){c.e(N)}finally{c.f()}}else o.setAttribute(a.name,this.expandExpressionsAsString(a.value,r))}for(var u=[],d=[],p=!1,f=0;f<e.childNodes.length;f++){var h=e.childNodes[f],g=h,v=!1;if(g.dataset){var m=!1;if(g.dataset.if){var b=g.dataset.if;this.evalBoolInContext(this.trimExpression(b),r)?(g.removeAttribute("data-if"),p=!0,v=!0):(d.push(g),m=!0)}else"undefined"!==typeof g.dataset.else&&(p?(d.push(g),m=!0):g.removeAttribute("data-else"));g.dataset.for&&!m?u.push(g):m||this.renderNode(h,t,r)}else this.renderNode(h,t,r);v||"#text"===h.nodeName||(p=!1)}for(var y=0,k=d;y<k.length;y++){var w=k[y];o.removeChild(w)}for(var x=0;x<u.length;x++){var C=u[x],T=C.dataset.for,_=this.trimExpression(T).split(/\s(in|of)\s/i);if(3===_.length){var I=_[0].trim(),E=_[2].trim(),A=this.evalInContext(E,r);if(Array.isArray(A)){C.removeAttribute("data-for");for(var R=0;R<A.length;R++){var P=Object.assign({$index:R},r);P[I]=A[R];var O=C.cloneNode(!0);this.renderNode(O,t,P),o.insertBefore(O,C)}}o.removeChild(C)}}return e}},{key:"evalBoolInContext",value:function(e,t){return t=Object.assign(Object.assign({},t),this.globalContext),new Function("with(this) { return !!("+e+")}").call(t)}},{key:"evalInContext",value:function(e,t){t=Object.assign(Object.assign({},t),this.globalContext);var r,n=new Function("with(this) { return "+e+";}");try{r=n.call(t)}catch(o){}return r}},{key:"trimExpression",value:function(e){return(e=e.trim()).startsWith(this._startExpression)&&e.endsWith(this._endExpression)&&(e=(e=e.substr(this._startExpression.length,e.length-this._startExpression.length-this._endExpression.length)).trim()),e}}]),e}();Kn._globalContext={};var Qn=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Wn=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Jn=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this)).templates={},e._renderedSlots=!1,e._renderedTemplates={},e._slotNamesAddedDuringRender=[],e.templateContext=e.templateContext||{},e}return v(r,[{key:"update",value:function(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],Ot(y(r.prototype),"update",this).call(this,e)}},{key:"updated",value:function(e){Ot(y(r.prototype),"updated",this).call(this,e),this.removeUnusedSlottedElements()}},{key:"renderTemplate",value:function(e,t,r){if(!this.hasTemplate(e))return null;r=r||e,this._slotNamesAddedDuringRender.push(r),this._renderedSlots=!0;var n=en(Vn||(Vn=Bn(["\n      <slot name=","></slot>\n    "])),r),o=Object.assign(Object.assign({},t),this.templateContext);if(this._renderedTemplates.hasOwnProperty(r)){var i=this._renderedTemplates[r],a=i.context,s=i.slot;if(qn(a,o))return n;this.removeChild(s)}var c=document.createElement("div");return c.slot=r,c.dataset.generated="template",Kn.renderTemplate(c,this.templates[e],o),this.appendChild(c),this._renderedTemplates[r]={context:o,slot:c},this.fireCustomEvent("templateRendered",{templateType:e,context:o,element:c}),n}},{key:"hasTemplate",value:function(e){return this.templates&&this.templates[e]}},{key:"getTemplates",value:function(){for(var e={},t=0;t<this.children.length;t++){var r=this.children[t];if("TEMPLATE"===r.nodeName){var n=r;n.dataset.type?e[n.dataset.type]=n:e.default=n,n.templateOrder=t}}return e}},{key:"removeUnusedSlottedElements",value:function(){if(this._renderedSlots){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.dataset&&t.dataset.generated&&!this._slotNamesAddedDuringRender.includes(t.slot)&&(this.removeChild(t),delete this._renderedTemplates[t.slot],e--)}this._renderedSlots=!1}}}]),r}(Un);Qn([hn({attribute:!1}),Wn("design:type",Object)],Jn.prototype,"templateContext",void 0);var Yn,Xn;var Zn=new WeakMap,$n=new WeakMap,eo=new WeakMap,to=new WeakMap,ro=new WeakMap;var no={get:function(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return $n.get(e);if("objectStoreNames"===t)return e.objectStoreNames||eo.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ao(e[t])},set:function(e,t,r){return e[t]=r,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function oo(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Xn||(Xn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.apply(so(this),r),ao(Zn.get(this))}:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return ao(e.apply(so(this),r))}:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var i=e.call.apply(e,[so(this),t].concat(n));return eo.set(i,t.sort?t.sort():[t]),ao(i)}}function io(e){return"function"===typeof e?oo(e):(e instanceof IDBTransaction&&function(e){if(!$n.has(e)){var t=new Promise((function(t,r){var n=function(){e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=function(){t(),n()},i=function(){r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));$n.set(e,t)}}(e),t=e,(Yn||(Yn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,no):e);var t}function ao(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,r){var n=function(){e.removeEventListener("success",o),e.removeEventListener("error",i)},o=function(){t(ao(e.result)),n()},i=function(){r(e.error),n()};e.addEventListener("success",o),e.addEventListener("error",i)}));return t.then((function(t){t instanceof IDBCursor&&Zn.set(t,e)})).catch((function(){})),ro.set(t,e),t}(e);if(to.has(e))return to.get(e);var t=io(e);return t!==e&&(to.set(e,t),ro.set(t,e)),t}var so=function(e){return ro.get(e)};var co=["get","getKey","getAll","getAllKeys","count"],lo=["put","add","delete","clear"],uo=new Map;function po(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(uo.get(t))return uo.get(t);var r=t.replace(/FromIndex$/,""),n=t!==r,o=lo.includes(r);if(r in(n?IDBIndex:IDBObjectStore).prototype&&(o||co.includes(r))){var i=function(){var e=et(Ze().mark((function e(t){var i,a,s,c,l,u,d=arguments;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=this.transaction(t,o?"readwrite":"readonly"),s=a.store,c=d.length,l=new Array(c>1?c-1:0),u=1;u<c;u++)l[u-1]=d[u];return n&&(s=s.index(l.shift())),e.next=6,Promise.all([(i=s)[r].apply(i,l),o&&a.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return uo.set(t,i),i}}}no=function(e){return Xe(Xe({},e),{},{get:function(t,r,n){return po(t,r)||e.get(t,r,n)},has:function(t,r){return!!po(t,r)||e.has(t,r)}})}(no);var fo=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},ho=function(){function e(){p(this,e)}return v(e,null,[{key:"getCache",value:function(e,t){var r="".concat(e.name,"/").concat(t);return this.isInitialized||this.init(),this.cacheStore.has(t)||this.cacheStore.set(r,new go(e,t)),this.cacheStore.get(r)}},{key:"clearCaches",value:function(){this.cacheStore.forEach((function(e){return indexedDB.deleteDatabase(e.getDBName())}))}},{key:"config",get:function(){return this.cacheConfig}},{key:"init",value:function(){var e,t=this;Pn.globalProvider&&(e=Pn.globalProvider.state),Pn.onProviderUpdated((function(){e===Sn.SignedIn&&Pn.globalProvider.state===Sn.SignedOut&&t.clearCaches(),e=Pn.globalProvider.state})),this.isInitialized=!0}}]),e}();ho.cacheStore=new Map,ho.isInitialized=!1,ho.cacheConfig={defaultInvalidationPeriod:36e5,groups:{invalidationPeriod:null,isEnabled:!0},isEnabled:!0,people:{invalidationPeriod:null,isEnabled:!0},photos:{invalidationPeriod:null,isEnabled:!0},presence:{invalidationPeriod:3e5,isEnabled:!0},users:{invalidationPeriod:null,isEnabled:!0},response:{invalidationPeriod:null,isEnabled:!0},files:{invalidationPeriod:null,isEnabled:!0},fileLists:{invalidationPeriod:null,isEnabled:!0}};var go=function(){function e(t,r){if(p(this,e),!(r in t.stores))throw Error('"store" must be defined in the "schema"');this.schema=t,this.store=r}return v(e,[{key:"getValue",value:function(e){return fo(this,void 0,void 0,Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.indexedDB){t.next=2;break}return t.abrupt("return",null);case 2:return t.prev=2,t.next=5,this.getDb();case 5:return t.abrupt("return",t.sent.get(this.store,e));case 8:return t.prev=8,t.t0=t.catch(2),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,this,[[2,8]])})))}},{key:"putValue",value:function(e,t){return fo(this,void 0,void 0,Ze().mark((function r(){return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(window.indexedDB){r.next=2;break}return r.abrupt("return");case 2:return r.prev=2,r.next=5,this.getDb();case 5:return r.next=7,r.sent.put(this.store,Object.assign(Object.assign({},t),{timeCached:Date.now()}),e);case 7:r.next=12;break;case 9:return r.prev=9,r.t0=r.catch(2),r.abrupt("return");case 12:case"end":return r.stop()}}),r,this,[[2,9]])})))}},{key:"clearStore",value:function(){return fo(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.indexedDB){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.getDb();case 5:e.sent.clear(this.store),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return");case 11:case"end":return e.stop()}}),e,this,[[2,8]])})))}},{key:"getDBName",value:function(){return"mgt-".concat(this.schema.name)}},{key:"getDb",value:function(){var e=this;return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.blocked,o=r.upgrade,i=r.blocking,a=r.terminated,s=indexedDB.open(e,t),c=ao(s);return o&&s.addEventListener("upgradeneeded",(function(e){o(ao(s.result),e.oldVersion,e.newVersion,ao(s.transaction))})),n&&s.addEventListener("blocked",(function(){return n()})),c.then((function(e){a&&e.addEventListener("close",(function(){return a()})),i&&e.addEventListener("versionchange",(function(){return i()}))})).catch((function(){})),c}(this.getDBName(),this.schema.version,{upgrade:function(t,r,n,o){for(var i in e.schema.stores)e.schema.stores.hasOwnProperty(i)&&(t.objectStoreNames.contains(i)||t.createObjectStore(i))}})}}]),e}(),vo=function(){function e(){p(this,e)}return v(e,null,[{key:"microsoftTeamsLib",get:function(){return this._microsoftTeamsLib||window.microsoftTeams},set:function(e){this._microsoftTeamsLib=e}},{key:"isAvailable",get:function(){return!!this.microsoftTeamsLib&&(!(window.parent!==window.self||!window.nativeInterface)||("embedded-page-container"===window.name||"extension-tab-frame"===window.name))}},{key:"executeDeepLink",value:function(e,t){var r=this.microsoftTeamsLib;r.initialize(),r.executeDeepLink(e,t)}}]),e}(),mo=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},bo=function(){function e(){p(this,e)}return v(e,[{key:"value",get:function(){return this._value}},{key:"hasNext",get:function(){return!!this._nextLink}},{key:"next",value:function(){return mo(this,void 0,void 0,Ze().mark((function e(){var t,r;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._nextLink){e.next=9;break}return t=this._nextLink.split(this._version)[1],e.next=4,this._graph.api(t).version(this._version).get();case 4:if(!((r=e.sent)&&r.value&&r.value.length)){e.next=9;break}return this._value=this._value.concat(r.value),this._nextLink=r["@odata.nextLink"],e.abrupt("return",r.value);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this)})))}}],[{key:"create",value:function(t,r,n){return mo(this,void 0,void 0,Ze().mark((function o(){var i,a;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r.get();case 2:if(!(i=o.sent)||!i.value){o.next=10;break}return(a=new e)._graph=t,a._value=i.value,a._nextLink=i["@odata.nextLink"],a._version=n||t.version,o.abrupt("return",a);case 10:return o.abrupt("return",null);case 11:case"end":return o.stop()}}),o)})))}},{key:"createFromValue",value:function(t,r,n){var o=new e;return o._graph=t,o._value=r,o._nextLink=n||null,o._version=t.version,o||null}}]),e}(),yo=function(){function e(){p(this,e),this.session=window.sessionStorage}return v(e,[{key:"setItem",value:function(e,t){this.session.setItem(e,t)}},{key:"getItem",value:function(e){return this.session.getItem(e)}},{key:"clear",value:function(){this.session.clear()}}]),e}();var ko,wo=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},xo=function(e){b(r,e);var t=C(r);function r(e){p(this,r);var n=[new yt(e),new xt(new wt),new At,new Co,new kt];return t.call(this,Yt.initWithMiddleware({middleware:er.apply(void 0,n)}))}return v(r,[{key:"forComponent",value:function(e){return this}}]),r}(ur),Co=function(){function e(){p(this,e),function(e){var t;try{t=window[e];var r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(n){return n instanceof DOMException&&(22===n.code||1014===n.code||"QuotaExceededError"===n.name||"NS_ERROR_DOM_QUOTA_REACHED"===n.name)&&t&&0!==t.length}}("sessionStorage")&&(this._session=new yo)}return v(e,[{key:"execute",value:function(e){return wo(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getBaseUrl();case 3:r=t.sent,e.request=r+encodeURIComponent(e.request),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:return t.next=11,this._nextMiddleware.execute(e);case 11:return t.abrupt("return",t.sent);case 12:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"setNext",value:function(e){this._nextMiddleware=e}},{key:"getBaseUrl",value:function(){var e,t;return wo(this,void 0,void 0,Ze().mark((function r(){var n,o;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this._baseUrl){r.next=20;break}if(!(n=null===(e=this._session)||void 0===e?void 0:e.getItem("endpointURL"))){r.next=6;break}this._baseUrl=n,r.next=20;break;case 6:return r.prev=6,r.next=9,fetch("https://cdn.graph.office.net/en-us/graph/api/proxy/endpoint");case 9:return o=r.sent,r.next=12,o.json();case 12:r.t0=r.sent,this._baseUrl=r.t0+"?url=",r.next=19;break;case 16:r.prev=16,r.t1=r.catch(6),this._baseUrl="https://proxy.apisandbox.msdn.microsoft.com/svc?url=";case 19:null===(t=this._session)||void 0===t||t.setItem("endpointURL",this._baseUrl);case 20:return r.abrupt("return",this._baseUrl);case 21:case"end":return r.stop()}}),r,this,[[6,16]])})))}}]),e}(),To=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},_o=function(e){b(r,e);var t=C(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return p(this,r),(e=t.call(this)).graph=new xo(w(e)),n?e.setState(Sn.SignedIn):e.setState(Sn.SignedOut),e}return v(r,[{key:"login",value:function(){return To(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState(Sn.Loading),e.next=3,new Promise((function(e){return setTimeout(e,3e3)}));case 3:this.setState(Sn.SignedIn);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"logout",value:function(){return To(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState(Sn.Loading),e.next=3,new Promise((function(e){return setTimeout(e,3e3)}));case 3:this.setState(Sn.SignedOut);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"getAccessToken",value:function(){return Promise.resolve("{token:https://graph.microsoft.com/}")}},{key:"name",get:function(){return"MgtMockProvider"}}]),r}(En),So=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Io=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Eo=function(e){b(r,e);var t=C(r);function r(){return p(this,r),t.apply(this,arguments)}return v(r,[{key:"initializeProvider",value:function(){Pn.globalProvider=new _o(!this.signedOut)}}]),r}(Hn);So([hn({attribute:"signed-out",type:Boolean}),Io("design:type",Object)],Eo.prototype,"signedOut",void 0),Eo=So([fn("mgt-mock-provider")],Eo);var Ao=[xn(ko||(ko=Bn(["\n.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--selected-person-background-color:#f3f2f1}.mgt-dark{--selected-person-background-color:#4f4f4f}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{background-color:#fff}.mgt-dark{background-color:#424242}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-list-background-color:#ffffff;--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#4a4a4a;--file-upload-dialog-content-color:white;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}\n"])))],Ro=document.createElement("style");Ro.type="text/css",Ro.appendChild(document.createTextNode("\n@font-face {\n    font-family: 'FabricMDL2Icons';\n    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format(\"woff\"),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format(\"truetype\");;\n}\n")),document.head.appendChild(Ro);var Po=document.createElement("style");Po.innerHTML=Ao.toString(),document.head.appendChild(Po);var Oo=function(){function e(t){p(this,e),this.classes=new Set,this.changed=!1,this.element=t;var r,n=S((t.getAttribute("class")||"").split(/\s+/));try{for(n.s();!(r=n.n()).done;){var o=r.value;this.classes.add(o)}}catch(i){n.e(i)}finally{n.f()}}return v(e,[{key:"add",value:function(e){this.classes.add(e),this.changed=!0}},{key:"remove",value:function(e){this.classes.delete(e),this.changed=!0}},{key:"commit",value:function(){if(this.changed){var e="";this.classes.forEach((function(t){return e+=t+" "})),this.element.setAttribute("class",e)}}}]),e}(),No=new WeakMap,Do=Rr((function(e){return function(t){if(!(t instanceof Br)||t instanceof Vr||"class"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");var r=t.committer,n=r.element,o=No.get(t);void 0===o&&(n.setAttribute("class",r.strings.join(" ")),No.set(t,o=new Set));var i=n.classList||new Oo(n);for(var a in o.forEach((function(t){t in e||(i.remove(t),o.delete(t))})),e){var s=e[a];s!=o.has(a)&&(s?(i.add(a),o.add(a)):(i.remove(a),o.delete(a)))}"function"===typeof i.commit&&i.commit()}}));function Lo(e){var t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=r)return e.toLocaleString("default",{hour:"numeric",minute:"numeric"});var n=new Date(r);if(n.setDate(t.getDate()-t.getDay()),e>=n)return e.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});var o=new Date(n);return o.setDate(n.getDate()-7),e>=o?e.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):e.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})}function Mo(e){var t=e.getMonth(),r=e.getDate();return"".concat(function(e){switch(e){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}}(t)," ").concat(r)}function Uo(e,t){var r;return function(){var n=arguments,o=this,i=function(){return e.apply(o,n)};clearTimeout(r),r=setTimeout(i,t)}}function Fo(e){return new Promise((function(t,r){var n=new FileReader;n.onerror=r,n.onload=function(e){t(n.result)},n.readAsDataURL(e)}))}function zo(e){return e.startsWith("[")?e.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString():e}function Ho(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function Bo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var r=1024,n=t<0?0:t,o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,i)).toFixed(n))+" "+o[i]}var qo,jo,Go={name:"presence",stores:{presence:"presence"},version:1},Vo={name:"users",stores:{users:"users",usersQuery:"usersQuery",userFilters:"userFilters"},version:2},Ko={name:"photos",stores:{contacts:"contacts",users:"users",groups:"groups"},version:1},Qo={name:"people",stores:{contacts:"contacts",groupPeople:"groupPeople",peopleQuery:"peopleQuery"},version:2},Wo={name:"groups",stores:{groups:"groups",groupsQuery:"groupsQuery"},version:4},Jo={name:"responses",stores:{responses:"responses"},version:1},Yo={name:"files",stores:{driveFiles:"driveFiles",groupFiles:"groupFiles",siteFiles:"siteFiles",userFiles:"userFiles",insightFiles:"insightFiles",fileQueries:"fileQueries"},version:1},Xo={name:"file-lists",stores:{fileLists:"fileLists",insightfileLists:"insightfileLists"},version:1},Zo=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};!function(e){e[e.any=0]="any",e.person="person",e.group="group"}(qo||(qo={})),function(e){e.any="any",e.user="user",e.contact="contact"}(jo||(jo={}));var $o=function(){return ho.config.people.invalidationPeriod||ho.config.defaultInvalidationPeriod},ei=function(){return ho.config.people.isEnabled&&ho.config.isEnabled};function ti(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:jo.any,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return Zo(this,void 0,void 0,Ze().mark((function i(){var a,s,c,l,u,d,p,f;return Ze().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a="people.read",c="".concat(t,":").concat(r,":").concat(n),!ei()){i.next=14;break}if(s=ho.getCache(Qo,Qo.stores.peopleQuery),!ei()){i.next=10;break}return i.next=7,s.getValue(c);case 7:i.t0=i.sent,i.next=11;break;case 10:i.t0=null;case 11:if(!((l=i.t0)&&$o()>Date.now()-l.timeCached)){i.next=14;break}return i.abrupt("return",l.results.map((function(e){return JSON.parse(e)})));case 14:return u="personType/class eq 'Person'",n!==jo.any&&(n===jo.user?u+="and personType/subclass eq 'OrganizationUser'":u+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),""!==o&&(u+="".concat(u," and ").concat(o)),i.prev=17,p=e.api("/me/people").search('"'+t+'"').top(r).filter(u).middlewareOptions($t(a)),n!==jo.contact&&(p=p.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),i.next=22,p.get();case 22:d=i.sent,ei()&&d&&((f={maxResults:r,results:null}).results=d.value.map((function(e){return JSON.stringify(e)})),s.putValue(c,f)),i.next=28;break;case 26:i.prev=26,i.t1=i.catch(17);case 28:return i.abrupt("return",d?d.value:null);case 29:case"end":return i.stop()}}),i,null,[[17,26]])})))}function ri(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jo.any,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Zo(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l,u;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o="people.read",a=r||"*:".concat(t),!ei()){n.next=9;break}return i=ho.getCache(Qo,Qo.stores.peopleQuery),n.next=6,i.getValue(a);case 6:if(!((s=n.sent)&&$o()>Date.now()-s.timeCached)){n.next=9;break}return n.abrupt("return",s.results.map((function(e){return JSON.parse(e)})));case 9:return"/me/people",c="personType/class eq 'Person'",t!==jo.any&&(t===jo.user?c+="and personType/subclass eq 'OrganizationUser'":c+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),r&&(c+=" and ".concat(r)),n.prev=13,u=e.api("/me/people").middlewareOptions($t(o)).filter(c),t!=jo.contact&&(u=u.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),n.next=18,u.get();case 18:l=n.sent,ei()&&l&&i.putValue(a,{maxResults:10,results:l.value.map((function(e){return JSON.stringify(e)}))}),n.next=24;break;case 22:n.prev=22,n.t0=n.catch(13);case 24:return n.abrupt("return",l?l.value:null);case 25:case"end":return n.stop()}}),n,null,[[13,22]])})))}function ni(e){var t=e,r=e,n=e;return r.mail?zo(r.mail):t.scoredEmailAddresses&&t.scoredEmailAddresses.length?zo(t.scoredEmailAddresses[0].address):n.emailAddresses&&n.emailAddresses.length?zo(n.emailAddresses[0].address):null}function oi(e,t){return Zo(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n="contacts.read",!ei()){r.next=8;break}return o=ho.getCache(Qo,Qo.stores.contacts),r.next=5,o.getValue(t);case 5:if(!((i=r.sent)&&$o()>Date.now()-i.timeCached)){r.next=8;break}return r.abrupt("return",JSON.parse(i.person));case 8:return a="".concat(t.replace(/#/g,"%2523")),r.next=11,e.api("/me/contacts").filter("emailAddresses/any(a:a/address eq '".concat(a,"')")).middlewareOptions($t(n)).get();case 11:return s=r.sent,ei()&&s&&o.putValue(t,{person:JSON.stringify(s.value)}),r.abrupt("return",s?s.value:null);case 14:case"end":return r.stop()}}),r)})))}function ii(e,t,r,n){return Zo(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u,p,f;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(a="".concat(t).concat(r),!ei()){o.next=8;break}return i=ho.getCache(Qo,Qo.stores.peopleQuery),o.next=5,i.getValue(a);case 5:if(!((s=o.sent)&&$o()>Date.now()-s.timeCached)){o.next=8;break}return o.abrupt("return",s.results.map((function(e){return JSON.parse(e)})));case 8:return c=e.api(r).version(t),n&&n.length&&(c=c.middlewareOptions($t.apply(void 0,d(n)))),o.next=12,c.get();case 12:if(!((l=o.sent)&&Array.isArray(l.value)&&l["@odata.nextLink"])){o.next=25;break}1,u=l;case 16:if(!u||!u["@odata.nextLink"]){o.next=25;break}return p=u["@odata.nextLink"].split(t)[1],o.next=21,e.client.api(p).version(t).get();case 21:(u=o.sent)&&u.value&&u.value.length&&(u.value=l.value.concat(u.value),l=u),o.next=16;break;case 25:if(ei()&&l&&(f={results:null},Array.isArray(l.value)?f.results=l.value.map((function(e){return JSON.stringify(e)})):f.results=[JSON.stringify(l)],i.putValue(a,f)),!l){o.next=30;break}return o.abrupt("return",Array.isArray(l.value)?l.value:[l]);case 30:return o.abrupt("return",null);case 31:case"end":return o.stop()}}),o)})))}var ai=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},si=function(){return ho.config.users.invalidationPeriod||ho.config.defaultInvalidationPeriod},ci=function(){return ho.config.users.isEnabled&&ho.config.isEnabled};function li(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return ai(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l,u;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o="/users",a=""===t?"*":t,s={maxResults:r,results:null},!ci()){n.next=10;break}return i=ho.getCache(Vo,Vo.stores.userFilters),n.next=7,i.getValue(a);case 7:if(!((c=n.sent)&&si()>Date.now()-c.timeCached)){n.next=10;break}return n.abrupt("return",c.results.map((function(e){return JSON.parse(e)})));case 10:return l=e.api(o).top(r),t&&l.filter(t),n.prev=12,n.next=15,l.middlewareOptions($t("user.read")).get();case 15:return u=n.sent,ci()&&u&&(s.results=u.value.map((function(e){return JSON.stringify(e)})),i.putValue(t,s)),n.abrupt("return",u.value);case 20:n.prev=20,n.t0=n.catch(12);case 22:case"end":return n.stop()}}),n,null,[[12,20]])})))}function ui(e,t){return ai(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s,c;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!ci()){r.next=10;break}return n=ho.getCache(Vo,Vo.stores.users),r.next=4,n.getValue("me");case 4:if(!((o=r.sent)&&si()>Date.now()-o.timeCached)){r.next=10;break}if(i=JSON.parse(o.user),(a=t?t.filter((function(e){return!Object.keys(i).includes(e)})):null)&&!(a.length<=1)){r.next=10;break}return r.abrupt("return",i);case 10:if(s="me",t&&(s=s+"?$select="+t.toString()),c=e.api(s).middlewareOptions($t("user.read")).get(),!ci()){r.next=22;break}return r.t0=n,r.t1=JSON,r.next=18,c;case 18:r.t2=r.sent,r.t3=r.t1.stringify.call(r.t1,r.t2),r.t4={user:r.t3},r.t0.putValue.call(r.t0,"me",r.t4);case 22:return r.abrupt("return",c);case 23:case"end":return r.stop()}}),r)})))}function di(e,t,r){return ai(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l,u;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o="user.readbasic.all",!ci()){n.next=11;break}return i=ho.getCache(Vo,Vo.stores.users),n.next=5,i.getValue(t);case 5:if(!((a=n.sent)&&si()>Date.now()-a.timeCached)){n.next=11;break}if(s=a.user?JSON.parse(a.user):null,(c=r&&s?r.filter((function(e){return!Object.keys(s).includes(e)})):null)&&!(c.length<=1)){n.next=11;break}return n.abrupt("return",s);case 11:return l="/users/".concat(t),r&&(l=l+"?$select="+r.toString()),n.prev=13,n.next=16,e.api(l).middlewareOptions($t(o)).get();case 16:u=n.sent,n.next=21;break;case 19:n.prev=19,n.t0=n.catch(13);case 21:return ci()&&i.putValue(t,{user:JSON.stringify(u)}),n.abrupt("return",u);case 23:case"end":return n.stop()}}),n,null,[[13,19]])})))}function pi(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return ai(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u,d,p,f,h,g,v,m,b,y,k,w,x,C=this;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(t&&0!==t.length){o.next=2;break}return o.abrupt("return",[]);case 2:i=e.createBatch(),a={},s={},c=[],r=r.toLowerCase(),ci()&&(l=ho.getCache(Vo,Vo.stores.users)),u=S(t),o.prev=9,u.s();case 11:if((d=u.n()).done){o.next=38;break}if(p=d.value,a[p]=null,f=null,!ci()){o.next=19;break}return o.next=18,l.getValue(p);case 18:f=o.sent;case 19:if(!(f&&si()>Date.now()-f.timeCached)){o.next=25;break}f=JSON.parse(null===f||void 0===f?void 0:f.user),h=null===f||void 0===f?void 0:f.displayName,r?(g=h&&h.toLowerCase().includes(r),!!g&&(s[p]=f||null)):a[p]=f||null,o.next=36;break;case 25:if(""===p){o.next=36;break}if("me"!==p.toString()){o.next=32;break}return o.next=29,ui(e);case 29:a[p]=o.sent,o.next=36;break;case 32:v="/users/".concat(p),n&&(v+="".concat(v,"?$filter=").concat(n)),i.get(p,v,["user.readbasic.all"]),c.push(p);case 36:o.next=11;break;case 38:o.next=43;break;case 40:o.prev=40,o.t0=o.catch(9),u.e(o.t0);case 43:return o.prev=43,u.f(),o.finish(43);case 46:return o.prev=46,o.next=49,i.executeAll();case 49:m=o.sent,b=S(t);try{for(b.s();!(y=b.n()).done;)k=y.value,(w=m.get(k))&&w.content&&(x=w.content,r?(null===x||void 0===x?void 0:x.displayName.toLowerCase()).contains(r)&&(s[k]=x):a[k]=x,ci()&&l.putValue(k,{user:JSON.stringify(x)}))}catch(T){b.e(T)}finally{b.f()}if(!r||!Object.keys(s).length){o.next=54;break}return o.abrupt("return",Promise.all(Object.values(s)));case 54:return o.abrupt("return",Promise.all(Object.values(a)));case 57:return o.prev=57,o.t1=o.catch(46),o.prev=59,t.filter((function(e){return c.includes(e)})).forEach((function(t){return a[t]=di(e,t)})),ci()&&t.filter((function(e){return c.includes(e)})).forEach((function(e){return ai(C,void 0,void 0,Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=l,t.t1=e,t.t2=JSON,t.next=5,a[e];case 5:return t.t3=t.sent,t.t4=t.t2.stringify.call(t.t2,t.t3),t.t5={user:t.t4},t.abrupt("return",t.t0.putValue.call(t.t0,t.t1,t.t5));case 9:case"end":return t.stop()}}),t)})))})),o.abrupt("return",Promise.all(Object.values(a)));case 65:return o.prev=65,o.t2=o.catch(59),o.abrupt("return",[]);case 68:case"end":return o.stop()}}),o,null,[[9,40,43,46],[46,57],[59,65]])})))}function fi(e,t){return ai(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s,c,l,u,d,p,f,h,g=this;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t&&0!==t.length){r.next=2;break}return r.abrupt("return",[]);case 2:n=e.createBatch(),o=[],ci()&&(a=ho.getCache(Vo,Vo.stores.usersQuery)),s=S(t),r.prev=6,s.s();case 8:if((c=s.n()).done){r.next=17;break}if(l=c.value,!ci()){r.next=14;break}return r.next=13,a.getValue(l);case 13:i=r.sent;case 14:ci()&&i&&si()>Date.now()-i.timeCached?o.push(JSON.parse(i.results[0])):""!==l&&n.get(l,'/me/people?$search="'.concat(l,'"'),["people.read"],{"X-PeopleQuery-QuerySources":"Mailbox,Directory"});case 15:r.next=8;break;case 17:r.next=22;break;case 19:r.prev=19,r.t0=r.catch(6),s.e(r.t0);case 22:return r.prev=22,s.f(),r.finish(22);case 25:return r.prev=25,r.next=28,n.executeAll();case 28:u=r.sent,d=S(t);try{for(d.s();!(p=d.n()).done;)f=p.value,(h=u.get(f))&&h.content&&h.content.value&&h.content.value.length>0?(o.push(h.content.value[0]),ci()&&a.putValue(f,{maxResults:1,results:[JSON.stringify(h.content.value[0])]})):o.push(null)}catch(v){d.e(v)}finally{d.f()}return r.abrupt("return",o);case 34:return r.prev=34,r.t1=r.catch(25),r.prev=36,r.abrupt("return",Promise.all(t.filter((function(e){return e&&""!==e})).map((function(t){return ai(g,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,ti(e,t,1);case 2:if(!(n=r.sent)||!n.length){r.next=6;break}return ci()&&a.putValue(t,{maxResults:1,results:[JSON.stringify(n[0])]}),r.abrupt("return",n[0]);case 6:case"end":return r.stop()}}),r)})))}))));case 40:return r.prev=40,r.t2=r.catch(36),r.abrupt("return",[]);case 43:case"end":return r.stop()}}),r,null,[[6,19,22,25],[25,34],[36,40]])})))}function hi(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return ai(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u,d;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(i="User.ReadBasic.All",a={maxResults:r,results:null},!ci()){o.next=9;break}return s=ho.getCache(Vo,Vo.stores.usersQuery),o.next=6,s.getValue(t);case 6:if(!((c=o.sent)&&si()>Date.now()-c.timeCached)){o.next=9;break}return o.abrupt("return",c.results.map((function(e){return JSON.parse(e)})));case 9:return l="".concat(t.replace(/#/g,"%2523")),u=e.api("users").header("ConsistencyLevel","eventual").count(!0).search('"displayName:'.concat(l,'" OR "mail:').concat(l,'"')),""!==n&&u.filter(n),o.prev=12,o.next=15,u.top(r).middlewareOptions($t(i)).get();case 15:d=o.sent,o.next=20;break;case 18:o.prev=18,o.t0=o.catch(12);case 20:return ci()&&d&&(a.results=d.value.map((function(e){return JSON.stringify(e)})),s.putValue(t,a)),o.abrupt("return",d?d.value:null);case 22:case"end":return o.stop()}}),o,null,[[12,18]])})))}function gi(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qo.person,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";return ai(this,void 0,void 0,Ze().mark((function c(){var l,u,d,p,f,h,g,v;return Ze().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(l=["user.read.all","people.read"],u={maxResults:n,results:null},p="".concat(r||"*",":").concat(t||"*",":").concat(o,":").concat(i,":").concat(a),!ci()){c.next=10;break}return d=ho.getCache(Vo,Vo.stores.usersQuery),c.next=7,d.getValue(p);case 7:if(!((f=c.sent)&&si()>Date.now()-f.timeCached)){c.next=10;break}return c.abrupt("return",f.results.map((function(e){return JSON.parse(e)})));case 10:return h="",t&&(h="startswith(displayName,'".concat(t,"') or startswith(givenName,'").concat(t,"') or startswith(surname,'").concat(t,"') or startswith(mail,'").concat(t,"') or startswith(userPrincipalName,'").concat(t,"')")),g="/groups/".concat(r,"/").concat(i?"transitiveMembers":"members"),o===qo.person?g+="/microsoft.graph.user":o===qo.group&&(g+="/microsoft.graph.group",t&&(h="startswith(displayName,'".concat(t,"') or startswith(mail,'").concat(t,"')"))),a&&(h+=t?" and ".concat(a):a),s&&(h+=t?" and ".concat(s):s),c.next=18,e.api(g).count(!0).top(n).filter(h).header("ConsistencyLevel","eventual").middlewareOptions($t.apply(void 0,l)).get();case 18:return v=c.sent,ci()&&v&&(u.results=v.value.map((function(e){return JSON.stringify(e)})),d.putValue(p,u)),c.abrupt("return",v?v.value:null);case 21:case"end":return c.stop()}}),c)})))}function vi(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qo.person,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return ai(this,void 0,void 0,Ze().mark((function s(){var c,l,u,p;return Ze().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:c=[],l=0;case 2:if(!(l<r.length)){s.next=17;break}return u=r[l],s.prev=4,s.next=7,gi(e,t,u,n,o,i,a);case 7:p=s.sent,c.push.apply(c,d(p)),s.next=14;break;case 11:return s.prev=11,s.t0=s.catch(4),s.abrupt("continue",14);case 14:l++,s.next=2;break;case 17:return s.abrupt("return",c);case 18:case"end":return s.stop()}}),s,null,[[4,11]])})))}var mi=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},bi=function(){return ho.config.photos.invalidationPeriod||ho.config.defaultInvalidationPeriod},yi=function(){return ho.config.photos.isEnabled&&ho.config.isEnabled};function ki(e,t,r){return mi(this,void 0,void 0,Ze().mark((function n(){var o,i,a;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.api("".concat(t,"/photo/$value")).responseType(zt.RAW).middlewareOptions($t.apply(void 0,d(r))).get();case 3:if(404!==(o=n.sent).status){n.next=8;break}return n.abrupt("return",{eTag:null,photo:null});case 8:if(o.ok){n.next=10;break}return n.abrupt("return",null);case 10:return i=o.headers.get("eTag"),n.t0=Fo,n.next=14,o.blob();case 14:return n.t1=n.sent,n.next=17,(0,n.t0)(n.t1);case 17:return a=n.sent,n.abrupt("return",{eTag:i,photo:a});case 21:return n.prev=21,n.t2=n.catch(0),n.abrupt("return",null);case 24:case"end":return n.stop()}}),n,null,[[0,21]])})))}function wi(e,t){return mi(this,void 0,void 0,Ze().mark((function r(){var n,o;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!yi()){r.next=7;break}return n=ho.getCache(Ko,Ko.stores.contacts),r.next=4,n.getValue(t);case 4:if(!((o=r.sent)&&bi()>Date.now()-o.timeCached)){r.next=7;break}return r.abrupt("return",o.photo);case 7:return r.next=9,ki(e,"me/contacts/".concat(t),["contacts.read"]);case 9:return o=r.sent,yi()&&o&&n.putValue(t,o),r.abrupt("return",o?o.photo:null);case 12:case"end":return r.stop()}}),r)})))}function xi(e,t){return mi(this,void 0,void 0,Ze().mark((function r(){var n,o,i;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!yi()){r.next=20;break}return n=ho.getCache(Ko,Ko.stores.users),r.next=4,n.getValue(t);case 4:if(!((o=r.sent)&&bi()>Date.now()-o.timeCached)){r.next=9;break}return r.abrupt("return",o.photo);case 9:if(!o){r.next=20;break}return r.prev=10,r.next=13,e.api("users/".concat(t,"/photo")).get();case 13:(i=r.sent)&&(i["@odata.mediaEtag"]!==o.eTag||null===i["@odata.mediaEtag"]&&null===i.eTag)&&(o=null),r.next=20;break;case 17:return r.prev=17,r.t0=r.catch(10),r.abrupt("return",null);case 20:if(r.t1=o,r.t1){r.next=25;break}return r.next=24,ki(e,"users/".concat(t),["user.readbasic.all"]);case 24:r.t1=r.sent;case 25:return o=r.t1,yi()&&o&&n.putValue(t,o),r.abrupt("return",o?o.photo:null);case 28:case"end":return r.stop()}}),r,null,[[10,17]])})))}function Ci(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return mi(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l,u;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!("personType"in t)||"OrganizationUser"===t.personType.subclass){n.next=11;break}if("PersonalContact"!==t.personType.subclass||!r){n.next=10;break}return o=ni(t),n.next=5,oi(e,o);case 5:if(!((i=n.sent)&&i.length&&i[0].id)){n.next=10;break}return n.next=9,wi(e,i[0].id);case 9:case 15:case 30:case 38:return n.abrupt("return",n.sent);case 10:case 39:return n.abrupt("return",null);case 11:if(!t.userPrincipalName&&!t.id){n.next=16;break}return a=t.userPrincipalName||t.id,n.next=15,xi(e,a);case 16:if(!t.id){n.next=22;break}return n.next=19,xi(e,t.id);case 19:if(!(s=n.sent)){n.next=22;break}return n.abrupt("return",s);case 22:if(!(c=ni(t))){n.next=39;break}return n.next=26,hi(e,c,1);case 26:if(!(l=n.sent)||!l.length){n.next=31;break}return n.next=30,xi(e,l[0].id);case 31:if(!r){n.next=39;break}return n.next=34,oi(e,c);case 34:if(!(u=n.sent)||!u.length){n.next=39;break}return n.next=38,wi(e,u[0].id);case 40:case"end":return n.stop()}}),n)})))}function Ti(e,t){return mi(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=t.id,!yi()){r.next=21;break}return o=ho.getCache(Ko,Ko.stores.groups),r.next=5,o.getValue(i);case 5:if(!((n=r.sent)&&bi()>Date.now()-n.timeCached)){r.next=10;break}return r.abrupt("return",n.photo);case 10:if(!n){r.next=21;break}return r.prev=11,r.next=14,e.api("groups/".concat(i,"/photo")).get();case 14:(a=r.sent)&&(a["@odata.mediaEtag"]!==n.eTag||null===a["@odata.mediaEtag"]&&null===a.eTag)&&(n=null),r.next=21;break;case 18:return r.prev=18,r.t0=r.catch(11),r.abrupt("return",null);case 21:if(r.t1=n,r.t1){r.next=26;break}return r.next=25,ki(e,"groups/".concat(i),["user.readbasic.all"]);case 25:r.t1=r.sent;case 26:return n=r.t1,yi()&&n&&o.putValue(i,n),r.abrupt("return",n?n.photo:null);case 29:case"end":return r.stop()}}),r,null,[[11,18]])})))}function _i(e,t){return mi(this,void 0,void 0,Ze().mark((function r(){var n,o;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=ho.getCache(Ko,t),r.next=3,n.getValue(e);case 3:return o=r.sent,r.abrupt("return",o);case 5:case"end":return r.stop()}}),r)})))}function Si(e,t,r){return mi(this,void 0,void 0,Ze().mark((function n(){return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:ho.getCache(Ko,t).putValue(e,r);case 2:case"end":return n.stop()}}),n)})))}var Ii=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Ei=function(){return ho.config.presence.invalidationPeriod||ho.config.defaultInvalidationPeriod},Ai=function(){return ho.config.presence.isEnabled&&ho.config.isEnabled};function Ri(e,t){return Ii(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!Ai()){r.next=7;break}return n=ho.getCache(Go,Go.stores.presence),r.next=4,n.getValue(t||"me");case 4:if(!((o=r.sent)&&Ei()>Date.now()-o.timeCached)){r.next=7;break}return r.abrupt("return",JSON.parse(o.presence));case 7:return i=t?["presence.read.all"]:["presence.read"],a=t?"/users/".concat(t,"/presence"):"/me/presence",r.next=11,e.api(a).middlewareOptions($t.apply(void 0,i)).get();case 11:return s=r.sent,Ai()&&n.putValue(t||"me",{presence:JSON.stringify(s)}),r.abrupt("return",s);case 14:case"end":return r.stop()}}),r)})))}function Pi(e,t){return Ii(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s,c,l,u,d,p,f,h,g,v,m,b,y;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t&&0!==t.length){r.next=2;break}return r.abrupt("return",{});case 2:n={},o=[],i=["presence.read.all"],Ai()&&(a=ho.getCache(Go,Go.stores.presence)),s=S(t),r.prev=7,s.s();case 9:if((c=s.n()).done){r.next=35;break}if(!(null===(l=c.value)||void 0===l?void 0:l.id)){r.next=33;break}if(u=l.id,n[u]=null,d=void 0,!Ai()){r.next=19;break}return r.next=18,a.getValue(u);case 18:d=r.sent;case 19:if(r.t0=Ai()&&d,!r.t0){r.next=28;break}return r.t1=Ei(),r.t2=Date.now(),r.next=25,d;case 25:r.t3=r.sent.timeCached,r.t4=r.t2-r.t3,r.t0=r.t1>r.t4;case 28:if(!r.t0){r.next=32;break}n[u]=JSON.parse(d.presence),r.next=33;break;case 32:o.push(u);case 33:r.next=9;break;case 35:r.next=40;break;case 37:r.prev=37,r.t5=r.catch(7),s.e(r.t5);case 40:return r.prev=40,s.f(),r.finish(40);case 43:if(r.prev=43,!(o.length>0)){r.next=50;break}return r.next=47,e.api("/communications/getPresencesByUserId").middlewareOptions($t.apply(void 0,i)).post({ids:o});case 47:p=r.sent,f=S(p.value);try{for(f.s();!(h=f.n()).done;)g=h.value,n[g.id]=g,Ai()&&a.putValue(g.id,{presence:JSON.stringify(g)})}catch(k){f.e(k)}finally{f.f()}case 50:return r.abrupt("return",n);case 53:return r.prev=53,r.t6=r.catch(43),r.prev=55,r.next=58,Promise.all(t.filter((function(e){return e&&e.id&&!n[e.id]&&"personType"in e&&"OrganizationUser"===e.personType.subclass})).map((function(t){return Ri(e,t.id)})));case 58:v=r.sent,m=S(v);try{for(m.s();!(b=m.n()).done;)y=b.value,n[y.id]=y}catch(k){m.e(k)}finally{m.f()}return r.abrupt("return",n);case 64:return r.prev=64,r.t7=r.catch(55),r.abrupt("return",null);case 67:case"end":return r.stop()}}),r,null,[[7,37,40,43],[43,53],[55,64]])})))}var Oi,Ni,Di,Li,Mi,Ui,Fi,zi,Hi,Bi,qi,ji,Gi,Vi,Ki,Qi,Wi,Ji,Yi,Xi,Zi,$i,ea,ta,ra,na,oa,ia,aa,sa,ca,la,ua,da,pa,fa,ha=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function ga(e,t,r){return ha(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l,u,d,p,f,h,g,v,m,b,y;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=null,i=null,c=t?"users/".concat(t):"me",l=c+(r?"?$select=".concat(r.toString()):""),u=t?["user.readbasic.all"]:["user.read"],!ci()){n.next=11;break}return d=ho.getCache(Vo,Vo.stores.users),n.next=9,d.getValue(t||"me");case 9:void 0!==(s=n.sent)&&si()>Date.now()-s.timeCached?null!==(i=s.user?JSON.parse(s.user):null)&&r&&r.filter((function(e){return!Object.keys(i).includes(e)})).length>=1&&(i=null,s=null):s=null;case 11:if(!yi()){n.next=30;break}return n.next=14,_i(t||"me",Ko.stores.users);case 14:if(!((a=n.sent)&&bi()>Date.now()-a.timeCached)){n.next=19;break}o=a.photo,n.next=30;break;case 19:if(!a){n.next=30;break}return n.prev=20,n.next=23,e.api("".concat(c,"/photo")).get();case 23:(p=n.sent)&&p["@odata.mediaEtag"]&&p["@odata.mediaEtag"]===a.eTag?(Si(t||"me",Ko.stores.users,a),o=a.photo):a=null,n.next=30;break;case 27:n.prev=27,n.t0=n.catch(20),"ErrorItemNotFound"!==n.t0.code&&"ImageNotFound"!==n.t0.code||Si(t||"me",Ko.stores.users,{eTag:null,photo:null});case 30:if(a||s){n.next=44;break}return h=e.createBatch(),t?(h.get("user","/users/".concat(t).concat(r?"?$select="+r.toString():""),["user.readbasic.all"]),h.get("photo","users/".concat(t,"/photo/$value"),["user.readbasic.all"])):(h.get("user","me",["user.read"]),h.get("photo","me/photo/$value",["user.read"])),n.next=35,h.executeAll();case 35:g=n.sent,(v=g.get("photo"))&&(f=v.headers.ETag,o=v.content),(m=g.get("user"))&&(i=m.content),ci()&&ho.getCache(Vo,Vo.stores.users).putValue(t||"me",{user:JSON.stringify(i)}),yi()&&Si(t||"me",Ko.stores.users,{eTag:f,photo:o}),n.next=66;break;case 44:if(a){n.next=56;break}return n.prev=45,n.next=48,ki(e,c,u);case 48:(b=n.sent)&&(yi()&&Si(t||"me",Ko.stores.users,{eTag:b.eTag,photo:b.photo}),o=b.photo),n.next=54;break;case 52:n.prev=52,n.t1=n.catch(45);case 54:n.next=66;break;case 56:if(s){n.next=66;break}return n.prev=57,n.next=60,e.api(l).middlewareOptions($t.apply(void 0,u)).get();case 60:(y=n.sent)&&(ci()&&ho.getCache(Vo,Vo.stores.users).putValue(t||"me",{user:JSON.stringify(y)}),i=y),n.next=66;break;case 64:n.prev=64,n.t2=n.catch(57);case 66:return i&&(i.personImage=o),n.abrupt("return",i);case 68:case"end":return n.stop()}}),n,null,[[20,27],[45,52],[57,64]])})))}function va(e,t){switch(e){case pa.ArrowRight:return en(Ni||(Ni=Bn(['\n        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M8 7L4.46481 10.5359L4.46481 7L4.46481 3.46413L8 7Z" />\n        </svg>\n      '])));case pa.ArrowDown:return en(Di||(Di=Bn(['\n        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />\n        </svg>\n      '])));case pa.TeamSeparator:return en(Li||(Li=Bn(['\n        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            fill-rule="evenodd"\n            clip-rule="evenodd"\n            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"\n            fill=',"\n          />\n        </svg>\n      "])),t);case pa.Search:return en(Mi||(Mi=Bn(['\n        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <g clip-path="url(#clip0)">\n            <circle cx="5.36377" cy="5.36396" r="4" transform="rotate(45 5.36377 5.36396)" stroke="#B3B0AD" />\n            <path\n              d="M8.19189 7.48529L12.7881 12.0815C12.9834 12.2767 12.9834 12.5933 12.7881 12.7886V12.7886C12.5928 12.9839 12.2762 12.9839 12.081 12.7886L7.48479 8.1924L8.19189 7.48529Z"\n              fill="#B3B0AD"\n            />\n          </g>\n          <defs>\n            <clipPath id="clip0">\n              <rect width="14" height="14" fill="white" />\n            </clipPath>\n          </defs>\n        </svg>\n      '])));case pa.SkypeArrow:return en(Ui||(Ui=Bn(['\n        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"\n            fill="#B4009E"\n          />\n        </svg>\n      '])));case pa.SmallEmail:return en(Fi||(Fi=Bn(['\n        <svg width="14" height="10" viewBox="0 0 14 10" xmlns="http://www.w3.org/2000/svg">\n          <path\n            fill-rule="evenodd"\n            clip-rule="evenodd"\n            d="M11.8473 1H2.04886L6.47364 4.18916C6.64273 4.31103 6.86969 4.31522 7.04316 4.19968L11.8473 1ZM1 1.47671V9H13V1.43376L7.59749 5.03198C7.07706 5.3786 6.39621 5.36601 5.88894 5.0004L1 1.47671ZM0 1C0 0.447715 0.447715 0 1 0H13C13.5523 0 14 0.447715 14 1V9C14 9.55228 13.5523 10 13 10H1C0.447716 10 0 9.55229 0 9V1Z"\n          />\n        </svg>\n      '])));case pa.SmallChat:return en(zi||(zi=Bn(['\n        <svg width="13" height="13" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg">\n          <path\n            fill-rule="evenodd"\n            clip-rule="evenodd"\n            d="M9.5781 8.26403L9.57811 8.26403C9.68611 8.29867 9.8455 8.36364 10.0125 8.50479C10.1405 8.61294 10.2409 8.73883 10.3235 8.86465L11.9634 10.9944C11.9701 10.9924 11.9753 10.9904 11.9785 10.9889C11.9841 10.9864 11.9918 10.9823 12 10.9768V1.32284C12 1.18078 11.8731 1 11.6207 1H1.37926C1.12692 1 1 1.18078 1 1.32284V7.37377C1 7.45357 1.01415 7.49036 1.02102 7.50507C1.02778 7.51955 1.04342 7.54689 1.09159 7.58705L1.10485 7.5981L1.11771 7.6096C1.13526 7.62529 1.21707 7.69076 1.33937 7.76027C1.46122 7.82952 1.58119 7.87864 1.67944 7.89966L1.69102 7.90214L1.691 7.9022C3.32106 8.27116 6.2626 8.27688 8.67896 8.18036L8.69908 8.17955L8.71921 8.17956L8.7627 8.17954C9.01362 8.17932 9.31313 8.17907 9.5781 8.26403ZM11.2376 11.6908L9.50506 9.44081C9.39493 9.26422 9.32445 9.23285 9.27276 9.21627C9.17534 9.18504 9.0401 9.17966 8.71888 9.17956C6.31879 9.27543 3.24831 9.27999 1.47024 8.87753C1.01314 8.77974 0.600449 8.48852 0.451238 8.35513C0.15593 8.10893 0 7.78958 0 7.37377V1.32284C0 0.593147 0.610664 0 1.37926 0H11.6207C12.3893 0 13 0.593147 13 1.32284V11.0441C13 11.4686 12.6828 11.7689 12.3881 11.9012C12.1048 12.0284 11.673 12.0728 11.3387 11.7993C11.3003 11.7679 11.2678 11.7301 11.2376 11.6908ZM3 3.5C3 3.22386 3.22386 3 3.5 3H9.5C9.77614 3 10 3.22386 10 3.5C10 3.77614 9.77614 4 9.5 4H3.5C3.22386 4 3 3.77614 3 3.5ZM3.5 5C3.22386 5 3 5.22386 3 5.5C3 5.77614 3.22386 6 3.5 6H6.5C6.77614 6 7 5.77614 7 5.5C7 5.22386 6.77614 5 6.5 5H3.5Z"\n          />\n        </svg>\n      '])));case pa.ExpandDown:return en(Hi||(Hi=Bn(['\n        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M14 1L7.5 7L1 1" stroke="#3078CD" />\n        </svg>\n      '])));case pa.Overview:return en(Bi||(Bi=Bn(['\n        <svg xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M12 4V9H2V4H12ZM11 8V5H3V8H11ZM13 4H18V9H13V4ZM17 8V5H14V8H17ZM8 15V10H18V15H8ZM9 11V14H17V11H9ZM2 15V10H7V15H2ZM3 11V14H6V11H3Z"\n          />\n        </svg>\n      '])));case pa.Send:return en(qi||(qi=Bn(['\n        <svg xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"\n          />\n        </svg>\n      '])));case pa.Contact:return en(ji||(ji=Bn(['\n        <svg xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M11.3315 11.7855L11.3452 11.7913L11.3591 11.7967C11.4057 11.8149 11.4421 11.8389 11.4762 11.8729L12.8836 13.2797C12.9177 13.3137 12.9416 13.35 12.9597 13.3965L12.9651 13.4104L12.971 13.4241C12.9902 13.4693 13 13.5151 13 13.5699C13 13.6248 12.9901 13.6759 12.9676 13.7303L12.9675 13.7302L12.9628 13.7419C12.9458 13.7844 12.9218 13.822 12.8836 13.8602L12.7941 13.9497C12.57 14.1736 12.3673 14.37 12.1855 14.5396C12.0445 14.6712 11.9037 14.7767 11.7639 14.8601C11.6429 14.9284 11.499 14.9865 11.3265 15.0296C11.1716 15.0683 10.9523 15.0957 10.6541 15.0957C10.226 15.0957 9.77339 15.0291 9.29316 14.8873C8.79837 14.7411 8.29897 14.537 7.79466 14.2716C7.29099 14.0043 6.7904 13.6843 6.2931 13.3097C5.79797 12.9334 5.32815 12.5234 4.88351 12.0793C4.44215 11.6299 4.03516 11.1575 3.66219 10.6619C3.2916 10.1652 2.97561 9.66531 2.71228 9.16232C2.44987 8.65684 2.24939 8.16115 2.1072 7.67496C1.96889 7.20203 1.9043 6.75953 1.9043 6.34426C1.9043 6.04676 1.92945 5.8283 1.96505 5.67477C2.00758 5.51024 2.06491 5.36965 2.13346 5.24839C2.21771 5.10725 2.32161 4.96874 2.44802 4.83312C2.61763 4.65148 2.814 4.44899 3.03788 4.22522L3.14024 4.12291C3.18256 4.08061 3.22694 4.05101 3.2785 4.0291C3.32105 4.01103 3.36887 4 3.43131 4C3.48634 4 3.53235 4.00983 3.57773 4.0291L3.57771 4.02914L3.58585 4.03251C3.6411 4.05541 3.68414 4.08469 3.72239 4.12291L5.12984 5.52968C5.16387 5.56369 5.18781 5.60004 5.20594 5.64649L5.21136 5.66038L5.2172 5.6741C5.23642 5.71931 5.24622 5.76513 5.24622 5.81992C5.24622 5.88591 5.23631 5.9178 5.23225 5.92835C5.20132 5.99698 5.16601 6.05438 5.12738 6.10352C5.07447 6.17083 5.01613 6.23146 4.95179 6.28625L4.94467 6.2923L4.93768 6.29849C4.81323 6.40852 4.69584 6.51839 4.58605 6.62811C4.45174 6.76237 4.32909 6.90895 4.22378 7.06908C4.0535 7.32254 3.96032 7.61696 3.96032 7.93007C3.96032 8.35888 4.12439 8.75141 4.42612 9.05299L7.95115 12.5763C8.25285 12.8779 8.64535 13.0417 9.07392 13.0417C9.38687 13.0417 9.68121 12.9486 9.9347 12.7785C10.0949 12.6733 10.2415 12.5507 10.3758 12.4164C10.4856 12.3067 10.5955 12.1894 10.7056 12.065L10.7118 12.058L10.7179 12.0509C10.7727 11.9866 10.8333 11.9283 10.9007 11.8754C10.9499 11.8367 11.0074 11.8014 11.0761 11.7704C11.0868 11.7663 11.1189 11.7564 11.1851 11.7564C11.2401 11.7564 11.2861 11.7662 11.3315 11.7855ZM11.5689 15.9998C11.8248 15.9358 12.0573 15.8442 12.2663 15.7248C12.4753 15.6012 12.6757 15.4499 12.8676 15.2708C13.0596 15.0918 13.2707 14.8872 13.501 14.657L13.5906 14.5674C13.7228 14.4353 13.823 14.284 13.8912 14.1134C13.9637 13.9387 14 13.7575 14 13.5699C14 13.3824 13.9637 13.2033 13.8912 13.0328C13.823 12.858 13.7228 12.7045 13.5906 12.5724L12.1831 11.1656C12.0509 11.0335 11.8974 10.9333 11.7225 10.8651C11.5519 10.7926 11.3728 10.7564 11.1851 10.7564C10.9974 10.7564 10.829 10.7884 10.6797 10.8523C10.5347 10.9163 10.4025 10.9951 10.283 11.0889C10.1636 11.1827 10.0549 11.2871 9.95677 11.4022C9.85868 11.5131 9.76272 11.6154 9.66889 11.7092C9.57506 11.8029 9.47909 11.8818 9.381 11.9457C9.28717 12.0097 9.18481 12.0417 9.07392 12.0417C8.91185 12.0417 8.77323 11.9841 8.65808 11.869L5.13305 8.34571C5.0179 8.23061 4.96032 8.09206 4.96032 7.93007C4.96032 7.81924 4.99231 7.71693 5.05628 7.62314C5.12026 7.52509 5.19916 7.42918 5.29299 7.33539C5.38682 7.24161 5.48918 7.14569 5.60007 7.04765C5.71522 6.9496 5.81972 6.84089 5.91355 6.72153C6.00738 6.60217 6.08628 6.47002 6.15026 6.32508C6.21423 6.17588 6.24622 6.00749 6.24622 5.81992C6.24622 5.63236 6.20997 5.45331 6.13746 5.2828C6.06922 5.10802 5.96899 4.95455 5.83678 4.8224L4.42932 3.41564C4.29711 3.28348 4.14357 3.18117 3.9687 3.1087C3.7981 3.03623 3.61897 3 3.43131 3C3.23939 3 3.05813 3.03623 2.88752 3.1087C2.71692 3.18117 2.56552 3.28348 2.4333 3.41564L2.33094 3.51795C2.10063 3.74814 1.89591 3.95916 1.71678 4.15099C1.54192 4.33856 1.39264 4.53678 1.26895 4.74567C1.14953 4.95455 1.05784 5.18475 0.993862 5.43626C0.934152 5.68777 0.904297 5.99044 0.904297 6.34426C0.904297 6.86434 0.985332 7.40147 1.1474 7.95565C1.30947 8.50983 1.53552 9.06614 1.82554 9.62458C2.11556 10.1788 2.46102 10.7244 2.86193 11.2615C3.26285 11.7944 3.70001 12.3017 4.17342 12.7834C4.65111 13.2609 5.15651 13.7021 5.68963 14.107C6.22703 14.512 6.77295 14.8616 7.3274 15.1557C7.88611 15.4499 8.44696 15.6801 9.00994 15.8463C9.57292 16.0126 10.121 16.0957 10.6541 16.0957C11.0081 16.0957 11.313 16.0637 11.5689 15.9998ZM14.9616 14H17.0002C17.5525 14 18.0002 13.5523 18.0002 13V5C18.0002 4.44772 17.5525 4 17.0002 4H6.43555L6.54385 4.11514C6.77073 4.34192 6.94536 4.60775 7.06365 4.90525C7.07677 4.93665 7.08919 4.96824 7.10089 5H16.8821L10.2238 8.32913C10.083 8.39951 9.91736 8.39951 9.7766 8.32913L7.22381 7.05273L6.7766 7.94716L9.32938 9.22355C9.75167 9.4347 10.2487 9.4347 10.671 9.22356L17.0002 6.05895V13H14.9314C14.9772 13.1858 15.0001 13.3764 15.0001 13.5699C15.0001 13.7154 14.9872 13.8589 14.9616 14Z"\n          />\n        </svg>\n      '])));case pa.Copy:return en(Gi||(Gi=Bn(['\n        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"\n          />\n        </svg>\n      '])));case pa.Phone:return en(Vi||(Vi=Bn(['\n        <svg width="15" height="15" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048" fill="none">\n            <path d="M1607 1213q44 0 84 16t72 48l220 220q31 31 47 71t17 85q0 44-16 84t-48 72l-14 14q-54 54-99 96t-94 70-109 44-143 15q-125 0-257-39t-262-108-256-164-237-207-206-238-162-256T38 775 0 523q0-83 14-142t43-108 70-93 96-99l16-16q31-31 71-48t85-17q44 0 84 17t72 48l220 220q31 31 47 71t17 85q0 44-15 78t-37 63-48 51-49 45-37 44-15 49q0 38 27 65l551 551q27 27 65 27 26 0 48-15t45-37 45-48 51-49 62-37 79-15zm-83 707q72 0 120-13t88-39 76-64 85-86q27-27 27-65 0-18-14-42t-38-52-51-55-56-54-51-47-37-35q-27-27-66-27-26 0-48 15t-44 37-45 48-52 49-62 37-79 15q-44 0-84-16t-72-48L570 927q-31-31-47-71t-17-85q0-44 15-78t37-63 48-51 49-46 37-44 15-48q0-39-27-66-13-13-34-36t-47-51-54-56-56-52-51-37-43-15q-38 0-65 27l-85 85q-37 37-64 76t-40 87-14 120q0 112 36 231t101 238 153 234 192 219 219 190 234 150 236 99 226 36z" fill="','"></path>\n        </svg>\n      '])),t);case pa.CellPhone:return en(Ki||(Ki=Bn(['\n        <svg width="10" height="15" viewBox="0 0 10 15" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <rect x="0.5" y="0.5" width="9" height="14" rx="0.9" stroke="','" />\n          <rect x="3" y="12" width="4" height="1" rx="0.5" fill="','" />\n        </svg>\n      '])),t,t);case pa.Chat:return en(Qi||(Qi=Bn(['\n        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M2.67824 0C2.3824 0 2.14258 0.239826 2.14258 0.535665C2.14258 0.831505 2.3824 1.07133 2.67824 1.07133H13.9985C14.5508 1.07133 14.9985 1.51905 14.9985 2.07133V12.3203C14.9985 12.6161 15.2384 12.856 15.5342 12.856C15.8301 12.856 16.0699 12.6161 16.0699 12.3203V2C16.0699 0.895431 15.1744 0 14.0699 0H2.67824Z"\n            fill="','"\n          />\n          <path\n            d="M9.34097 11.4769L9.3309 11.4769L9.32085 11.4773C6.74142 11.5804 3.51639 11.5801 1.6855 11.1657L1.6855 11.1657L1.67972 11.1644C1.30373 11.084 0.937799 10.8292 0.816663 10.7209L0.81023 10.7152L0.803602 10.7096C0.601843 10.5414 0.5 10.3403 0.5 10.0423V3.55978C0.5 3.07185 0.912353 2.64258 1.47765 2.64258H12.4497C13.0149 2.64258 13.4273 3.07185 13.4273 3.55978V13.9745C13.4273 14.1578 13.2827 14.3397 13.067 14.4366C12.8614 14.5288 12.6204 14.5275 12.457 14.3904L10.5932 11.9699C10.5218 11.8587 10.4457 11.7646 10.3579 11.6904C10.2528 11.6015 10.1556 11.5622 10.0869 11.5401L9.93419 12.0163L10.0869 11.5401C9.89097 11.4773 9.65413 11.477 9.34097 11.4769Z"\n            stroke="','"\n          />\n        </svg>\n      '])),t,t);case pa.Department:return en(Wi||(Wi=Bn(['\n        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M9.625 3.5H14V11.375H0V3.5H4.375V1.75H9.625V3.5ZM5.25 2.625V3.5H8.75V2.625H5.25ZM13.125 4.375H0.875V6.125H3.5V5.25H4.375V6.125H9.625V5.25H10.5V6.125H13.125V4.375ZM0.875 10.5H13.125V7H10.5V7.875H9.625V7H4.375V7.875H3.5V7H0.875V10.5Z"\n            fill="','"\n          />\n        </svg>\n      '])),t);case pa.Email:return en(Ji||(Ji=Bn(['\n        <svg width="14" height="10" viewBox="0 0 14 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M0.5 0.772727C0.5 0.622104 0.622104 0.5 0.772727 0.5H13.2273C13.3779 0.5 13.5 0.622104 13.5 0.772727V9.22727C13.5 9.3779 13.3779 9.5 13.2273 9.5H0.772727C0.622104 9.5 0.5 9.3779 0.5 9.22727V0.772727Z"\n            stroke="','"\n          />\n          <path d="M13.5 0.5L7.18923 4.70314C6.92113 4.8817 6.57039 4.87522 6.30907 4.68687L0.5 0.5" stroke="#929292" />\n        </svg>\n      '])),t);case pa.OfficeLocation:return en(Yi||(Yi=Bn(['\n        <svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M6.78489 16.3832L6.78263 16.3859C6.75278 16.4216 6.71543 16.4503 6.67324 16.4701L6.88498 16.923L6.67324 16.4701C6.63105 16.4898 6.58504 16.5 6.53846 16.5C6.49188 16.5 6.44588 16.4898 6.40368 16.4701C6.36149 16.4503 6.32415 16.4216 6.2943 16.3859L6.29202 16.3832C5.47882 15.4241 4.01597 13.6289 2.75914 11.7172C2.13055 10.7611 1.56021 9.78597 1.14862 8.87887C0.732553 7.96189 0.5 7.15987 0.5 6.53687C0.5 3.20251 3.20343 0.5 6.53846 0.5C9.87349 0.5 12.5769 3.20251 12.5769 6.53687C12.5769 7.16011 12.3444 7.96225 11.9283 8.87925C11.5167 9.78639 10.9464 10.7615 10.3178 11.7175C9.06097 13.6291 7.59812 15.424 6.78489 16.3832Z"\n            stroke="','"\n          />\n          <path\n            d="M4.40039 6.53921C4.40039 5.37092 5.34748 4.42383 6.51577 4.42383C7.68407 4.42383 8.63116 5.37092 8.63116 6.53921C8.63116 7.70751 7.68407 8.6546 6.51577 8.6546C5.34748 8.6546 4.40039 7.70751 4.40039 6.53921Z"\n            stroke="','"\n          />\n        </svg>\n      '])),t,t);case pa.Person:return en(Xi||(Xi=Bn(['\n        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            fill-rule="evenodd"\n            clip-rule="evenodd"\n            d="M8.91699 4C8.91699 5.65685 7.57385 7 5.91699 7C4.26014 7 2.91699 5.65685 2.91699 4C2.91699 2.34315 4.26014 1 5.91699 1C7.57385 1 8.91699 2.34315 8.91699 4ZM8.04431 7.38803C9.16935 6.68014 9.91699 5.42738 9.91699 4C9.91699 1.79086 8.12613 0 5.91699 0C3.70785 0 1.91699 1.79086 1.91699 4C1.91699 5.42739 2.66465 6.68016 3.78972 7.38805C1.82681 8.13254 0.356122 9.8773 0 12H1.01706C1.48033 9.71776 3.49808 8 5.91704 8C8.336 8 10.3538 9.71776 10.817 12H11.8341C11.478 9.87728 10.0072 8.1325 8.04431 7.38803Z"\n            fill="','"\n          />\n        </svg>\n      '])),t);case pa.Messages:return en(Zi||(Zi=Bn(['\n        <svg xmlns="http://www.w3.org/2000/svg">\n          <path\n            fill-rule="evenodd"\n            clip-rule="evenodd"\n            d="M4 3.5C4 3.22386 4.22386 3 4.5 3H16C17.1046 3 18 3.89543 18 5V12.5C18 12.7761 17.7761 13 17.5 13C17.2239 13 17 12.7761 17 12.5V5C17 4.44772 16.5523 4 16 4H4.5C4.22386 4 4 3.77614 4 3.5ZM4.04886 6H13.8473L9.04316 9.19968C8.86969 9.31522 8.64273 9.31103 8.47364 9.18916L4.04886 6ZM3 14V6.47671L7.88894 10.0004C8.39621 10.366 9.07706 10.3786 9.59749 10.032L15 6.43376V14H3ZM3 5C2.44772 5 2 5.44772 2 6V14C2 14.5523 2.44772 15 3 15H15C15.5523 15 16 14.5523 16 14V6C16 5.44772 15.5523 5 15 5H3Z"\n          />\n        </svg>\n      '])));case pa.Organization:return en($i||($i=Bn(['\n        <svg xmlns="http://www.w3.org/2000/svg">\n          <path\n            fill-rule="evenodd"\n            clip-rule="evenodd"\n            d="M13 4H8V7H13V4ZM8 3C7.44772 3 7 3.44772 7 4V7C7 7.55228 7.44772 8 8 8H10V9H7.5C6.67157 9 6 9.67157 6 10.5V11H4C3.44772 11 3 11.4477 3 12V15C3 15.5523 3.44772 16 4 16H9C9.55228 16 10 15.5523 10 15V12C10 11.4477 9.55228 11 9 11H7V10.5C7 10.2239 7.22386 10 7.5 10H13.5C13.7761 10 14 10.2239 14 10.5V11H12C11.4477 11 11 11.4477 11 12V15C11 15.5523 11.4477 16 12 16H17C17.5523 16 18 15.5523 18 15V12C18 11.4477 17.5523 11 17 11H15V10.5C15 9.67157 14.3284 9 13.5 9H11V8H13C13.5523 8 14 7.55228 14 7V4C14 3.44772 13.5523 3 13 3H8ZM9 12H4L4 15H9V12ZM12 12H17V15H12V12Z"\n          />\n        </svg>\n      '])));case pa.ExpandRight:return en(ea||(ea=Bn(['\n        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />\n        </svg>\n      '])));case pa.Profile:return en(ta||(ta=Bn(['\n        <svg xmlns="http://www.w3.org/2000/svg">\n          <path\n            fill-rule="evenodd"\n            clip-rule="evenodd"\n            d="M13 8C13 9.65685 11.6569 11 10 11C8.34315 11 7 9.65685 7 8C7 6.34315 8.34315 5 10 5C11.6569 5 13 6.34315 13 8ZM12.1273 11.388C13.2524 10.6801 14 9.42738 14 8C14 5.79086 12.2091 4 10 4C7.79086 4 6 5.79086 6 8C6 9.42739 6.74766 10.6802 7.87272 11.3881C5.90981 12.1325 4.43913 13.8773 4.08301 16H5.10007C5.56334 13.7178 7.58109 12 10 12C12.419 12 14.4368 13.7178 14.9 16H15.9171C15.561 13.8773 14.0903 12.1325 12.1273 11.388Z"\n          />\n        </svg>\n      '])));case pa.Profile:return en(ra||(ra=Bn(['\n        <svg width="12" height="14" viewBox="0 0 12 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            opacity="0.5"\n            d="M5.125 10.0625C5.125 10.2448 5.15918 10.4157 5.22754 10.5752C5.2959 10.7347 5.38932 10.8737 5.50781 10.9922C5.6263 11.1107 5.7653 11.2041 5.9248 11.2725C6.08431 11.3408 6.25521 11.375 6.4375 11.375H9.0625C9.35872 11.375 9.63672 11.4297 9.89648 11.5391C10.1608 11.6484 10.3978 11.8079 10.6074 12.0176C10.8171 12.2272 10.9766 12.4642 11.0859 12.7285C11.1953 12.9883 11.25 13.2663 11.25 13.5625C11.25 13.681 11.2067 13.7835 11.1201 13.8701C11.0335 13.9567 10.931 14 10.8125 14C10.694 14 10.5915 13.9567 10.5049 13.8701C10.4183 13.7835 10.375 13.681 10.375 13.5625C10.375 13.3802 10.3408 13.2093 10.2725 13.0498C10.2041 12.8903 10.1107 12.7513 9.99219 12.6328C9.8737 12.5143 9.7347 12.4209 9.5752 12.3525C9.41569 12.2842 9.24479 12.25 9.0625 12.25H6.4375C6.14128 12.25 5.861 12.1953 5.59668 12.0859C5.33691 11.9766 5.10221 11.8171 4.89258 11.6074C4.68294 11.3978 4.52344 11.1631 4.41406 10.9033C4.30469 10.639 4.25 10.3587 4.25 10.0625V9.46777C3.7168 9.21712 3.23372 8.89811 2.80078 8.51074C2.36784 8.12337 1.9987 7.69043 1.69336 7.21191C1.39258 6.72884 1.16016 6.21159 0.996094 5.66016C0.832031 5.10417 0.75 4.52995 0.75 3.9375C0.75 3.39518 0.852539 2.88477 1.05762 2.40625C1.26725 1.92773 1.5498 1.51074 1.90527 1.15527C2.26074 0.799805 2.67773 0.519531 3.15625 0.314453C3.63477 0.104818 4.14518 0 4.6875 0C5.22982 0 5.74023 0.104818 6.21875 0.314453C6.69727 0.519531 7.11426 0.799805 7.46973 1.15527C7.8252 1.51074 8.10547 1.92773 8.31055 2.40625C8.52018 2.88477 8.625 3.39518 8.625 3.9375C8.625 4.52995 8.54297 5.10417 8.37891 5.66016C8.21484 6.21615 7.98014 6.7334 7.6748 7.21191C7.37402 7.69043 7.00716 8.12337 6.57422 8.51074C6.14583 8.89811 5.66276 9.21712 5.125 9.46777V10.0625ZM1.625 3.9375C1.625 4.45247 1.69564 4.9515 1.83691 5.43457C1.98275 5.91309 2.18783 6.3597 2.45215 6.77441C2.72103 7.18913 3.04232 7.56283 3.41602 7.89551C3.79427 8.22363 4.2181 8.49479 4.6875 8.70898C5.1569 8.49479 5.57845 8.22363 5.95215 7.89551C6.3304 7.56283 6.65169 7.18913 6.91602 6.77441C7.1849 6.3597 7.38997 5.91309 7.53125 5.43457C7.67708 4.9515 7.75 4.45247 7.75 3.9375C7.75 3.51367 7.66797 3.11719 7.50391 2.74805C7.3444 2.37435 7.12565 2.05078 6.84766 1.77734C6.57422 1.49935 6.25065 1.2806 5.87695 1.12109C5.50781 0.957031 5.11133 0.875 4.6875 0.875C4.26367 0.875 3.86491 0.957031 3.49121 1.12109C3.12207 1.2806 2.7985 1.49935 2.52051 1.77734C2.24707 2.05078 2.02832 2.37435 1.86426 2.74805C1.70475 3.11719 1.625 3.51367 1.625 3.9375ZM6.4375 4.375C6.31901 4.375 6.21647 4.33171 6.12988 4.24512C6.04329 4.15853 6 4.05599 6 3.9375C6 3.75521 5.96582 3.58431 5.89746 3.4248C5.8291 3.2653 5.73568 3.1263 5.61719 3.00781C5.4987 2.88932 5.3597 2.7959 5.2002 2.72754C5.04069 2.65918 4.86979 2.625 4.6875 2.625C4.56901 2.625 4.46647 2.58171 4.37988 2.49512C4.29329 2.40853 4.25 2.30599 4.25 2.1875C4.25 2.06901 4.29329 1.96647 4.37988 1.87988C4.46647 1.79329 4.56901 1.75 4.6875 1.75C4.98828 1.75 5.27083 1.80697 5.53516 1.9209C5.80404 2.03483 6.03646 2.19206 6.23242 2.39258C6.43294 2.58854 6.59017 2.82096 6.7041 3.08984C6.81803 3.35417 6.875 3.63672 6.875 3.9375C6.875 4.05599 6.83171 4.15853 6.74512 4.24512C6.65853 4.33171 6.55599 4.375 6.4375 4.375Z"\n            fill="black"\n          />\n        </svg>\n      '])));case pa.File:return en(na||(na=Bn(['\n        <svg width="20" height="26" viewBox="0 0 20 26" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            opacity="0.64"\n            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"\n            fill="#605E5C"\n          />\n          <path\n            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"\n            fill="white"\n          />\n          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />\n        </svg>\n      '])));case pa.Files:return en(oa||(oa=Bn(['\n        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M17 8C17.1354 8 17.263 8.02604 17.3828 8.07812C17.5078 8.13021 17.6146 8.20312 17.7031 8.29688C17.7969 8.38542 17.8698 8.48958 17.9219 8.60938C17.974 8.72917 18 8.85677 18 8.99219C18 9.14844 17.9635 9.29948 17.8906 9.44531L14.6172 16H2V5C2 4.85938 2.02604 4.72917 2.07812 4.60938C2.13021 4.48958 2.20052 4.38542 2.28906 4.29688C2.38281 4.20312 2.48958 4.13021 2.60938 4.07812C2.72917 4.02604 2.85938 4 3 4H5.75C5.98438 4 6.1849 4.02604 6.35156 4.07812C6.52344 4.125 6.67448 4.1849 6.80469 4.25781C6.9401 4.33073 7.0599 4.41146 7.16406 4.5C7.26823 4.58854 7.3724 4.66927 7.47656 4.74219C7.58594 4.8151 7.70052 4.8776 7.82031 4.92969C7.94531 4.97656 8.08854 5 8.25 5H14C14.1406 5 14.2708 5.02604 14.3906 5.07812C14.5104 5.13021 14.6146 5.20312 14.7031 5.29688C14.7969 5.38542 14.8698 5.48958 14.9219 5.60938C14.974 5.72917 15 5.85938 15 6V8H17ZM3 13.3828L5.41406 8.55469C5.5026 8.38281 5.625 8.2474 5.78125 8.14844C5.94271 8.04948 6.11979 8 6.3125 8H14V6H8.25C8.01562 6 7.8125 5.97656 7.64062 5.92969C7.47396 5.8776 7.32292 5.8151 7.1875 5.74219C7.05729 5.66927 6.9401 5.58854 6.83594 5.5C6.73177 5.41146 6.625 5.33073 6.51562 5.25781C6.41146 5.1849 6.29688 5.125 6.17188 5.07812C6.05208 5.02604 5.91146 5 5.75 5H3V13.3828ZM17 9H6.3125L3.3125 15H14L17 9Z"\n          />\n        </svg>\n      '])));case pa.Back:return en(ia||(ia=Bn(['\n        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"\n          />\n        </svg>\n      '])));case pa.Upload:return en(aa||(aa=Bn(['\n    <svg class="upload-icon" width="10" height="12"  xmlns="http://www.w3.org/2000/svg">\n      <path\n        d="m9.58733,0l0,0.74599l-9.22101,0l0,-0.74599l9.22101,0zm0.3602,5.70569l-0.72039,0.52453l-3.73803,-2.7392l0,8.44489l-1.02456,0l0,-8.44489l-3.73803,2.7392l-0.72039,-0.52453l4.9707,-3.64838l4.9707,3.64838z"\n      />\n    </svg>\n  '])));case pa.FileCloud:return en(sa||(sa=Bn(['\n    <svg width="16" height="16"  xmlns="http://www.w3.org/2000/svg">\n      <path\n        d="m8,0c2.8166,0 4.4145,1.9233 4.6469,4.246l0.071,0c1.8127,0 3.2821,1.5119 3.2821,3.377c0,0.0953 -0.0038,0.1897 -0.0114,0.283c-0.322,-0.4017 -0.6967,-0.7591 -1.1138,-1.062c-0.3104,-0.9329 -1.1627,-1.598 -2.1568,-1.598l-0.0711,0c-0.5137,0 -0.9439,-0.3893 -0.9951,-0.9005c-0.2021,-2.0206 -1.5433,-3.3455 -3.6518,-3.3455c-2.1139,0 -3.4489,1.3159 -3.6518,3.3455c-0.0511,0.5112 -0.4813,0.9005 -0.9951,0.9005l-0.071,0c-1.2539,0 -2.2821,1.0579 -2.2821,2.377c0,1.3191 1.0282,2.377 2.2821,2.377l2.6655,0c-0.087,0.323 -0.1466,0.6572 -0.1762,1l-2.4893,0c-1.8127,0 -3.2821,-1.5119 -3.2821,-3.377c0,-1.8029 1.3731,-3.2758 3.102,-3.372l0.2511,-0.005c0.2338,-2.338 1.8303,-4.246 4.6469,-4.246zm3.5,16c2.4853,0 4.5,-2.0147 4.5,-4.5c0,-2.4853 -2.0147,-4.5 -4.5,-4.5c-2.4853,0 -4.5,2.0147 -4.5,4.5c0,2.4853 2.0147,4.5 4.5,4.5zm0,-7c0.2761,0 0.5,0.2239 0.5,0.5l0,1.5l1.5,0c0.2761,0 0.5,0.2239 0.5,0.5c0,0.2761 -0.2239,0.5 -0.5,0.5l-1.5,0l0,1.5c0,0.2761 -0.2239,0.5 -0.5,0.5c-0.2761,0 -0.5,-0.2239 -0.5,-0.5l0,-1.5l-1.5,0c-0.2761,0 -0.5,-0.2239 -0.5,-0.5c0,-0.2761 0.2239,-0.5 0.5,-0.5l1.5,0l0,-1.5c0,-0.2761 0.2239,-0.5 0.5,-0.5z" fill="#0078D4"\n      />\n    </svg>\n  '])));case pa.DragFile:return en(ca||(ca=Bn(['\n    <svg width="13" height="16" xmlns="http://www.w3.org/2000/svg">\n      <path\n        d="m0,1.00189c0,-0.8451 0.983,-1.3091 1.636,-0.772l11.006,9.0622c0.724,0.5964 0.302,1.772 -0.636,1.772l-5.592,0c-0.435,0 -0.849,0.1892 -1.134,0.5185l-3.524,4.0725c-0.606,0.7003 -1.756,0.2717 -1.756,-0.6544l0,-13.9988zm12.006,9.0622l-11.006,-9.0622l0,13.9988l3.524,-4.0724c0.475,-0.5488 1.164,-0.8642 1.89,-0.8642l5.592,0z"\n      />\n    </svg>\n  '])));case pa.Cancel:return en(la||(la=Bn(['\n    <svg class="cancel-icon" width="10" height="10" xmlns="http://www.w3.org/2000/svg">\n      <path\n        d="m5.52795,4.92946l4.37418,4.36141l-0.57055,0.56806l-4.38052,-4.35509l-4.38052,4.35509l-0.57055,-0.56806l4.37418,-4.36141l-4.37418,-4.36141l0.57055,-0.56806l4.38052,4.35509l4.38052,-4.35509l0.57055,0.56806l-4.37418,4.36141z"\n      />\n    </svg>\n  '])));case pa.Success:return en(ua||(ua=Bn(['\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path fill="#009E00" d="m6.322,12c3.492,0 6.323,-2.6863 6.323,-6c0,-3.3137 -2.831,-6 -6.323,-6c-3.491,0 -6.322,2.6863 -6.322,6c0,3.3137 2.831,6 6.322,6z"/>\n      <path fill="white" d="m9.629,3.7509c-0.131,-0.125 -0.31,-0.1952 -0.496,-0.1952c-0.187,0 -0.365,0.0702 -0.497,0.1952l-3.267,3.1l-1.393,-1.3222c-0.177,-0.1695 -0.436,-0.2361 -0.68,-0.1746c-0.243,0.0615 -0.433,0.2418 -0.497,0.4725c-0.065,0.2307 0.005,0.4767 0.184,0.6449l1.807,1.7154c0.019,0.0331 0.041,0.0646 0.066,0.094c0.289,0.2562 0.738,0.2562 1.027,0c0.024,-0.0294 0.047,-0.0609 0.065,-0.0941l3.681,-3.4931c0.275,-0.2603 0.275,-0.6824 0,-0.9428z"/>\n    </svg>\n  '])));case pa.Fail:return en(da||(da=Bn(['\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path fill="#EF355D" d="m6,12c3.314,0 6,-2.6863 6,-6c0,-3.3137 -2.686,-6 -6,-6c-3.314,0 -6,2.6863 -6,6c0,3.3137 2.686,6 6,6z"/>\n      <path fill="white" d="m6.943,6.0004l1.544,-1.5444c0.169,-0.1683 0.236,-0.4142 0.174,-0.6448c-0.061,-0.2306 -0.241,-0.4107 -0.472,-0.4722c-0.231,-0.0616 -0.477,0.0049 -0.645,0.1742l-1.544,1.5443l-1.545,-1.5443c-0.26,-0.259 -0.681,-0.2583 -0.941,0.0014c-0.26,0.2598 -0.26,0.6808 -0.001,0.9414l1.544,1.5444l-1.544,1.5444c-0.259,0.2606 -0.259,0.6815 0.001,0.9413c0.26,0.2598 0.681,0.2604 0.941,0.0015l1.545,-1.5444l1.544,1.5444c0.261,0.2589 0.682,0.2583 0.942,-0.0015c0.259,-0.2598 0.26,-0.6807 0.001,-0.9413l-1.544,-1.5444z" />\n    </svg>\n  '])))}}function ma(){return void 0!==window.getWindowSegments}!function(e){e[e.image=2]="image",e[e.oneline=3]="oneline",e[e.twolines=4]="twolines",e[e.threelines=5]="threelines"}(Oi||(Oi={})),function(e){e[e.ArrowRight=0]="ArrowRight",e[e.ArrowDown=1]="ArrowDown",e[e.TeamSeparator=2]="TeamSeparator",e[e.Search=3]="Search",e[e.SkypeArrow=4]="SkypeArrow",e[e.SmallEmail=5]="SmallEmail",e[e.SmallChat=6]="SmallChat",e[e.ExpandDown=7]="ExpandDown",e[e.Overview=8]="Overview",e[e.Send=9]="Send",e[e.Contact=10]="Contact",e[e.Copy=11]="Copy",e[e.Phone=12]="Phone",e[e.CellPhone=13]="CellPhone",e[e.Chat=14]="Chat",e[e.Department=15]="Department",e[e.Email=16]="Email",e[e.OfficeLocation=17]="OfficeLocation",e[e.Person=18]="Person",e[e.Messages=19]="Messages",e[e.Organization=20]="Organization",e[e.ExpandRight=21]="ExpandRight",e[e.Profile=22]="Profile",e[e.Birthday=23]="Birthday",e[e.File=24]="File",e[e.Files=25]="Files",e[e.Back=26]="Back",e[e.Upload=27]="Upload",e[e.FileCloud=28]="FileCloud",e[e.DragFile=29]="DragFile",e[e.Cancel=30]="Cancel",e[e.Success=31]="Success",e[e.Fail=32]="Fail"}(pa||(pa={}));var ba,ya,ka,wa,xa,Ca,Ta=[xn(fa||(fa=Bn(["\n.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));border-radius:8px}.root .flyout.small{overflow-y:auto;overflow-x:hidden}.root.visible .flyout{display:inline-block;animation-name:fadeIn;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}.root.visible .flyout.small{overflow-y:auto;overflow-x:hidden}@keyframes fadeIn{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}\n"])))],_a=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Sa=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ia=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this))._edgePadding=24,e._renderedOnce=!1,e.avoidHidingAnchor=!0,e.handleWindowEvent=e.handleWindowEvent.bind(w(e)),e.handleResize=e.handleResize.bind(w(e)),e.handleKeyUp=e.handleKeyUp.bind(w(e)),e.addEventListener("expanded",(function(){window.requestAnimationFrame((function(){e.updateFlyout()}))})),e}return v(r,[{key:"isOpen",get:function(){return this._isOpen},set:function(e){var t=this,r=this._isOpen;r!==e&&(this._isOpen=e,window.requestAnimationFrame((function(){t.setupWindowEvents(t.isOpen);var e=t._flyout;!t.isOpen&&e&&(e.style.width=null,e.style.setProperty("--mgt-flyout-set-width",null),e.style.setProperty("--mgt-flyout-set-height",null),e.style.maxHeight=null,e.style.top=null,e.style.left=null,e.style.bottom=null)})),this.requestUpdate("isOpen",r),this.dispatchEvent(new Event(e?"opened":"closed")))}},{key:"_flyout",get:function(){return this.renderRoot.querySelector(".flyout")}},{key:"_anchor",get:function(){return this.renderRoot.querySelector(".anchor")}},{key:"_topScout",get:function(){return this.renderRoot.querySelector(".scout-top")}},{key:"_bottomScout",get:function(){return this.renderRoot.querySelector(".scout-bottom")}},{key:"open",value:function(){this.isOpen=!0}},{key:"close",value:function(){this.isOpen=!1}},{key:"disconnectedCallback",value:function(){this.setupWindowEvents(!1),Ot(y(r.prototype),"disconnectedCallback",this).call(this)}},{key:"updated",value:function(e){var t=this;Ot(y(r.prototype),"updated",this).call(this,e),window.requestAnimationFrame((function(){t.updateFlyout()}))}},{key:"render",value:function(){var e={dir:this.direction,root:!0,visible:this.isOpen},t=this.renderAnchor(),r=null;return this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0),(this.isOpen||this._renderedOnce)&&(this._renderedOnce=!0,r=en(ba||(ba=Bn(["\n        <div class="," @wheel=",">\n          ","\n        </div>\n      "])),this._smallView?"flyout small":"flyout",this.handleFlyoutWheel,this.renderFlyout())),en(ya||(ya=Bn(["\n      <div class=",'>\n        <div class="anchor">\n          ','\n        </div>\n        <div class="scout-top"></div>\n        <div class="scout-bottom"></div>\n        ',"\n      </div>\n    "])),Do(e),t,r)}},{key:"renderAnchor",value:function(){return en(ka||(ka=Bn(["\n      <slot></slot>\n    "])))}},{key:"renderFlyout",value:function(){return en(wa||(wa=Bn(['\n      <slot name="flyout"></slot>\n    '])))}},{key:"updateFlyout",value:function(){var e=this;if(this.isOpen){var t=this._anchor,r=this._flyout;if(r&&t){var n=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth;this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight;var o,i,a,s=0,c=0,l=r.getBoundingClientRect(),u=t.getBoundingClientRect(),d=this._topScout.getBoundingClientRect(),p=this._bottomScout.getBoundingClientRect(),f={height:this._windowHeight,left:0,top:0,width:n};if(ma()){var h,g,v=(ma()?window:null).getWindowSegments(),m=u.left+u.width/2,b=u.top+u.height/2,y=S(v);try{for(y.s();!(g=y.n()).done;){var k=g.value;if(m>=k.left&&b>=k.top){h=k;break}}}catch(C){y.e(C)}finally{y.f()}h&&(f.left=h.left,f.top=h.top,f.width=h.width,f.height=h.height)}l.width+2*this._edgePadding>f.width?l.width>f.width?(a=f.width,s=0):s=(f.width-l.width)/2:s=u.left+l.width+this._edgePadding>f.width?u.left-(u.left+l.width+this._edgePadding-f.width):u.left<this._edgePadding?this._edgePadding:u.left;var w=f.height-(u.top+u.height),x=u.top;this.avoidHidingAnchor?w<=l.height?x<l.height?x>w?(o=f.height-u.top,i=x):(c=u.bottom,i=w):(o=f.height-u.top,i=x):(c=u.bottom,i=w):l.height+2*this._edgePadding>f.height?l.height>=f.height?(i=f.height,c=0):c=(f.height-l.height)/2:c=u.top+u.height+l.height+this._edgePadding>f.height?f.height-l.height-this._edgePadding:Math.max(u.top+u.height,this._edgePadding),0===d.top&&0===d.left||(s-=d.left,"undefined"!==typeof o?o+=p.top-this._windowHeight:c-=d.top),"rtl"===this.direction?s>100&&this.offsetLeft>100&&(r.style.left="".concat(f.width-s+l.left-l.width-30,"px")):r.style.left="".concat(s+f.left,"px"),"undefined"!==typeof o?(r.style.top="unset",r.style.bottom="".concat(o,"px")):(r.style.bottom="unset",r.style.top="".concat(c+f.top,"px")),a&&(r.style.width="".concat(a,"px"),r.style.setProperty("--mgt-flyout-set-width","".concat(a,"px")),window.requestAnimationFrame((function(){return e.updateFlyout()}))),i?(r.style.maxHeight="".concat(i,"px"),r.style.setProperty("--mgt-flyout-set-height","".concat(i,"px"))):(r.style.maxHeight=null,r.style.setProperty("--mgt-flyout-set-height","unset"))}}}},{key:"setupWindowEvents",value:function(e){e&&this.isLightDismiss?(window.addEventListener("wheel",this.handleWindowEvent),window.addEventListener("pointerdown",this.handleWindowEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("keyup",this.handleKeyUp)):(window.removeEventListener("wheel",this.handleWindowEvent),window.removeEventListener("pointerdown",this.handleWindowEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("keyup",this.handleKeyUp))}},{key:"handleWindowEvent",value:function(e){var t=this._flyout;if(t)if(e.composedPath){var r=e.composedPath();if(r.includes(t)||"pointerdown"===e.type&&r.includes(this))return}else for(var n=e.target;n;)if((n=n.parentElement)===t||"pointerdown"===e.type&&n===this)return;this.close()}},{key:"handleResize",value:function(e){this.close()}},{key:"handleKeyUp",value:function(e){"Escape"===e.key&&this.close()}},{key:"handleFlyoutWheel",value:function(e){e.preventDefault()}}],[{key:"styles",get:function(){return Ta}}]),r}(Un);_a([hn({attribute:"light-dismiss",type:Boolean}),Sa("design:type",Boolean)],Ia.prototype,"isLightDismiss",void 0),_a([hn({attribute:null,type:Boolean}),Sa("design:type",Boolean)],Ia.prototype,"avoidHidingAnchor",void 0),_a([hn({attribute:"isOpen",type:Boolean}),Sa("design:type",Boolean),Sa("design:paramtypes",[Boolean])],Ia.prototype,"isOpen",null),Ia=_a([fn("mgt-flyout"),Sa("design:paramtypes",[])],Ia),function(e){e[e.none=0]="none",e[e.hover=1]="hover",e[e.click=2]="click"}(xa||(xa={}));var Ea,Aa,Ra,Pa,Oa,Na,Da,La,Ma,Ua,Fa,za,Ha,Ba,qa,ja,Ga,Va,Ka,Qa,Wa,Ja,Ya,Xa,Za,$a,es,ts,rs=[xn(Ca||(Ca=Bn(["\n@charset \"UTF-8\";:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host([hidden]){display:none}:host{display:inline-block;font-family:var(--font-family,var(--default-font-family));vertical-align:top}:host .root{display:block;margin:-11px -13px;padding:11px 13px}:host .root:focus-visible{outline:0}:host svg,mgt-person svg{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root,mgt-person .person-root{position:relative;display:flex;align-items:center;color:var(--color,var(--color-sub1,#323130))}:host .person-root.clickable,mgt-person .person-root.clickable{cursor:pointer}:host .person-root.small:focus-visible,mgt-person .person-root.small:focus-visible{outline:auto}:host .person-root .user-avatar,mgt-person .person-root .user-avatar{position:relative;width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));display:flex;justify-content:center;align-items:center;flex-shrink:0;cursor:var(--avatar-cursor,inherit)}:host .person-root .user-avatar .user-presence,mgt-person .person-root .user-avatar .user-presence{margin:0;position:absolute;left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);top:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);border:2px solid var(--presence-background-color,var(--background-color,#fff));border-radius:50%}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#b4009e}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg{color:#b4009e;width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-basic,mgt-person .person-root .user-avatar .user-presence .presence-basic{width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);border-style:solid;border-width:2px;border-radius:50%;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);vertical-align:top;display:flex;align-items:center}:host .person-root .user-avatar .user-presence .presence-basic.presence-offline,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-offline{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#8a8886}:host .person-root .user-avatar .user-presence .presence-basic.presence-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-available{background-color:#6bb700;border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-available{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-away,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-away{background-color:#fa4;border-color:#fa4}:host .person-root .user-avatar .user-presence .presence-basic.presence-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-dnd{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-busy{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-offline::before,mgt-person .person-root .user-avatar .user-presence .presence-offline::before{content:\"\uf13d\";color:#8a8886;font-weight:700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-available::before,mgt-person .person-root .user-avatar .user-presence .presence-available::before{content:\"\uef80\";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-available::before{content:\"\uef80\";color:#6bb700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-away::before,mgt-person .person-root .user-avatar .user-presence .presence-away::before{content:\"\uef81\";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-dnd::before{content:\"\uef82\";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-dnd::before{content:\"\uef82\";color:#c50f1f;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar.initials,mgt-person .person-root .user-avatar.initials{color:var(--initials-color,#fff);border-radius:var(--avatar-border-radius,50%);font-weight:400}:host .person-root .user-avatar.initials .contact-icon,:host .person-root .user-avatar.initials .initials-text,mgt-person .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .initials-text{cursor:var(--avatar-cursor,inherit);margin-top:-1px;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .4)}:host .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .contact-icon{display:inline}:host .person-root .user-avatar.small,mgt-person .person-root .user-avatar.small{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root .user-avatar.small .contact-icon,:host .person-root .user-avatar.small .initials-text,mgt-person .person-root .user-avatar.small .contact-icon,mgt-person .person-root .user-avatar.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}:host .person-root .user-avatar.small .user-presence,mgt-person .person-root .user-avatar.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}:host .person-root .user-avatar.small .user-presence .presence-basic,mgt-person .person-root .user-avatar.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}:host .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}:host .person-root .user-avatar.small .user-presence .presence-available::before,:host .person-root .user-avatar.small .user-presence .presence-away::before,:host .person-root .user-avatar.small .user-presence .presence-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-offline::before,:host .person-root .user-avatar.small .user-presence .presence-oof-available::before,:host .person-root .user-avatar.small .user-presence .presence-oof-away::before,:host .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-offline::before{content:''}:host .person-root .user-avatar .img-wrapper,mgt-person .person-root .user-avatar .img-wrapper{height:100%;width:100%;display:flex;overflow:hidden;border:var(--avatar-border,0);border-radius:var(--avatar-border-radius,50%);position:relative}:host .person-root .user-avatar .img-wrapper img,mgt-person .person-root .user-avatar .img-wrapper img{position:absolute;display:block;top:-100%;right:-100%;bottom:-100%;left:-100%;margin:auto;height:100%;width:100%;object-fit:cover;object-position:top}:host .person-root .user-avatar .img-wrapper img:focus(),mgt-person .person-root .user-avatar .img-wrapper img:focus(){outline:0}:host .person-root .user-avatar.pinkRed10,mgt-person .person-root .user-avatar.pinkRed10{background-color:var(--initials-background-color,#750b1c)}:host .person-root .user-avatar.red20,mgt-person .person-root .user-avatar.red20{background-color:var(--initials-background-color,#a4262c)}:host .person-root .user-avatar.red10,mgt-person .person-root .user-avatar.red10{background-color:var(--initials-background-color,#d13438)}:host .person-root .user-avatar.orange20,mgt-person .person-root .user-avatar.orange20{background-color:var(--initials-background-color,#ca5010)}:host .person-root .user-avatar.orangeYellow20,mgt-person .person-root .user-avatar.orangeYellow20{background-color:var(--initials-background-color,#986f0b)}:host .person-root .user-avatar.green10,mgt-person .person-root .user-avatar.green10{background-color:var(--initials-background-color,#498205)}:host .person-root .user-avatar.green20,mgt-person .person-root .user-avatar.green20{background-color:var(--initials-background-color,#0b6a0b)}:host .person-root .user-avatar.cyan20,mgt-person .person-root .user-avatar.cyan20{background-color:var(--initials-background-color,#038387)}:host .person-root .user-avatar.cyan30,mgt-person .person-root .user-avatar.cyan30{background-color:var(--initials-background-color,#005b70)}:host .person-root .user-avatar.cyanBlue10,mgt-person .person-root .user-avatar.cyanBlue10{background-color:var(--initials-background-color,#0078d4)}:host .person-root .user-avatar.cyanBlue20,mgt-person .person-root .user-avatar.cyanBlue20{background-color:var(--initials-background-color,#004e8c)}:host .person-root .user-avatar.blue10,mgt-person .person-root .user-avatar.blue10{background-color:var(--initials-background-color,#4f6bed)}:host .person-root .user-avatar.blueMagenta30,mgt-person .person-root .user-avatar.blueMagenta30{background-color:var(--initials-background-color,#5c2e91)}:host .person-root .user-avatar.blueMagenta20,mgt-person .person-root .user-avatar.blueMagenta20{background-color:var(--initials-background-color,#8764b8)}:host .person-root .user-avatar.magenta20,mgt-person .person-root .user-avatar.magenta20{background-color:var(--initials-background-color,#881798)}:host .person-root .user-avatar.magenta10,mgt-person .person-root .user-avatar.magenta10{background-color:var(--initials-background-color,#c239b3)}:host .person-root .user-avatar.magentaPink10,mgt-person .person-root .user-avatar.magentaPink10{background-color:var(--initials-background-color,#e3008c)}:host .person-root .user-avatar.orange30,mgt-person .person-root .user-avatar.orange30{background-color:var(--initials-background-color,#8e562e)}:host .person-root .user-avatar.gray30,mgt-person .person-root .user-avatar.gray30{background-color:var(--initials-background-color,#7a7574)}:host .person-root .user-avatar.gray20,mgt-person .person-root .user-avatar.gray20{background-color:var(--initials-background-color,#69797e)}:host .person-root .details,mgt-person .person-root .details{flex-shrink:1;display:flex;flex-direction:column;overflow:hidden;line-height:1.4;margin:var(--details-spacing,0 0 0 12px)}:host .person-root .details.small,mgt-person .person-root .details.small{margin:var(--details-spacing,0 0 0 6px)}:host .person-root .details>div,mgt-person .person-root .details>div{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}:host .person-root .details .line1,mgt-person .person-root .details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,600);text-transform:var(text-transform,none)}:host .person-root .details .line2,mgt-person .person-root .details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--email-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none))}:host .person-root .details .line3,mgt-person .person-root .details .line3{color:var(--line3-color,var(--color-sub2,#717171));font-size:var(--line3-font-size,var(--email-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none))}:host .avatar-icon,mgt-person .avatar-icon{display:flex;align-items:center;justify-content:center;line-height:1;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .5);width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));overflow:hidden;border-radius:var(--avatar-border-radius,50%)}:host .avatar-icon.small,mgt-person .avatar-icon.small{font-size:var(--avatar-size-s,var(--avatar-size,24px));width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}[dir=rtl] .root{direction:rtl}[dir=rtl] svg{direction:rtl}[dir=rtl] .person-root .user-avatar{position:relative}[dir=rtl] .person-root .details{margin:var(--details-spacing,0 12px 0 0)}[dir=rtl] .person-root .details.small{margin:var(--details-spacing,0 6px 0 0)}[dir=rtl] .person-root .user-presence .presence-oof-offline svg{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-offline::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-away::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root.small .contact-icon,[dir=rtl] .person-root.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}[dir=rtl] .person-root.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}[dir=rtl] .person-root.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}[dir=rtl] .person-root.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path,mgt-person svg,mgt-person svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path,mgt-person svg,mgt-person svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"],["\n@charset \"UTF-8\";:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host([hidden]){display:none}:host{display:inline-block;font-family:var(--font-family,var(--default-font-family));vertical-align:top}:host .root{display:block;margin:-11px -13px;padding:11px 13px}:host .root:focus-visible{outline:0}:host svg,mgt-person svg{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root,mgt-person .person-root{position:relative;display:flex;align-items:center;color:var(--color,var(--color-sub1,#323130))}:host .person-root.clickable,mgt-person .person-root.clickable{cursor:pointer}:host .person-root.small:focus-visible,mgt-person .person-root.small:focus-visible{outline:auto}:host .person-root .user-avatar,mgt-person .person-root .user-avatar{position:relative;width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));display:flex;justify-content:center;align-items:center;flex-shrink:0;cursor:var(--avatar-cursor,inherit)}:host .person-root .user-avatar .user-presence,mgt-person .person-root .user-avatar .user-presence{margin:0;position:absolute;left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);top:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);border:2px solid var(--presence-background-color,var(--background-color,#fff));border-radius:50%}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#b4009e}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg{color:#b4009e;width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-basic,mgt-person .person-root .user-avatar .user-presence .presence-basic{width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);border-style:solid;border-width:2px;border-radius:50%;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);vertical-align:top;display:flex;align-items:center}:host .person-root .user-avatar .user-presence .presence-basic.presence-offline,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-offline{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#8a8886}:host .person-root .user-avatar .user-presence .presence-basic.presence-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-available{background-color:#6bb700;border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-available{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-away,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-away{background-color:#fa4;border-color:#fa4}:host .person-root .user-avatar .user-presence .presence-basic.presence-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-dnd{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-busy{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-offline::before,mgt-person .person-root .user-avatar .user-presence .presence-offline::before{content:\"\uf13d\";color:#8a8886;font-weight:700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-available::before,mgt-person .person-root .user-avatar .user-presence .presence-available::before{content:\"\uef80\";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-available::before{content:\"\uef80\";color:#6bb700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-away::before,mgt-person .person-root .user-avatar .user-presence .presence-away::before{content:\"\uef81\";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-dnd::before{content:\"\uef82\";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-dnd::before{content:\"\uef82\";color:#c50f1f;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar.initials,mgt-person .person-root .user-avatar.initials{color:var(--initials-color,#fff);border-radius:var(--avatar-border-radius,50%);font-weight:400}:host .person-root .user-avatar.initials .contact-icon,:host .person-root .user-avatar.initials .initials-text,mgt-person .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .initials-text{cursor:var(--avatar-cursor,inherit);margin-top:-1px;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .4)}:host .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .contact-icon{display:inline}:host .person-root .user-avatar.small,mgt-person .person-root .user-avatar.small{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root .user-avatar.small .contact-icon,:host .person-root .user-avatar.small .initials-text,mgt-person .person-root .user-avatar.small .contact-icon,mgt-person .person-root .user-avatar.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}:host .person-root .user-avatar.small .user-presence,mgt-person .person-root .user-avatar.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}:host .person-root .user-avatar.small .user-presence .presence-basic,mgt-person .person-root .user-avatar.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}:host .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}:host .person-root .user-avatar.small .user-presence .presence-available::before,:host .person-root .user-avatar.small .user-presence .presence-away::before,:host .person-root .user-avatar.small .user-presence .presence-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-offline::before,:host .person-root .user-avatar.small .user-presence .presence-oof-available::before,:host .person-root .user-avatar.small .user-presence .presence-oof-away::before,:host .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-offline::before{content:''}:host .person-root .user-avatar .img-wrapper,mgt-person .person-root .user-avatar .img-wrapper{height:100%;width:100%;display:flex;overflow:hidden;border:var(--avatar-border,0);border-radius:var(--avatar-border-radius,50%);position:relative}:host .person-root .user-avatar .img-wrapper img,mgt-person .person-root .user-avatar .img-wrapper img{position:absolute;display:block;top:-100%;right:-100%;bottom:-100%;left:-100%;margin:auto;height:100%;width:100%;object-fit:cover;object-position:top}:host .person-root .user-avatar .img-wrapper img:focus(),mgt-person .person-root .user-avatar .img-wrapper img:focus(){outline:0}:host .person-root .user-avatar.pinkRed10,mgt-person .person-root .user-avatar.pinkRed10{background-color:var(--initials-background-color,#750b1c)}:host .person-root .user-avatar.red20,mgt-person .person-root .user-avatar.red20{background-color:var(--initials-background-color,#a4262c)}:host .person-root .user-avatar.red10,mgt-person .person-root .user-avatar.red10{background-color:var(--initials-background-color,#d13438)}:host .person-root .user-avatar.orange20,mgt-person .person-root .user-avatar.orange20{background-color:var(--initials-background-color,#ca5010)}:host .person-root .user-avatar.orangeYellow20,mgt-person .person-root .user-avatar.orangeYellow20{background-color:var(--initials-background-color,#986f0b)}:host .person-root .user-avatar.green10,mgt-person .person-root .user-avatar.green10{background-color:var(--initials-background-color,#498205)}:host .person-root .user-avatar.green20,mgt-person .person-root .user-avatar.green20{background-color:var(--initials-background-color,#0b6a0b)}:host .person-root .user-avatar.cyan20,mgt-person .person-root .user-avatar.cyan20{background-color:var(--initials-background-color,#038387)}:host .person-root .user-avatar.cyan30,mgt-person .person-root .user-avatar.cyan30{background-color:var(--initials-background-color,#005b70)}:host .person-root .user-avatar.cyanBlue10,mgt-person .person-root .user-avatar.cyanBlue10{background-color:var(--initials-background-color,#0078d4)}:host .person-root .user-avatar.cyanBlue20,mgt-person .person-root .user-avatar.cyanBlue20{background-color:var(--initials-background-color,#004e8c)}:host .person-root .user-avatar.blue10,mgt-person .person-root .user-avatar.blue10{background-color:var(--initials-background-color,#4f6bed)}:host .person-root .user-avatar.blueMagenta30,mgt-person .person-root .user-avatar.blueMagenta30{background-color:var(--initials-background-color,#5c2e91)}:host .person-root .user-avatar.blueMagenta20,mgt-person .person-root .user-avatar.blueMagenta20{background-color:var(--initials-background-color,#8764b8)}:host .person-root .user-avatar.magenta20,mgt-person .person-root .user-avatar.magenta20{background-color:var(--initials-background-color,#881798)}:host .person-root .user-avatar.magenta10,mgt-person .person-root .user-avatar.magenta10{background-color:var(--initials-background-color,#c239b3)}:host .person-root .user-avatar.magentaPink10,mgt-person .person-root .user-avatar.magentaPink10{background-color:var(--initials-background-color,#e3008c)}:host .person-root .user-avatar.orange30,mgt-person .person-root .user-avatar.orange30{background-color:var(--initials-background-color,#8e562e)}:host .person-root .user-avatar.gray30,mgt-person .person-root .user-avatar.gray30{background-color:var(--initials-background-color,#7a7574)}:host .person-root .user-avatar.gray20,mgt-person .person-root .user-avatar.gray20{background-color:var(--initials-background-color,#69797e)}:host .person-root .details,mgt-person .person-root .details{flex-shrink:1;display:flex;flex-direction:column;overflow:hidden;line-height:1.4;margin:var(--details-spacing,0 0 0 12px)}:host .person-root .details.small,mgt-person .person-root .details.small{margin:var(--details-spacing,0 0 0 6px)}:host .person-root .details>div,mgt-person .person-root .details>div{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}:host .person-root .details .line1,mgt-person .person-root .details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,600);text-transform:var(text-transform,none)}:host .person-root .details .line2,mgt-person .person-root .details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--email-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none))}:host .person-root .details .line3,mgt-person .person-root .details .line3{color:var(--line3-color,var(--color-sub2,#717171));font-size:var(--line3-font-size,var(--email-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none))}:host .avatar-icon,mgt-person .avatar-icon{display:flex;align-items:center;justify-content:center;line-height:1;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .5);width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));overflow:hidden;border-radius:var(--avatar-border-radius,50%)}:host .avatar-icon.small,mgt-person .avatar-icon.small{font-size:var(--avatar-size-s,var(--avatar-size,24px));width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}[dir=rtl] .root{direction:rtl}[dir=rtl] svg{direction:rtl}[dir=rtl] .person-root .user-avatar{position:relative}[dir=rtl] .person-root .details{margin:var(--details-spacing,0 12px 0 0)}[dir=rtl] .person-root .details.small{margin:var(--details-spacing,0 6px 0 0)}[dir=rtl] .person-root .user-presence .presence-oof-offline svg{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-offline::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-away::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root.small .contact-icon,[dir=rtl] .person-root.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}[dir=rtl] .person-root.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}[dir=rtl] .person-root.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}[dir=rtl] .person-root.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path,mgt-person svg,mgt-person svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path,mgt-person svg,mgt-person svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"])))],ns={photoFor:"Photo for",emailAddress:"Email address",initials:"Initials"},os=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},is=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},as=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};!function(e){e[e.avatar=2]="avatar",e[e.oneline=3]="oneline",e[e.twolines=4]="twolines",e[e.threelines=5]="threelines"}(es||(es={})),function(e){e.photo="photo",e.initials="initials"}(ts||(ts={}));var ss,cs=["businessPhones","displayName","givenName","jobTitle","mail","mobilePhone","officeLocation","preferredLanguage","surname","userPrincipalName","id"],ls=$a=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this)).personCardInteraction=xa.none,e.line1Property="displayName",e.line2Property="email",e.line3Property="jobTitle",e.view=Oi.image,e.avatarSize="auto",e.disableImageFetch=!1,e._isInvalidImageSrc=!1,e._avatarType="photo",e}return v(r,[{key:"strings",get:function(){return ns}},{key:"personQuery",get:function(){return this._personQuery},set:function(e){e!==this._personQuery&&(this._personQuery=e,this.personDetailsInternal=null,this.requestStateUpdate())}},{key:"fallbackDetails",get:function(){return this._fallbackDetails},set:function(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,this.personDetailsInternal||(e&&e.displayName?this._personAvatarBg=this.getColorFromName(e.displayName):this._personAvatarBg="gray20",this.requestStateUpdate()))}},{key:"userId",get:function(){return this._userId},set:function(e){e!==this._userId&&(this._userId=e,this.personDetailsInternal=null,this.requestStateUpdate())}},{key:"personDetailsInternal",get:function(){return this._personDetailsInternal},set:function(e){this._personDetailsInternal!==e&&(this._personDetailsInternal=e,e&&e.displayName?this._personAvatarBg=this.getColorFromName(e.displayName):this._personAvatarBg="gray20",this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetailsInternal"))}},{key:"personDetails",get:function(){return this._personDetails},set:function(e){this._personDetails!==e&&(this._personDetails=e,e&&e.displayName?this._personAvatarBg=this.getColorFromName(e.displayName):this._personAvatarBg="gray20",this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetails"))}},{key:"personImage",get:function(){return this._personImage||this._fetchedImage},set:function(e){if(e!==this._personImage){this._isInvalidImageSrc=!e;var t=this._personImage;this._personImage=e,this.requestUpdate("personImage",t)}}},{key:"avatarType",get:function(){return this._avatarType},set:function(e){e!==this._avatarType&&(this._avatarType=e,this.requestStateUpdate())}},{key:"personPresence",get:function(){return this._personPresence||this._fetchedPresence},set:function(e){if(e!==this._personPresence){var t=this._personPresence;this._personPresence=e,this.requestUpdate("personPresence",t)}}},{key:"flyout",get:function(){return this.renderRoot.querySelector(".flyout")}},{key:"render",value:function(){if(this.isLoadingState&&!this.personDetails&&!this.personDetailsInternal&&!this.fallbackDetails)return this.renderLoading();var e=this.personDetails||this.personDetailsInternal||this.fallbackDetails,t=this.getImage(),r=this.personPresence||this._fetchedPresence;if(!e&&!t)return this.renderNoData();e&&e.personImage||!t||(e.personImage=t);var n=this.renderTemplate("default",{person:e,personImage:t,personPresence:r});if(!n){var o=this.renderDetails(e,r),i=this.renderAvatar(e,t,r),a={"person-root":!0,clickable:this.personCardInteraction===xa.click,small:!this.isLargeAvatar()};n=en(Ea||(Ea=Bn(["\n        <div class=",' tabindex="0">\n          '," ","\n        </div>\n      "])),Do(a),i,o)}return this.personCardInteraction!==xa.none&&(n=this.renderFlyout(n,e,t,r)),en(Aa||(Aa=Bn(['\n      <div\n        class="root"\n        dir=',"\n        @click=","\n        @mouseenter=","\n        @mouseleave=","\n        @keydown=","\n      >\n        ","\n      </div>\n    "])),this.direction,this.handleMouseClick,this.handleMouseEnter,this.handleMouseLeave,this.handleKeyDown,n)}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null)||en(Ra||(Ra=Bn([""])))}},{key:"clearState",value:function(){this._personImage="",this._personDetailsInternal=null,this._fetchedImage=null,this._fetchedPresence=null}},{key:"renderNoData",value:function(){var e=this.renderTemplate("no-data",null);if(e)return e;var t={"avatar-icon":!0,"ms-Icon":!0,"ms-Icon--Contact":!0,small:!this.isLargeAvatar()};return en(Pa||(Pa=Bn(["\n      <i class=","></i>\n    "])),Do(t))}},{key:"renderImage",value:function(e,t){var r=this;if(t&&!this._isInvalidImageSrc&&"photo"===this._avatarType){var n="".concat(this.strings.photoFor," ").concat(e.displayName);return en(Oa||(Oa=Bn(['\n        <div class="img-wrapper">\n          <img alt='," src="," @error="," />\n        </div>\n      "])),n,t,(function(){return r._isInvalidImageSrc=!0}))}if(e){var o=this.getInitials(e);return en(Na||(Na=Bn(['\n        <span class="initials-text" aria-label="'," ",'">\n          ',"\n        </span>\n      "])),this.strings.initials,o,o&&o.length?en(Da||(Da=Bn(["\n                ","\n              "])),o):en(La||(La=Bn(['\n                <i class="ms-Icon ms-Icon--Contact contact-icon"></i>\n              ']))))}}},{key:"renderPresence",value:function(e){if(!this.showPresence||!e)return en(Ma||(Ma=Bn([""])));var t=null;switch(e.availability){case"DoNotDisturb":if("OutOfOffice"===e.activity)t="presence-oof-dnd";else t="presence-dnd";break;case"BeRightBack":t="presence-away";break;case"Available":switch(e.activity){case"Available":t="presence-available";break;case"OutOfOffice":t="presence-oof-available"}break;case"Busy":if("OutOfOffice"===e.activity)t="presence-oof-busy";else t="presence-busy";break;case"Away":switch(e.activity){case"Away":t="presence-away";break;case"OutOfOffice":t="presence-oof-offline"}break;case"Offline":switch(e.activity){case"Offline":case"OffWork":t="presence-offline";break;case"OutOfOffice":t="presence-oof-offline"}break;default:t="presence-offline"}var r={"ms-Icon":!0,"presence-basic":!0};r[t]=!0;var n=null;return n="presence-oof-offline"===t?en(Ua||(Ua=Bn(['\n        <div class="ms-Icon presence-basic presence-oof-offline-wrapper">\n          <i class="presence-oof-offline">\n            ',"\n          </i>\n        </div>\n      "])),va(pa.SkypeArrow,"#666666")):en(Fa||(Fa=Bn(["\n        <i class=",' aria-hidden="true"></i>\n      '])),Do(r)),en(za||(za=Bn(['\n      <div class="user-presence" title='," aria-label=",' role="img">\n        ',"\n      </div>\n    "])),e.activity,e.activity,n)}},{key:"renderAvatar",value:function(e,t,r){var n=!t||this._isInvalidImageSrc||this._avatarType===ts.initials,o={initials:n,small:!this.isLargeAvatar(),"user-avatar":!0},i="";if(n&&e?(o[this._personAvatarBg]=!0,i="".concat(this.strings.initials," ").concat(this.getInitials(e))):""!==(i=e&&e.displayName||"")&&(i="".concat(this.strings.photoFor," ").concat(i)),""===i){var a=ni(e);null!==a&&(i="".concat(this.strings.emailAddress," ").concat(a))}var s=this.renderImage(e,t),c=this.renderPresence(r);return en(Ha||(Ha=Bn(["\n      <div class="," title="," aria-label=",">\n        "," ","\n      </div>\n    "])),Do(o),i,i,s,c)}},{key:"handleLine1Clicked",value:function(){this.fireCustomEvent("line1clicked",this.personDetailsInternal)}},{key:"handleLine2Clicked",value:function(){this.fireCustomEvent("line2clicked",this.personDetailsInternal)}},{key:"handleLine3Clicked",value:function(){this.fireCustomEvent("line3clicked",this.personDetailsInternal)}},{key:"renderDetails",value:function(e,t){var r=this;if(!e||this.view===Oi.image||this.view===es.avatar)return en(Ba||(Ba=Bn([""])));var n=e;t&&(n.presenceActivity=null===t||void 0===t?void 0:t.activity,n.presenceAvailability=null===t||void 0===t?void 0:t.availability);var o=[];if(this.view>Oi.image)if(this.hasTemplate("line1")){var i=this.renderTemplate("line1",{person:n});o.push(en(qa||(qa=Bn(['\n          <div class="line1" @click=',">","</div>\n        "])),(function(){return r.handleLine1Clicked()}),i))}else{var a=this.getTextFromProperty(n,this.line1Property);a&&o.push(en(ja||(ja=Bn(['\n            <div class="line1" @click=',' role="presentation" aria-label="','">',"</div>\n          "])),(function(){return r.handleLine1Clicked()}),a,a))}if(this.view>Oi.oneline)if(this.hasTemplate("line2")){var s=this.renderTemplate("line2",{person:n});o.push(en(Ga||(Ga=Bn(['\n          <div class="line2" @click=',">","</div>\n        "])),(function(){return r.handleLine2Clicked()}),s))}else{var c=this.getTextFromProperty(n,this.line2Property);c&&o.push(en(Va||(Va=Bn(['\n            <div class="line2" @click=',' role="presentation" aria-label="','">',"</div>\n          "])),(function(){return r.handleLine2Clicked()}),c,c))}if(this.view>Oi.twolines)if(this.hasTemplate("line3")){var l=this.renderTemplate("line3",{person:n});o.push(en(Ka||(Ka=Bn(['\n          <div class="line3" @click=',">","</div>\n        "])),(function(){return r.handleLine3Clicked()}),l))}else{var u=this.getTextFromProperty(n,this.line3Property);u&&o.push(en(Qa||(Qa=Bn(['\n            <div class="line3" @click=',' role="presentation" aria-label="','">',"</div>\n          "])),(function(){return r.handleLine3Clicked()}),u,u))}var d=Do({details:!0,small:!this.isLargeAvatar()});return en(Wa||(Wa=Bn(['\n      <div class="','">\n        ',"\n      </div>\n    "])),d,o)}},{key:"renderFlyout",value:function(e,t,r,n){var o=this._personCardShouldRender?en(Ja||(Ja=Bn(['\n          <div slot="flyout">\n            ',"\n          </div>\n        "])),this.renderFlyoutContent(t,r,n)):en(Ya||(Ya=Bn([""])));return en(Xa||(Xa=Bn(['\n      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=',">\n        "," ","\n      </mgt-flyout>\n    "])),!1,e,o)}},{key:"renderFlyoutContent",value:function(e,t,r){return this.renderTemplate("person-card",{person:e,personImage:t})||en(Za||(Za=Bn(["\n        <mgt-person-card\n          lock-tab-navigation\n          .personDetails=","\n          .personImage=","\n          .personPresence=","\n          .showPresence=","\n        ></mgt-person-card>\n      "])),e,t,r,this.showPresence)}},{key:"loadState",value:function(){return as(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a,s,c,l,u;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=Pn.globalProvider)&&t.state!==Sn.Loading){e.next=3;break}return e.abrupt("return");case 3:if(!t||t.state!==Sn.SignedOut){e.next=6;break}return this.personDetailsInternal=null,e.abrupt("return");case 6:if(r=t.graph.forComponent(this),n=(n=[].concat(cs,[this.line1Property,this.line2Property,this.line3Property])).filter((function(e){return"email"!==e})),!(o=this.personDetailsInternal||this.personDetails)){e.next=24;break}if(o.personImage||!this.fetchImage||"photo"!==this._avatarType||this.personImage||this._fetchedImage){e.next=22;break}if(!("groupTypes"in o)){e.next=18;break}return e.next=15,Ti(r,o,$a.config.useContactApis);case 15:i=e.sent,e.next=21;break;case 18:return e.next=20,Ci(r,o,$a.config.useContactApis);case 20:i=e.sent;case 21:i&&(o.personImage=i,this._fetchedImage=i);case 22:e.next=64;break;case 24:if(!this.userId&&"me"!==this.personQuery){e.next=45;break}if("photo"!==this._avatarType||this.disableImageFetch){e.next=31;break}return e.next=28,ga(r,this.userId,n);case 28:a=e.sent,e.next=40;break;case 31:if("me"!==this.personQuery){e.next=37;break}return e.next=34,ui(r,n);case 34:a=e.sent,e.next=40;break;case 37:return e.next=39,di(r,this.userId,n);case 39:a=e.sent;case 40:this.personDetailsInternal=a,this.personDetails=a,this._fetchedImage=this.getImage(),e.next=64;break;case 45:if(!this.personQuery){e.next=64;break}return e.next=48,ti(r,this.personQuery,1);case 48:if((s=e.sent)&&0!==s.length){e.next=56;break}return e.next=52,hi(r,this.personQuery,1);case 52:if(e.t0=e.sent,e.t0){e.next=55;break}e.t0=[];case 55:s=e.t0;case 56:if(!s||!s.length){e.next=64;break}if(this.personDetailsInternal=s[0],this.personDetails=s[0],"photo"!==this._avatarType||this.disableImageFetch){e.next=64;break}return e.next=62,Ci(r,s[0],$a.config.useContactApis);case 62:(c=e.sent)&&(this.personDetailsInternal.personImage=c,this.personDetails.personImage=c,this._fetchedImage=c);case 64:if(l={activity:"Offline",availability:"Offline",id:null},!this.showPresence||this.personPresence||this._fetchedPresence){e.next=81;break}if(e.prev=66,!(o=this.personDetailsInternal||this.personDetails)){e.next=75;break}return u="me"!==this.personQuery?null===o||void 0===o?void 0:o.id:null,e.next=72,Ri(r,u);case 72:this._fetchedPresence=e.sent,e.next=76;break;case 75:this._fetchedPresence=l;case 76:e.next=81;break;case 78:e.prev=78,e.t1=e.catch(66),this._fetchedPresence=l;case 81:case"end":return e.stop()}}),e,this,[[66,78]])})))}},{key:"getInitials",value:function(e){if(e||(e=this.personDetailsInternal),e.initials)return e.initials;var t="";if(e.givenName&&(t+=e.givenName[0].toUpperCase()),e.surname&&(t+=e.surname[0].toUpperCase()),!t&&e.displayName)for(var r=e.displayName.split(/\s+/),n=0;n<2&&n<r.length;n++)r[n][0]&&this.isLetter(r[n][0])&&(t+=r[n][0].toUpperCase());return t}},{key:"getColorFromName",value:function(e){var t=e.split("").map((function(e){return e.charCodeAt(0)})).join(""),r=["pinkRed10","red20","red10","orange20","orangeYellow20","green10","green20","cyan20","cyan30","cyanBlue10","cyanBlue20","blue10","blueMagenta30","blueMagenta20","magenta20","magenta10","magentaPink10","orange30","gray30","gray20"];return r[parseInt(t,10)%r.length]}},{key:"getImage",value:function(){if(this.personImage)return this.personImage;if(this._fetchedImage)return this._fetchedImage;var e=this.personDetailsInternal||this.personDetails;return e&&e.personImage?e.personImage:null}},{key:"isLetter",value:function(e){try{return e.match(new RegExp("\\p{L}","u"))}catch(t){return e.toLowerCase()!==e.toUpperCase()}}},{key:"getTextFromProperty",value:function(e,t){if(!t||0===t.length)return null;for(var r,n=t.trim().split(","),o=0;!r&&o<n.length;){var i=n[o].trim();switch(i){case"mail":case"email":r=ni(e);break;default:r=e[i]}o++}return r}},{key:"isLargeAvatar",value:function(){return"large"===this.avatarSize||"auto"===this.avatarSize&&this.view>Oi.oneline}},{key:"handleMouseClick",value:function(e){this.personCardInteraction===xa.click&&this.showPersonCard()}},{key:"handleKeyDown",value:function(e){e&&"Enter"===e.key&&this.showPersonCard()}},{key:"handleMouseEnter",value:function(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this.personCardInteraction===xa.hover&&(this._mouseEnterTimeout=setTimeout(this.showPersonCard.bind(this),500))}},{key:"handleMouseLeave",value:function(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=setTimeout(this.hidePersonCard.bind(this),500)}},{key:"hidePersonCard",value:function(){var e=this.flyout;e&&e.close();var t=this.querySelector("mgt-person-card")||this.renderRoot.querySelector("mgt-person-card");t&&(t.isExpanded=!1,t.clearHistory())}},{key:"showPersonCard",value:function(){this._personCardShouldRender||(this._personCardShouldRender=!0);var e=this.flyout;e&&e.open()}}],[{key:"styles",get:function(){return rs}},{key:"requiredScopes",get:function(){var e=["user.readbasic.all","user.read","people.read","presence.read.all","presence.read"];return $a.config.useContactApis&&e.push("contacts.read"),e}}]),r}(Jn);ls.config={useContactApis:!0},os([hn({attribute:"person-query"}),is("design:type",String),is("design:paramtypes",[String])],ls.prototype,"personQuery",null),os([hn({attribute:"fallback-details",type:Object}),is("design:type",Object),is("design:paramtypes",[Object])],ls.prototype,"fallbackDetails",null),os([hn({attribute:"user-id"}),is("design:type",String),is("design:paramtypes",[String])],ls.prototype,"userId",null),os([hn({attribute:"show-presence",type:Boolean}),is("design:type",Boolean)],ls.prototype,"showPresence",void 0),os([hn({attribute:"avatar-size",type:String}),is("design:type",String)],ls.prototype,"avatarSize",void 0),os([hn({attribute:null,type:Object}),is("design:type",Object),is("design:paramtypes",[Object])],ls.prototype,"personDetailsInternal",null),os([hn({attribute:"person-details",type:Object}),is("design:type",Object),is("design:paramtypes",[Object])],ls.prototype,"personDetails",null),os([hn({attribute:"person-image",type:String}),is("design:type",String),is("design:paramtypes",[String])],ls.prototype,"personImage",null),os([hn({attribute:"fetch-image",type:Boolean}),is("design:type",Boolean)],ls.prototype,"fetchImage",void 0),os([hn({attribute:"disable-image-fetch",type:Boolean}),is("design:type",Boolean)],ls.prototype,"disableImageFetch",void 0),os([hn({attribute:"avatar-type",converter:function(e){return"initials"===(e=e.toLowerCase())?ts.initials:ts.photo}}),is("design:type",String),is("design:paramtypes",[String])],ls.prototype,"avatarType",null),os([hn({attribute:"person-presence",type:Object}),is("design:type",Object),is("design:paramtypes",[Object])],ls.prototype,"personPresence",null),os([hn({attribute:"person-card",converter:function(e,t){return e=e.toLowerCase(),"undefined"===typeof xa[e]?xa.none:xa[e]}}),is("design:type",Number)],ls.prototype,"personCardInteraction",void 0),os([hn({attribute:"line1-property"}),is("design:type",String)],ls.prototype,"line1Property",void 0),os([hn({attribute:"line2-property"}),is("design:type",String)],ls.prototype,"line2Property",void 0),os([hn({attribute:"line3-property"}),is("design:type",String)],ls.prototype,"line3Property",void 0),os([hn({converter:function(e){return e&&0!==e.length?(e=e.toLowerCase(),"undefined"===typeof Oi[e]?Oi.image:Oi[e]):Oi.image}}),is("design:type",Number)],ls.prototype,"view",void 0),os([gn(),is("design:type",String)],ls.prototype,"_fetchedImage",void 0),os([gn(),is("design:type",Object)],ls.prototype,"_fetchedPresence",void 0),os([gn(),is("design:type",Boolean)],ls.prototype,"_isInvalidImageSrc",void 0),os([gn(),is("design:type",Boolean)],ls.prototype,"_personCardShouldRender",void 0),ls=$a=os([fn("mgt-person"),is("design:paramtypes",[])],ls);var us=[xn(ss||(ss=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}:host .header,mgt-agenda .header{margin:var(--agenda-header-margin,40px 10px 14px 10px);font-family:var(--default-font-family);font-size:var(--agenda-header-font-size,24px);color:var(--agenda-header-color,var(--color-sub1,#323130))}:host .agenda>.group:first-child>.header,mgt-agenda .agenda>.group:first-child>.header{margin-top:0}:host .agenda-list,mgt-agenda .agenda-list{list-style-type:none;padding:0;margin:0;font-family:var(--default-font-family);font-style:normal;font-weight:400}:host .event,mgt-agenda .event{background:var(--event-background-color,#fff);border:var(--event-border,solid 2px transparent);box-shadow:var(--event-box-shadow,0 2px 8px var(--box-shadow-color,rgba(0,0,0,.092)));margin:var(--event-margin,0 10px 14px 10px);padding:var(--event-padding,0);display:flex;border-radius:8px}:host .narrow .event,mgt-agenda .narrow .event{flex-direction:column}:host .event-time-container,mgt-agenda .event-time-container{display:flex;flex-direction:column;margin:18px 38px 18px 18px;width:125px}:host .narrow .event-time-container,mgt-agenda .narrow .event-time-container{margin:14px 18px 8px 18px}:host .event-time,mgt-agenda .event-time{font-size:var(--event-time-font-size,12px);color:var(--event-time-color,var(--color,#000));font-weight:600}:host .event-duration,mgt-agenda .event-duration{color:rgba(16,16,16,.3)}:host .event-details-container,mgt-agenda .event-details-container{margin:14px 18px 14px 0}:host .narrow .event-details-container,mgt-agenda .narrow .event-details-container{margin:0 18px 14px 18px}:host .event-subject,mgt-agenda .event-subject{margin:0 18px 0 0;font-size:var(--event-subject-font-size,19px);color:var(--event-subject-color,var(--color-sub1,#323130))}:host .event-location-container,mgt-agenda .event-location-container{display:flex;margin:8px 18px 0 0}:host .event-location-icon svg,mgt-agenda .event-location-icon svg{height:12px}:host .event-location-icon svg path,mgt-agenda .event-location-icon svg path{stroke:var(--event-location-color,var(--color,#000))}:host .event-location,mgt-agenda .event-location{font-size:var(--event-location-font-size,12px);color:var(--event-location-color,var(--color,#000));margin:0 0 0 4px;line-height:17px}:host .event-attendees,mgt-agenda .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}:host .event-other-container,mgt-agenda .event-other-container{margin:2px 16px 4px 16px;margin-left:auto}:host .loading-element,mgt-agenda .loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .event-time-loading,mgt-agenda .event-time-loading{width:100px;height:10px}:host .event-subject-loading,mgt-agenda .event-subject-loading{width:263px;height:16px}:host .event-location-icon-loading,mgt-agenda .event-location-icon-loading{width:14px;height:14px}:host .event-location-loading,mgt-agenda .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .event-attendee-loading,mgt-agenda .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}[dir=rtl] .event-location{margin:0 4px 0 0}[dir=rtl] .event-time-container{direction:ltr;margin:18px 18px 18px 38px}[dir=rtl] .event-details-container{margin:14px 0 14px 18px}[dir=rtl] .event-details-container .event-subject{margin:0 0 0 18px}[dir=rtl] .event-details-container .event-location-container{margin:8px 0 0 18px}@media (forced-colors:active) and (prefers-color-scheme:dark){svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#000!important}}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}:host .header,mgt-agenda .header{margin:var(--agenda-header-margin,40px 10px 14px 10px);font-family:var(--default-font-family);font-size:var(--agenda-header-font-size,24px);color:var(--agenda-header-color,var(--color-sub1,#323130))}:host .agenda>.group:first-child>.header,mgt-agenda .agenda>.group:first-child>.header{margin-top:0}:host .agenda-list,mgt-agenda .agenda-list{list-style-type:none;padding:0;margin:0;font-family:var(--default-font-family);font-style:normal;font-weight:400}:host .event,mgt-agenda .event{background:var(--event-background-color,#fff);border:var(--event-border,solid 2px transparent);box-shadow:var(--event-box-shadow,0 2px 8px var(--box-shadow-color,rgba(0,0,0,.092)));margin:var(--event-margin,0 10px 14px 10px);padding:var(--event-padding,0);display:flex;border-radius:8px}:host .narrow .event,mgt-agenda .narrow .event{flex-direction:column}:host .event-time-container,mgt-agenda .event-time-container{display:flex;flex-direction:column;margin:18px 38px 18px 18px;width:125px}:host .narrow .event-time-container,mgt-agenda .narrow .event-time-container{margin:14px 18px 8px 18px}:host .event-time,mgt-agenda .event-time{font-size:var(--event-time-font-size,12px);color:var(--event-time-color,var(--color,#000));font-weight:600}:host .event-duration,mgt-agenda .event-duration{color:rgba(16,16,16,.3)}:host .event-details-container,mgt-agenda .event-details-container{margin:14px 18px 14px 0}:host .narrow .event-details-container,mgt-agenda .narrow .event-details-container{margin:0 18px 14px 18px}:host .event-subject,mgt-agenda .event-subject{margin:0 18px 0 0;font-size:var(--event-subject-font-size,19px);color:var(--event-subject-color,var(--color-sub1,#323130))}:host .event-location-container,mgt-agenda .event-location-container{display:flex;margin:8px 18px 0 0}:host .event-location-icon svg,mgt-agenda .event-location-icon svg{height:12px}:host .event-location-icon svg path,mgt-agenda .event-location-icon svg path{stroke:var(--event-location-color,var(--color,#000))}:host .event-location,mgt-agenda .event-location{font-size:var(--event-location-font-size,12px);color:var(--event-location-color,var(--color,#000));margin:0 0 0 4px;line-height:17px}:host .event-attendees,mgt-agenda .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}:host .event-other-container,mgt-agenda .event-other-container{margin:2px 16px 4px 16px;margin-left:auto}:host .loading-element,mgt-agenda .loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .event-time-loading,mgt-agenda .event-time-loading{width:100px;height:10px}:host .event-subject-loading,mgt-agenda .event-subject-loading{width:263px;height:16px}:host .event-location-icon-loading,mgt-agenda .event-location-icon-loading{width:14px;height:14px}:host .event-location-loading,mgt-agenda .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .event-attendee-loading,mgt-agenda .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}[dir=rtl] .event-location{margin:0 4px 0 0}[dir=rtl] .event-time-container{direction:ltr;margin:18px 18px 18px 38px}[dir=rtl] .event-details-container{margin:14px 0 14px 18px}[dir=rtl] .event-details-container .event-subject{margin:0 0 0 18px}[dir=rtl] .event-details-container .event-location-container{margin:8px 0 0 18px}@media (forced-colors:active) and (prefers-color-scheme:dark){svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#000!important}}\n"])))],ds=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function ps(e,t,r,n){return ds(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return"calendars.read",i="startdatetime=".concat(t.toISOString()),a="enddatetime=".concat(r.toISOString()),s=n?"groups/".concat(n,"/calendar"):"me",s+="/calendarview?".concat(i,"&").concat(a),c=e.api(s).middlewareOptions($t("calendars.read")).orderby("start/dateTime"),o.abrupt("return",bo.create(e,c));case 7:case"end":return o.stop()}}),o)})))}var fs,hs,gs,vs,ms,bs,ys,ks,ws,xs,Cs,Ts,_s,Ss,Is,Es,As,Rs,Ps,Os,Ns,Ds=function(e,t){var r=e.startNode.parentNode,n=void 0===t?e.endNode:t.startNode,o=r.insertBefore(Cr(),n);r.insertBefore(Cr(),n);var i=new qr(e.options);return i.insertAfterNode(o),i},Ls=function(e,t){return e.setValue(t),e.commit(),e},Ms=function(e,t,r){var n=e.startNode.parentNode,o=r?r.startNode:e.endNode,i=t.endNode.nextSibling;i!==o&&function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t!==r;){var o=t.nextSibling;e.insertBefore(t,n),t=o}}(n,t.startNode,i,o)},Us=function(e){gr(e.startNode.parentNode,e.startNode,e.endNode.nextSibling)},Fs=function(e,t,r){for(var n=new Map,o=t;o<=r;o++)n.set(e[o],o);return n},zs=new WeakMap,Hs=new WeakMap,Bs=Rr((function(e,t,r){var n;return void 0===r?r=t:void 0!==t&&(n=t),function(t){if(!(t instanceof qr))throw new Error("repeat can only be used in text bindings");var o,i,a,s=zs.get(t)||[],c=Hs.get(t)||[],l=[],u=[],d=[],p=0,f=S(e);try{for(f.s();!(o=f.n()).done;){var h=o.value;d[p]=n?n(h,p):p,u[p]=r(h,p),p++}}catch(T){f.e(T)}finally{f.f()}for(var g=0,v=s.length-1,m=0,b=u.length-1;g<=v&&m<=b;)if(null===s[g])g++;else if(null===s[v])v--;else if(c[g]===d[m])l[m]=Ls(s[g],u[m]),g++,m++;else if(c[v]===d[b])l[b]=Ls(s[v],u[b]),v--,b--;else if(c[g]===d[b])l[b]=Ls(s[g],u[b]),Ms(t,s[g],l[b+1]),g++,b--;else if(c[v]===d[m])l[m]=Ls(s[v],u[m]),Ms(t,s[v],s[g]),v--,m++;else if(void 0===i&&(i=Fs(d,m,b),a=Fs(c,g,v)),i.has(c[g]))if(i.has(c[v])){var y=a.get(d[m]),k=void 0!==y?s[y]:null;if(null===k){var w=Ds(t,s[g]);Ls(w,u[m]),l[m]=w}else l[m]=Ls(k,u[m]),Ms(t,k,s[g]),s[y]=null;m++}else Us(s[v]),v--;else Us(s[g]),g++;for(;m<=b;){var x=Ds(t,l[b+1]);Ls(x,u[m]),l[m++]=x}for(;g<=v;){var C=s[g++];null!==C&&Us(C)}zs.set(t,l),Hs.set(t,d)}})),qs=[xn(fs||(fs=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host .people-list,mgt-people .people-list{list-style-type:none;margin:var(--list-margin,8px 4px 8px 8px);padding:0;font-family:var(--default-font-family);color:var(--color,#000);font-style:normal;font-weight:400;display:flex;align-items:center}:host .people-person,mgt-people .people-person{margin:var(--avatar-margin,0 4px 0 0);display:flex}:host .overflow span,mgt-people .overflow span{vertical-align:middle}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host .people-list,mgt-people .people-list{list-style-type:none;margin:var(--list-margin,8px 4px 8px 8px);padding:0;font-family:var(--default-font-family);color:var(--color,#000);font-style:normal;font-weight:400;display:flex;align-items:center}:host .people-person,mgt-people .people-person{margin:var(--avatar-margin,0 4px 0 0);display:flex}:host .overflow span,mgt-people .overflow span{vertical-align:middle}\n"])))],js=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Gs=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Vs=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Ks=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this)).personCardInteraction=xa.hover,e.scopes=[],e._version="v1.0",e.showMax=3,e}return v(r,[{key:"groupId",get:function(){return this._groupId},set:function(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}},{key:"userIds",get:function(){return this._userIds},set:function(e){Gn(this._userIds,e)||(this._userIds=e,this.requestStateUpdate(!0))}},{key:"peopleQueries",get:function(){return this._peopleQueries},set:function(e){Gn(this._peopleQueries,e)||(this._peopleQueries=e,this.requestStateUpdate(!0))}},{key:"resource",get:function(){return this._resource},set:function(e){this._resource!==e&&(this._resource=e,this.requestStateUpdate(!0))}},{key:"version",get:function(){return this._version},set:function(e){this._version!==e&&(this._version=e,this.requestStateUpdate(!0))}},{key:"fallbackDetails",get:function(){return this._fallbackDetails},set:function(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,this.requestStateUpdate())}},{key:"clearState",value:function(){this.people=null}},{key:"requestStateUpdate",value:function(e){return e&&(this.people=null),Ot(y(r.prototype),"requestStateUpdate",this).call(this,e)}},{key:"render",value:function(){return this.isLoadingState?this.renderLoading():this.people&&0!==this.people.length?this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople():this.renderNoData()}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null)||en(hs||(hs=Bn([""])))}},{key:"renderPeople",value:function(){var e=this,t=this.people.slice(0,this.showMax).filter((function(e){return e}));return en(gs||(gs=Bn(['\n      <ul class="people-list" aria-label="people">\n        ',"\n        ","\n      </ul>\n    "])),Bs(t,(function(e){return e.id?e.id:e.displayName}),(function(t){return en(vs||(vs=Bn(['\n            <li class="people-person">\n              ',"\n            </li>\n          "])),e.renderPerson(t))})),this.people.length>this.showMax?this.renderOverflow():null)}},{key:"renderOverflow",value:function(){var e=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:e,max:this.showMax,people:this.people})||en(ms||(ms=Bn(['\n        <li aria-label="and ',' more attendees" class="overflow"><span>+',"<span></li>\n      "])),e,e)}},{key:"renderPerson",value:function(e){var t={activity:"Offline",availability:"Offline",id:null};this.showPresence&&this._peoplePresence&&(t=this._peoplePresence[e.id]);return this.renderTemplate("person",{person:e},e.id)||en(bs||(bs=Bn(["\n        <mgt-person\n          .personDetails=","\n          .fetchImage=","\n          .avatarSize=","\n          .personCardInteraction=","\n          .showPresence=","\n          .personPresence=","\n        ></mgt-person>\n      "])),e,!0,"small",this.personCardInteraction,this.showPresence,t)}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||en(ys||(ys=Bn([""])))}},{key:"loadState",value:function(){return Vs(this,void 0,void 0,Ze().mark((function e(){var t,r,n=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.people){e.next=39;break}if(!(t=Pn.globalProvider)||t.state!==Sn.SignedIn){e.next=39;break}if(r=t.graph.forComponent(this),!this.groupId){e.next=10;break}return e.next=7,gi(r,null,this.groupId,this.showMax,qo.person);case 7:this.people=e.sent,e.next=32;break;case 10:if(!this.userIds&&!this.peopleQueries){e.next=23;break}if(!this.userIds){e.next=17;break}return e.next=14,pi(r,this.userIds);case 14:this.people=e.sent,e.next=20;break;case 17:return e.next=19,fi(r,this.peopleQueries);case 19:this.people=e.sent;case 20:this._fallbackDetails?this.people=this.people.map((function(e,t){return e||(t<n._fallbackDetails.length?n._fallbackDetails[t]:null)})):this.people=this.people.filter((function(e){return null!==e})),e.next=32;break;case 23:if(!this.resource){e.next=29;break}return e.next=26,ii(r,this.version,this.resource,this.scopes);case 26:this.people=e.sent,e.next=32;break;case 29:return e.next=31,ri(r);case 31:this.people=e.sent;case 32:if(!this.showPresence){e.next=38;break}return e.next=35,Pi(r,this.people);case 35:this._peoplePresence=e.sent,e.next=39;break;case 38:this._peoplePresence=null;case 39:case"end":return e.stop()}}),e,this)})))}}],[{key:"styles",get:function(){return qs}},{key:"requiredScopes",get:function(){return d(new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read"].concat(d(ls.requiredScopes))))}}]),r}(Jn);js([hn({attribute:"group-id",type:String}),Gs("design:type",String),Gs("design:paramtypes",[Object])],Ks.prototype,"groupId",null),js([hn({attribute:"user-ids",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),Gs("design:type",Array),Gs("design:paramtypes",[Array])],Ks.prototype,"userIds",null),js([hn({attribute:"people",type:Object}),Gs("design:type",Array)],Ks.prototype,"people",void 0),js([hn({attribute:"people-queries",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),Gs("design:type",Array),Gs("design:paramtypes",[Array])],Ks.prototype,"peopleQueries",null),js([hn({attribute:"show-max",type:Number}),Gs("design:type",Number)],Ks.prototype,"showMax",void 0),js([hn({attribute:"show-presence",type:Boolean}),Gs("design:type",Boolean)],Ks.prototype,"showPresence",void 0),js([hn({attribute:"person-card",converter:function(e,t){return e=e.toLowerCase(),"undefined"===typeof xa[e]?xa.hover:xa[e]}}),Gs("design:type",Number)],Ks.prototype,"personCardInteraction",void 0),js([hn({attribute:"resource",type:String}),Gs("design:type",String),Gs("design:paramtypes",[Object])],Ks.prototype,"resource",null),js([hn({attribute:"version",type:String}),Gs("design:type",String),Gs("design:paramtypes",[Object])],Ks.prototype,"version",null),js([hn({attribute:"scopes",converter:function(e){return e?e.toLowerCase().split(","):null},reflect:!0}),Gs("design:type",Array)],Ks.prototype,"scopes",void 0),js([hn({attribute:"fallback-details",type:Array}),Gs("design:type",Array),Gs("design:paramtypes",[Array])],Ks.prototype,"fallbackDetails",null),Ks=js([fn("mgt-people"),Gs("design:paramtypes",[])],Ks);var Qs,Ws=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Js=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ys=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Xs=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this))._days=3,e.onResize=e.onResize.bind(w(e)),e}return v(r,[{key:"date",get:function(){return this._date},set:function(e){this._date!==e&&(this._date=e,this.reloadState())}},{key:"groupId",get:function(){return this._groupId},set:function(e){this._groupId!==e&&(this._groupId=e,this.reloadState())}},{key:"days",get:function(){return this._days},set:function(e){this._days!==e&&(this._days=e,this.reloadState())}},{key:"eventQuery",get:function(){return this._eventQuery},set:function(e){this._eventQuery!==e&&(this._eventQuery=e,this.reloadState())}},{key:"preferredTimezone",get:function(){return this._preferredTimezone},set:function(e){this._preferredTimezone!==e&&(this._preferredTimezone=e,this.reloadState())}},{key:"connectedCallback",value:function(){this._isNarrow=this.offsetWidth<600,Ot(y(r.prototype),"connectedCallback",this).call(this),window.addEventListener("resize",this.onResize)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("resize",this.onResize),Ot(y(r.prototype),"disconnectedCallback",this).call(this)}},{key:"render",value:function(){if(!this.events&&this.isLoadingState)return this.renderLoading();if(!this.events||0===this.events.length)return this.renderNoData();var e=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,t=this.renderTemplate("default",{events:e});return t||(this._isNarrow=this.offsetWidth<600,en(ks||(ks=Bn(["\n      <div dir=",' class="agenda',"",'">\n        ',"\n        ","\n      </div>\n    "])),this.direction,this._isNarrow?" narrow":"",this.groupByDay?" grouped":"",this.groupByDay?this.renderGroups(e):this.renderEvents(e),this.isLoadingState?this.renderLoading():en(ws||(ws=Bn([""])))))}},{key:"reload",value:function(){return Ys(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadEvents();case 2:this.events=e.sent;case 3:case"end":return e.stop()}}),e,this)})))}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null)||en(xs||(xs=Bn(['\n        <div class="event">\n          <div class="event-time-container">\n            <div class="event-time-loading loading-element"></div>\n          </div>\n          <div class="event-details-container">\n            <div class="event-subject-loading loading-element"></div>\n            <div class="event-location-container">\n              <div class="event-location-icon-loading loading-element"></div>\n              <div class="event-location-loading loading-element"></div>\n            </div>\n            <div class="event-location-container">\n              <div class="event-attendee-loading loading-element"></div>\n              <div class="event-attendee-loading loading-element"></div>\n              <div class="event-attendee-loading loading-element"></div>\n            </div>\n          </div>\n        </div>\n      '])))}},{key:"clearState",value:function(){this.events=null}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||en(Cs||(Cs=Bn([""])))}},{key:"renderEvent",value:function(e){return en(Ts||(Ts=Bn(['\n      <div class="event">\n        <div class="event-time-container">\n          <div class="event-time" aria-label="','">','</div>\n        </div>\n        <div class="event-details-container">\n          '," "," ",'\n        </div>\n        <div class="event-other-container">',"</div>\n      </div>\n    "])),this.getEventTimeString(e),this.getEventTimeString(e),this.renderTitle(e),this.renderLocation(e),this.renderAttendees(e),this.renderOther(e))}},{key:"renderHeader",value:function(e){return this.renderTemplate("header",{header:e},"header-"+e)||en(_s||(_s=Bn(['\n        <div class="header" aria-label="','">',"</div>\n      "])),e,e)}},{key:"renderTitle",value:function(e){return en(Ss||(Ss=Bn(["\n      <div aria-label=",' class="event-subject">',"</div>\n    "])),e.subject,e.subject)}},{key:"renderLocation",value:function(e){return e.location.displayName?en(Is||(Is=Bn(['\n      <div class="event-location-container">\n        <div class="event-location-icon">','</div>\n        <div class="event-location" aria-label="','">',"</div>\n      </div>\n    "])),va(pa.OfficeLocation),e.location.displayName,e.location.displayName):null}},{key:"renderAttendees",value:function(e){return e.attendees.length?en(Es||(Es=Bn(['\n      <mgt-people\n        class="event-attendees"\n        .peopleQueries=',"\n      ></mgt-people>\n    "])),e.attendees.map((function(e){return e.emailAddress.address}))):null}},{key:"renderOther",value:function(e){return this.hasTemplate("event-other")?en(As||(As=Bn(["\n          ","\n        "])),this.renderTemplate("event-other",{event:e},e.id+"-other")):null}},{key:"renderGroups",value:function(e){var t=this,r={};return e.forEach((function(e){var n,o=null===(n=null===e||void 0===e?void 0:e.start)||void 0===n?void 0:n.dateTime;"UTC"===e.end.timeZone&&(o+="Z");var i=t.getDateHeaderFromDateTimeString(o);r[i]=r[i]||[],r[i].push(e)})),en(Rs||(Rs=Bn(["\n      ","\n    "])),Object.keys(r).map((function(e){return en(Ps||(Ps=Bn(['\n            <div class="group">'," ","</div>\n          "])),t.renderHeader(e),t.renderEvents(r[e]))})))}},{key:"renderEvents",value:function(e){var t=this;return en(Os||(Os=Bn(['\n      <ul class="agenda-list">\n        ',"\n      </ul>\n    "])),e.map((function(e){return en(Ns||(Ns=Bn(["\n              <li @click=",">\n                ","\n              </li>\n            "])),(function(){return t.eventClicked(e)}),t.renderTemplate("event",{event:e},e.id)||t.renderEvent(e))})))}},{key:"loadState",value:function(){return Ys(this,void 0,void 0,Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.events){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.loadEvents();case 4:(t=e.sent)&&t.length>0&&(this.events=t);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"reloadState",value:function(){return Ys(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.events=null,this.requestStateUpdate(!0);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"onResize",value:function(){this._isNarrow=this.offsetWidth<600}},{key:"eventClicked",value:function(e){this.fireCustomEvent("eventClick",{event:e})}},{key:"getEventTimeString",value:function(e){if(e.isAllDay)return"ALL DAY";var t=e.start.dateTime;"UTC"===e.start.timeZone&&(t+="Z");var r=e.end.dateTime;"UTC"===e.end.timeZone&&(r+="Z");var n=this.prettyPrintTimeFromDateTime(new Date(t)),o=this.prettyPrintTimeFromDateTime(new Date(r));return"".concat(n," - ").concat(o)}},{key:"loadEvents",value:function(){return Ys(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a,s,c,l,u,d;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Pn.globalProvider,r=[],!t||t.state!==Sn.SignedIn){e.next=39;break}if(n=t.graph.forComponent(this),!this.eventQuery){e.next=20;break}return e.prev=5,(o=this.eventQuery.split("|")).length>1?(a=o[0].trim(),i=o[1].trim()):a=this.eventQuery,s=n.api(a),i&&(s=s.middlewareOptions($t(i))),e.next=12,s.get();case 12:(c=e.sent)&&c.value&&(r=c.value),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(5);case 18:e.next=39;break;case 20:return l=this.date?new Date(this.date):new Date,(u=new Date(l.getTime())).setDate(l.getDate()+this.days),e.prev=23,e.next=26,ps(n,l,u,this.groupId);case 26:if(!(d=e.sent)||!d.value){e.next=35;break}r=d.value;case 29:if(!d.hasNext){e.next=35;break}return e.next=32,d.next();case 32:r=d.value,e.next=29;break;case 35:e.next=39;break;case 37:e.prev=37,e.t1=e.catch(23);case 39:return e.abrupt("return",r);case 40:case"end":return e.stop()}}),e,this,[[5,16],[23,37]])})))}},{key:"prettyPrintTimeFromDateTime",value:function(e){return e.toLocaleTimeString(navigator.language,{timeStyle:"short",timeZone:this.preferredTimezone})}},{key:"getDateHeaderFromDateTimeString",value:function(e){return new Date(e).toLocaleDateString(navigator.language,{dateStyle:"full",timeZone:this.preferredTimezone})}}],[{key:"styles",get:function(){return us}},{key:"requiredScopes",get:function(){return d(new Set(["calendars.read"].concat(d(Ks.requiredScopes))))}}]),r}(Jn);Ws([hn({attribute:"date",type:String}),Js("design:type",String),Js("design:paramtypes",[Object])],Xs.prototype,"date",null),Ws([hn({attribute:"group-id",type:String}),Js("design:type",String),Js("design:paramtypes",[Object])],Xs.prototype,"groupId",null),Ws([hn({attribute:"days",type:Number}),Js("design:type",Number),Js("design:paramtypes",[Object])],Xs.prototype,"days",null),Ws([hn({attribute:"event-query",type:String}),Js("design:type",String),Js("design:paramtypes",[Object])],Xs.prototype,"eventQuery",null),Ws([hn({attribute:"events",type:Array}),Js("design:type",Array)],Xs.prototype,"events",void 0),Ws([hn({attribute:"show-max",type:Number}),Js("design:type",Number)],Xs.prototype,"showMax",void 0),Ws([hn({attribute:"group-by-day",type:Boolean}),Js("design:type",Boolean)],Xs.prototype,"groupByDay",void 0),Ws([hn({attribute:"preferred-timezone",type:String}),Js("design:type",String),Js("design:paramtypes",[Object])],Xs.prototype,"preferredTimezone",null),Ws([hn({attribute:!1}),Js("design:type",Boolean)],Xs.prototype,"_isNarrow",void 0),Xs=Ws([fn("mgt-agenda"),Js("design:paramtypes",[])],Xs);var Zs=[xn(Qs||(Qs=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{background-color:#fff}.mgt-dark{background-color:#424242}:host{font-family:var(--font-family,var(--default-font-family))}:host .item,mgt-file .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(background-color,#fff)}:host .item__file-type-icon,mgt-file .item__file-type-icon{padding:16px;width:var(--file-type-icon-size,28px);min-width:var(--file-type-icon-size,28px);height:var(--file-type-icon-size,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img,mgt-file .item__file-type-icon img{height:var(--file-type-icon-size,28px);width:var(--file-type-icon-size,28px)}:host .item__details,mgt-file .item__details{padding:10px 0}:host .item__details .line1,mgt-file .item__details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,400);text-transform:var(text-transform,none);line-height:20px;color:var(--color-sub1,#323130)}:host .item__details .line2,mgt-file .item__details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none));line-height:16px}:host .item__details .line3,mgt-file .item__details .line3{color:var(--line3-color,var(--color-sub1,#323130));font-size:var(--line3-font-size,var(--size-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none));line-height:16px}[dir=rtl] .item__details{direction:ltr}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{background-color:#fff}.mgt-dark{background-color:#424242}:host{font-family:var(--font-family,var(--default-font-family))}:host .item,mgt-file .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(background-color,#fff)}:host .item__file-type-icon,mgt-file .item__file-type-icon{padding:16px;width:var(--file-type-icon-size,28px);min-width:var(--file-type-icon-size,28px);height:var(--file-type-icon-size,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img,mgt-file .item__file-type-icon img{height:var(--file-type-icon-size,28px);width:var(--file-type-icon-size,28px)}:host .item__details,mgt-file .item__details{padding:10px 0}:host .item__details .line1,mgt-file .item__details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,400);text-transform:var(text-transform,none);line-height:20px;color:var(--color-sub1,#323130)}:host .item__details .line2,mgt-file .item__details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none));line-height:16px}:host .item__details .line3,mgt-file .item__details .line3{color:var(--line3-color,var(--color-sub1,#323130));font-size:var(--line3-font-size,var(--size-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none));line-height:16px}[dir=rtl] .item__details{direction:ltr}\n"])))],$s=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function ec(){ho.getCache(Xo,Xo.stores.fileLists).clearStore()}var tc=function(){return ho.config.files.invalidationPeriod||ho.config.defaultInvalidationPeriod},rc=function(){return ho.config.files.isEnabled&&ho.config.isEnabled},nc=function(){return ho.config.fileLists.isEnabled&&ho.config.isEnabled};function oc(e,t){return $s(this,void 0,void 0,Ze().mark((function r(){var n,o,i;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=ho.getCache(Yo,Yo.stores.fileQueries),r.next=3,Mc(n,t);case 3:if(!(o=r.sent)){r.next=6;break}return r.abrupt("return",o);case 6:return"files.read",r.prev=7,r.next=10,e.api(t).middlewareOptions($t("files.read")).get();case 10:i=r.sent,rc()&&n.putValue(t,{file:JSON.stringify(i)}),r.next=16;break;case 14:r.prev=14,r.t0=r.catch(7);case 16:return r.abrupt("return",i||null);case 17:case"end":return r.stop()}}),r,null,[[7,14]])})))}function ic(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="/drives/".concat(t,"/items/").concat(r),i=ho.getCache(Yo,Yo.stores.driveFiles),n.next=4,Mc(i,o);case 4:if(!(a=n.sent)){n.next=7;break}return n.abrupt("return",a);case 7:return"files.read",n.prev=8,n.next=11,e.api(o).middlewareOptions($t("files.read")).get();case 11:s=n.sent,rc()&&i.putValue(o,{file:JSON.stringify(s)}),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(8);case 17:return n.abrupt("return",s||null);case 18:case"end":return n.stop()}}),n,null,[[8,15]])})))}function ac(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="/drives/".concat(t,"/root:/").concat(r),i=ho.getCache(Yo,Yo.stores.driveFiles),n.next=4,Mc(i,o);case 4:if(!(a=n.sent)){n.next=7;break}return n.abrupt("return",a);case 7:return"files.read",n.prev=8,n.next=11,e.api(o).middlewareOptions($t("files.read")).get();case 11:s=n.sent,rc()&&i.putValue(o,{file:JSON.stringify(s)}),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(8);case 17:return n.abrupt("return",s||null);case 18:case"end":return n.stop()}}),n,null,[[8,15]])})))}function sc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="/groups/".concat(t,"/drive/items/").concat(r),i=ho.getCache(Yo,Yo.stores.groupFiles),n.next=4,Mc(i,o);case 4:if(!(a=n.sent)){n.next=7;break}return n.abrupt("return",a);case 7:return"files.read",n.prev=8,n.next=11,e.api(o).middlewareOptions($t("files.read")).get();case 11:s=n.sent,rc()&&i.putValue(o,{file:JSON.stringify(s)}),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(8);case 17:return n.abrupt("return",s||null);case 18:case"end":return n.stop()}}),n,null,[[8,15]])})))}function cc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="/groups/".concat(t,"/drive/root:/").concat(r),i=ho.getCache(Yo,Yo.stores.groupFiles),n.next=4,Mc(i,o);case 4:if(!(a=n.sent)){n.next=7;break}return n.abrupt("return",a);case 7:return"files.read",n.prev=8,n.next=11,e.api(o).middlewareOptions($t("files.read")).get();case 11:s=n.sent,rc()&&i.putValue(o,{file:JSON.stringify(s)}),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(8);case 17:return n.abrupt("return",s||null);case 18:case"end":return n.stop()}}),n,null,[[8,15]])})))}function lc(e,t){return $s(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n="/me/drive/items/".concat(t),o=ho.getCache(Yo,Yo.stores.userFiles),r.next=4,Mc(o,n);case 4:if(!(i=r.sent)){r.next=7;break}return r.abrupt("return",i);case 7:return"files.read",r.prev=8,r.next=11,e.api(n).middlewareOptions($t("files.read")).get();case 11:a=r.sent,rc()&&o.putValue(n,{file:JSON.stringify(a)}),r.next=17;break;case 15:r.prev=15,r.t0=r.catch(8);case 17:return r.abrupt("return",a||null);case 18:case"end":return r.stop()}}),r,null,[[8,15]])})))}function uc(e,t){return $s(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n="/me/drive/root:/".concat(t),o=ho.getCache(Yo,Yo.stores.userFiles),r.next=4,Mc(o,n);case 4:if(!(i=r.sent)){r.next=7;break}return r.abrupt("return",i);case 7:return"files.read",r.prev=8,r.next=11,e.api(n).middlewareOptions($t("files.read")).get();case 11:a=r.sent,rc()&&o.putValue(n,{file:JSON.stringify(a)}),r.next=17;break;case 15:r.prev=15,r.t0=r.catch(8);case 17:return r.abrupt("return",a||null);case 18:case"end":return r.stop()}}),r,null,[[8,15]])})))}function dc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="/sites/".concat(t,"/drive/items/").concat(r),i=ho.getCache(Yo,Yo.stores.siteFiles),n.next=4,Mc(i,o);case 4:if(!(a=n.sent)){n.next=7;break}return n.abrupt("return",a);case 7:return"files.read",n.prev=8,n.next=11,e.api(o).middlewareOptions($t("files.read")).get();case 11:s=n.sent,rc()&&i.putValue(o,{file:JSON.stringify(s)}),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(8);case 17:return n.abrupt("return",s||null);case 18:case"end":return n.stop()}}),n,null,[[8,15]])})))}function pc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="/sites/".concat(t,"/drive/root:/").concat(r),i=ho.getCache(Yo,Yo.stores.siteFiles),n.next=4,Mc(i,o);case 4:if(!(a=n.sent)){n.next=7;break}return n.abrupt("return",a);case 7:return"files.read",n.prev=8,n.next=11,e.api(o).middlewareOptions($t("files.read")).get();case 11:s=n.sent,rc()&&i.putValue(o,{file:JSON.stringify(s)}),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(8);case 17:return n.abrupt("return",s||null);case 18:case"end":return n.stop()}}),n,null,[[8,15]])})))}function fc(e,t,r,n){return $s(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i="/sites/".concat(t,"/lists/").concat(r,"/items/").concat(n,"/driveItem"),a=ho.getCache(Yo,Yo.stores.siteFiles),o.next=4,Mc(a,i);case 4:if(!(s=o.sent)){o.next=7;break}return o.abrupt("return",s);case 7:return"files.read",o.prev=8,o.next=11,e.api(i).middlewareOptions($t("files.read")).get();case 11:c=o.sent,rc()&&a.putValue(i,{file:JSON.stringify(c)}),o.next=17;break;case 15:o.prev=15,o.t0=o.catch(8);case 17:return o.abrupt("return",c||null);case 18:case"end":return o.stop()}}),o,null,[[8,15]])})))}function hc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="/users/".concat(t,"/drive/items/").concat(r),i=ho.getCache(Yo,Yo.stores.userFiles),n.next=4,Mc(i,o);case 4:if(!(a=n.sent)){n.next=7;break}return n.abrupt("return",a);case 7:return"files.read",n.prev=8,n.next=11,e.api(o).middlewareOptions($t("files.read")).get();case 11:s=n.sent,rc()&&i.putValue(o,{file:JSON.stringify(s)}),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(8);case 17:return n.abrupt("return",s||null);case 18:case"end":return n.stop()}}),n,null,[[8,15]])})))}function gc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="/users/".concat(t,"/drive/root:/").concat(r),i=ho.getCache(Yo,Yo.stores.userFiles),n.next=4,Mc(i,o);case 4:if(!(a=n.sent)){n.next=7;break}return n.abrupt("return",a);case 7:return"files.read",n.prev=8,n.next=11,e.api(o).middlewareOptions($t("files.read")).get();case 11:s=n.sent,rc()&&i.putValue(o,{file:JSON.stringify(s)}),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(8);case 17:return n.abrupt("return",s||null);case 18:case"end":return n.stop()}}),n,null,[[8,15]])})))}function vc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="/me/insights/".concat(t,"/").concat(r,"/resource"),i=ho.getCache(Yo,Yo.stores.insightFiles),n.next=4,Mc(i,o);case 4:if(!(a=n.sent)){n.next=7;break}return n.abrupt("return",a);case 7:return"sites.read.all",n.prev=8,n.next=11,e.api(o).middlewareOptions($t("sites.read.all")).get();case 11:s=n.sent,rc()&&i.putValue(o,{file:JSON.stringify(s)}),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(8);case 17:return n.abrupt("return",s||null);case 18:case"end":return n.stop()}}),n,null,[[8,15]])})))}function mc(e,t,r,n){return $s(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i="/users/".concat(t,"/insights/").concat(r,"/").concat(n,"/resource"),a=ho.getCache(Yo,Yo.stores.insightFiles),o.next=4,Mc(a,i);case 4:if(!(s=o.sent)){o.next=7;break}return o.abrupt("return",s);case 7:return"sites.read.all",o.prev=8,o.next=11,e.api(i).middlewareOptions($t("sites.read.all")).get();case 11:c=o.sent,rc()&&a.putValue(i,{file:JSON.stringify(c)}),o.next=17;break;case 15:o.prev=15,o.t0=o.catch(8);case 17:return o.abrupt("return",c||null);case 18:case"end":return o.stop()}}),o,null,[[8,15]])})))}function bc(e,t){return $s(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s,c;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n="/me/drive/root/children",a=Xo.stores.fileLists,i=ho.getCache(Xo,a),r.next=5,Uc(i,a,n);case 5:if(!(s=r.sent)){r.next=11;break}return r.next=9,Lc(e,s.files,s.nextLink);case 9:return o=r.sent,r.abrupt("return",o);case 11:return"files.read",r.prev=12,c=e.api(n).middlewareOptions($t("files.read")),t&&c.top(t),r.next=17,Dc(e,c);case 17:o=r.sent,nc()&&i.putValue(n,{files:o.value,nextLink:o._nextLink}),r.next=23;break;case 21:r.prev=21,r.t0=r.catch(12);case 23:return r.abrupt("return",o||null);case 24:case"end":return r.stop()}}),r,null,[[12,21]])})))}function yc(e,t,r,n){return $s(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i="/drives/".concat(t,"/items/").concat(r,"/children"),c=Xo.stores.fileLists,s=ho.getCache(Xo,c),o.next=5,Uc(s,c,i);case 5:if(!(l=o.sent)){o.next=11;break}return o.next=9,Lc(e,l.files,l.nextLink);case 9:return a=o.sent,o.abrupt("return",a);case 11:return"files.read",o.prev=12,u=e.api(i).middlewareOptions($t("files.read")),n&&u.top(n),o.next=17,Dc(e,u);case 17:a=o.sent,nc()&&s.putValue(i,{files:a.value,nextLink:a._nextLink}),o.next=23;break;case 21:o.prev=21,o.t0=o.catch(12);case 23:return o.abrupt("return",a||null);case 24:case"end":return o.stop()}}),o,null,[[12,21]])})))}function kc(e,t,r,n){return $s(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i="/drives/".concat(t,"/root:/").concat(r,":/children"),c=Xo.stores.fileLists,s=ho.getCache(Xo,c),o.next=5,Uc(s,c,i);case 5:if(!(l=o.sent)){o.next=11;break}return o.next=9,Lc(e,l.files,l.nextLink);case 9:return a=o.sent,o.abrupt("return",a);case 11:return"files.read",o.prev=12,u=e.api(i).middlewareOptions($t("files.read")),n&&u.top(n),o.next=17,Dc(e,u);case 17:a=o.sent,nc()&&s.putValue(i,{files:a.value,nextLink:a._nextLink}),o.next=23;break;case 21:o.prev=21,o.t0=o.catch(12);case 23:return o.abrupt("return",a||null);case 24:case"end":return o.stop()}}),o,null,[[12,21]])})))}function wc(e,t,r,n){return $s(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i="/groups/".concat(t,"/drive/items/").concat(r,"/children"),c=Xo.stores.fileLists,s=ho.getCache(Xo,c),o.next=5,Uc(s,c,i);case 5:if(!(l=o.sent)){o.next=11;break}return o.next=9,Lc(e,l.files,l.nextLink);case 9:return a=o.sent,o.abrupt("return",a);case 11:return"files.read",o.prev=12,u=e.api(i).middlewareOptions($t("files.read")),n&&u.top(n),o.next=17,Dc(e,u);case 17:a=o.sent,nc()&&s.putValue(i,{files:a.value,nextLink:a._nextLink}),o.next=23;break;case 21:o.prev=21,o.t0=o.catch(12);case 23:return o.abrupt("return",a||null);case 24:case"end":return o.stop()}}),o,null,[[12,21]])})))}function xc(e,t,r,n){return $s(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i="/groups/".concat(t,"/drive/root:/").concat(r,":/children"),c=Xo.stores.fileLists,s=ho.getCache(Xo,c),o.next=5,Uc(s,c,i);case 5:if(!(l=o.sent)){o.next=11;break}return o.next=9,Lc(e,l.files,l.nextLink);case 9:return a=o.sent,o.abrupt("return",a);case 11:return"files.read",o.prev=12,u=e.api(i).middlewareOptions($t("files.read")),n&&u.top(n),o.next=17,Dc(e,u);case 17:a=o.sent,nc()&&s.putValue(i,{files:a.value,nextLink:a._nextLink}),o.next=23;break;case 21:o.prev=21,o.t0=o.catch(12);case 23:return o.abrupt("return",a||null);case 24:case"end":return o.stop()}}),o,null,[[12,21]])})))}function Cc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="/me/drive/items/".concat(t,"/children"),s=Xo.stores.fileLists,a=ho.getCache(Xo,s),n.next=5,Uc(a,s,o);case 5:if(!(c=n.sent)){n.next=11;break}return n.next=9,Lc(e,c.files,c.nextLink);case 9:return i=n.sent,n.abrupt("return",i);case 11:return"files.read",n.prev=12,l=e.api(o).middlewareOptions($t("files.read")),r&&l.top(r),n.next=17,Dc(e,l);case 17:i=n.sent,nc()&&a.putValue(o,{files:i.value,nextLink:i._nextLink}),n.next=23;break;case 21:n.prev=21,n.t0=n.catch(12);case 23:return n.abrupt("return",i||null);case 24:case"end":return n.stop()}}),n,null,[[12,21]])})))}function Tc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="/me/drive/root:/".concat(t,":/children"),s=Xo.stores.fileLists,a=ho.getCache(Xo,s),n.next=5,Uc(a,s,o);case 5:if(!(c=n.sent)){n.next=11;break}return n.next=9,Lc(e,c.files,c.nextLink);case 9:return i=n.sent,n.abrupt("return",i);case 11:return"files.read",n.prev=12,l=e.api(o).middlewareOptions($t("files.read")),r&&l.top(r),n.next=17,Dc(e,l);case 17:i=n.sent,nc()&&a.putValue(o,{files:i.value,nextLink:i._nextLink}),n.next=23;break;case 21:n.prev=21,n.t0=n.catch(12);case 23:return n.abrupt("return",i||null);case 24:case"end":return n.stop()}}),n,null,[[12,21]])})))}function _c(e,t,r,n){return $s(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i="/sites/".concat(t,"/drive/items/").concat(r,"/children"),c=Xo.stores.fileLists,s=ho.getCache(Xo,c),o.next=5,Uc(s,c,i);case 5:if(!(l=o.sent)){o.next=11;break}return o.next=9,Lc(e,l.files,l.nextLink);case 9:return a=o.sent,o.abrupt("return",a);case 11:return"files.read",o.prev=12,u=e.api(i).middlewareOptions($t("files.read")),n&&u.top(n),o.next=17,Dc(e,u);case 17:a=o.sent,nc()&&s.putValue(i,{files:a.value,nextLink:a._nextLink}),o.next=23;break;case 21:o.prev=21,o.t0=o.catch(12);case 23:return o.abrupt("return",a||null);case 24:case"end":return o.stop()}}),o,null,[[12,21]])})))}function Sc(e,t,r,n){return $s(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i="/sites/".concat(t,"/drive/root:/").concat(r,":/children"),c=Xo.stores.fileLists,s=ho.getCache(Xo,c),o.next=5,Uc(s,c,i);case 5:if(!(l=o.sent)){o.next=11;break}return o.next=9,Lc(e,l.files,l.nextLink);case 9:return a=o.sent,o.abrupt("return",a);case 11:return"files.read",o.prev=12,u=e.api(i).middlewareOptions($t("files.read")),n&&u.top(n),o.next=17,Dc(e,u);case 17:a=o.sent,nc()&&s.putValue(i,{files:a.value,nextLink:a._nextLink}),o.next=23;break;case 21:o.prev=21,o.t0=o.catch(12);case 23:return o.abrupt("return",a||null);case 24:case"end":return o.stop()}}),o,null,[[12,21]])})))}function Ic(e,t,r,n){return $s(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i="/users/".concat(t,"/drive/items/").concat(r,"/children"),c=Xo.stores.fileLists,s=ho.getCache(Xo,c),o.next=5,Uc(s,c,i);case 5:if(!(l=o.sent)){o.next=11;break}return o.next=9,Lc(e,l.files,l.nextLink);case 9:return a=o.sent,o.abrupt("return",a);case 11:return"files.read",o.prev=12,u=e.api(i).middlewareOptions($t("files.read")),n&&u.top(n),o.next=17,Dc(e,u);case 17:a=o.sent,nc()&&s.putValue(i,{files:a.value,nextLink:a._nextLink}),o.next=23;break;case 21:o.prev=21,o.t0=o.catch(12);case 23:return o.abrupt("return",a||null);case 24:case"end":return o.stop()}}),o,null,[[12,21]])})))}function Ec(e,t,r,n){return $s(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,l,u;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i="/users/".concat(t,"/drive/root:/").concat(r,":/children"),c=Xo.stores.fileLists,s=ho.getCache(Xo,c),o.next=5,Uc(s,c,i);case 5:if(!(l=o.sent)){o.next=11;break}return o.next=9,Lc(e,l.files,l.nextLink);case 9:return a=o.sent,o.abrupt("return",a);case 11:return"files.read",o.prev=12,u=e.api(i).middlewareOptions($t("files.read")),n&&u.top(n),o.next=17,Dc(e,u);case 17:a=o.sent,nc()&&s.putValue(i,{files:a.value,nextLink:a._nextLink}),o.next=23;break;case 21:o.prev=21,o.t0=o.catch(12);case 23:return o.abrupt("return",a||null);case 24:case"end":return o.stop()}}),o,null,[[12,21]])})))}function Ac(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=Xo.stores.fileLists,i=ho.getCache(Xo,a),n.next=4,Uc(i,a,t);case 4:if(!(s=n.sent)){n.next=10;break}return n.next=8,Lc(e,s.files,s.nextLink);case 8:return o=n.sent,n.abrupt("return",o);case 10:return c=["files.read","sites.read.all"],n.prev=11,n.next=14,e.api(t).middlewareOptions($t.apply(void 0,c));case 14:return l=n.sent,r&&l.top(r),n.next=18,Dc(e,l);case 18:o=n.sent,nc()&&i.putValue(t,{files:o.value,nextLink:o._nextLink}),n.next=24;break;case 22:n.prev=22,n.t0=n.catch(11);case 24:return n.abrupt("return",o||null);case 25:case"end":return n.stop()}}),n,null,[[11,22]])})))}function Rc(e,t){return $s(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s,c,l;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n="/me/insights/".concat(t),i=Xo.stores.insightfileLists,o=ho.getCache(Xo,i),r.next=5,Uc(o,i,n);case 5:if(!(a=r.sent)){r.next=8;break}return r.abrupt("return",a.files);case 8:return s=["sites.read.all"],r.prev=9,r.next=12,e.api(n).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions($t.apply(void 0,s)).get();case 12:c=r.sent,r.next=17;break;case 15:r.prev=15,r.t0=r.catch(9);case 17:return r.next=19,Nc(e,c,s);case 19:return l=r.sent,nc()&&o.putValue(n,{files:l}),r.abrupt("return",l||null);case 22:case"end":return r.stop()}}),r,null,[[9,15]])})))}function Pc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l,u,d,p;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return"shared"===r?(o="/me/insights/shared",i="((lastshared/sharedby/id eq '".concat(t,"') and (resourceReference/type eq 'microsoft.graph.driveItem'))")):(o="/users/".concat(t,"/insights/").concat(r),i="resourceReference/type eq 'microsoft.graph.driveItem'"),a="".concat(o,"?$filter=").concat(i),c=Xo.stores.insightfileLists,s=ho.getCache(Xo,c),n.next=6,Uc(s,c,a);case 6:if(!(l=n.sent)){n.next=9;break}return n.abrupt("return",l.files);case 9:return u=["sites.read.all"],n.prev=10,n.next=13,e.api(o).filter(i).middlewareOptions($t.apply(void 0,u)).get();case 13:d=n.sent,n.next=18;break;case 16:n.prev=16,n.t0=n.catch(10);case 18:return n.next=20,Nc(e,d,u);case 20:return p=n.sent,nc()&&s.putValue(o,{files:p}),n.abrupt("return",p||null);case 23:case"end":return n.stop()}}),n,null,[[10,16]])})))}function Oc(e,t){return $s(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s,c,l,u,d,p,f,h,g,v=this;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t&&0!==t.length){r.next=2;break}return r.abrupt("return",[]);case 2:n=e.createBatch(),o=[],i=["files.read"],rc()&&(a=ho.getCache(Yo,Yo.stores.fileQueries)),c=S(t),r.prev=7,c.s();case 9:if((l=c.n()).done){r.next=18;break}if(u=l.value,!rc()){r.next=15;break}return r.next=14,a.getValue(u);case 14:s=r.sent;case 15:rc()&&s&&tc()>Date.now()-s.timeCached?o.push(JSON.parse(s.file)):""!==u&&n.get(u,u,i);case 16:r.next=9;break;case 18:r.next=23;break;case 20:r.prev=20,r.t0=r.catch(7),c.e(r.t0);case 23:return r.prev=23,c.f(),r.finish(23);case 26:return r.prev=26,r.next=29,n.executeAll();case 29:d=r.sent,p=S(t);try{for(p.s();!(f=p.n()).done;)h=f.value,(g=d.get(h))&&g.content&&(o.push(g.content),rc()&&a.putValue(h,{file:JSON.stringify(g.content)}))}catch(m){p.e(m)}finally{p.f()}return r.abrupt("return",o);case 35:return r.prev=35,r.t1=r.catch(26),r.prev=37,r.abrupt("return",Promise.all(t.filter((function(e){return e&&""!==e})).map((function(t){return $s(v,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,oc(e,t);case 2:if(!(n=r.sent)){r.next=6;break}return rc()&&a.putValue(t,{file:JSON.stringify(n)}),r.abrupt("return",n);case 6:case"end":return r.stop()}}),r)})))}))));case 41:return r.prev=41,r.t2=r.catch(37),r.abrupt("return",[]);case 44:case"end":return r.stop()}}),r,null,[[7,20,23,26],[26,35],[37,41]])})))}function Nc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l,u,p,f,h,g,v,m=this;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return",[]);case 2:o=t.value,i=e.createBatch(),a=[],s=S(o);try{for(s.s();!(c=s.n()).done;)l=c.value,""!==(u=l.resourceReference.id)&&i.get(u,u,r)}catch(b){s.e(b)}finally{s.f()}return n.prev=7,n.next=10,i.executeAll();case 10:p=n.sent,f=S(o);try{for(f.s();!(h=f.n()).done;)g=h.value,(v=p.get(g.resourceReference.id))&&v.content&&a.push(v.content)}catch(b){f.e(b)}finally{f.f()}return n.abrupt("return",a);case 16:return n.prev=16,n.t0=n.catch(7),n.prev=18,n.abrupt("return",Promise.all(o.filter((function(e){return e.resourceReference.id&&""!==e.resourceReference.id})).map((function(t){return $s(m,void 0,void 0,Ze().mark((function n(){var o;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.api(t.resourceReference.id).middlewareOptions($t.apply(void 0,d(r))).get();case 2:if(!(o=n.sent)||!o.length){n.next=5;break}return n.abrupt("return",o[0].content);case 5:case"end":return n.stop()}}),n)})))}))));case 22:return n.prev=22,n.t1=n.catch(18),n.abrupt("return",[]);case 25:case"end":return n.stop()}}),n,null,[[7,16],[18,22]])})))}function Dc(e,t){return $s(this,void 0,void 0,Ze().mark((function r(){return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",bo.create(e,t));case 1:case"end":return r.stop()}}),r)})))}function Lc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",bo.createFromValue(e,t,r));case 1:case"end":return n.stop()}}),n)})))}function Mc(e,t){return $s(this,void 0,void 0,Ze().mark((function r(){var n,o;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!rc()){r.next=7;break}return r.next=3,e.getValue(t);case 3:if(!((n=r.sent)&&tc()>Date.now()-n.timeCached)){r.next=7;break}return o=JSON.parse(n.file),r.abrupt("return",o);case 7:return r.abrupt("return",null);case 8:case"end":return r.stop()}}),r)})))}function Uc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e||(e=ho.getCache(Xo,t)),!nc()){n.next=7;break}return n.next=4,e.getValue(r);case 4:if(!((o=n.sent)&&(ho.config.fileLists.invalidationPeriod||ho.config.defaultInvalidationPeriod)>Date.now()-o.timeCached)){n.next=7;break}return n.abrupt("return",o);case 7:return n.abrupt("return",null);case 8:case"end":return n.stop()}}),n)})))}function Fc(e){return $s(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e._nextLink,!e.hasNext){t.next=4;break}return t.next=4,e.next();case 4:nc()&&(n=ho.getCache(Xo,Xo.stores.fileLists),o=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(r),i=o[3],n.putValue(i,{files:e.value,nextLink:e._nextLink}));case 5:case"end":return t.stop()}}),t)})))}function zc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i,a;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.api(t).responseType(zt.RAW).middlewareOptions($t.apply(void 0,d(r))).get();case 3:if(404!==(o=n.sent).status){n.next=8;break}return n.abrupt("return",{eTag:null,thumbnail:null});case 8:if(o.ok){n.next=10;break}return n.abrupt("return",null);case 10:return i=o.headers.get("eTag"),n.t0=Fo,n.next=14,o.blob();case 14:return n.t1=n.sent,n.next=17,(0,n.t0)(n.t1);case 17:return a=n.sent,n.abrupt("return",{eTag:i,thumbnail:a});case 21:return n.prev=21,n.t2=n.catch(0),n.abrupt("return",null);case 24:case"end":return n.stop()}}),n,null,[[0,21]])})))}function Hc(e,t){return $s(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,"files.read",r.prev=2,r.next=5,e.api(t).middlewareOptions($t("files.read")).get().catch((function(e){return null}));case 5:n=r.sent,r.next=10;break;case 8:r.prev=8,r.t0=r.catch(2);case 10:return r.abrupt("return",n||null);case 13:return r.prev=13,r.t1=r.catch(0),r.abrupt("return",null);case 16:case"end":return r.stop()}}),r,null,[[0,13],[2,8]])})))}function Bc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o,i;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,"files.readwrite",o={item:{"@microsoft.graph.conflictBehavior":0===r||null===r?"rename":"replace"}},n.prev=3,n.next=6,e.api(t).middlewareOptions($t("files.readwrite")).post(JSON.stringify(o));case 6:i=n.sent,n.next=11;break;case 9:n.prev=9,n.t0=n.catch(3);case 11:return n.abrupt("return",i||null);case 14:return n.prev=14,n.t1=n.catch(0),n.abrupt("return",null);case 17:case"end":return n.stop()}}),n,null,[[0,14],[3,9]])})))}function qc(e,t,r,n,o){return $s(this,void 0,void 0,Ze().mark((function i(){var a,s;return Ze().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,"files.readwrite",a={"Content-Length":r,"Content-Range":n},i.prev=3,i.next=6,e.client.api(t).middlewareOptions($t("files.readwrite")).headers(a).put(o);case 6:s=i.sent,i.next=11;break;case 9:i.prev=9,i.t0=i.catch(3);case 11:return i.abrupt("return",s||null);case 14:return i.prev=14,i.t1=i.catch(0),i.abrupt("return",null);case 17:case"end":return i.stop()}}),i,null,[[0,14],[3,9]])})))}function jc(e,t,r){return $s(this,void 0,void 0,Ze().mark((function n(){var o;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,"files.readwrite",n.prev=2,n.next=5,e.client.api(t).middlewareOptions($t("files.readwrite")).put(r);case 5:o=n.sent,n.next=10;break;case 8:n.prev=8,n.t0=n.catch(2);case 10:return n.abrupt("return",o||null);case 13:return n.prev=13,n.t1=n.catch(0),n.abrupt("return",null);case 16:case"end":return n.stop()}}),n,null,[[0,13],[2,8]])})))}function Gc(e,t){return $s(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,"files.readwrite",r.prev=2,r.next=5,e.client.api(t).middlewareOptions($t("files.readwrite")).delete((function(e){return e}));case 5:n=r.sent,r.next=10;break;case 8:r.prev=8,r.t0=r.catch(2);case 10:return r.abrupt("return",n||null);case 13:return r.prev=13,r.t1=r.catch(0),r.abrupt("return",null);case 16:case"end":return r.stop()}}),r,null,[[0,13],[2,8]])})))}var Vc={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},Kc="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types";var Qc,Wc,Jc,Yc,Xc,Zc,$c,el,tl,rl,nl,ol,il,al,sl={modifiedSubtitle:"Modified",sizeSubtitle:"Size"},cl=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ll=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ul=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},dl=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this)).line1Property="name",e.line2Property="lastModifiedDateTime",e.line3Property="size",e.view=Oi.threelines,e}return v(r,[{key:"strings",get:function(){return sl}},{key:"fileQuery",get:function(){return this._fileQuery},set:function(e){e!==this._fileQuery&&(this._fileQuery=e,this.requestStateUpdate())}},{key:"siteId",get:function(){return this._siteId},set:function(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate())}},{key:"driveId",get:function(){return this._driveId},set:function(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate())}},{key:"groupId",get:function(){return this._groupId},set:function(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate())}},{key:"listId",get:function(){return this._listId},set:function(e){e!==this._listId&&(this._listId=e,this.requestStateUpdate())}},{key:"userId",get:function(){return this._userId},set:function(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate())}},{key:"itemId",get:function(){return this._itemId},set:function(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate())}},{key:"itemPath",get:function(){return this._itemPath},set:function(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate())}},{key:"insightType",get:function(){return this._insightType},set:function(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate())}},{key:"insightId",get:function(){return this._insightId},set:function(e){e!==this._insightId&&(this._insightId=e,this.requestStateUpdate())}},{key:"fileDetails",get:function(){return this._fileDetails},set:function(e){e!==this._fileDetails&&(this._fileDetails=e,this.requestStateUpdate())}},{key:"fileIcon",get:function(){return this._fileIcon},set:function(e){e!==this._fileIcon&&(this._fileIcon=e,this.requestStateUpdate())}},{key:"render",value:function(){if(!this.driveItem&&this.isLoadingState)return this.renderLoading();if(!this.driveItem)return this.renderNoData();var e,t=this.driveItem;if(!(e=this.renderTemplate("default",{file:t}))){var r=this.renderDetails(t),n=this.renderFileTypeIcon();e=en(Qc||(Qc=Bn(['\n        <div class="item">\n          '," ","\n        </div>\n      "])),n,r)}return en(Wc||(Wc=Bn(["\n      <span dir=",">\n        ","\n      </span>\n    "])),this.direction,e)}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null)||en(Jc||(Jc=Bn([""])))}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||en(Yc||(Yc=Bn([""])))}},{key:"renderFileTypeIcon",value:function(){if(!this.fileIcon&&!this.driveItem.name)return en(Xc||(Xc=Bn([""])));var e,t,r,n;if(this.fileIcon)e=this.fileIcon;else{var o=/(?:\.([^.]+))?$/,i=void 0===this.driveItem.package&&void 0===this.driveItem.folder?o.exec(this.driveItem.name)[1]?o.exec(this.driveItem.name)[1].toLowerCase():"null":void 0!==this.driveItem.package&&"oneNote"===this.driveItem.package.type?"onetoc":"folder";t=i,r=48,n="svg",e=Object.keys(Vc).find((function(e){return Vc[e]===t}))?"".concat(Kc,"/").concat(r.toString(),"/").concat(t,".").concat(n):"jpg"===t||"png"===t?(t="photo","".concat(Kc,"/").concat(r.toString(),"/").concat(t,".").concat(n)):null}return en(Zc||(Zc=Bn(['\n      <div class="item__file-type-icon">\n        ',"\n      </div>\n    "])),e?en($c||($c=Bn(["\n              <img src=",' alt="File icon" />\n            '])),e):en(el||(el=Bn(["\n              ","\n            "])),va(pa.File)))}},{key:"renderDetails",value:function(e){if(!e||this.view===Oi.image)return en(tl||(tl=Bn([""])));var t=[];if(this.view>Oi.image){var r=this.getTextFromProperty(e,this.line1Property);r&&t.push(en(rl||(rl=Bn(['\n          <div class="line1" aria-label="','">',"</div>\n        "])),r,r))}if(this.view>Oi.oneline){var n=this.getTextFromProperty(e,this.line2Property);n&&t.push(en(nl||(nl=Bn(['\n          <div class="line2" aria-label="','">',"</div>\n        "])),n,n))}if(this.view>Oi.twolines){var o=this.getTextFromProperty(e,this.line3Property);o&&t.push(en(ol||(ol=Bn(['\n          <div class="line3" aria-label="','">',"</div>\n        "])),o,o))}return en(il||(il=Bn(['\n      <div class="item__details">\n        ',"\n      </div>\n    "])),t)}},{key:"loadState",value:function(){return ul(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.fileDetails){e.next=3;break}return this.driveItem=this.fileDetails,e.abrupt("return");case 3:if((t=Pn.globalProvider)&&t.state!==Sn.Loading){e.next=6;break}return e.abrupt("return");case 6:if(t.state!==Sn.SignedOut){e.next=9;break}return this.driveItem=null,e.abrupt("return");case 9:if(r=t.graph.forComponent(this),o=!this.driveId&&!this.siteId&&!this.groupId&&!this.listId&&!this.userId,!(this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId)&&(!this.userId||this.itemId||this.itemPath||this.insightType||this.insightId)){e.next=15;break}n=null,e.next=101;break;case 15:if(!this.fileQuery){e.next=21;break}return e.next=18,oc(r,this.fileQuery);case 18:n=e.sent,e.next=101;break;case 21:if(!this.itemId||!o){e.next=27;break}return e.next=24,lc(r,this.itemId);case 24:n=e.sent,e.next=101;break;case 27:if(!this.itemPath||!o){e.next=33;break}return e.next=30,uc(r,this.itemPath);case 30:n=e.sent,e.next=101;break;case 33:if(!this.userId){e.next=52;break}if(!this.itemId){e.next=40;break}return e.next=37,hc(r,this.userId,this.itemId);case 37:n=e.sent,e.next=50;break;case 40:if(!this.itemPath){e.next=46;break}return e.next=43,gc(r,this.userId,this.itemPath);case 43:n=e.sent,e.next=50;break;case 46:if(!this.insightType||!this.insightId){e.next=50;break}return e.next=49,mc(r,this.userId,this.insightType,this.insightId);case 49:n=e.sent;case 50:e.next=101;break;case 52:if(!this.driveId){e.next=65;break}if(!this.itemId){e.next=59;break}return e.next=56,ic(r,this.driveId,this.itemId);case 56:n=e.sent,e.next=63;break;case 59:if(!this.itemPath){e.next=63;break}return e.next=62,ac(r,this.driveId,this.itemPath);case 62:n=e.sent;case 63:e.next=101;break;case 65:if(!this.siteId||this.listId){e.next=78;break}if(!this.itemId){e.next=72;break}return e.next=69,dc(r,this.siteId,this.itemId);case 69:n=e.sent,e.next=76;break;case 72:if(!this.itemPath){e.next=76;break}return e.next=75,pc(r,this.siteId,this.itemPath);case 75:n=e.sent;case 76:e.next=101;break;case 78:if(!this.listId){e.next=84;break}return e.next=81,fc(r,this.siteId,this.listId,this.itemId);case 81:n=e.sent,e.next=101;break;case 84:if(!this.groupId){e.next=97;break}if(!this.itemId){e.next=91;break}return e.next=88,sc(r,this.groupId,this.itemId);case 88:n=e.sent,e.next=95;break;case 91:if(!this.itemPath){e.next=95;break}return e.next=94,cc(r,this.groupId,this.itemPath);case 94:n=e.sent;case 95:e.next=101;break;case 97:if(!this.insightType||this.userId){e.next=101;break}return e.next=100,vc(r,this.insightType,this.insightId);case 100:n=e.sent;case 101:this.driveItem=n;case 102:case"end":return e.stop()}}),e,this)})))}},{key:"getTextFromProperty",value:function(e,t){if(!t||0===t.length)return null;for(var r,n=t.trim().split(","),o=0;!r&&o<n.length;){var i=n[o].trim();switch(i){case"size":var a=void 0;a=e.size?this.formatBytes(e.size):"0",r="".concat(this.strings.sizeSubtitle,": ").concat(a);break;case"lastModifiedDateTime":var s=void 0,c=void 0;if(e.lastModifiedDateTime)s=Lo(new Date(e.lastModifiedDateTime)),c="".concat(this.strings.modifiedSubtitle," ").concat(s);else c="";r=c;break;default:r=e[i]}o++}return r}},{key:"formatBytes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var r=1024,n=t<0?0:t,o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,i)).toFixed(n))+" "+o[i]}}],[{key:"styles",get:function(){return Zs}},{key:"requiredScopes",get:function(){return d(new Set(["files.read","files.read.all","sites.read.all"]))}}]),r}(Jn);cl([hn({attribute:"file-query"}),ll("design:type",String),ll("design:paramtypes",[String])],dl.prototype,"fileQuery",null),cl([hn({attribute:"site-id"}),ll("design:type",String),ll("design:paramtypes",[String])],dl.prototype,"siteId",null),cl([hn({attribute:"drive-id"}),ll("design:type",String),ll("design:paramtypes",[String])],dl.prototype,"driveId",null),cl([hn({attribute:"group-id"}),ll("design:type",String),ll("design:paramtypes",[String])],dl.prototype,"groupId",null),cl([hn({attribute:"list-id"}),ll("design:type",String),ll("design:paramtypes",[String])],dl.prototype,"listId",null),cl([hn({attribute:"user-id"}),ll("design:type",String),ll("design:paramtypes",[String])],dl.prototype,"userId",null),cl([hn({attribute:"item-id"}),ll("design:type",String),ll("design:paramtypes",[String])],dl.prototype,"itemId",null),cl([hn({attribute:"item-path"}),ll("design:type",String),ll("design:paramtypes",[String])],dl.prototype,"itemPath",null),cl([hn({attribute:"insight-type"}),ll("design:type",String),ll("design:paramtypes",[String])],dl.prototype,"insightType",null),cl([hn({attribute:"insight-id"}),ll("design:type",String),ll("design:paramtypes",[String])],dl.prototype,"insightId",null),cl([hn({type:Object}),ll("design:type",Object),ll("design:paramtypes",[Object])],dl.prototype,"fileDetails",null),cl([hn({attribute:"file-icon"}),ll("design:type",String),ll("design:paramtypes",[String])],dl.prototype,"fileIcon",null),cl([hn({type:Object}),ll("design:type",Object)],dl.prototype,"driveItem",void 0),cl([hn({attribute:"line1-property"}),ll("design:type",String)],dl.prototype,"line1Property",void 0),cl([hn({attribute:"line2-property"}),ll("design:type",String)],dl.prototype,"line2Property",void 0),cl([hn({attribute:"line3-property"}),ll("design:type",String)],dl.prototype,"line3Property",void 0),cl([hn({attribute:"view",converter:function(e){return e&&0!==e.length?(e=e.toLowerCase(),"undefined"===typeof Oi[e]?Oi.threelines:Oi[e]):Oi.threelines}}),ll("design:type",Number)],dl.prototype,"view",void 0),dl=cl([fn("mgt-file"),ll("design:paramtypes",[])],dl);var pl,fl,hl,gl,vl,ml,bl,yl,kl=[xn(al||(al=Bn(["\n.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#4a4a4a;--file-upload-dialog-content-color:white;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}:host .file-upload-area-button{width:100%}:host .file-upload-area-button div{float:var(--file-upload-button-float,right);text-align:center;display:table;margin-top:39px;margin-right:16px;margin-left:16px}:host .file-upload-area-button fluent-button.file-upload-button{color:var(--file-upload-button-color,inherit);vertical-align:middle;display:table-cell;background-color:var(--file-upload-button-background-color,#f3f2f1);width:120px;height:32px;cursor:pointer;font-size:var(--default-font-size);font-family:var(--default-font-family);position:relative}:host .file-upload-area-button fluent-button.file-upload-button:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1))}:host .file-upload-area-button input{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}:host .file-upload-table{margin:var(--file-item-margin,0)}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;width:50%;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;top:12px;left:16px}:host .file-upload-table .file-upload-cell fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-left:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-button-color,var(--color,inherit))}:host .file-upload-table.upload{display:table;width:260px}:host .mgt-file-item{--file-background-color:transparent}:host .upload-icon{fill:var(--file-upload-button-color,var(--color,inherit));height:12px}:host .file-upload-Template{clear:both}:host .file-upload-Template .file-upload-folder-tab{padding-left:20px}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border,dashed #0078d4 1px);background-color:var(--file-upload-background-color,rgba(0,120,212,.1));position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;display:inline-block}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-content-background-color,#fff);margin:auto;padding:24px;width:294px;height:auto;margin-top:165px;font-size:var(--default-font-size);font-family:var(--default-font-family);box-shadow:var(--file-list-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));line-height:20px}:host .file-upload-dialog .file-upload-dialog-content div{color:var(--file-upload-dialog-content-color,#323130)}:host .file-upload-dialog .file-upload-dialog-check-wrapper{margin-top:12px}:host .file-upload-dialog fluent-checkbox.file-upload-dialog-check{--neutral-fill-input-rest:$file-upload-dialog-content-color}:host .file-upload-dialog fluent-checkbox.file-upload-dialog-check span{color:var(--file-upload-dialog-content-color,#323130)}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{text-align:right}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-button-color,var(--color,inherit));padding-right:5px}:host .file-upload-dialog .file-upload-dialog-ok{height:32px;min-width:60px;border:1px solid var(--file-upload-dialog-primarybutton-background-color,#006cbe);background-color:var(--file-upload-dialog-primarybutton-background-color,#006cbe);color:var(--file-upload-dialog-primarybutton-color,#fff);font-size:var(--default-font-size);margin-right:5px}:host .file-upload-dialog .file-upload-dialog-cancel{height:32px;min-width:82px;border:1px solid #8a8886;background-color:var(--file-upload-dialog-content-background-color,#fff);color:var(--file-upload-dialog-content-color,#323130);font-size:var(--default-font-size)}:host .file-upload-dialog.visible{position:absolute;z-index:1;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:var(--file-upload-dialog-background-color,rgba(0,0,0,.1));display:inline-block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{border-top:var(--file-item-border-top,none);border-left:var(--file-item-border-left,none);border-right:var(--file-item-border-right,none);border-bottom:var(--file-item-border-bottom,none);border-radius:var(--file-item-border-radius,2px);cursor:pointer}:host .file-upload-dialog-success.focused,:host .file-upload-dialog-success:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1))}:host .file-upload-dialog-success.focused mgt-file,:host .file-upload-dialog-success:hover mgt-file{--file-background-color:$file-item-background-color--hover}:host .file-upload-dialog-success.selected,:host .file-upload-dialog-success:active{background-color:var(--file-item-background-color--active,rgba(0,0,0,.05))}:host .file-upload-dialog-success.selected mgt-file,:host .file-upload-dialog-success:active mgt-file{--file-background-color:$file-item-background-color--active}\n"])))],wl={failUploadFile:"File upload fail.",cancelUploadFile:"File cancel.",buttonUploadFile:"Upload Files",maximumFilesTitle:"Maximum files",maximumFiles:"Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?",maximumFileSizeTitle:"Maximum files size",maximumFileSize:'Sorry, the maximum file size to upload is {FileSize}. The file "{FileName}" has ',fileTypeTitle:"File type",fileType:'Sorry, the format of following file "{FileName}" cannot be uploaded.',checkAgain:"Don't show again",checkApplyAll:"Apply to all",buttonOk:"OK",buttonCancel:"Cancel",buttonUpload:"Upload",buttonKeep:"Keep",buttonReplace:"Replace",buttonReselect:"Reselect",fileReplaceTitle:"Replace file",fileReplace:'Do you want to replace the file "{FileName}" or keep file with new name?'},xl=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Cl=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Tl=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},_l=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this))._dragCounter=0,e._dropEffect="copy",e._maxChunckSize=4194304,e._dialogTitle="",e._dialogContent="",e._dialogPrimaryButton="",e._dialogSecondaryButton="",e._dialogCheckBox="",e._applyAll=!1,e._applyAllConflitBehavior=null,e._maximumFiles=!1,e._maximumFileSize=!1,e._excludedFileType=!1,e.handleonDragOver=function(t){return Tl(w(e),void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),t.stopPropagation(),t.dataTransfer.items&&t.dataTransfer.items.length>0&&(t.dataTransfer.dropEffect=t.dataTransfer.dropEffect=this._dropEffect);case 3:case"end":return e.stop()}}),e,this)})))},e.handleonDragEnter=function(t){return Tl(w(e),void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),t.stopPropagation(),this._dragCounter++,t.dataTransfer.items&&t.dataTransfer.items.length>0&&(t.dataTransfer.dropEffect=this._dropEffect,this.renderRoot.querySelector("#file-upload-border").classList.add("visible"));case 4:case"end":return e.stop()}}),e,this)})))},e.handleonDragLeave=function(t){(t.preventDefault(),t.stopPropagation(),e._dragCounter--,0===e._dragCounter)&&e.renderRoot.querySelector("#file-upload-border").classList.remove("visible")},e.handleonDrop=function(t){return Tl(w(e),void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.stopPropagation(),this.renderRoot.querySelector("#file-upload-border").classList.remove("visible"),!t.dataTransfer||!t.dataTransfer.items){e.next=10;break}return e.t0=this,e.next=8,this.getFilesFromUploadArea(t.dataTransfer.items);case 8:e.t1=e.sent,e.t0.getSelectedFiles.call(e.t0,e.t1);case 10:t.dataTransfer.clearData(),this._dragCounter=0;case 12:case"end":return e.stop()}}),e,this)})))},e.filesToUpload=[],e}return v(r,[{key:"strings",get:function(){return wl}},{key:"render",value:function(){if(null!==this.parentElement){var e=this.parentElement;e.addEventListener("dragenter",this.handleonDragEnter),e.addEventListener("dragleave",this.handleonDragLeave),e.addEventListener("dragover",this.handleonDragOver),e.addEventListener("drop",this.handleonDrop)}return en(pl||(pl=Bn(['\n        <div id="file-upload-dialog" class="file-upload-dialog">\n          \x3c!-- Modal content --\x3e\n          <fluent-card class="file-upload-dialog-content">\n            <span class="file-upload-dialog-close" id="file-upload-dialog-close" >','</span>\n            <div class="file-upload-dialog-content-text">\n              <h2 class="file-upload-dialog-title">',"</h2>\n              <div>",'</div>\n              <div class="file-upload-dialog-check-wrapper">\n                <fluent-checkbox id="file-upload-dialog-check" class="file-upload-dialog-check" >\n                  <span>','</span>\n                </fluent-checkbox>\n              </div>\n            </div>\n            <div class="file-upload-dialog-editor">\n              <fluent-button class="file-upload-dialog-ok">\n              ','\n              </fluent-button>\n              <fluent-button class="file-upload-dialog-cancel">\n              ','\n              </fluent-button>\n            </div>\n          </fluent-card>\n        </div>\n        <div id="file-upload-border" >\n        </div>\n        <div class="file-upload-area-button">\n        <div>\n          <input\n            id="file-upload-input"\n            aria-label="file upload input"\n            type="file"\n            multiple="true"\n            @change="','"\n          />\n          <fluent-button class="file-upload-button" @click=',">\n            ","",'\n          </fluent-button>\n        </div>\n        </div>\n        <div class="file-upload-Template">\n        ',"\n        </div>\n       "])),va(pa.Cancel),this._dialogTitle,this._dialogContent,this._dialogCheckBox,this._dialogPrimaryButton,this._dialogSecondaryButton,this.onFileUploadChange,this.onFileUploadClick,va(pa.Upload),wl.buttonUploadFile,this.renderFolderTemplate(this.filesToUpload))}},{key:"renderFolderTemplate",value:function(e){var t=this,r=[];if(e.length>0){var n=e.map((function(e){return-1===r.indexOf(e.fullPath.substring(0,e.fullPath.lastIndexOf("/")))?""!==e.fullPath.substring(0,e.fullPath.lastIndexOf("/"))?(r.push(e.fullPath.substring(0,e.fullPath.lastIndexOf("/"))),en(fl||(fl=Bn(["\n            <div class='file-upload-table'>\n              <div class='file-upload-cell'>\n                <mgt-file\n                  .fileDetails=","\n                  .view=",'\n                  class="mgt-file-item"\n                >\n                </mgt-file>\n              </div>\n            </div>\n            ',""])),{name:e.fullPath.substring(1,e.fullPath.lastIndexOf("/")),folder:"Folder"},Oi.oneline,t.renderFileTemplate(e,"file-upload-folder-tab"))):en(hl||(hl=Bn(["",""])),t.renderFileTemplate(e,"")):en(gl||(gl=Bn(["",""])),t.renderFileTemplate(e,"file-upload-folder-tab"))}));return en(vl||(vl=Bn(["",""])),n)}return null}},{key:"renderFileTemplate",value:function(e,t){return en(ml||(ml=Bn(['\n        <div class="','">\n          <div class="',"\">\n            <div class='file-upload-cell'>\n              <div style=",'>\n                <div class="file-upload-status">\n                  ',"\n                </div>\n                <mgt-file\n                  .fileDetails=","\n                  .view=","\n                  .line2Property=",'\n                  class="mgt-file-item"\n                  >\n                </mgt-file>\n              </div>\n            </div>\n              ',"\n            </div>\n          </div>\n        </div>\n        "])),e.completed?"file-upload-table":"file-upload-table upload",t+("lastModifiedDateTime"===e.fieldUploadResponse?" file-upload-dialog-success":""),"description"===e.fieldUploadResponse?"opacity: 0.5;":"",e.iconStatus,e.driveItem,e.view,e.fieldUploadResponse,!1===e.completed?this.renderFileUploadTemplate(e):null)}},{key:"renderFileUploadTemplate",value:function(e){var t=this;return en(bl||(bl=Bn(["\n    <div class='file-upload-cell'>\n      <div class='file-upload-table file-upload-name' >\n        <div class='file-upload-cell'>\n          <div title=\"","\" class='file-upload-filename'>","</div>\n        </div>\n      </div>\n      <div class='file-upload-table'>\n        <div class='file-upload-cell'>\n          <div class=\"",'">\n            <fluent-progress class="file-upload-bar" value="','" ></fluent-progress>\n            <div class=\'file-upload-cell\' style="padding-left:5px">\n              <span>','%</span>\n              <span\n                class="file-upload-cancel"\n                @click=',">\n                ","\n              </span>\n            </div>\n          <div>\n        </div>\n      </div>\n    </div>\n    "])),e.file.name,e.file.name,e.completed?"file-upload-table":"file-upload-table upload",e.percent,e.percent,(function(r){return t.deleteFileUploadSession(e)}),va(pa.Cancel))}},{key:"onFileUploadChange",value:function(e){return Tl(this,void 0,void 0,Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&!(e.target.files.length<1)){t.next=4;break}return t.abrupt("return");case 4:return t.t0=this,t.next=7,this.getFilesFromUploadArea(e.target.files);case 7:t.t1=t.sent,t.t0.getSelectedFiles.call(t.t0,t.t1),e.target.value=null;case 10:case"end":return t.stop()}}),t,this)})))}},{key:"onFileUploadClick",value:function(){this.renderRoot.querySelector("#file-upload-input").click()}},{key:"deleteFileUploadSession",value:function(e){return Tl(this,void 0,void 0,Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,void 0===e.uploadUrl){t.next=10;break}return t.next=4,Gc(this.fileUploadList.graph,e.uploadUrl);case 4:t.sent,e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,wl.cancelUploadFile),t.next=13;break;case 10:e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,wl.cancelUploadFile);case 13:t.next=20;break;case 15:t.prev=15,t.t0=t.catch(0),e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,wl.cancelUploadFile);case 20:case"end":return t.stop()}}),t,this,[[0,15]])})))}},{key:"getSelectedFiles",value:function(e){return Tl(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i,a,s,c=this;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],o=[],this._applyAll=!1,this._applyAllConflitBehavior=null,this._maximumFiles=!1,this._maximumFileSize=!1,this._excludedFileType=!1,this.filesToUpload.forEach((function(e){return Tl(c,void 0,void 0,Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.completed?o.push(e):n.push(e);case 1:case"end":return t.stop()}}),t)})))})),i=Ze().mark((function t(){var r,o,i,s,l,u,d,p;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e[a],o=""===r.fullPath?"/"+r.name:r.fullPath,0!==n.filter((function(e){return e.fullPath===o})).length){t.next=38;break}if(i=!0,!(n.length>=c.fileUploadList.maxUploadFile)){t.next=14;break}if(i=!1,c._maximumFiles){t.next=14;break}return t.next=9,c.getFileUploadStatus(e[a],o,"MaxFiles",c.fileUploadList);case 9:if(null===(s=t.sent)){t.next=14;break}if(0!==s[0]){t.next=13;break}return t.abrupt("return",{v:null});case 13:1===s[0]&&(c._maximumFiles=!0);case 14:if(void 0===c.fileUploadList.maxFileSize||!i){t.next=22;break}if(!(e[a].size>1024*c.fileUploadList.maxFileSize)){t.next=22;break}if(i=!1,!1!==c._maximumFileSize){t.next=22;break}return t.next=20,c.getFileUploadStatus(e[a],o,"MaxFileSize",c.fileUploadList);case 20:null!==(l=t.sent)&&1===l[0]&&(c._maximumFileSize=!0);case 22:if(void 0===c.fileUploadList.excludedFileExtensions){t.next=31;break}if(!(c.fileUploadList.excludedFileExtensions.length>0&&i)){t.next=31;break}if(!(c.fileUploadList.excludedFileExtensions.filter((function(t){return e[a].name.toLowerCase().indexOf(t.toLowerCase())>-1})).length>0)){t.next=31;break}if(i=!1,!1!==c._excludedFileType){t.next=31;break}return t.next=29,c.getFileUploadStatus(e[a],o,"ExcludedFileType",c.fileUploadList);case 29:null!==(u=t.sent)&&1===u[0]&&(c._excludedFileType=!0);case 31:if(!i){t.next=38;break}return t.next=34,c.getFileUploadStatus(e[a],o,"Upload",c.fileUploadList);case 34:d=t.sent,p=!1,null!==d&&(-1===d[0]?p=!0:(c._applyAll=Boolean(d[0]),c._applyAllConflitBehavior=d[1]?1:0)),n.push({file:e[a],driveItem:{name:e[a].name},fullPath:o,conflictBehavior:null!==d?d[1]?1:0:null,iconStatus:null,percent:1,view:Oi.image,completed:p,maxSize:c._maxChunckSize,minSize:0});case 38:case"end":return t.stop()}}),t)})),a=0;case 10:if(!(a<e.length)){t.next=18;break}return t.delegateYield(i(),"t0",12);case 12:if("object"!==typeof(s=t.t0)){t.next=15;break}return t.abrupt("return",s.v);case 15:a++,t.next=10;break;case 18:(n=n.sort((function(e,t){return e.fullPath.substring(0,e.fullPath.lastIndexOf("/")).localeCompare(t.fullPath.substring(0,t.fullPath.lastIndexOf("/")))}))).forEach((function(e){if(0!==o.filter((function(t){return t.fullPath===e.fullPath})).length){var t=o.findIndex((function(t){return t.fullPath===e.fullPath}));o.splice(t,1)}})),(r=n).push.apply(r,o),this.filesToUpload=n,this.filesToUpload.forEach((function(e){return Tl(c,void 0,void 0,Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sendFileItemGraph(e);case 2:case"end":return t.stop()}}),t,this)})))}));case 23:case"end":return t.stop()}}),t,this)})))}},{key:"getFileUploadStatus",value:function(e,t,n,o){var i=this,a=Object.create(null,{requestStateUpdate:{get:function(){return Ot(y(r.prototype),"requestStateUpdate",i)}}});return Tl(this,void 0,void 0,Ze().mark((function r(){var i,s=this;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=this.renderRoot.querySelector("#file-upload-dialog"),r.t0=n,r.next="Upload"===r.t0?4:"MaxFiles"===r.t0?22:"ExcludedFileType"===r.t0?31:"MaxFileSize"===r.t0?39:47;break;case 4:return r.next=6,Hc(this.fileUploadList.graph,"".concat(this.getGrapQuery(t),"?$select=id"));case 6:if(null===r.sent){r.next=20;break}if(!0!==this._applyAll){r.next=10;break}return r.abrupt("return",[this._applyAll,this._applyAllConflitBehavior]);case 10:return i.classList.add("visible"),this._dialogTitle=wl.fileReplaceTitle,this._dialogContent=wl.fileReplace.replace("{FileName}",e.name),this._dialogCheckBox=wl.checkApplyAll,this._dialogPrimaryButton=wl.buttonReplace,this._dialogSecondaryButton=wl.buttonKeep,a.requestStateUpdate.call(this,!0),r.abrupt("return",new Promise((function(e){return Tl(s,void 0,void 0,Ze().mark((function t(){var r,n,o,a,s,c,l;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=function(){i.classList.remove("visible"),e([-1])},c=function(){i.classList.remove("visible"),e([a.checked?1:0,0])},s=function(){i.classList.remove("visible"),e([a.checked?1:0,1])},r=this.renderRoot.querySelector(".file-upload-dialog-close"),n=this.renderRoot.querySelector(".file-upload-dialog-ok"),o=this.renderRoot.querySelector(".file-upload-dialog-cancel"),(a=this.renderRoot.querySelector("#file-upload-dialog-check")).checked=!1,a.classList.remove("hide"),n.removeEventListener("click",s),o.removeEventListener("click",c),r.removeEventListener("click",l),n.addEventListener("click",s),o.addEventListener("click",c),r.addEventListener("click",l);case 15:case"end":return t.stop()}}),t,this)})))})));case 20:return r.abrupt("return",null);case 21:case 47:return r.abrupt("break",48);case 22:return i.classList.add("visible"),this._dialogTitle=wl.maximumFilesTitle,this._dialogContent=wl.maximumFiles.split("{MaxNumber}").join(o.maxUploadFile.toString()),this._dialogCheckBox=wl.checkApplyAll,this._dialogPrimaryButton=wl.buttonUpload,this._dialogSecondaryButton=wl.buttonReselect,a.requestStateUpdate.call(this,!0),r.abrupt("return",new Promise((function(e){return Tl(s,void 0,void 0,Ze().mark((function t(){var r,n,o,a,s,c;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=function(){i.classList.remove("visible"),e([0])},s=function(){i.classList.remove("visible"),e([1])},r=this.renderRoot.querySelector(".file-upload-dialog-ok"),n=this.renderRoot.querySelector(".file-upload-dialog-cancel"),o=this.renderRoot.querySelector(".file-upload-dialog-close"),(a=this.renderRoot.querySelector("#file-upload-dialog-check")).checked=!1,a.classList.add("hide"),r.removeEventListener("click",s),n.removeEventListener("click",c),o.removeEventListener("click",c),r.addEventListener("click",s),n.addEventListener("click",c),o.addEventListener("click",c);case 14:case"end":return t.stop()}}),t,this)})))})));case 31:return i.classList.add("visible"),this._dialogTitle=wl.fileTypeTitle,this._dialogContent=wl.fileType.replace("{FileName}",e.name)+" ("+o.excludedFileExtensions.join(",")+")",this._dialogCheckBox=wl.checkAgain,this._dialogPrimaryButton=wl.buttonOk,this._dialogSecondaryButton=wl.buttonCancel,a.requestStateUpdate.call(this,!0),r.abrupt("return",new Promise((function(e){return Tl(s,void 0,void 0,Ze().mark((function t(){var r,n,o,a,s,c;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=function(){i.classList.remove("visible"),e([0])},s=function(){i.classList.remove("visible"),e([a.checked?1:0])},r=this.renderRoot.querySelector(".file-upload-dialog-ok"),n=this.renderRoot.querySelector(".file-upload-dialog-cancel"),o=this.renderRoot.querySelector(".file-upload-dialog-close"),(a=this.renderRoot.querySelector("#file-upload-dialog-check")).checked=!1,a.classList.remove("hide"),r.removeEventListener("click",s),n.removeEventListener("click",c),o.removeEventListener("click",c),r.addEventListener("click",s),n.addEventListener("click",c),o.addEventListener("click",c);case 14:case"end":return t.stop()}}),t,this)})))})));case 39:return i.classList.add("visible"),this._dialogTitle=wl.maximumFileSizeTitle,this._dialogContent=wl.maximumFileSize.replace("{FileSize}",Bo(o.maxFileSize)).replace("{FileName}",e.name)+Bo(e.size)+".",this._dialogCheckBox=wl.checkAgain,this._dialogPrimaryButton=wl.buttonOk,this._dialogSecondaryButton=wl.buttonCancel,a.requestStateUpdate.call(this,!0),r.abrupt("return",new Promise((function(e){return Tl(s,void 0,void 0,Ze().mark((function t(){var r,n,o,a,s,c;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=function(){i.classList.remove("visible"),e([0])},s=function(){i.classList.remove("visible"),e([a.checked?1:0])},r=this.renderRoot.querySelector(".file-upload-dialog-ok"),n=this.renderRoot.querySelector(".file-upload-dialog-cancel"),o=this.renderRoot.querySelector(".file-upload-dialog-close"),(a=this.renderRoot.querySelector("#file-upload-dialog-check")).checked=!1,a.classList.remove("hide"),r.removeEventListener("click",s),n.removeEventListener("click",c),o.removeEventListener("click",c),r.addEventListener("click",s),n.addEventListener("click",c),o.addEventListener("click",c);case 14:case"end":return t.stop()}}),t,this)})))})));case 48:case"end":return r.stop()}}),r,this)})))}},{key:"getGrapQuery",value:function(e){var t="";return this.fileUploadList.itemPath&&this.fileUploadList.itemPath.length>0&&(t="/"===this.fileUploadList.itemPath.substring(0,1)?this.fileUploadList.itemPath:"/"+this.fileUploadList.itemPath),this.fileUploadList.userId&&this.fileUploadList.itemId?"/users/".concat(this.fileUploadList.userId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.userId&&this.fileUploadList.itemPath?"/users/".concat(this.fileUploadList.userId,"/drive/root:").concat(t).concat(e):this.fileUploadList.groupId&&this.fileUploadList.itemId?"/groups/".concat(this.fileUploadList.groupId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.groupId&&this.fileUploadList.itemPath?"/groups/".concat(this.fileUploadList.groupId,"/drive/root:").concat(t).concat(e):this.fileUploadList.driveId&&this.fileUploadList.itemId?"/drives/".concat(this.fileUploadList.driveId,"/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.driveId&&this.fileUploadList.itemPath?"/drives/".concat(this.fileUploadList.driveId,"/root:").concat(t).concat(e):this.fileUploadList.siteId&&this.fileUploadList.itemId?"/sites/".concat(this.fileUploadList.siteId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.siteId&&this.fileUploadList.itemPath?"/sites/".concat(this.fileUploadList.siteId,"/drive/root:").concat(t).concat(e):this.fileUploadList.itemId?"/me/drive/items/".concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.itemPath?"/me/drive/root:".concat(t).concat(e):"/me/drive/root:".concat(e)}},{key:"sendFileItemGraph",value:function(e){return Tl(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.fileUploadList.graph,n="",!(e.file.size<this._maxChunckSize)){t.next=18;break}if(t.prev=3,e.completed){t.next=11;break}return null!==e.conflictBehavior&&1!==e.conflictBehavior||(n="".concat(this.getGrapQuery(e.fullPath),":/content")),0===e.conflictBehavior&&(n="".concat(this.getGrapQuery(e.fullPath),":/content?@microsoft.graph.conflictBehavior=rename")),t.next=9,jc(r,n,e.file);case 9:e.driveItem=t.sent,null!==e.driveItem?this.setUploadSuccess(e):(e.driveItem={name:e.file.name},this.setUploadFail(e,wl.failUploadFile));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),this.setUploadFail(e,wl.failUploadFile);case 16:t.next=37;break;case 18:if(e.completed){t.next=37;break}if(void 0!==e.uploadUrl){t.next=37;break}return t.next=22,Bc(r,"".concat(this.getGrapQuery(e.fullPath),":/createUploadSession"),e.conflictBehavior);case 22:if(o=t.sent,t.prev=23,null===o){t.next=32;break}return e.uploadUrl=o.uploadUrl,t.next=28,this.sendSessionUrlGraph(r,e);case 28:null!==(i=t.sent)?(e.driveItem=i,this.setUploadSuccess(e)):this.setUploadFail(e,wl.failUploadFile),t.next=33;break;case 32:this.setUploadFail(e,wl.failUploadFile);case 33:t.next=37;break;case 35:t.prev=35,t.t1=t.catch(23);case 37:case"end":return t.stop()}}),t,this,[[3,13],[23,35]])})))}},{key:"sendSessionUrlGraph",value:function(e,t){var n=this,o=Object.create(null,{requestStateUpdate:{get:function(){return Ot(y(r.prototype),"requestStateUpdate",n)}}});return Tl(this,void 0,void 0,Ze().mark((function r(){var n,i;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(t.file.size>t.minSize)){r.next=26;break}if(void 0!==t.mimeStreamString){r.next=5;break}return r.next=4,this.readFileContent(t.file);case 4:t.mimeStreamString=r.sent;case 5:if(n=new Blob([t.mimeStreamString.slice(t.minSize,t.maxSize)]),t.percent=Math.round(t.maxSize/t.file.size*100),o.requestStateUpdate.call(this,!0),void 0===t.uploadUrl){r.next=23;break}return r.next=11,qc(e,t.uploadUrl,"".concat(t.maxSize-t.minSize),"bytes ".concat(t.minSize,"-").concat(t.maxSize-1,"/").concat(t.file.size),n);case 11:if(null!==(i=r.sent)){r.next=16;break}return r.abrupt("return",null);case 16:if(void 0===i.id){r.next=20;break}return r.abrupt("return",i);case 20:void 0!==i.nextExpectedRanges&&(t.minSize=parseInt(i.nextExpectedRanges[0].split("-")[0]),t.maxSize=t.minSize+this._maxChunckSize,t.maxSize>t.file.size&&(t.maxSize=t.file.size));case 21:r.next=24;break;case 23:return r.abrupt("return",null);case 24:r.next=0;break;case 26:case"end":return r.stop()}}),r,this)})))}},{key:"setUploadSuccess",value:function(e){var t=this;e.percent=100,Ot(y(r.prototype),"requestStateUpdate",this).call(this,!0),setTimeout((function(){e.iconStatus=va(pa.Success),e.view=Oi.twolines,e.fieldUploadResponse="lastModifiedDateTime",e.completed=!0,Ot(y(r.prototype),"requestStateUpdate",t).call(t,!0),ec()}),500)}},{key:"setUploadFail",value:function(e,t){var n=this;setTimeout((function(){e.iconStatus=va(pa.Fail),e.view=Oi.twolines,e.driveItem.description=t,e.fieldUploadResponse="description",e.completed=!0,Ot(y(r.prototype),"requestStateUpdate",n).call(n,!0)}),500)}},{key:"readFileContent",value:function(e){return new Promise((function(t,r){var n=new FileReader;n.onloadend=function(e){t(n.result)},n.onerror=function(e){r(e)},n.readAsArrayBuffer(e)}))}},{key:"getFilesFromUploadArea",value:function(e){return Tl(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i,a,s,c,l,u,p;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[],o=[],i=0;case 3:if(!(i<e.length)){t.next=15;break}if("file"!==(a=e[i]).kind){t.next=10;break}return a.getAsEntry?(n=a.getAsEntry()).isDirectory?r.push(n):(s=a.getAsFile())&&(s.fullPath="",o.push(s)):a.webkitGetAsEntry?(n=a.webkitGetAsEntry()).isDirectory?r.push(n):(c=a.getAsFile())&&(c.fullPath="",o.push(c)):"function"==typeof a.getAsFile&&(l=a.getAsFile())&&(l.fullPath="",o.push(l)),t.abrupt("continue",12);case 10:(u=a)&&(u.fullPath="",o.push(u));case 12:i++,t.next=3;break;case 15:if(!(r.length>0)){t.next=20;break}return t.next=18,this.getFolderFiles(r);case 18:p=t.sent,o.push.apply(o,d(p));case 20:return t.abrupt("return",o);case 21:case"end":return t.stop()}}),t,this)})))}},{key:"getFolderFiles",value:function(e){return new Promise((function(t){var r=0,n=[];function o(e,i){var a;e.isDirectory?(a=e.createReader(),r++,a.readEntries((function(e){r--;var i,a=S(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;o(s,s.fullPath)}}catch(c){a.e(c)}finally{a.f()}0===r&&t(n)}))):(r++,e.file((function(e){r--,e.fullPath=i,n.push(e),0===r&&t(n)})))}e.forEach((function(e){o(e,"")}))}))}}],[{key:"styles",get:function(){return kl}},{key:"requiredScopes",get:function(){return d(new Set(["files.readwrite","files.readwrite.all","sites.readwrite.all"]))}}]),r}(Un);xl([hn({type:Object}),Cl("design:type",Array)],_l.prototype,"filesToUpload",void 0),xl([hn({type:Object}),Cl("design:type",Object)],_l.prototype,"fileUploadList",void 0),_l=xl([fn("mgt-file-upload"),Cl("design:paramtypes",[])],_l);var Sl,Il,El,Al,Rl,Pl,Ol,Nl,Dl,Ll,Ml,Ul,Fl,zl,Hl=[xn(yl||(yl=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-list-background-color:#ffffff;--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#4a4a4a;--file-upload-dialog-content-color:white;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}:host{font-family:var(--default-font-family);font-size:var(--default-font-size)}:host .file-list-wrapper,mgt-file-item .file-list-wrapper{background-color:var(--file-list-background-color,#fff);box-shadow:var(--file-list-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--file-list-border-radius,4px);border:var(--file-list-border,none);position:relative;color:var(--color-sub1,#323130);display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .file-list,mgt-file-item .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,4px 0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item,mgt-file-item .file-list-wrapper .file-list .file-item{border-top:var(--file-item-border-top,none);border-left:var(--file-item-border-left,none);border-right:var(--file-item-border-right,none);border-bottom:var(--file-item-border-bottom,none);margin:var(--file-item-margin,0 4px);border-radius:var(--file-item-border-radius,2px);cursor:pointer}:host .file-list-wrapper .file-list .file-item mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item mgt-file{--file-background-color:$background-color}:host .file-list-wrapper .file-list .file-item.focused,:host .file-list-wrapper .file-list .file-item:hover,mgt-file-item .file-list-wrapper .file-list .file-item.focused,mgt-file-item .file-list-wrapper .file-list .file-item:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1));border-radius:4px}:host .file-list-wrapper .file-list .file-item.focused mgt-file,:host .file-list-wrapper .file-list .file-item:hover mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.focused mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:hover mgt-file{--file-background-color:$file-item-background-color--hover}:host .file-list-wrapper .file-list .file-item.selected,:host .file-list-wrapper .file-list .file-item:active,mgt-file-item .file-list-wrapper .file-list .file-item.selected,mgt-file-item .file-list-wrapper .file-list .file-item:active{background-color:var(--file-item-background-color--active,rgba(0,0,0,.05))}:host .file-list-wrapper .file-list .file-item.selected mgt-file,:host .file-list-wrapper .file-list .file-item:active mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.selected mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:active mgt-file{--file-background-color:$file-item-background-color--active}:host .file-list-wrapper .progress-ring,mgt-file-item .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more,mgt-file-item .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,6px);border-bottom-right-radius:var(--show-more-button-border-bottom-right-radius,8px);border-bottom-left-radius:var(--show-more-button-border-bottom-left-radius,8px);cursor:pointer;background-color:var(--show-more-button-background-color,var(--background-color-sub2,#f3f2f1))}:host .file-list-wrapper .show-more:hover,mgt-file-item .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color--hover,var(--file-item-background-color--hover,rgba(0,0,0,.1)))}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-list-background-color:#ffffff;--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#4a4a4a;--file-upload-dialog-content-color:white;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}:host{font-family:var(--default-font-family);font-size:var(--default-font-size)}:host .file-list-wrapper,mgt-file-item .file-list-wrapper{background-color:var(--file-list-background-color,#fff);box-shadow:var(--file-list-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--file-list-border-radius,4px);border:var(--file-list-border,none);position:relative;color:var(--color-sub1,#323130);display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .file-list,mgt-file-item .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,4px 0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item,mgt-file-item .file-list-wrapper .file-list .file-item{border-top:var(--file-item-border-top,none);border-left:var(--file-item-border-left,none);border-right:var(--file-item-border-right,none);border-bottom:var(--file-item-border-bottom,none);margin:var(--file-item-margin,0 4px);border-radius:var(--file-item-border-radius,2px);cursor:pointer}:host .file-list-wrapper .file-list .file-item mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item mgt-file{--file-background-color:$background-color}:host .file-list-wrapper .file-list .file-item.focused,:host .file-list-wrapper .file-list .file-item:hover,mgt-file-item .file-list-wrapper .file-list .file-item.focused,mgt-file-item .file-list-wrapper .file-list .file-item:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1));border-radius:4px}:host .file-list-wrapper .file-list .file-item.focused mgt-file,:host .file-list-wrapper .file-list .file-item:hover mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.focused mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:hover mgt-file{--file-background-color:$file-item-background-color--hover}:host .file-list-wrapper .file-list .file-item.selected,:host .file-list-wrapper .file-list .file-item:active,mgt-file-item .file-list-wrapper .file-list .file-item.selected,mgt-file-item .file-list-wrapper .file-list .file-item:active{background-color:var(--file-item-background-color--active,rgba(0,0,0,.05))}:host .file-list-wrapper .file-list .file-item.selected mgt-file,:host .file-list-wrapper .file-list .file-item:active mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.selected mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:active mgt-file{--file-background-color:$file-item-background-color--active}:host .file-list-wrapper .progress-ring,mgt-file-item .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more,mgt-file-item .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,6px);border-bottom-right-radius:var(--show-more-button-border-bottom-right-radius,8px);border-bottom-left-radius:var(--show-more-button-border-bottom-left-radius,8px);cursor:pointer;background-color:var(--show-more-button-background-color,var(--background-color-sub2,#f3f2f1))}:host .file-list-wrapper .show-more:hover,mgt-file-item .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color--hover,var(--file-item-background-color--hover,rgba(0,0,0,.1)))}\n"])))],Bl={showMoreSubtitle:"Show more items"},ql=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},jl=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Gl=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Vl=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this))._focusedItemIndex=-1,e.pageSize=10,e.itemView=Oi.twolines,e.maxUploadFile=10,e.enableFileUpload=!1,e._preloadedFiles=[],e}return v(r,[{key:"strings",get:function(){return Bl}},{key:"fileListQuery",get:function(){return this._fileListQuery},set:function(e){e!==this._fileListQuery&&(this._fileListQuery=e,this.requestStateUpdate(!0))}},{key:"fileQueries",get:function(){return this._fileQueries},set:function(e){Gn(this._fileQueries,e)||(this._fileQueries=e,this.requestStateUpdate(!0))}},{key:"siteId",get:function(){return this._siteId},set:function(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate(!0))}},{key:"driveId",get:function(){return this._driveId},set:function(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate(!0))}},{key:"groupId",get:function(){return this._groupId},set:function(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate(!0))}},{key:"itemId",get:function(){return this._itemId},set:function(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate(!0))}},{key:"itemPath",get:function(){return this._itemPath},set:function(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate(!0))}},{key:"userId",get:function(){return this._userId},set:function(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate(!0))}},{key:"insightType",get:function(){return this._insightType},set:function(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate(!0))}},{key:"fileExtensions",get:function(){return this._fileExtensions},set:function(e){Gn(this._fileExtensions,e)||(this._fileExtensions=e,this.requestStateUpdate(!0))}},{key:"pageSize",get:function(){return this._pageSize},set:function(e){e!==this._pageSize&&(this._pageSize=e,this.requestStateUpdate(!0))}},{key:"maxFileSize",get:function(){return this._maxFileSize},set:function(e){e!==this._maxFileSize&&(this._maxFileSize=e,this.requestStateUpdate(!0))}},{key:"maxUploadFile",get:function(){return this._maxUploadFile},set:function(e){e!==this._maxUploadFile&&(this._maxUploadFile=e,this.requestStateUpdate(!0))}},{key:"excludedFileExtensions",get:function(){return this._excludedFileExtensions},set:function(e){Gn(this._excludedFileExtensions,e)||(this._excludedFileExtensions=e,this.requestStateUpdate(!0))}},{key:"requestStateUpdate",value:function(e){return this.clearState(),Ot(y(r.prototype),"requestStateUpdate",this).call(this,e)}},{key:"clearState",value:function(){Ot(y(r.prototype),"clearState",this).call(this),this.files=null}},{key:"render",value:function(){return!this.files&&this.isLoadingState?this.renderLoading():this.files&&0!==this.files.length?this.renderTemplate("default",{files:this.files})||this.renderFiles():this.renderNoData()}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null)||en(Sl||(Sl=Bn([""])))}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||(!0===this.enableFileUpload&&void 0!==Pn.globalProvider?en(Il||(Il=Bn(['\n      <fluent-design-system-provider use-defaults>\n        <div id="file-list-wrapper" class="file-list-wrapper" dir=',">\n          ","\n        </div>\n      </fluent-design-system-provider>\n      "])),this.direction,this.renderFileUpload()):en(El||(El=Bn([""]))))}},{key:"renderFiles",value:function(){var e=this;return en(Al||(Al=Bn(['\n    <fluent-design-system-provider use-defaults>\n      <div id="file-list-wrapper" class="file-list-wrapper" dir=',">\n        ",'\n        <ul\n          id="file-list"\n          class="file-list"\n          tabindex="0"\n          @keydown="','"\n          @keyup="','"\n          @blur="','"\n        >\n          ',"\n        </ul>\n        ","\n      </div>\n    </fluent-design-system-provider>\n    "])),this.direction,this.enableFileUpload?this.renderFileUpload():null,this.onFileListKeyDown,this.onFileListKeyUp,this.onFileListOut,Bs(this.files,(function(e){return e.id}),(function(t){return en(Rl||(Rl=Bn(['\n              <li class="file-item" @click=',">\n                ","\n              </li>\n            "])),(function(r){return e.handleItemSelect(t,r)}),e.renderFile(t))})),!this.hideMoreFilesButton&&this.pageIterator&&(this.pageIterator.hasNext||this._preloadedFiles.length)?this.renderMoreFileButton():null)}},{key:"renderFile",value:function(e){var t=this.itemView;return this.renderTemplate("file",{file:e},e.id)||en(Pl||(Pl=Bn(["\n        <mgt-file .fileDetails="," .view=","></mgt-file>\n      "])),e,t)}},{key:"renderMoreFileButton",value:function(){var e=this;return this._isLoadingMore?en(Ol||(Ol=Bn(['\n        <fluent-progress-ring role="progressbar" viewBox="0 0 8 8" class="progress-ring"></fluent-progress-ring>\n      ']))):en(Nl||(Nl=Bn(['<a id="show-more" class="show-more" @click=',' tabindex="0" @keydown=',"><span>","<span></a>"])),(function(){return e.renderNextPage()}),this.onShowMoreKeyDown,this.strings.showMoreSubtitle)}},{key:"renderFileUpload",value:function(){var e={graph:Pn.globalProvider.graph.forComponent(this),driveId:this.driveId,excludedFileExtensions:this.excludedFileExtensions,groupId:this.groupId,itemId:this.itemId,itemPath:this.itemPath,userId:this.userId,siteId:this.siteId,maxFileSize:this.maxFileSize,maxUploadFile:this.maxUploadFile};return en(Dl||(Dl=Bn(["\n        <mgt-file-upload .fileUploadList="," ></mgt-file-upload>\n      "])),e)}},{key:"onShowMoreKeyDown",value:function(e){e&&"Enter"===e.code&&(e.preventDefault(),this.renderNextPage())}},{key:"onFileListKeyUp",value:function(e){var t=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];"Enter"!==e.code&&"Space"!==e.code||(e.preventDefault(),null===t||void 0===t||t.classList.remove("selected"),null===t||void 0===t||t.classList.add("focused"))}},{key:"onFileListKeyDown",value:function(e){var t,r=this.renderRoot.querySelector(".file-list");if(r&&r.children.length){if("ArrowUp"!==e.code&&"ArrowDown"!==e.code||("ArrowUp"===e.code&&(-1===this._focusedItemIndex&&(this._focusedItemIndex=r.children.length),this._focusedItemIndex=(this._focusedItemIndex-1+r.children.length)%r.children.length),"ArrowDown"===e.code&&(this._focusedItemIndex=(this._focusedItemIndex+1)%r.children.length),t=r.children[this._focusedItemIndex],this.updateItemBackgroundColor(r,t,"focused")),"Enter"===e.code||"Space"===e.code){var n=(t=r.children[this._focusedItemIndex]).children[0];e.preventDefault(),this.fireCustomEvent("itemClick",n.fileDetails),this.updateItemBackgroundColor(r,t,"selected")}"Tab"===e.code&&(null===(t=r.children[this._focusedItemIndex])||void 0===t||t.classList.remove("focused"))}}},{key:"onFileListOut",value:function(){var e=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];null===e||void 0===e||e.classList.remove("focused")}},{key:"loadState",value:function(){return Gl(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a,s=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=Pn.globalProvider)&&t.state!==Sn.Loading){e.next=3;break}return e.abrupt("return");case 3:if(t.state!==Sn.SignedOut){e.next=6;break}return this.files=null,e.abrupt("return");case 6:if(r=t.graph.forComponent(this),i=!this.driveId&&!this.siteId&&!this.groupId&&!this.userId,(this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this.files=null),this.files){e.next=114;break}if(!this.fileListQuery){e.next=16;break}return e.next=13,Ac(r,this.fileListQuery,this.pageSize);case 13:o=e.sent,e.next=102;break;case 16:if(!this.fileQueries){e.next=22;break}return e.next=19,Oc(r,this.fileQueries);case 19:n=e.sent,e.next=102;break;case 22:if(!i){e.next=46;break}if(!this.itemId){e.next=29;break}return e.next=26,Cc(r,this.itemId,this.pageSize);case 26:o=e.sent,e.next=44;break;case 29:if(!this.itemPath){e.next=35;break}return e.next=32,Tc(r,this.itemPath,this.pageSize);case 32:o=e.sent,e.next=44;break;case 35:if(!this.insightType){e.next=41;break}return e.next=38,Rc(r,this.insightType);case 38:n=e.sent,e.next=44;break;case 41:return e.next=43,bc(r,this.pageSize);case 43:o=e.sent;case 44:e.next=102;break;case 46:if(!this.driveId){e.next=59;break}if(!this.itemId){e.next=53;break}return e.next=50,yc(r,this.driveId,this.itemId,this.pageSize);case 50:o=e.sent,e.next=57;break;case 53:if(!this.itemPath){e.next=57;break}return e.next=56,kc(r,this.driveId,this.itemPath,this.pageSize);case 56:o=e.sent;case 57:e.next=102;break;case 59:if(!this.groupId){e.next=72;break}if(!this.itemId){e.next=66;break}return e.next=63,wc(r,this.groupId,this.itemId,this.pageSize);case 63:o=e.sent,e.next=70;break;case 66:if(!this.itemPath){e.next=70;break}return e.next=69,xc(r,this.groupId,this.itemPath,this.pageSize);case 69:o=e.sent;case 70:e.next=102;break;case 72:if(!this.siteId){e.next=85;break}if(!this.itemId){e.next=79;break}return e.next=76,_c(r,this.siteId,this.itemId,this.pageSize);case 76:o=e.sent,e.next=83;break;case 79:if(!this.itemPath){e.next=83;break}return e.next=82,Sc(r,this.siteId,this.itemPath,this.pageSize);case 82:o=e.sent;case 83:e.next=102;break;case 85:if(!this.userId){e.next=102;break}if(!this.itemId){e.next=92;break}return e.next=89,Ic(r,this.userId,this.itemId,this.pageSize);case 89:o=e.sent,e.next=102;break;case 92:if(!this.itemPath){e.next=98;break}return e.next=95,Ec(r,this.userId,this.itemPath,this.pageSize);case 95:o=e.sent,e.next=102;break;case 98:if(!this.insightType){e.next=102;break}return e.next=101,Pc(r,this.userId,this.insightType);case 101:n=e.sent;case 102:if(o&&(this.pageIterator=o,this._preloadedFiles=d(this.pageIterator.value),n=this._preloadedFiles.length>=this.pageSize?this._preloadedFiles.splice(0,this.pageSize):this._preloadedFiles.splice(0,this._preloadedFiles.length)),!this.fileExtensions||null===this.fileExtensions){e.next=113;break}if(!this.pageIterator||!this.pageIterator.value){e.next=112;break}case 105:if(!this.pageIterator.hasNext){e.next=110;break}return e.next=108,Fc(this.pageIterator);case 108:e.next=105;break;case 110:n=this.pageIterator.value,this._preloadedFiles=[];case 112:a=n.filter((function(e){var t,r=S(s.fileExtensions);try{for(r.s();!(t=r.n()).done;){if(t.value==s.getFileExtension(e.name))return e}}catch(n){r.e(n)}finally{r.f()}}));case 113:a&&a.length>=0?(this.files=a,this.pageSize&&(n=this.files.splice(0,this.pageSize),this.files=n)):this.files=n;case 114:case"end":return e.stop()}}),e,this)})))}},{key:"handleItemSelect",value:function(e,t){if(this.fireCustomEvent("itemClick",e),t){var r=this.renderRoot.querySelector(".file-list"),n=Array.from(r.children),o=t.target.closest("li"),i=n.indexOf(o);this._focusedItemIndex=i;for(var a=0;a<r.children.length;a++)r.children[a].classList.remove("focused")}}},{key:"renderNextPage",value:function(){return Gl(this,void 0,void 0,Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._preloadedFiles.length>0)){e.next=4;break}this.files=[].concat(d(this.files),d(this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length)))),e.next=12;break;case 4:if(!this.pageIterator.hasNext){e.next=12;break}return this._isLoadingMore=!0,(t=this.renderRoot.querySelector("file-list-wrapper"))&&t.animate&&t.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),e.next=10,Fc(this.pageIterator);case 10:this._isLoadingMore=!1,this.files=this.pageIterator.value;case 12:this.requestUpdate();case 13:case"end":return e.stop()}}),e,this)})))}},{key:"getFileExtension",value:function(e){return/(?:\.([^.]+))?$/.exec(e)[1]||""}},{key:"updateItemBackgroundColor",value:function(e,t,r){for(var n=0;n<e.children.length;n++)e.children[n].classList.remove(r);t&&(t.classList.add(r),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}},{key:"reload",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&ec(),this.requestStateUpdate(!0)}}],[{key:"styles",get:function(){return Hl}},{key:"requiredScopes",get:function(){return d(new Set(d(dl.requiredScopes)))}}]),r}(Jn);ql([hn({attribute:"file-list-query"}),jl("design:type",String),jl("design:paramtypes",[String])],Vl.prototype,"fileListQuery",null),ql([hn({attribute:"file-queries",converter:function(e,t){return e?e.split(",").map((function(e){return e.trim()})):null}}),jl("design:type",Array),jl("design:paramtypes",[Array])],Vl.prototype,"fileQueries",null),ql([hn({type:Object}),jl("design:type",Array)],Vl.prototype,"files",void 0),ql([hn({attribute:"site-id"}),jl("design:type",String),jl("design:paramtypes",[String])],Vl.prototype,"siteId",null),ql([hn({attribute:"drive-id"}),jl("design:type",String),jl("design:paramtypes",[String])],Vl.prototype,"driveId",null),ql([hn({attribute:"group-id"}),jl("design:type",String),jl("design:paramtypes",[String])],Vl.prototype,"groupId",null),ql([hn({attribute:"item-id"}),jl("design:type",String),jl("design:paramtypes",[String])],Vl.prototype,"itemId",null),ql([hn({attribute:"item-path"}),jl("design:type",String),jl("design:paramtypes",[String])],Vl.prototype,"itemPath",null),ql([hn({attribute:"user-id"}),jl("design:type",String),jl("design:paramtypes",[String])],Vl.prototype,"userId",null),ql([hn({attribute:"insight-type"}),jl("design:type",String),jl("design:paramtypes",[String])],Vl.prototype,"insightType",null),ql([hn({attribute:"item-view",converter:function(e){return e&&0!==e.length?(e=e.toLowerCase(),"undefined"===typeof Oi[e]?Oi.threelines:Oi[e]):Oi.threelines}}),jl("design:type",Number)],Vl.prototype,"itemView",void 0),ql([hn({attribute:"file-extensions",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),jl("design:type",Array),jl("design:paramtypes",[Array])],Vl.prototype,"fileExtensions",null),ql([hn({attribute:"page-size",type:Number}),jl("design:type",Number),jl("design:paramtypes",[Number])],Vl.prototype,"pageSize",null),ql([hn({attribute:"hide-more-files-button",type:Boolean}),jl("design:type",Boolean)],Vl.prototype,"hideMoreFilesButton",void 0),ql([hn({attribute:"max-file-size",type:Number}),jl("design:type",Number),jl("design:paramtypes",[Number])],Vl.prototype,"maxFileSize",null),ql([hn({attribute:"enable-file-upload",type:Boolean}),jl("design:type",Boolean)],Vl.prototype,"enableFileUpload",void 0),ql([hn({attribute:"max-upload-file",type:Number}),jl("design:type",Number),jl("design:paramtypes",[Number])],Vl.prototype,"maxUploadFile",null),ql([hn({attribute:"excluded-file-extensions",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),jl("design:type",Array),jl("design:paramtypes",[Array])],Vl.prototype,"excludedFileExtensions",null),ql([gn(),jl("design:type",Boolean)],Vl.prototype,"_isLoadingMore",void 0),Vl=ql([fn("mgt-file-list"),jl("design:paramtypes",[])],Vl);var Kl,Ql=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Wl=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Jl=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};!function(e){e.json="json",e.image="image"}(Kl||(Kl={}));var Yl,Xl=function(){return ho.config.response.isEnabled&&ho.config.isEnabled},Zl=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.apply(this,arguments)).scopes=[],e.version="v1.0",e.type=Kl.json,e.maxPages=3,e.pollingRate=0,e.cacheEnabled=!1,e.cacheInvalidationPeriod=0,e.isPolling=!1,e.isRefreshing=!1,e}return v(r,[{key:"attributeChangedCallback",value:function(e,t,n){Ot(y(r.prototype),"attributeChangedCallback",this).call(this,e,t,n),this.requestStateUpdate()}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}},{key:"clearState",value:function(){this.response=null}},{key:"render",value:function(){var e=this;if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.error)return this.renderTemplate("error",this.error);if(this.hasTemplate("value")&&this.response&&this.response.value){var t;if(Array.isArray(this.response.value)){var r=null;this.isLoadingState&&!this.isPolling&&(r=this.renderTemplate("loading",null)),t=en(Ll||(Ll=Bn(["\n          "," ","\n        "])),this.response.value.map((function(t){return e.renderTemplate("value",t,t.id)})),r)}else t=this.renderTemplate("value",this.response);if(this.hasTemplate("default")){var n=this.renderTemplate("default",this.response);return this.templates.value.templateOrder>this.templates.default.templateOrder?en(Ml||(Ml=Bn(["\n            ","","\n          "])),n,t):en(Ul||(Ul=Bn(["\n            ","","\n          "])),t,n)}return t}return this.response?this.renderTemplate("default",this.response)||en(Fl||(Fl=Bn([""]))):this.hasTemplate("no-data")?this.renderTemplate("no-data",null):en(zl||(zl=Bn([""])))}},{key:"loadState",value:function(){return Jl(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a,s,c,l,u,p,f,h,g,v,m,b=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Pn.globalProvider,this.error=null,t&&t.state===Sn.SignedIn){e.next=4;break}return e.abrupt("return");case 4:if(!this.resource){e.next=72;break}if(e.prev=5,n="".concat(this.version).concat(this.resource),o=null,!this.shouldRetrieveCache()){e.next=19;break}if(r=ho.getCache(Jo,Jo.stores.responses),!Xl()){e.next=16;break}return e.next=13,r.getValue(n);case 13:e.t0=e.sent,e.next=17;break;case 16:e.t0=null;case 17:(i=e.t0)&&(this.cacheInvalidationPeriod||ho.config.response.invalidationPeriod||ho.config.defaultInvalidationPeriod)>Date.now()-i.timeCached&&(o=JSON.parse(i.response));case 19:if(o){e.next=63;break}if(a=this.resource,s=!1,this.response&&this.response["@odata.deltaLink"]?(a=this.response["@odata.deltaLink"],s=!0):s=new URL(a,"https://graph.microsoft.com").pathname.endsWith("delta"),c=t.graph.forComponent(this),l=c.api(a).version(this.version),this.scopes&&this.scopes.length&&(l=l.middlewareOptions($t.apply(void 0,d(this.scopes)))),this.type!==Kl.json){e.next=46;break}return e.next=29,l.get();case 29:if(o=e.sent,s&&this.response&&Array.isArray(this.response.value)&&Array.isArray(o.value)&&(o.value=this.response.value.concat(o.value)),this.isPolling||qn(this.response,o)||(this.response=o),!(o&&Array.isArray(o.value)&&o["@odata.nextLink"])){e.next=44;break}u=1,p=o;case 35:if(!((u<this.maxPages||this.maxPages<=0||s&&this.pollingRate)&&p&&p["@odata.nextLink"])){e.next=44;break}return u++,f=p["@odata.nextLink"].split(this.version)[1],e.next=40,c.client.api(f).version(this.version).get();case 40:(p=e.sent)&&p.value&&p.value.length&&(p.value=o.value.concat(p.value),o=p,this.isPolling||(this.response=o)),e.next=35;break;case 44:e.next=62;break;case 46:if(-1!==this.resource.indexOf("/photo/$value")||-1!==this.resource.indexOf("/thumbnails/")){e.next=48;break}throw new Error("Only /photo/$value and /thumbnails/ endpoints support the image type");case 48:if(!(this.resource.indexOf("/photo/$value")>-1)){e.next=56;break}return g=this.resource.replace("/photo/$value",""),e.next=52,ki(c,g,this.scopes);case 52:(v=e.sent)&&(h=v.photo),e.next=61;break;case 56:if(!(this.resource.indexOf("/thumbnails/")>-1)){e.next=61;break}return e.next=59,zc(c,this.resource,this.scopes);case 59:(m=e.sent)&&(h=m.thumbnail);case 61:h&&(o={image:h});case 62:this.shouldUpdateCache()&&o&&(r=ho.getCache(Jo,Jo.stores.responses)).putValue(n,{response:JSON.stringify(o)});case 63:qn(this.response,o)||(this.response=o),e.next=69;break;case 66:e.prev=66,e.t1=e.catch(5),this.error=e.t1;case 69:this.response&&(this.error=null,this.pollingRate&&setTimeout((function(){return Jl(b,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isPolling=!0,e.next=3,this.loadState();case 3:this.isPolling=!1;case 4:case"end":return e.stop()}}),e,this)})))}),this.pollingRate)),e.next=73;break;case 72:this.response=null;case 73:this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error});case 75:case"end":return e.stop()}}),e,this,[[5,66]])})))}},{key:"shouldRetrieveCache",value:function(){return Xl()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}},{key:"shouldUpdateCache",value:function(){return Xl()&&this.cacheEnabled}}]),r}(Jn);Ql([hn({attribute:"resource",reflect:!0,type:String}),Wl("design:type",String)],Zl.prototype,"resource",void 0),Ql([hn({attribute:"scopes",converter:function(e,t){return e?e.toLowerCase().split(","):null},reflect:!0}),Wl("design:type",Array)],Zl.prototype,"scopes",void 0),Ql([hn({attribute:"version",reflect:!0,type:String}),Wl("design:type",String)],Zl.prototype,"version",void 0),Ql([hn({attribute:"type",reflect:!0,type:Kl}),Wl("design:type",String)],Zl.prototype,"type",void 0),Ql([hn({attribute:"max-pages",reflect:!0,type:Number}),Wl("design:type",Number)],Zl.prototype,"maxPages",void 0),Ql([hn({attribute:"polling-rate",reflect:!0,type:Number}),Wl("design:type",Number)],Zl.prototype,"pollingRate",void 0),Ql([hn({attribute:"cache-enabled",reflect:!0,type:Boolean}),Wl("design:type",Boolean)],Zl.prototype,"cacheEnabled",void 0),Ql([hn({attribute:"cache-invalidation-period",reflect:!0,type:Number}),Wl("design:type",Number)],Zl.prototype,"cacheInvalidationPeriod",void 0),Ql([hn({attribute:!1}),Wl("design:type",Object)],Zl.prototype,"response",void 0),Ql([hn({attribute:!1}),Wl("design:type",Object)],Zl.prototype,"error",void 0),Zl=Ql([fn("mgt-get")],Zl);var $l,eu,tu,ru,nu,ou,iu,au,su=[xn(Yl||(Yl=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}:host,mgt-login{--font-size:14px;--font-weight:600;--width:'100%';--height:'100%';--margin:0;--padding:12px 20px;--popup-command-font-size:12px;--popup-command-margin:16px 0 0;--popup-padding:24px 48px 16px 24px}:host .root,mgt-login .root{position:relative;display:inline-block}:host .login-button,mgt-login .login-button{display:flex;align-items:center;font-family:var(--default-font-family);font-size:var(--font-size);font-weight:var(--font-weight);width:var(--width);height:var(--height);margin:var(--margin);padding:var(--padding);color:var(--button-color,#323130);background-color:var(--button-background-color,transparent);border:none;cursor:pointer;transition:color .3s,background-color .3s;word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-button mgt-person,mgt-login .login-button mgt-person{--color-sub1:set-var(button__color, $theme-default, $login)}:host .login-button:hover,mgt-login .login-button:hover{color:var(--button-color--hover,#0078d4);--color:var(--button-color--hover, #0078d4);background-color:var(--button-background-color--hover,var(--background-color--hover,#edebe9));--color-sub1:var(--button-color--hover, #0078d4);border-radius:4px}:host .login-button:focus,mgt-login .login-button:focus{outline:0}:host .login-button:disabled,mgt-login .login-button:disabled{opacity:.4;pointer-events:none}:host .login-button.no-click,mgt-login .login-button.no-click{pointer-events:none}:host .login-button:focus-visible,mgt-login .login-button:focus-visible{outline:auto}:host .login-icon+span,mgt-login .login-icon+span{margin-left:6px}:host .popup,mgt-login .popup{font-family:var(--default-font-family);background-color:var(--popup-background-color,var(--background-color,#fff));min-width:240px;z-index:1;color:var(--popup-color,#323130);border-radius:8px}:host .popup mgt-person,mgt-login .popup mgt-person{--color-sub1:set-var(popup__color, $theme-default, $login)}:host .popup-content,mgt-login .popup-content{display:flex;flex-direction:column;padding:var(--popup-padding);border-radius:8px}:host .popup-commands ul,mgt-login .popup-commands ul{list-style-type:none;margin:var(--popup-command-margin);padding:0}:host .popup-command,mgt-login .popup-command{font-family:var(--default-font-family);font-size:var(--popup-command-font-size);font-weight:var(--font-weight);color:#0078d4;background-color:var(--popup-background-color,var(--background-color,#fff));border:none;padding:0;cursor:pointer;transition:color .3s;word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .popup-command:hover,mgt-login .popup-command:hover{color:#005a9e}[dir=rtl]{--popup-padding:24px 24px 16px 48px}[dir=rtl] mgt-person .details{--details-spacing:0px 12px 0px 0px}[dir=rtl] mgt-person .details.small{--details-spacing:0px 6px 0px 0px}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}:host,mgt-login{--font-size:14px;--font-weight:600;--width:'100%';--height:'100%';--margin:0;--padding:12px 20px;--popup-command-font-size:12px;--popup-command-margin:16px 0 0;--popup-padding:24px 48px 16px 24px}:host .root,mgt-login .root{position:relative;display:inline-block}:host .login-button,mgt-login .login-button{display:flex;align-items:center;font-family:var(--default-font-family);font-size:var(--font-size);font-weight:var(--font-weight);width:var(--width);height:var(--height);margin:var(--margin);padding:var(--padding);color:var(--button-color,#323130);background-color:var(--button-background-color,transparent);border:none;cursor:pointer;transition:color .3s,background-color .3s;word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-button mgt-person,mgt-login .login-button mgt-person{--color-sub1:set-var(button__color, $theme-default, $login)}:host .login-button:hover,mgt-login .login-button:hover{color:var(--button-color--hover,#0078d4);--color:var(--button-color--hover, #0078d4);background-color:var(--button-background-color--hover,var(--background-color--hover,#edebe9));--color-sub1:var(--button-color--hover, #0078d4);border-radius:4px}:host .login-button:focus,mgt-login .login-button:focus{outline:0}:host .login-button:disabled,mgt-login .login-button:disabled{opacity:.4;pointer-events:none}:host .login-button.no-click,mgt-login .login-button.no-click{pointer-events:none}:host .login-button:focus-visible,mgt-login .login-button:focus-visible{outline:auto}:host .login-icon+span,mgt-login .login-icon+span{margin-left:6px}:host .popup,mgt-login .popup{font-family:var(--default-font-family);background-color:var(--popup-background-color,var(--background-color,#fff));min-width:240px;z-index:1;color:var(--popup-color,#323130);border-radius:8px}:host .popup mgt-person,mgt-login .popup mgt-person{--color-sub1:set-var(popup__color, $theme-default, $login)}:host .popup-content,mgt-login .popup-content{display:flex;flex-direction:column;padding:var(--popup-padding);border-radius:8px}:host .popup-commands ul,mgt-login .popup-commands ul{list-style-type:none;margin:var(--popup-command-margin);padding:0}:host .popup-command,mgt-login .popup-command{font-family:var(--default-font-family);font-size:var(--popup-command-font-size);font-weight:var(--font-weight);color:#0078d4;background-color:var(--popup-background-color,var(--background-color,#fff));border:none;padding:0;cursor:pointer;transition:color .3s;word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .popup-command:hover,mgt-login .popup-command:hover{color:#005a9e}[dir=rtl]{--popup-padding:24px 24px 16px 48px}[dir=rtl] mgt-person .details{--details-spacing:0px 12px 0px 0px}[dir=rtl] mgt-person .details.small{--details-spacing:0px 6px 0px 0px}\n"])))],cu={signInLinkSubtitle:"Sign In",signOutLinkSubtitle:"Sign Out"},lu=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},uu=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},du=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},pu=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this))._isFlyoutOpen=!1,e}return v(r,[{key:"strings",get:function(){return cu}},{key:"flyout",get:function(){return this.renderRoot.querySelector(".flyout")}},{key:"connectedCallback",value:function(){Ot(y(r.prototype),"connectedCallback",this).call(this),this.addEventListener("click",(function(e){return e.stopPropagation()}))}},{key:"login",value:function(){return du(this,void 0,void 0,Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.userDetails&&this.fireCustomEvent("loginInitiated")){e.next=2;break}return e.abrupt("return");case 2:if(!(t=Pn.globalProvider)||!t.login){e.next=7;break}return e.next=6,t.login();case 6:t.state===Sn.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed");case 7:case"end":return e.stop()}}),e,this)})))}},{key:"logout",value:function(){return du(this,void 0,void 0,Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fireCustomEvent("logoutInitiated")){e.next=2;break}return e.abrupt("return");case 2:if(!(t=Pn.globalProvider)||!t.logout){e.next=9;break}return e.next=6,t.logout();case 6:this.userDetails=null,this.hideFlyout(),this.fireCustomEvent("logoutCompleted");case 9:case"end":return e.stop()}}),e,this)})))}},{key:"render",value:function(){return en($l||($l=Bn(['\n      <div class="root" dir=',">\n        <div>\n          ","\n        </div>\n        ","\n      </div>\n    "])),this.direction,this.renderButton(),this.renderFlyout())}},{key:"loadState",value:function(){return du(this,void 0,void 0,Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=Pn.globalProvider)||this.userDetails){e.next=11;break}if(t.state!==Sn.SignedIn){e.next=10;break}return e.next=5,ga(t.graph.forComponent(this));case 5:this.userDetails=e.sent,this.userDetails.personImage&&(this._image=this.userDetails.personImage),this.fireCustomEvent("loginCompleted"),e.next=11;break;case 10:this.userDetails=null;case 11:case"end":return e.stop()}}),e,this)})))}},{key:"renderButton",value:function(){var e=Pn.globalProvider,t=Sn.SignedIn,r=this.strings.signInLinkSubtitle;e&&e.state===t&&(r=this.userDetails?this.userDetails.displayName:this.strings.signInLinkSubtitle);var n={"login-button":!0,"no-click":this._isFlyoutOpen};return en(eu||(eu=Bn(["\n      <button aria-label=",' ?disabled="','" @click='," class=",' role="button">\n        ',"\n      </button>\n    "])),r,this.isLoadingState,this.onClick,Do(n),this.renderButtonContent())}},{key:"renderFlyout",value:function(){var e=this;return en(tu||(tu=Bn(['\n      <mgt-flyout\n        class="flyout"\n        light-dismiss\n        @opened=',"\n        @closed=",'\n      >\n        <div slot="flyout">\n          ',"\n        </div>\n      </mgt-flyout>\n    "])),(function(){return e._isFlyoutOpen=!0}),(function(){return e._isFlyoutOpen=!1}),this.renderFlyoutContent())}},{key:"renderFlyoutContent",value:function(){if(this.userDetails)return en(ru||(ru=Bn(['\n      <div class="popup">\n        <div class="popup-content">\n          <div>\n            ','\n          </div>\n          <div class="popup-commands">\n            ',"\n          </div>\n        </div>\n      </div>\n    "])),this.renderFlyoutPersonDetails(this.userDetails,this._image),this.renderFlyoutCommands())}},{key:"renderFlyoutPersonDetails",value:function(e,t){return this.renderTemplate("flyout-person-details",{personDetails:e,personImage:t})||en(nu||(nu=Bn(["\n        <mgt-person .personDetails="," .personImage="," .view="," />\n      "])),e,t,Oi.twolines)}},{key:"renderFlyoutCommands",value:function(){var e=this;return this.renderTemplate("flyout-commands",{handleSignOut:function(){return e.logout()}})||en(ou||(ou=Bn(['\n        <ul>\n          <li>\n            <button class="popup-command" @click='," aria-label=",">\n              ","\n            </button>\n          </li>\n        </ul>\n      "])),this.logout,this.strings.signOutLinkSubtitle,this.strings.signOutLinkSubtitle)}},{key:"renderButtonContent",value:function(){return this.userDetails?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent()}},{key:"renderSignedInButtonContent",value:function(e,t){return this.renderTemplate("signed-in-button-content",{personDetails:e,personImage:t})||en(iu||(iu=Bn(["\n        <mgt-person .personDetails="," .personImage="," .view="," />\n      "])),this.userDetails,this._image,Oi.oneline)}},{key:"clearState",value:function(){this.userDetails=null,this._image=null}},{key:"renderSignedOutButtonContent",value:function(){return this.renderTemplate("signed-out-button-content",null)||en(au||(au=Bn(['\n        <i class="login-icon ms-Icon ms-Icon--Contact"></i>\n        <span>',"</span>\n      "])),this.strings.signInLinkSubtitle)}},{key:"showFlyout",value:function(){var e=this.flyout;e&&e.open()}},{key:"hideFlyout",value:function(){var e=this.flyout;e&&e.close()}},{key:"onClick",value:function(){this.userDetails?this.showFlyout():this.login()}}],[{key:"styles",get:function(){return su}},{key:"requiredScopes",get:function(){return d(new Set(["user.read"].concat(d(ls.requiredScopes))))}}]),r}(Jn);lu([hn({attribute:"user-details",type:Object}),uu("design:type",Object)],pu.prototype,"userDetails",void 0),lu([hn({attribute:!1}),uu("design:type",Boolean)],pu.prototype,"_isFlyoutOpen",void 0),pu=lu([fn("mgt-login"),uu("design:paramtypes",[])],pu);var fu,hu=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};!function(e){e[e.any=0]="any",e[e.unified=1]="unified",e[e.security=2]="security",e[e.mailenabledsecurity=4]="mailenabledsecurity",e[e.distribution=8]="distribution"}(fu||(fu={}));var gu,vu=function(){return ho.config.groups.invalidationPeriod||ho.config.defaultInvalidationPeriod},mu=function(){return ho.config.groups.isEnabled&&ho.config.isEnabled};function bu(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:fu.any,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return hu(this,void 0,void 0,Ze().mark((function i(){var a,s,c,l,u,d,p,f,h,g,v,m,b,y,k,w,x,C,T,_,I;return Ze().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a="Group.Read.All",c="".concat(t||"*","*").concat(n,"*").concat(o),!mu()){i.next=10;break}return s=ho.getCache(Wo,Wo.stores.groupsQuery),i.next=6,s.getValue(c);case 6:if(!((l=i.sent)&&vu()>Date.now()-l.timeCached)){i.next=10;break}if(!(l.top>=r)){i.next=10;break}return i.abrupt("return",l.groups.map((function(e){return JSON.parse(e)})).slice(0,r+1));case 10:if(u="",p=[],""!==t&&(u="(startswith(displayName,'".concat(t,"') or startswith(mailNickname,'").concat(t,"') or startswith(mail,'").concat(t,"'))")),o&&(u+="".concat(t?" and ":"").concat(o)),n===fu.any){i.next=83;break}for(f=e.createBatch(),h=[],fu.unified===(n&fu.unified)&&h.push("groupTypes/any(c:c+eq+'Unified')"),fu.security===(n&fu.security)&&h.push("(mailEnabled eq false and securityEnabled eq true)"),fu.mailenabledsecurity===(n&fu.mailenabledsecurity)&&h.push("(mailEnabled eq true and securityEnabled eq true)"),fu.distribution===(n&fu.distribution)&&h.push("(mailEnabled eq true and securityEnabled eq false)"),u=u?"".concat(u," and "):"",g=0,v=h;g<v.length;g++)m=v[g],f.get(m,"/groups?$filter=".concat(u+m),["Group.Read.All"]);return i.prev=23,i.next=26,f.executeAll();case 26:d=i.sent,b=0;case 28:if(!(b<h.length)){i.next=49;break}if(!d.get(h[b]).content.value){i.next=46;break}y=S(d.get(h[b]).content.value),i.prev=31,w=Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=k.value,0===p.filter((function(e){return e.id===t.id})).length&&p.push(t),[];case 4:case"end":return e.stop()}}),e)})),y.s();case 34:if((k=y.n()).done){i.next=38;break}return i.delegateYield(w(),"t0",36);case 36:i.next=34;break;case 38:i.next=43;break;case 40:i.prev=40,i.t1=i.catch(31),y.e(i.t1);case 43:return i.prev=43,y.f(),i.finish(43);case 46:b++,i.next=28;break;case 49:i.next=81;break;case 51:i.prev=51,i.t2=i.catch(23),i.prev=53,x=[],C=S(h),i.prev=56,C.s();case 58:if((T=C.n()).done){i.next=67;break}return _=T.value,i.t3=x,i.next=63,e.api("groups").filter("".concat(u," and ").concat(_)).top(r).count(!0).header("ConsistencyLevel","eventual").middlewareOptions($t(a)).get();case 63:i.t4=i.sent,i.t3.push.call(i.t3,i.t4);case 65:i.next=58;break;case 67:i.next=72;break;case 69:i.prev=69,i.t5=i.catch(56),C.e(i.t5);case 72:return i.prev=72,C.f(),i.finish(72);case 75:return i.abrupt("return",Promise.all(x));case 78:return i.prev=78,i.t6=i.catch(53),i.abrupt("return",[]);case 81:i.next=89;break;case 83:if(0!==p.length){i.next=89;break}return i.next=86,e.api("groups").filter(u).top(r).count(!0).header("ConsistencyLevel","eventual").middlewareOptions($t(a)).get();case 86:return I=i.sent,mu()&&I&&s.putValue(c,{groups:I.value.map((function(e){return JSON.stringify(e)})),top:r}),i.abrupt("return",I?I.value:null);case 89:return i.abrupt("return",p);case 90:case"end":return i.stop()}}),i,null,[[23,51],[31,40,43,46],[53,78],[56,69,72,75]])})))}function yu(e,t,r){return hu(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l,u;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o="Group.Read.All",!mu()){n.next=11;break}return i=ho.getCache(Wo,Wo.stores.groups),n.next=5,i.getValue(t);case 5:if(!((a=n.sent)&&vu()>Date.now()-a.timeCached)){n.next=11;break}if(s=a.group?JSON.parse(a.group):null,(c=r&&s?r.filter((function(e){return!Object.keys(s).includes(e)})):null)&&!(c.length<=1)){n.next=11;break}return n.abrupt("return",s);case 11:return l="/groups/".concat(t),r&&(l=l+"?$select="+r.toString()),n.next=15,e.api(l).middlewareOptions($t(o)).get();case 15:return u=n.sent,mu()&&i.putValue(t,{group:JSON.stringify(u)}),n.abrupt("return",u);case 18:case"end":return n.stop()}}),n)})))}function ku(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return hu(this,void 0,void 0,Ze().mark((function n(){var o,i,a,s,c,l,u,d,p,f,h,g,v,m,b=this;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t&&0!==t.length){n.next=2;break}return n.abrupt("return",[]);case 2:o=e.createBatch(),i={},a=[],mu()&&(s=ho.getCache(Wo,Wo.stores.groups)),c=S(t),n.prev=7,c.s();case 9:if((l=c.n()).done){n.next=20;break}if(u=l.value,i[u]=null,d=null,!mu()){n.next=17;break}return n.next=16,s.getValue(u);case 16:d=n.sent;case 17:d&&vu()>Date.now()-d.timeCached?i[u]=d.group?JSON.parse(d.group):null:""!==u&&(p="/groups/".concat(u),r&&(p="".concat(p,"?$filters=").concat(r)),o.get(u,p,["Group.Read.All"]),a.push(u));case 18:n.next=9;break;case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(7),c.e(n.t0);case 25:return n.prev=25,c.f(),n.finish(25);case 28:return n.prev=28,n.next=31,o.executeAll();case 31:f=n.sent,h=S(t);try{for(h.s();!(g=h.n()).done;)v=g.value,(m=f.get(v))&&m.content&&(i[v]=m.content,mu()&&s.putValue(v,{group:JSON.stringify(m.content)}))}catch(y){h.e(y)}finally{h.f()}return n.abrupt("return",Promise.all(Object.values(i)));case 37:return n.prev=37,n.t1=n.catch(28),n.prev=39,t.filter((function(e){return a.includes(e)})).forEach((function(t){return i[t]=yu(e,t)})),mu()&&t.filter((function(e){return a.includes(e)})).forEach((function(e){return hu(b,void 0,void 0,Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=s,t.t1=e,t.t2=JSON,t.next=5,i[e];case 5:return t.t3=t.sent,t.t4=t.t2.stringify.call(t.t2,t.t3),t.t5={group:t.t4},t.abrupt("return",t.t0.putValue.call(t.t0,t.t1,t.t5));case 9:case"end":return t.stop()}}),t)})))})),n.abrupt("return",Promise.all(Object.values(i)));case 45:return n.prev=45,n.t2=n.catch(39),n.abrupt("return",[]);case 48:case"end":return n.stop()}}),n,null,[[7,22,25,28],[28,37],[39,45]])})))}function wu(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:fu.any,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return hu(this,void 0,void 0,Ze().mark((function a(){var s,c,l,u;return Ze().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s=[],a.next=3,bu(e,t,n,o,i);case 3:if(c=a.sent)for(l=0;l<c.length;l++)(u=c[l]).id&&r.includes(u.id)&&s.push(u);return a.abrupt("return",s);case 6:case"end":return a.stop()}}),a)})))}var xu,Cu,Tu=[xn(gu||(gu=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}:host .spinner{border:2px solid #c7e0f4;border-top:2px solid #0078d4;border-radius:50%;width:20px;height:20px;animation:spin 2s linear infinite}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}:host .spinner{border:2px solid #c7e0f4;border-top:2px solid #0078d4;border-radius:50%;width:20px;height:20px;animation:spin 2s linear infinite}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}\n"])))],_u=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Su=function(e){b(r,e);var t=C(r);function r(){return p(this,r),t.apply(this,arguments)}return v(r,[{key:"render",value:function(){return en(xu||(xu=Bn(['\n      <div class="spinner"></div>\n    '])))}}],[{key:"styles",get:function(){return Tu}}]),r}(Un);Su=_u([fn("mgt-spinner")],Su);var Iu,Eu,Au,Ru,Pu,Ou,Nu,Du,Lu,Mu,Uu,Fu,zu,Hu,Bu=[xn(Cu||(Cu=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--selected-person-background-color:#f3f2f1}.mgt-dark{--selected-person-background-color:#4f4f4f}:host{font-family:var(--default-font-family);font-size:14px;height:24px;display:contents;overflow:hidden;position:absolute;width:135px;left:0;top:0;border-radius:12px}:host .root,mgt-people-picker .root{display:block}.people-picker{background-color:var(--input-background-color,#fff);border-top:var(--input-border-top,var(--input-border,2px solid #605e5c));border-right:var(--input-border-right,var(--input-border,2px solid #605e5c));border-bottom:var(--input-border-bottom,var(--input-border,2px solid #605e5c));border-left:var(--input-border-left,var(--input-border,2px solid #605e5c));padding:6px 0 0}.people-picker:hover{border-color:var(--input-border-color--hover,#323130)}.people-picker.focused{border-color:var(--input-border-color--focus,#0078d4)}.people-picker.disabled{pointer-events:none}.people-picker .people-picker-inner{flex:1 1 auto;display:flex;flex-wrap:wrap;vertical-align:middle;list-style-type:none;font-style:normal;font-weight:400;overflow:hidden}.people-picker .flyout .search-box{margin:1px 2px 8px}.people-picker .flyout .search-box.search-box-start{line-height:normal;margin-inline-start:0;margin-inline-end:0}.people-picker .flyout .search-box__input{box-sizing:border-box;border-width:0;border-style:none;width:100%;display:flex;flex:1 0 auto;font-family:var(--default-font-family);position:relative;outline:0;font-style:normal;font-weight:400;font-size:14px;background-color:var(--input-background-color,#fff);color:var(--color-sub1,#323130);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}.people-picker .flyout .search-box__input::placeholder{color:var(--placeholder-color,#605e5c)}.people-picker .flyout .flyout-root{padding:0;border-radius:2px;min-width:260px;overflow-y:auto;text-align:left;list-style-type:none;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));max-height:var(--mgt-flyout-set-height,unset);border-radius:8px}.people-picker .flyout .flyout-root li{cursor:pointer}.people-picker .flyout .flyout-root .people-list{list-style:none;padding:0}.people-picker .flyout .flyout-root .people-list .list-person{display:flex;flex-direction:row;align-items:center;padding:12px;font-style:normal;font-weight:600;font-size:14px;margin:var(--file-item-margin,4px);border-radius:4px}.people-picker .flyout .flyout-root .people-list .list-person:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.people-picker .flyout .flyout-root .people-list .list-person:hover .people-person-text-area{color:var(--dropdown-item-text-hover-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person.focused{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.people-picker .flyout .flyout-root .people-list .list-person.focused .people-person-text-area{color:var(--dropdown-item-text-hover-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area{margin-left:13px;flex:1 1 0;max-height:40px;overflow:hidden;color:var(--dropdown-item-text-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text{font-size:14px;font-weight:400;margin:0;padding:0}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text.highlight-search-text{font-weight:700}.people-picker .selected-list{list-style:none;padding:0;display:contents}.people-picker .selected-list__person-wrapper,.people-picker .selected-list__person-wrapper-highlighted,.people-picker .selected-list__person-wrapper-highlighted:hover{display:flex;margin:0 5px 6px 0;align-items:center;border-radius:12px;height:24px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;position:relative;background-color:var(--selected-person-background-color,#f3f2f1)}.people-picker .selected-list__person-wrapper-highlighted__person,.people-picker .selected-list__person-wrapper__person{overflow:hidden;min-width:100%;--avatar-size-s:24px;margin-left:0;--color:var(--color-sub1, #323130);color:var(--color-sub1,#323130);padding-bottom:1px;padding-right:4px}.people-picker .selected-list__person-wrapper-highlighted__overflow,.people-picker .selected-list__person-wrapper__overflow{margin-left:25px}.people-picker .selected-list__person-wrapper-highlighted__overflow__gradient,.people-picker .selected-list__person-wrapper__overflow__gradient{content:'';position:absolute;margin-right:23px;width:10px;height:90%;top:0;right:0;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:none}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon,.people-picker .selected-list__person-wrapper__overflow__close-icon{font-family:FabricMDL2Icons;cursor:pointer;background-color:var(--selected-person-background-color,#f3f2f1);color:var(--color-sub1,#323130);display:flex;flex-direction:column;align-items:center;position:absolute;height:24px;width:24px;right:0;top:0;border-radius:12px;line-height:24px}.people-picker .selected-list__person-wrapper-highlighted,.people-picker .selected-list__person-wrapper-highlighted:hover{background:#005393}.people-picker .selected-list__person-wrapper-highlighted__person{color:#fff;--color:white}.people-picker .selected-list__person-wrapper-highlighted__overflow__gradient{background-image:none}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon{background:#005393;color:#fff;line-height:24px}.people-picker .selected-list__person-wrapper-highlighted:hover{background-color:#006cbe}mgt-person{--avatar-size-s:32px;margin-left:12px;cursor:default}:host .loading-text,:host .search-error-text,mgt-people-picker .loading-text,mgt-people-picker .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;margin-left:50px;margin-right:50px;color:#0078d4}:host .message-parent,mgt-people-picker .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}:host .people-person-job-title,mgt-people-picker .people-person-job-title{flex:100%;order:3;font-weight:400;font-size:12px}:host .people-person-job-title.uppercase,mgt-people-picker .people-person-job-title.uppercase{text-transform:uppercase}mgt-flyout{flex:1 0 auto}[dir=rtl] mgt-person{margin:0 12px 0 0}[dir=rtl] .selected-list{margin-right:8px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted,[dir=rtl] .selected-list__person-wrapper{margin-left:6px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__person,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__person,[dir=rtl] .selected-list__person-wrapper__person{margin-right:0!important;margin-left:4px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__overflow__gradient,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__overflow__gradient,[dir=rtl] .selected-list__person-wrapper__overflow__gradient{right:auto!important;position:absolute!important;margin-right:0!important;width:10px!important;height:90%;top:0}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__overflow__close-icon,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon,[dir=rtl] .selected-list__person-wrapper__overflow__close-icon{right:auto!important;margin-left:5px!important;left:0!important}[dir=rtl] .people-person-text-area{margin-right:13px;margin-left:0!important}[dir=rtl] .flyout-root{text-align:right!important}@media (forced-colors:active) and (prefers-color-scheme:dark){svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#fff!important}.flyout-root{border:1px solid #fff}.people-list .list-person{border:solid 1px #fff}}@media (forced-colors:active) and (prefers-color-scheme:light){svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#000!important}.flyout-root{border:1px solid #000}.people-list .list-person{border:solid 1px #000}}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--selected-person-background-color:#f3f2f1}.mgt-dark{--selected-person-background-color:#4f4f4f}:host{font-family:var(--default-font-family);font-size:14px;height:24px;display:contents;overflow:hidden;position:absolute;width:135px;left:0;top:0;border-radius:12px}:host .root,mgt-people-picker .root{display:block}.people-picker{background-color:var(--input-background-color,#fff);border-top:var(--input-border-top,var(--input-border,2px solid #605e5c));border-right:var(--input-border-right,var(--input-border,2px solid #605e5c));border-bottom:var(--input-border-bottom,var(--input-border,2px solid #605e5c));border-left:var(--input-border-left,var(--input-border,2px solid #605e5c));padding:6px 0 0}.people-picker:hover{border-color:var(--input-border-color--hover,#323130)}.people-picker.focused{border-color:var(--input-border-color--focus,#0078d4)}.people-picker.disabled{pointer-events:none}.people-picker .people-picker-inner{flex:1 1 auto;display:flex;flex-wrap:wrap;vertical-align:middle;list-style-type:none;font-style:normal;font-weight:400;overflow:hidden}.people-picker .flyout .search-box{margin:1px 2px 8px}.people-picker .flyout .search-box.search-box-start{line-height:normal;margin-inline-start:0;margin-inline-end:0}.people-picker .flyout .search-box__input{box-sizing:border-box;border-width:0;border-style:none;width:100%;display:flex;flex:1 0 auto;font-family:var(--default-font-family);position:relative;outline:0;font-style:normal;font-weight:400;font-size:14px;background-color:var(--input-background-color,#fff);color:var(--color-sub1,#323130);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}.people-picker .flyout .search-box__input::placeholder{color:var(--placeholder-color,#605e5c)}.people-picker .flyout .flyout-root{padding:0;border-radius:2px;min-width:260px;overflow-y:auto;text-align:left;list-style-type:none;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));max-height:var(--mgt-flyout-set-height,unset);border-radius:8px}.people-picker .flyout .flyout-root li{cursor:pointer}.people-picker .flyout .flyout-root .people-list{list-style:none;padding:0}.people-picker .flyout .flyout-root .people-list .list-person{display:flex;flex-direction:row;align-items:center;padding:12px;font-style:normal;font-weight:600;font-size:14px;margin:var(--file-item-margin,4px);border-radius:4px}.people-picker .flyout .flyout-root .people-list .list-person:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.people-picker .flyout .flyout-root .people-list .list-person:hover .people-person-text-area{color:var(--dropdown-item-text-hover-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person.focused{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.people-picker .flyout .flyout-root .people-list .list-person.focused .people-person-text-area{color:var(--dropdown-item-text-hover-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area{margin-left:13px;flex:1 1 0;max-height:40px;overflow:hidden;color:var(--dropdown-item-text-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text{font-size:14px;font-weight:400;margin:0;padding:0}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text.highlight-search-text{font-weight:700}.people-picker .selected-list{list-style:none;padding:0;display:contents}.people-picker .selected-list__person-wrapper,.people-picker .selected-list__person-wrapper-highlighted,.people-picker .selected-list__person-wrapper-highlighted:hover{display:flex;margin:0 5px 6px 0;align-items:center;border-radius:12px;height:24px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;position:relative;background-color:var(--selected-person-background-color,#f3f2f1)}.people-picker .selected-list__person-wrapper-highlighted__person,.people-picker .selected-list__person-wrapper__person{overflow:hidden;min-width:100%;--avatar-size-s:24px;margin-left:0;--color:var(--color-sub1, #323130);color:var(--color-sub1,#323130);padding-bottom:1px;padding-right:4px}.people-picker .selected-list__person-wrapper-highlighted__overflow,.people-picker .selected-list__person-wrapper__overflow{margin-left:25px}.people-picker .selected-list__person-wrapper-highlighted__overflow__gradient,.people-picker .selected-list__person-wrapper__overflow__gradient{content:'';position:absolute;margin-right:23px;width:10px;height:90%;top:0;right:0;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:none}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon,.people-picker .selected-list__person-wrapper__overflow__close-icon{font-family:FabricMDL2Icons;cursor:pointer;background-color:var(--selected-person-background-color,#f3f2f1);color:var(--color-sub1,#323130);display:flex;flex-direction:column;align-items:center;position:absolute;height:24px;width:24px;right:0;top:0;border-radius:12px;line-height:24px}.people-picker .selected-list__person-wrapper-highlighted,.people-picker .selected-list__person-wrapper-highlighted:hover{background:#005393}.people-picker .selected-list__person-wrapper-highlighted__person{color:#fff;--color:white}.people-picker .selected-list__person-wrapper-highlighted__overflow__gradient{background-image:none}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon{background:#005393;color:#fff;line-height:24px}.people-picker .selected-list__person-wrapper-highlighted:hover{background-color:#006cbe}mgt-person{--avatar-size-s:32px;margin-left:12px;cursor:default}:host .loading-text,:host .search-error-text,mgt-people-picker .loading-text,mgt-people-picker .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;margin-left:50px;margin-right:50px;color:#0078d4}:host .message-parent,mgt-people-picker .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}:host .people-person-job-title,mgt-people-picker .people-person-job-title{flex:100%;order:3;font-weight:400;font-size:12px}:host .people-person-job-title.uppercase,mgt-people-picker .people-person-job-title.uppercase{text-transform:uppercase}mgt-flyout{flex:1 0 auto}[dir=rtl] mgt-person{margin:0 12px 0 0}[dir=rtl] .selected-list{margin-right:8px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted,[dir=rtl] .selected-list__person-wrapper{margin-left:6px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__person,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__person,[dir=rtl] .selected-list__person-wrapper__person{margin-right:0!important;margin-left:4px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__overflow__gradient,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__overflow__gradient,[dir=rtl] .selected-list__person-wrapper__overflow__gradient{right:auto!important;position:absolute!important;margin-right:0!important;width:10px!important;height:90%;top:0}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__overflow__close-icon,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon,[dir=rtl] .selected-list__person-wrapper__overflow__close-icon{right:auto!important;margin-left:5px!important;left:0!important}[dir=rtl] .people-person-text-area{margin-right:13px;margin-left:0!important}[dir=rtl] .flyout-root{text-align:right!important}@media (forced-colors:active) and (prefers-color-scheme:dark){svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#fff!important}.flyout-root{border:1px solid #fff}.people-list .list-person{border:solid 1px #fff}}@media (forced-colors:active) and (prefers-color-scheme:light){svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#000!important}.flyout-root{border:1px solid #000}.people-list .list-person{border:solid 1px #000}}\n"])))],qu={inputPlaceholderText:"Start typing a name",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",suggestedContact:"suggested contact",suggestedContacts:"suggested contacts",selected:"selected",removeSelectedItem:"remove selected item"},ju=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Gu=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Vu=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Ku=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this))._type=qo.person,e._groupType=fu.any,e._userType=jo.any,e._arrowSelectionCount=-1,e._highlightedUsers=[],e._currentHighlightedUserPos=0,e._isFocused=!1,e._setAnyEmail=!1,e.clearState(),e._showLoading=!0,e.showMax=6,e.disableImages=!1,e.disabled=!1,e.allowAnyEmail=!1,e.addEventListener("copy",e.handleCopy),e.addEventListener("cut",e.handleCut),e.addEventListener("paste",e.handlePaste),e}return v(r,[{key:"strings",get:function(){return qu}},{key:"flyout",get:function(){return this.renderRoot.querySelector(".flyout")}},{key:"input",get:function(){return this.renderRoot.querySelector(".search-box__input")}},{key:"groupId",get:function(){return this._groupId},set:function(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}},{key:"groupIds",get:function(){return this._groupIds},set:function(e){Gn(this._groupIds,e)||(this._groupIds=e,this.requestStateUpdate(!0))}},{key:"type",get:function(){return this._type},set:function(e){this._type!==e&&(this._type=e,this.requestStateUpdate(!0))}},{key:"groupType",get:function(){return this._groupType},set:function(e){this._groupType!==e&&(this._groupType=e,this.requestStateUpdate(!0))}},{key:"userType",get:function(){return this._userType},set:function(e){this._userType!==e&&(this._userType=e,this.requestStateUpdate(!0))}},{key:"userIds",get:function(){return this._userIds},set:function(e){Gn(this._userIds,e)||(this._userIds=e,this.requestStateUpdate(!0))}},{key:"userFilters",get:function(){return this._userFilters},set:function(e){this._userFilters=e,this.requestStateUpdate(!0)}},{key:"peopleFilters",get:function(){return this._peopleFilters},set:function(e){this._peopleFilters=e,this.requestStateUpdate(!0)}},{key:"groupFilters",get:function(){return this._groupFilters},set:function(e){this._groupFilters=e,this.requestStateUpdate(!0)}},{key:"focus",value:function(e){this.input&&(this.input.focus(e),this.input.select())}},{key:"selectUsersById",value:function(e){return Vu(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i,a,s;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Pn.globalProvider,n=Pn.globalProvider.graph,!r||r.state!==Sn.SignedIn){t.next=19;break}t.t0=Ze().keys(e);case 4:if((t.t1=t.t0()).done){t.next=19;break}return o=t.t1.value,i=e[o],t.prev=7,t.next=10,di(n,i);case 10:a=t.sent,this.addPerson(a),t.next=17;break;case 14:t.prev=14,t.t2=t.catch(7),t.t2.message&&t.t2.message.includes("does not exist")&&this.allowAnyEmail&&Ho(i)&&(s={mail:i,displayName:i},this.addPerson(s));case 17:t.next=4;break;case 19:case"end":return t.stop()}}),t,this,[[7,14]])})))}},{key:"selectGroupsById",value:function(e){return Vu(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Pn.globalProvider,n=Pn.globalProvider.graph,!r||r.state!==Sn.SignedIn){t.next=17;break}t.t0=Ze().keys(e);case 4:if((t.t1=t.t0()).done){t.next=17;break}return o=t.t1.value,t.prev=6,t.next=9,yu(n,e[o]);case 9:i=t.sent,this.addPerson(i),t.next=15;break;case 13:t.prev=13,t.t2=t.catch(6);case 15:t.next=4;break;case 17:case"end":return t.stop()}}),t,this,[[6,13]])})))}},{key:"render",value:function(){var e=this.renderTemplate("default",{people:this._foundPeople});if(e)return e;var t=this.renderSelectedPeople(this.selectedPeople),r=this.renderInput(),n=this.renderFlyout(r),o={focused:this._isFocused,"people-picker":!0,disabled:this.disabled};return en(Iu||(Iu=Bn(["\n       <div dir="," class=",'>\n          <div class="people-picker-inner">'," ","</div>\n       </div>\n     "])),this.direction,Do(o),t,n)}},{key:"clearState",value:function(){this.selectedPeople=[],this.userInput="",this._highlightedUsers=[],this._currentHighlightedUserPos=0}},{key:"requestStateUpdate",value:function(e){return e&&(this._groupPeople=null,this._foundPeople=null,this.selectedPeople=[],this.defaultPeople=null),Ot(y(r.prototype),"requestStateUpdate",this).call(this,e)}},{key:"renderInput",value:function(){var e=!!this.selectedPeople.length,t=this.disabled?this.placeholder||"":this.placeholder?this.placeholder:this.strings.inputPlaceholderText,r={"search-box":!0,"search-box-start":e};return"single"===(this.selectionMode?this.selectionMode:"multiple")&&this.selectedPeople.length>=1?(this.lostFocus(),en(Eu||(Eu=Bn([""])))):en(Au||(Au=Bn(['\n       <div class="','">\n         <input\n           id="people-picker-input"\n           class="search-box__input"\n           type="text"\n           role="combobox"\n           placeholder=','\n           autocomplete="off"\n           aria-label=','\n           aria-controls="suggestions-list"\n           aria-haspopup="listbox"\n           aria-autocomplete="list"\n           aria-expanded="false"\n           @click="','"\n           @focus="','"\n           @keydown="','"\n           @keyup="','"\n           @blur=',"\n           ?disabled=","\n         />\n       </div>\n     "])),Do(r),t,this.ariaLabel||"",this.handleInputClick,this.gainedFocus,this.onUserKeyDown,this.onUserKeyUp,this.lostFocus,this.disabled)}},{key:"renderSelectedPeople",value:function(e){var t=this;return e&&e.length?en(Pu||(Pu=Bn(['\n       <ul\n        id="selected-list"\n        aria-label="','"\n        class="selected-list"\n        >',"</ul>\n     "])),this.strings.selected,e.slice(0,e.length).map((function(e){return en(Ou||(Ou=Bn(['\n             <li\n             class="selected-list__person-wrapper">\n               ','\n\n               <div class="selected-list__person-wrapper__overflow">\n                 <div class="selected-list__person-wrapper__overflow__gradient"></div>\n                 <div\n                   tabindex="0"\n                   role="button"\n                   aria-label="'," ",'"\n                   class="selected-list__person-wrapper__overflow__close-icon"\n                   @click="','"\n                   @keydown="','"\n                 >\n                   \ue711\n                 </div>\n               </div>\n              </li>\n           '],['\n             <li\n             class="selected-list__person-wrapper">\n               ','\n\n               <div class="selected-list__person-wrapper__overflow">\n                 <div class="selected-list__person-wrapper__overflow__gradient"></div>\n                 <div\n                   tabindex="0"\n                   role="button"\n                   aria-label="'," ",'"\n                   class="selected-list__person-wrapper__overflow__close-icon"\n                   @click="','"\n                   @keydown="','"\n                 >\n                   \\uE711\n                 </div>\n               </div>\n              </li>\n           '])),t.renderTemplate("selected-person",{person:e},"selected-".concat(e.id?e.id:e.displayName))||t.renderSelectedPerson(e),t.strings.removeSelectedItem,e.displayName,(function(r){return t.removePerson(e,r)}),(function(r){return t.handleRemovePersonKeyDown(e,r)}))}))):en(Ru||(Ru=Bn([""])))}},{key:"renderFlyout",value:function(e){var t=this;return en(Nu||(Nu=Bn(['\n       <mgt-flyout light-dismiss class="flyout">\n         ','\n         <div slot="flyout" class="flyout-root" @wheel=',">\n           ","\n         </div>\n       </mgt-flyout>\n     "])),e,(function(e){return t.handleSectionScroll(e)}),this.renderFlyoutContent())}},{key:"renderFlyoutContent",value:function(){if(this.isLoadingState||this._showLoading)return this.renderLoading();var e=this._foundPeople;return e&&0!==e.length&&0!==this.showMax?this.renderSearchResults(e):this.renderNoData()}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null)||en(Du||(Du=Bn(['\n         <div class="message-parent">\n           <mgt-spinner></mgt-spinner>\n           <div label="loading-text" aria-label="loading" class="loading-text">\n             ',"\n           </div>\n         </div>\n       "])),this.strings.loadingMessage)}},{key:"renderNoData",value:function(){if(this._isFocused)return this.renderTemplate("error",null)||this.renderTemplate("no-data",null)||en(Lu||(Lu=Bn(['\n         <div class="message-parent">\n           <div label="search-error-text" aria-label=',' class="search-error-text">\n             ',"\n           </div>\n         </div>\n       "])),this.strings.noResultsFound,this.strings.noResultsFound)}},{key:"renderSearchResults",value:function(e){var t=this,r=e.filter((function(e){return e.id}));return en(Mu||(Mu=Bn(['\n      <ul\n        id="suggestions-list"\n        aria-label="','"\n        class="people-list"\n        role="listbox">\n         ',"\n       </ul>\n     "])),this.strings.suggestedContacts,Bs(r,(function(e){return e.id}),(function(e){return en(Uu||(Uu=Bn(['\n               <li\n                id="','"\n                aria-label=" '," ",'"\n                class="list-person"\n                role="option"\n                @click="','">\n                 ',"\n               </li>\n             "])),e.id,t.strings.suggestedContact,e.displayName,(function(r){return t.handleSuggestionClick(e)}),t.renderPersonResult(e))})))}},{key:"renderPersonResult",value:function(e){var t=e,r=t.jobTitle||t.mail,n={"people-person-job-title":!0,uppercase:!!t.jobTitle};return this.renderTemplate("person",{person:e},e.id)||en(Fu||(Fu=Bn(["\n         <mgt-person\n          .personDetails=","\n          .fetchImage=","\n          .personCardInteraction=",'\n         ></mgt-person>\n         <div class="people-person-text-area" id="','">\n           ','\n           <span class="','">',"</span>\n         </div>\n       "])),e,!this.disableImages,xa.none,e.displayName,this.renderHighlightText(e),Do(n),r)}},{key:"renderSelectedPerson",value:function(e){return en(zu||(zu=Bn(['\n       <mgt-person\n         tabindex="-1"\n         class="selected-list__person-wrapper__person"\n         .personDetails=',"\n         .fetchImage=","\n         .view=","\n         .personCardInteraction=","\n       ></mgt-person>\n     "])),e,!this.disableImages,Oi.oneline,xa.click)}},{key:"loadState",value:function(){return Vu(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a,s,c,l,u,p,f,h,g;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.people,r=this.userInput.toLowerCase(),n=Pn.globalProvider,!t){e.next=8;break}r&&(o=t.filter((function(e){return null===e||void 0===e?void 0:e.displayName.toLowerCase().includes(r)})),t=o),this._showLoading=!1,e.next=206;break;case 8:if(t||!n||n.state!==Sn.SignedIn){e.next=206;break}if(i=n.graph.forComponent(this),r.length||!this._isFocused){e.next=101;break}if(!this.defaultPeople){e.next=15;break}t=this.defaultPeople,e.next=101;break;case 15:if(!this.groupId&&!this.groupIds){e.next=61;break}if(null!==this._groupPeople){e.next=58;break}if(!this.groupId){e.next=35;break}if(e.prev=18,this.type!==qo.group){e.next=25;break}return e.next=22,gi(i,null,this.groupId,this.showMax,this.type,this.transitiveSearch);case 22:this._groupPeople=e.sent,e.next=28;break;case 25:return e.next=27,gi(i,null,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters);case 27:this._groupPeople=e.sent;case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(18),this._groupPeople=[];case 33:e.next=58;break;case 35:if(!this.groupIds){e.next=58;break}if(this.type!==qo.group){e.next=48;break}return e.prev=37,e.next=40,ku(i,this.groupIds,this.groupFilters);case 40:this._groupPeople=e.sent,e.next=46;break;case 43:e.prev=43,e.t1=e.catch(37),this._groupPeople=[];case 46:e.next=58;break;case 48:return e.prev=48,e.next=51,vi(i,"",this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters);case 51:a=e.sent,this._groupPeople=a,e.next=58;break;case 55:e.prev=55,e.t2=e.catch(48),this._groupPeople=[];case 58:t=this._groupPeople||[],e.next=100;break;case 61:if(this.type!==qo.person&&this.type!==qo.any){e.next=80;break}if(!this.userIds){e.next=68;break}return e.next=65,pi(i,this.userIds,"",this.userFilters);case 65:t=e.sent,e.next=78;break;case 68:if(s=this.userType===jo.user||this.userType===jo.contact,!this._userFilters||!s){e.next=75;break}return e.next=72,li(i,this._userFilters,this.showMax);case 72:t=e.sent,e.next=78;break;case 75:return e.next=77,ri(i,this.userType,this._peopleFilters);case 77:t=e.sent;case 78:e.next=100;break;case 80:if(this.type!==qo.group){e.next=100;break}if(!this.groupIds){e.next=92;break}return e.prev=82,e.next=85,this.getGroupsForGroupIds(i,t);case 85:t=e.sent,e.next=90;break;case 88:e.prev=88,e.t3=e.catch(82);case 90:e.next=100;break;case 92:return e.next=94,bu(i,"",this.showMax,this.groupType,this._groupFilters);case 94:if(e.t4=e.sent,e.t4){e.next=97;break}e.t4=[];case 97:(c=e.t4).length>0&&c[0].value&&(c=c[0].value),t=c;case 100:this.defaultPeople=t;case 101:if(this._showLoading=!1,!this.defaultSelectedUserIds&&!this.defaultSelectedGroupIds||this.selectedPeople.length||this.defaultSelectedUsers){e.next=114;break}return e.next=105,pi(i,this.defaultSelectedUserIds,"",this.userFilters);case 105:return this.defaultSelectedUsers=e.sent,e.next=108,ku(i,this.defaultSelectedGroupIds,this.peopleFilters);case 108:this.defaultSelectedGroups=e.sent,this.defaultSelectedGroups=this.defaultSelectedGroups.filter((function(e){return null!==e})),this.defaultSelectedUsers=this.defaultSelectedUsers.filter((function(e){return null!==e})),this.selectedPeople=[].concat(d(this.defaultSelectedUsers),d(this.defaultSelectedGroups)),this.requestUpdate(),this.fireCustomEvent("selectionChanged",this.selectedPeople);case 114:if(!r){e.next=206;break}if(t=[],!this.groupId){e.next=125;break}return e.next=119,gi(i,r,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters);case 119:if(e.t5=e.sent,e.t5){e.next=122;break}e.t5=[];case 122:t=e.t5,e.next=206;break;case 125:if(this.type!==qo.person&&this.type!==qo.any){e.next=181;break}if(e.prev=126,this.userType!==jo.contact&&this.userType!==jo.user){e.next=139;break}if(!this.userIds||!this.userIds.length){e.next=134;break}return e.next=131,pi(i,this.userIds,r,this._userFilters);case 131:t=e.sent,e.next=137;break;case 134:return e.next=136,hi(i,r,this.showMax,this._userFilters);case 136:t=e.sent;case 137:e.next=162;break;case 139:if(this.groupIds){e.next=154;break}if(!this.userIds||!this.userIds.length){e.next=146;break}return e.next=143,pi(i,this.userIds,r,this._userFilters);case 143:t=e.sent,e.next=152;break;case 146:return e.next=148,ti(i,r,this.showMax,this.userType,this._peopleFilters);case 148:if(e.t6=e.sent,e.t6){e.next=151;break}e.t6=[];case 151:t=e.t6;case 152:e.next=162;break;case 154:return e.prev=154,e.next=157,vi(i,r,this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters);case 157:t=e.sent,e.next=162;break;case 160:e.prev=160,e.t7=e.catch(154);case 162:e.next=166;break;case 164:e.prev=164,e.t8=e.catch(126);case 166:if(!(t&&t.length<this.showMax&&this.userType!==jo.contact&&this.type!==qo.person)){e.next=181;break}return e.prev=167,e.next=170,hi(i,r,this.showMax,this._userFilters);case 170:if(e.t9=e.sent,e.t9){e.next=173;break}e.t9=[];case 173:l=e.t9,u=new Set(t.map((function(e){return e.id}))),p=S(l);try{for(p.s();!(f=p.n()).done;)h=f.value,u.has(h.id)||t.push(h)}catch(v){p.e(v)}finally{p.f()}e.next=181;break;case 179:e.prev=179,e.t10=e.catch(167);case 181:if(this.type!==qo.group&&this.type!==qo.any||!(t.length<this.showMax)){e.next=206;break}if(!this.groupIds){e.next=193;break}return e.prev=183,e.next=186,wu(i,r,this.groupIds,this.showMax,this.groupType,this.userFilters);case 186:t=e.sent,e.next=191;break;case 189:e.prev=189,e.t11=e.catch(183);case 191:e.next=206;break;case 193:return g=[],e.prev=194,e.next=197,bu(i,r,this.showMax,this.groupType,this._groupFilters);case 197:if(e.t12=e.sent,e.t12){e.next=200;break}e.t12=[];case 200:g=e.t12,t=t.concat(g),e.next=206;break;case 204:e.prev=204,e.t13=e.catch(194);case 206:this._foundPeople=this.filterPeople(t);case 207:case"end":return e.stop()}}),e,this,[[18,30],[37,43],[48,55],[82,88],[126,164],[154,160],[167,179],[183,189],[194,204]])})))}},{key:"getGroupsForGroupIds",value:function(e,t){return Vu(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,ku(e,this.groupIds,this.groupFilters);case 2:n=r.sent,o=S(n);try{for(o.s();!(i=o.n()).done;)a=i.value,t=t.concat(a)}catch(s){o.e(s)}finally{o.f()}return t=t.filter((function(e){return e})),r.abrupt("return",t);case 7:case"end":return r.stop()}}),r,this)})))}},{key:"hideFlyout",value:function(){var e=this.flyout;e&&e.close(),this.input&&(this.input.setAttribute("aria-expanded","false"),this.input.setAttribute("aria-activedescendant","")),this._arrowSelectionCount=-1}},{key:"showFlyout",value:function(){var e=this.flyout;e&&e.open(),this.input&&this.input.setAttribute("aria-expanded","true")}},{key:"removePerson",value:function(e,t){t.stopPropagation();var r=this.selectedPeople.filter((function(t){return!e.id&&t.displayName?t.displayName!==e.displayName:t.id!==e.id}));this.selectedPeople=r,this.loadState(),this.fireCustomEvent("selectionChanged",this.selectedPeople),this.input.focus()}},{key:"handleRemovePersonKeyDown",value:function(e,t){"Enter"===t.key&&this.removePerson(e,t)}},{key:"addPerson",value:function(e){var t=this;e&&(setTimeout((function(){t.clearInput()}),50),0===this.selectedPeople.filter((function(t){return!e.id&&t.displayName?t.displayName===e.displayName:t.id===e.id})).length&&(this.selectedPeople=[].concat(d(this.selectedPeople),[e]),this.fireCustomEvent("selectionChanged",this.selectedPeople),this.loadState(),this._foundPeople=[],this._arrowSelectionCount=-1))}},{key:"clearInput",value:function(){this.clearHighlighted(),"single"!==this.selectionMode&&(this.input.value=""),this.userInput=""}},{key:"handleInputClick",value:function(){this.flyout.isOpen||this.handleUserSearch()}},{key:"gainedFocus",value:function(){this.clearHighlighted(),this._isFocused=!0,this.loadState()}},{key:"lostFocus",value:function(){this._isFocused=!1,this._arrowSelectionCount=-1,this.input&&(this.input.setAttribute("aria-expanded","false"),this.input.setAttribute("aria-activedescendant",""));var e=this.renderRoot.querySelector(".people-list");if(e)for(var t=0;t<e.children.length;t++)e.children[t].classList.remove("focused"),e.children[t].setAttribute("aria-selected","false");this.requestUpdate()}},{key:"renderHighlightText",value:function(e){var t="",r="",n="",o=e.displayName,i=o.toLowerCase().indexOf(this.userInput.toLowerCase());if(-1!==i){var a=this.userInput.length;0===i?(t="",n=o.slice(0,a),r=o.slice(a,o.length)):i===o.length?(t=o.slice(0,i),n=o.slice(i,o.length),r=""):(t=o.slice(0,i),n=o.slice(i,i+a),r=o.slice(i+a,o.length))}else t=e.displayName;return en(Hu||(Hu=Bn(['\n       <div>\n         <span class="people-person-text">','</span\n         ><span class="people-person-text highlight-search-text">','</span\n         ><span class="people-person-text">',"</span>\n       </div>\n     "])),t,n,r)}},{key:"onUserKeyUp",value:function(e){var t=(e.ctrlKey||e.metaKey)&&"v"===e.key,r=["ControlLeft","ControlRight"].includes(e.code)||e.ctrlKey||e.metaKey,n=["ArrowDown","ArrowRight","ArrowUp","ArrowLeft"].includes(e.code),o=e.target;if(!t&&r||n)return(r||["ArrowLeft","ArrowRight"].includes(e.code))&&this.hideFlyout(),void(["ArrowDown"].includes(e.code)&&!this.flyout.isOpen&&this._isFocused&&this.handleUserSearch());if(!e.shiftKey&&"ShiftLeft"!==e.code&&"Tab"!==e.code&&"Enter"!==e.code){if("Escape"===e.code)return this.clearInput(),this._foundPeople=[],void(this._arrowSelectionCount=-1);if("Backspace"===e.code&&0===this.userInput.length&&this.selectedPeople.length>0)return this.clearHighlighted(),this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-1),this.loadState(),this.hideFlyout(),void this.fireCustomEvent("selectionChanged",this.selectedPeople);if("Comma"!==e.code&&"Semicolon"!==e.code)this.userInput=o.value,Ho(this.userInput)&&this.allowAnyEmail?this._setAnyEmail&&this.handleAnyEmail():this.handleUserSearch(),this._setAnyEmail=!1;else this.allowAnyEmail&&(this._setAnyEmail=!0,e.preventDefault(),e.stopPropagation())}}},{key:"handleAnyEmail",value:function(){if(this._showLoading=!1,this._arrowSelectionCount=-1,Ho(this.userInput)){var e={mail:this.userInput,displayName:this.userInput};this.addPerson(e)}this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0)}},{key:"handleSuggestionClick",value:function(e){this.addPerson(e),this.hideFlyout(),this.input.focus()}},{key:"handleUserSearch",value:function(){var e=this;this._debouncedSearch||(this._debouncedSearch=Uo((function(){return Vu(e,void 0,void 0,Ze().mark((function e(){var t,r=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=setTimeout((function(){r._showLoading=!0}),50),e.next=3,this.loadState();case 3:clearTimeout(t),this._showLoading=!1,this._arrowSelectionCount=-1,this.showFlyout();case 7:case"end":return e.stop()}}),e,this)})))}),400)),this._debouncedSearch()}},{key:"onUserKeyDown",value:function(e){var t=this,r=this.renderRoot.querySelector(".selected-list"),n=e.ctrlKey||e.metaKey;if(n&&r){var o=r.querySelectorAll("mgt-person.selected-list__person-wrapper__person");if(this.hideFlyout(),n&&"ArrowLeft"===e.code)this._currentHighlightedUserPos=(this._currentHighlightedUserPos-1+o.length)%o.length,this._currentHighlightedUserPos>=0&&!Number.isNaN(this._currentHighlightedUserPos)?this._highlightedUsers.push(o[this._currentHighlightedUserPos]):this._currentHighlightedUserPos=0;else if(n&&"ArrowRight"===e.code){var i=this._highlightedUsers.pop();if(i){var a=i.parentElement;a&&(this.clearHighlighted(a),this._currentHighlightedUserPos++)}}else n&&"KeyA"===e.code&&(this._highlightedUsers=[],o.forEach((function(e){return t._highlightedUsers.push(e)})));this._highlightedUsers&&this.highlightSelectedPeople(this._highlightedUsers)}else if(this.clearHighlighted(),this.flyout.isOpen){var s=e.target;if("ArrowUp"!==e.key&&"ArrowDown"!==e.key||(this.handleArrowSelection(e),s.value.length>0&&e.preventDefault()),"Enter"===e.code)if(!e.shiftKey&&this._foundPeople){e.preventDefault(),e.stopPropagation();var c=this._foundPeople[this._arrowSelectionCount];c&&(this.addPerson(c),this.hideFlyout(),this.input.value="")}else this.allowAnyEmail&&this.handleAnyEmail();"Escape"==e.code&&e.stopPropagation(),"Tab"===e.code&&this.hideFlyout(),"Comma"!==e.code&&"Semicolon"!==e.code||this.allowAnyEmail&&(e.preventDefault(),e.stopPropagation(),this.userInput=s.value,this.handleAnyEmail())}}},{key:"writeHighlightedText",value:function(){return Vu(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a,s,c,l,u,d;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],r=0;r<this._highlightedUsers.length;r++)n=this._highlightedUsers[r],o=n._personDetails,i=o.id,a=o.displayName,s=o.email,c=o.userPrincipalName,l=o.scoredEmailAddresses,u=void 0,u=l&&l.length>0?l.pop().address:c||s,t.push({id:i,displayName:a,email:u});return d="",t.length>0&&(d=JSON.stringify(t)),e.next=6,navigator.clipboard.writeText(d);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"handleCut",value:function(){return Vu(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.writeHighlightedText();case 2:this.removeHighlightedOnCut();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"handleCopy",value:function(){return Vu(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.writeHighlightedText();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"handlePaste",value:function(){return Vu(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a,s,c;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.readText();case 3:if(!(t=e.sent)){e.next=29;break}if(e.prev=5,(r=JSON.parse(t))&&r.length>0){n=S(r);try{for(n.s();!(o=n.n()).done;)i=o.value,this.addPerson(i)}catch(l){n.e(l)}finally{n.f()}}e.next=29;break;case 10:if(e.prev=10,e.t0=e.catch(5),!(e.t0 instanceof SyntaxError)){e.next=29;break}a=[",",";"],e.prev=14,c=0;case 16:if(!(c<a.length)){e.next=25;break}if(!((s=t.split(a[c])).length>1)){e.next=22;break}return this.hideFlyout(),this.selectUsersById(s),e.abrupt("break",25);case 22:c++,e.next=16;break;case 25:e.next=29;break;case 27:e.prev=27,e.t1=e.catch(14);case 29:e.next=33;break;case 31:e.prev=31,e.t2=e.catch(0);case 33:case"end":return e.stop()}}),e,this,[[0,31],[5,10],[14,27]])})))}},{key:"removeHighlightedOnCut",value:function(){this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-this._highlightedUsers.length),this._highlightedUsers=[],this._currentHighlightedUserPos=0,this.loadState(),this.hideFlyout(),this.fireCustomEvent("selectionChanged",this.selectedPeople)}},{key:"highlightSelectedPeople",value:function(e){for(var t=0;t<e.length;t++){var r=e[t].parentElement;r.setAttribute("class","selected-list__person-wrapper-highlighted");var n=Array.from(r.getElementsByClassName("selected-list__person-wrapper__person"));if(n&&n.length>0)n.pop().setAttribute("class","selected-list__person-wrapper-highlighted__person");var o=Array.from(r.getElementsByClassName("selected-list__person-wrapper__overflow__gradient"));if(o&&o.length>0)o.pop().setAttribute("class","selected-list__person-wrapper-highlighted__overflow__gradient");var i=Array.from(r.getElementsByClassName("selected-list__person-wrapper__overflow__close-icon"));if(i&&i.length>0)i.pop().setAttribute("class","selected-list__person-wrapper-highlighted__overflow__close-icon")}}},{key:"clearHighlighted",value:function(e){if(e)this.clearNodeHighlights(e);else{for(var t=0;t<this._highlightedUsers.length;t++){var r=this._highlightedUsers[t].parentElement;r&&this.clearNodeHighlights(r)}this._highlightedUsers=[],this._currentHighlightedUserPos=0}}},{key:"clearNodeHighlights",value:function(e){e.setAttribute("class","selected-list__person-wrapper");var t=Array.from(e.getElementsByClassName("selected-list__person-wrapper-highlighted__person"));t&&t.length>0&&t.pop().setAttribute("class","selected-list__person-wrapper__person");var r=Array.from(e.getElementsByClassName("selected-list__person-wrapper-highlighted__overflow__gradient"));r&&r.length>0&&r.pop().setAttribute("class","selected-list__person-wrapper__overflow__gradient");var n=Array.from(e.getElementsByClassName("selected-list__person-wrapper-highlighted__overflow__close-icon"));n&&n.length>0&&n.pop().setAttribute("class","selected-list__person-wrapper__overflow__close-icon")}},{key:"handleArrowSelection",value:function(e){var t=this.renderRoot.querySelector(".people-list");if(t&&t.children.length){e&&("ArrowUp"===e.key&&(-1===this._arrowSelectionCount?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount-1+t.children.length)%t.children.length),"ArrowDown"===e.key&&(-1===this._arrowSelectionCount?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount+1)%t.children.length));for(var r=0;r<t.children.length;r++)t.children[r].classList.remove("focused"),t.children[r].setAttribute("aria-selected","false");var n=t.children[this._arrowSelectionCount];n&&(n.classList.add("focused"),n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}),n.setAttribute("aria-selected","true"),this.input.setAttribute("aria-activedescendant",t.children[this._arrowSelectionCount].id))}}},{key:"filterPeople",value:function(e){if(e&&e.length>0){e=e.filter((function(e){return e}));for(var t=this.selectedPeople.map((function(e){return e.id?e.id:e.displayName})),r=e.filter((function(e){return(null===e||void 0===e?void 0:e.id)?-1===t.indexOf(e.id):-1===t.indexOf(null===e||void 0===e?void 0:e.displayName)})),n=new Set,o=0;o<r.length;o++){var i=JSON.stringify(r[o]);n.add(i)}var a=[];return n.forEach((function(e){var t=JSON.parse(e);a.push(t)})),a}}},{key:"handleSectionScroll",value:function(e){var t=this.renderRoot.querySelector(".flyout-root");t&&(e.deltaY<0&&0===t.scrollTop||e.deltaY>0&&t.clientHeight+t.scrollTop>=t.scrollHeight-1||e.stopPropagation())}}],[{key:"styles",get:function(){return Bu}},{key:"requiredScopes",get:function(){return d(new Set(["user.read.all","people.read","group.read.all","user.readbasic.all"].concat(d(ls.requiredScopes))))}}]),r}(Jn);ju([hn({attribute:"group-id",converter:function(e){return e.trim()}}),Gu("design:type",String),Gu("design:paramtypes",[Object])],Ku.prototype,"groupId",null),ju([hn({attribute:"group-ids",converter:function(e){return e.split(",").map((function(e){return e.trim()}))}}),Gu("design:type",Array),Gu("design:paramtypes",[Object])],Ku.prototype,"groupIds",null),ju([hn({attribute:"type",converter:function(e,t){return(e=e.toLowerCase())&&0!==e.length?"undefined"===typeof qo[e]?qo.any:qo[e]:qo.any}}),Gu("design:type",Object),Gu("design:paramtypes",[Object])],Ku.prototype,"type",null),ju([hn({attribute:"group-type",converter:function(e,t){if(!e||0===e.length)return fu.any;var r,n=[],o=S(e.split(","));try{for(o.s();!(r=o.n()).done;){var i=r.value;i=i.trim(),"undefined"!==typeof fu[i]&&n.push(fu[i])}}catch(a){o.e(a)}finally{o.f()}return 0===n.length?fu.any:n.reduce((function(e,t){return e|t}))}}),Gu("design:type",Number),Gu("design:paramtypes",[Object])],Ku.prototype,"groupType",null),ju([hn({attribute:"user-type",converter:function(e,t){return(e=e.toLowerCase())&&0!==e.length?"undefined"===typeof jo[e]?jo.any:jo[e]:jo.any}}),Gu("design:type",String),Gu("design:paramtypes",[Object])],Ku.prototype,"userType",null),ju([hn({attribute:"transitive-search",type:Boolean}),Gu("design:type",Boolean)],Ku.prototype,"transitiveSearch",void 0),ju([hn({attribute:"people",type:Object}),Gu("design:type",Array)],Ku.prototype,"people",void 0),ju([hn({attribute:"show-max",type:Number}),Gu("design:type",Number)],Ku.prototype,"showMax",void 0),ju([hn({attribute:"disable-images",type:Boolean}),Gu("design:type",Boolean)],Ku.prototype,"disableImages",void 0),ju([hn({attribute:"selected-people",type:Array}),Gu("design:type",Array)],Ku.prototype,"selectedPeople",void 0),ju([hn({attribute:"default-selected-user-ids",converter:function(e){return e.split(",").map((function(e){return e.trim()}))},type:String}),Gu("design:type",Array)],Ku.prototype,"defaultSelectedUserIds",void 0),ju([hn({attribute:"default-selected-group-ids",converter:function(e){return e.split(",").map((function(e){return e.trim()}))},type:String}),Gu("design:type",Array)],Ku.prototype,"defaultSelectedGroupIds",void 0),ju([hn({attribute:"placeholder",type:String}),Gu("design:type",String)],Ku.prototype,"placeholder",void 0),ju([hn({attribute:"disabled",type:Boolean}),Gu("design:type",Boolean)],Ku.prototype,"disabled",void 0),ju([hn({attribute:"allow-any-email",type:Boolean}),Gu("design:type",Boolean)],Ku.prototype,"allowAnyEmail",void 0),ju([hn({attribute:"selection-mode",type:String}),Gu("design:type",String)],Ku.prototype,"selectionMode",void 0),ju([hn({attribute:"user-ids",converter:function(e){return e.split(",").map((function(e){return e.trim()}))},type:String}),Gu("design:type",Array),Gu("design:paramtypes",[Array])],Ku.prototype,"userIds",null),ju([hn({attribute:"user-filters"}),Gu("design:type",String),Gu("design:paramtypes",[String])],Ku.prototype,"userFilters",null),ju([hn({attribute:"people-filters"}),Gu("design:type",String),Gu("design:paramtypes",[String])],Ku.prototype,"peopleFilters",null),ju([hn({attribute:"group-filters"}),Gu("design:type",String),Gu("design:paramtypes",[String])],Ku.prototype,"groupFilters",null),ju([hn({attribute:"aria-label",type:String}),Gu("design:type",String)],Ku.prototype,"ariaLabel",void 0),ju([hn({attribute:!1}),Gu("design:type",Boolean)],Ku.prototype,"_showLoading",void 0),ju([vn(),Gu("design:type",Object)],Ku.prototype,"_isFocused",void 0),ju([vn(),Gu("design:type",Boolean)],Ku.prototype,"_setAnyEmail",void 0),ju([vn(),Gu("design:type",Array)],Ku.prototype,"_foundPeople",void 0),Ku=ju([fn("mgt-people-picker"),Gu("design:paramtypes",[])],Ku);var Qu,Wu=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Ju="businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id,accountEnabled",Yu="directReports",Xu="files",Zu="messages",$u="people",ed="person";function td(e,t,r,n){return Wu(this,void 0,void 0,Ze().mark((function o(){var i,a,s,c,u,d,p,f,h,g,v,m;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i=t.id,a=ni(t),s="classification"in t||"personType"in t&&("PersonalContact"===t.personType.subclass||"Group"===t.personType.class),c=e.createBatch(),s||n.sections.organization&&(rd(c,i),"boolean"!==typeof n.sections.organization&&n.sections.organization.showWorksWith&&nd(c,i)),n.sections.mailMessages&&a&&od(c,a),n.sections.files&&id(c,r?null:a),d={},o.prev=8,o.next=11,c.executeAll();case 11:u=o.sent,o.next=16;break;case 14:o.prev=14,o.t0=o.catch(8);case 16:if(u){p=S(u);try{for(p.s();!(f=p.n()).done;)h=l(f.value,2),g=h[0],v=h[1],d[g]=v.content.value||v.content}catch(b){p.e(b)}finally{p.f()}}if(s||!n.sections.profile){o.next=27;break}return o.prev=18,o.next=21,ad(e,i);case 21:(m=o.sent)&&(d.profile=m),o.next=27;break;case 25:o.prev=25,o.t1=o.catch(18);case 27:return d.directReports&&d.directReports.length>0&&(d.directReports=d.directReports.filter((function(e){return e.accountEnabled}))),o.abrupt("return",d);case 29:case"end":return o.stop()}}),o,null,[[8,14],[18,25]])})))}function rd(e,t){var r="manager($levels=max;$select=".concat(Ju,")");e.get(ed,"users/".concat(t,"?$expand=").concat(r,"&$select=").concat(Ju,"&$count=true"),["user.read.all"],{ConsistencyLevel:"eventual"}),e.get(Yu,"users/".concat(t,"/directReports?$select=").concat(Ju))}function nd(e,t){e.get($u,"users/".concat(t,"/people?$filter=personType/class eq 'Person'"),["People.Read.All"])}function od(e,t){e.get(Zu,'me/messages?$search="from:'.concat(t,'"'),["Mail.ReadBasic"])}function id(e,t){var r;r=t?"me/insights/shared?$filter=lastshared/sharedby/address eq '".concat(t,"'"):"me/insights/used",e.get(Xu,r,["Sites.Read.All"])}function ad(e,t){return Wu(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api("/users/".concat(t,"/profile")).version("beta").get();case 2:return n=r.sent,r.abrupt("return",n);case 4:case"end":return r.stop()}}),r)})))}var sd,cd,ld,ud=[xn(Qu||(Qu=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}:host{background:var(--person-card-background-color,var(--background-color,#fff));width:var(--mgt-flyout-set-width,340px);font-family:var(--default-font-family);overflow:hidden;user-select:none;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));border-radius:8px}:host .small{max-height:100vh;overflow-y:auto;overflow-x:hidden}:host .nav{height:0;position:relative;z-index:100}:host .nav__back{padding:8px;height:32px;width:32px;align-items:center;justify-content:center}:host .nav__back svg{fill:var(--person-card-nav-back-arrow-color,#0078d4)}:host .nav__back:hover{cursor:pointer}:host .nav__back:hover svg{fill:var(--person-card-nav-back-arrow-hover-color,#000)}:host .person-details-container{display:flex;flex-direction:column;width:calc(var(--mgt-flyout-set-width,340px) - 40px);padding:20px}:host .person-details-container .person-image{--presence-background-color:var(--person-card-background-color, var(--background-color, #ffffff));--presence-icon-color:var(--person-card-background-color, var(--background-color, #ffffff));--avatar-size:75px;--font-size:var(--person-card-display-name-font-size, 20px);--color:var(--person-card-display-name-color, var(--color-sub1, #323130));--line2-font-size:var(--person-card-title-font-size, 14px);--line2-color:var(--person-card-title-color);--line3-font-size:var(--person-card-subtitle-font-size, 12px);--line3-color:var(--person-card-subtitle-color)}:host .person-details-container .base-icons{display:flex;-webkit-align-items:center;align-items:center;max-width:120px;margin-top:16px}:host .person-details-container .base-icons .icon{display:flex;align-items:center;cursor:pointer;font-size:12px;white-space:nowrap;margin:-11px -13px;padding:11px 13px}:host .person-details-container .base-icons .icon:not(:last-child){margin-right:20px}:host .person-details-container .base-icons .icon svg{fill:var(--icon-color,#605e5c)}:host .person-details-container .base-icons .icon span{margin-left:8px;color:var(--person-card-base-links-color,#023b8f)}:host .person-details-container .base-icons .icon:hover{color:var(--person-card-base-links-hover-color,#012e7f)}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;align-items:center;height:28px;background:var(--person-card-background-color,var(--background-color,#fff));border-top:1px solid var(--line-seperator-color,#edebe9)}:host .expanded-details-container .expanded-details-button svg path{stroke:#1a1a1a}:host .expanded-details-container .expanded-details-button:hover{background-color:var(--background-color--hover,#edebe9)}:host .section-nav{display:flex;padding:0 14px;border-bottom:1px solid var(--tab-line-color,#edebe9)}:host .section-nav__icon{all:initial;box-sizing:border-box;width:48px;padding:12px;display:flex;align-items:center;justify-content:center;border:2px solid transparent;margin-bottom:-1px;cursor:pointer}:host .section-nav__icon svg{width:20px;height:20px;fill:var(--icon-color,#605e5c)}:host .section-nav__icon:hover{background:var(--tab-background-color--hover,#edebe9)}:host .section-nav__icon:focus{border-color:#000}:host .section-nav__icon.active{border-bottom-color:var(--person-card-tab-nav-color,#0078d4);border-bottom-style:solid;border-left-color:none;border-right-color:none;border-top-color:none;border-top-style:none;border-left-style:none;border-right-style:none}:host .section-nav__icon.active svg{fill:var(--person-card-tab-nav-color,#0078d4)}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .section-host{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden}:host .section-host.small{overflow-y:hidden}:host .quick-message{display:flex;flex-direction:row;border-bottom:1px solid var(--tab-line-color,#edebe9);padding:12px 10px 8px 10px}:host .quick-message__input{flex-grow:1;padding-left:8px;border:none;border-radius:2px;color:var(--color-sub1,#323130);background-color:var(--background-color-sub2,#f3f2f1)}:host .quick-message__send{all:initial;height:32px;width:32px;display:flex;align-items:center;justify-content:center}:host .quick-message__send svg{fill:var(--color-sub2,#717171);height:18px;width:18px}:host .quick-message__send:hover svg{fill:var(--color-sub1,#323130)}:host .sections .section{padding:14px 0;display:flex;flex-direction:column;position:relative}:host .sections .section:not(:last-child):after{position:absolute;content:'';width:90%;transform:translateX(-50%);border-bottom:1px solid var(--tab-line-color,#edebe9);left:50%;bottom:0}:host .sections .section__header{display:flex;flex-direction:row;padding:0 20px}:host .sections .section__title{flex-grow:1;color:var(--title-color-subtitle,#323130);font-size:14px;font-weight:600}:host .sections .section__show-more{color:var(--person-card-show-more-color,#0078d4);font-size:12px;font-weight:600;align-self:center}:host .sections .section__show-more:hover{cursor:pointer;color:var(--person-card-show-more-hover-color,#005a9e)}:host .sections .section__content{margin-top:14px}:host .sections .section .additional-details{padding:0 20px}[dir=rtl] .base-icons span{margin-right:8px}[dir=rtl] .nav__back{width:20px!important;-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){.root{border:1px solid #fff;border-radius:inherit}.root svg,.root svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root{border:1px solid #000;border-radius:inherit}.root svg,.root svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}:host{background:var(--person-card-background-color,var(--background-color,#fff));width:var(--mgt-flyout-set-width,340px);font-family:var(--default-font-family);overflow:hidden;user-select:none;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));border-radius:8px}:host .small{max-height:100vh;overflow-y:auto;overflow-x:hidden}:host .nav{height:0;position:relative;z-index:100}:host .nav__back{padding:8px;height:32px;width:32px;align-items:center;justify-content:center}:host .nav__back svg{fill:var(--person-card-nav-back-arrow-color,#0078d4)}:host .nav__back:hover{cursor:pointer}:host .nav__back:hover svg{fill:var(--person-card-nav-back-arrow-hover-color,#000)}:host .person-details-container{display:flex;flex-direction:column;width:calc(var(--mgt-flyout-set-width,340px) - 40px);padding:20px}:host .person-details-container .person-image{--presence-background-color:var(--person-card-background-color, var(--background-color, #ffffff));--presence-icon-color:var(--person-card-background-color, var(--background-color, #ffffff));--avatar-size:75px;--font-size:var(--person-card-display-name-font-size, 20px);--color:var(--person-card-display-name-color, var(--color-sub1, #323130));--line2-font-size:var(--person-card-title-font-size, 14px);--line2-color:var(--person-card-title-color);--line3-font-size:var(--person-card-subtitle-font-size, 12px);--line3-color:var(--person-card-subtitle-color)}:host .person-details-container .base-icons{display:flex;-webkit-align-items:center;align-items:center;max-width:120px;margin-top:16px}:host .person-details-container .base-icons .icon{display:flex;align-items:center;cursor:pointer;font-size:12px;white-space:nowrap;margin:-11px -13px;padding:11px 13px}:host .person-details-container .base-icons .icon:not(:last-child){margin-right:20px}:host .person-details-container .base-icons .icon svg{fill:var(--icon-color,#605e5c)}:host .person-details-container .base-icons .icon span{margin-left:8px;color:var(--person-card-base-links-color,#023b8f)}:host .person-details-container .base-icons .icon:hover{color:var(--person-card-base-links-hover-color,#012e7f)}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;align-items:center;height:28px;background:var(--person-card-background-color,var(--background-color,#fff));border-top:1px solid var(--line-seperator-color,#edebe9)}:host .expanded-details-container .expanded-details-button svg path{stroke:#1a1a1a}:host .expanded-details-container .expanded-details-button:hover{background-color:var(--background-color--hover,#edebe9)}:host .section-nav{display:flex;padding:0 14px;border-bottom:1px solid var(--tab-line-color,#edebe9)}:host .section-nav__icon{all:initial;box-sizing:border-box;width:48px;padding:12px;display:flex;align-items:center;justify-content:center;border:2px solid transparent;margin-bottom:-1px;cursor:pointer}:host .section-nav__icon svg{width:20px;height:20px;fill:var(--icon-color,#605e5c)}:host .section-nav__icon:hover{background:var(--tab-background-color--hover,#edebe9)}:host .section-nav__icon:focus{border-color:#000}:host .section-nav__icon.active{border-bottom-color:var(--person-card-tab-nav-color,#0078d4);border-bottom-style:solid;border-left-color:none;border-right-color:none;border-top-color:none;border-top-style:none;border-left-style:none;border-right-style:none}:host .section-nav__icon.active svg{fill:var(--person-card-tab-nav-color,#0078d4)}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .section-host{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden}:host .section-host.small{overflow-y:hidden}:host .quick-message{display:flex;flex-direction:row;border-bottom:1px solid var(--tab-line-color,#edebe9);padding:12px 10px 8px 10px}:host .quick-message__input{flex-grow:1;padding-left:8px;border:none;border-radius:2px;color:var(--color-sub1,#323130);background-color:var(--background-color-sub2,#f3f2f1)}:host .quick-message__send{all:initial;height:32px;width:32px;display:flex;align-items:center;justify-content:center}:host .quick-message__send svg{fill:var(--color-sub2,#717171);height:18px;width:18px}:host .quick-message__send:hover svg{fill:var(--color-sub1,#323130)}:host .sections .section{padding:14px 0;display:flex;flex-direction:column;position:relative}:host .sections .section:not(:last-child):after{position:absolute;content:'';width:90%;transform:translateX(-50%);border-bottom:1px solid var(--tab-line-color,#edebe9);left:50%;bottom:0}:host .sections .section__header{display:flex;flex-direction:row;padding:0 20px}:host .sections .section__title{flex-grow:1;color:var(--title-color-subtitle,#323130);font-size:14px;font-weight:600}:host .sections .section__show-more{color:var(--person-card-show-more-color,#0078d4);font-size:12px;font-weight:600;align-self:center}:host .sections .section__show-more:hover{cursor:pointer;color:var(--person-card-show-more-hover-color,#005a9e)}:host .sections .section__content{margin-top:14px}:host .sections .section .additional-details{padding:0 20px}[dir=rtl] .base-icons span{margin-right:8px}[dir=rtl] .nav__back{width:20px!important;-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){.root{border:1px solid #fff;border-radius:inherit}.root svg,.root svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root{border:1px solid #000;border-radius:inherit}.root svg,.root svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"])))],dd=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},pd=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},fd=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this))._isCompact=!1,e._personDetails=null,e}return v(r,[{key:"personDetails",get:function(){return this._personDetails},set:function(e){this._personDetails!==e&&(this._personDetails=e,this.requestStateUpdate())}},{key:"isCompact",get:function(){return this._isCompact}},{key:"asCompactView",value:function(){return this._isCompact=!0,this.requestUpdate(),this}},{key:"asFullView",value:function(){return this._isCompact=!1,this.requestUpdate(),this}},{key:"clearState",value:function(){this._isCompact=!1,this._personDetails=null}},{key:"render",value:function(){return this.isCompact?this.renderCompactView():this.renderFullView()}},{key:"renderLoading",value:function(){return en(sd||(sd=Bn(['\n      <div class="loading">\n        <mgt-spinner></mgt-spinner>\n      </div>\n    '])))}},{key:"renderNoData",value:function(){return en(cd||(cd=Bn(['\n      <div class="no-data">No data</div>\n    '])))}},{key:"navigateCard",value:function(e){for(var t=this.parentNode;t;)if((t=t.parentNode)&&t.host&&"MGT-PERSON-CARD"===t.host.tagName){t=t.host;break}t.navigate(e)}}]),r}(Jn);dd([hn({attribute:"person-details",type:Object}),pd("design:type",Object),pd("design:paramtypes",[Object])],fd.prototype,"personDetails",null);var hd,gd,vd,md,bd,yd,kd,wd,xd=[xn(ld||(ld=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, \"Segoe UI\");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--title-color-sub2,#717171);line-height:20px}:host .root .part .part__details .part__value{grid-column:2;color:var(--color-sub1,#323130);font-size:14px;font-weight:400}:host .root .part .part__details .part__value .part__link{color:var(--person-card-contact-link-color,#0078d4);font-family:var(--default-font-family);font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:var(--person-card-contact-link-hover-color,#004578)}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--background-color-sub2,#f3f2f1);visibility:hidden;display:flex;align-items:center;justify-content:center}:host .root .part .part__copy svg{fill:var(--color-sub1,#323130);cursor:pointer}:host .root .part:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, \"Segoe UI\");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--title-color-sub2,#717171);line-height:20px}:host .root .part .part__details .part__value{grid-column:2;color:var(--color-sub1,#323130);font-size:14px;font-weight:400}:host .root .part .part__details .part__value .part__link{color:var(--person-card-contact-link-color,#0078d4);font-family:var(--default-font-family);font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:var(--person-card-contact-link-hover-color,#004578)}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--background-color-sub2,#f3f2f1);visibility:hidden;display:flex;align-items:center;justify-content:center}:host .root .part .part__copy svg{fill:var(--color-sub1,#323130);cursor:pointer}:host .root .part:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"])))],Cd={contactSectionTitle:"Contact",emailTitle:"Email",chatTitle:"Teams",businessPhoneTitle:"Business Phone",cellPhoneTitle:"Mobile Phone",departmentTitle:"Department",titleTitle:"Title",officeLocationTitle:"Office Location",copyToClipboardButton:"Copy to clipboard"},Td=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},_d=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Sd=function(e){b(r,e);var t=C(r);function r(e){var n;return p(this,r),(n=t.call(this))._contactParts={email:{icon:va(pa.Email,"#929292"),onClick:function(){return n.sendEmail(ni(n._person))},showCompact:!0,title:n.strings.emailTitle},chat:{icon:va(pa.Chat,"#929292"),onClick:function(){var e;return n.sendChat(null===(e=n._person)||void 0===e?void 0:e.userPrincipalName)},showCompact:!1,title:n.strings.chatTitle},businessPhone:{icon:va(pa.Phone,"#929292"),onClick:function(){var e,t;return n.sendCall((null===(t=null===(e=n._person)||void 0===e?void 0:e.businessPhones)||void 0===t?void 0:t.length)>0?n._person.businessPhones[0]:null)},showCompact:!0,title:n.strings.businessPhoneTitle},cellPhone:{icon:va(pa.CellPhone,"#929292"),onClick:function(){var e;return n.sendCall(null===(e=n._person)||void 0===e?void 0:e.mobilePhone)},showCompact:!0,title:n.strings.cellPhoneTitle},department:{icon:va(pa.Department,"#929292"),showCompact:!1,title:n.strings.departmentTitle},title:{icon:va(pa.Person,"#929292"),showCompact:!1,title:n.strings.titleTitle},officeLocation:{icon:va(pa.OfficeLocation,"#929292"),showCompact:!0,title:n.strings.officeLocationTitle}},n.sendCall=function(e){n.sendLink("tel:",e)},n._person=e,n._contactParts.email.value=ni(n._person),n._contactParts.chat.value=n._person.userPrincipalName,n._contactParts.cellPhone.value=n._person.mobilePhone,n._contactParts.department.value=n._person.department,n._contactParts.title.value=n._person.jobTitle,n._contactParts.officeLocation.value=n._person.officeLocation,n._person.businessPhones&&n._person.businessPhones.length&&(n._contactParts.businessPhone.value=n._person.businessPhones[0]),n}return v(r,[{key:"strings",get:function(){return Cd}},{key:"hasData",get:function(){return!!this._contactParts&&!!Object.values(this._contactParts).filter((function(e){return!!e.value})).length}},{key:"displayName",get:function(){return this.strings.contactSectionTitle}},{key:"renderIcon",value:function(){return va(pa.Contact)}},{key:"clearState",value:function(){Ot(y(r.prototype),"clearState",this).call(this);for(var e=0,t=Object.keys(this._contactParts);e<t.length;e++){var n=t[e];this._contactParts[n].value=null}}},{key:"renderCompactView",value:function(){var e,t=this;if(!this.hasData)return null;var r=Object.values(this._contactParts).filter((function(e){return!!e.value})),n=Object.values(r).filter((function(e){return!!e.value&&e.showCompact}));return n&&n.length||(n=Object.values(r).slice(0,2)),e=en(hd||(hd=Bn(["\n      ","\n    "])),n.map((function(e){return t.renderContactPart(e)}))),en(gd||(gd=Bn(['\n      <div class="root compact" dir=',">\n        ","\n      </div>\n    "])),this.direction,e)}},{key:"renderFullView",value:function(){var e,t=this;if(this.hasData){var r=Object.values(this._contactParts).filter((function(e){return!!e.value}));e=en(vd||(vd=Bn(["\n        ","\n      "])),r.map((function(e){return t.renderContactPart(e)})))}return en(md||(md=Bn(['\n      <div class="root" dir=','>\n        <div class="title" tabindex="0">',"</div>\n        ","\n      </div>\n    "])),this.direction,this.displayName,e)}},{key:"renderContactPart",value:function(e){var t=this,r=!1;"Mobile Phone"!==e.title&&"Business Phone"!==e.title||(r=!0);var n={part__link:!0,phone:r},o=e.onClick?en(bd||(bd=Bn(["\n          <span class="," @click=",">","</span>\n        "])),Do(n),(function(t){return e.onClick(t)}),e.value):en(yd||(yd=Bn(["\n          ","\n        "])),e.value);return en(kd||(kd=Bn(['\n      <div class="part" @click=',' tabindex="0">\n        <div class="part__icon" aria-label='," title=",">",'</div>\n        <div class="part__details">\n          <div class="part__title">','</div>\n          <div class="part__value" title=',">",'</div>\n        </div>\n        <div class="part__copy" aria-role="button" aria-label='," title=",">\n          ","\n        </div>\n      </div>\n    "])),(function(r){return t.handlePartClick(r,e.value)}),e.title,e.title,e.icon,e.title,e.title,o,this.strings.copyToClipboardButton,this.strings.copyToClipboardButton,va(pa.Copy))}},{key:"handlePartClick",value:function(e,t){t&&navigator.clipboard.writeText(t)}},{key:"sendLink",value:function(e,t){t?window.open("".concat(e).concat(t),"_blank","noreferrer"):console.error("Target resource for ".concat(e," link was not provided: resource: ").concat(t))}},{key:"sendChat",value:function(e){if(e){var t="https://teams.microsoft.com/l/chat/0/0?users=".concat(e),r=function(){return window.open(t,"_blank","noreferrer")};vo.isAvailable?vo.executeDeepLink(t,(function(e){e||r()})):r()}else console.error("Can't send chat when upn is not provided")}},{key:"sendEmail",value:function(e){this.sendLink("mailto:",e)}}],[{key:"styles",get:function(){return xd}}]),r}(fd);Sd=Td([fn("mgt-person-card-contact"),_d("design:paramtypes",[Object])],Sd);var Id,Ed,Ad,Rd,Pd,Od,Nd,Dd=[xn(wd||(wd=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, \"Segoe UI\");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .file{display:flex;align-items:center;padding:11px 20px}:host .root .file:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .file:last-child{margin-bottom:unset}:host .root .file .file__icon{width:28px;min-width:28px;height:28px;margin-right:12px;display:flex;align-items:center;justify-content:center}:host .root .file .file__icon img{height:28px;width:28px}:host .root .file .file__details{min-width:0;margin-right:40px}:host .root .file .file__details .file__name{font-size:14px;color:var(--color-sub1,#323130)}:host .root .file .file__details .file__last-modified{font-size:12px;color:var(--color-sub2,#717171)}:host .root .file .file__details>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[dir=rtl] .file__icon{margin-right:0!important}[dir=rtl] .file__details{margin-right:12px!important}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, \"Segoe UI\");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .file{display:flex;align-items:center;padding:11px 20px}:host .root .file:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .file:last-child{margin-bottom:unset}:host .root .file .file__icon{width:28px;min-width:28px;height:28px;margin-right:12px;display:flex;align-items:center;justify-content:center}:host .root .file .file__icon img{height:28px;width:28px}:host .root .file .file__details{min-width:0;margin-right:40px}:host .root .file .file__details .file__name{font-size:14px;color:var(--color-sub1,#323130)}:host .root .file .file__details .file__last-modified{font-size:12px;color:var(--color-sub2,#717171)}:host .root .file .file__details>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[dir=rtl] .file__icon{margin-right:0!important}[dir=rtl] .file__details{margin-right:12px!important}\n"])))],Ld={filesSectionTitle:"Files",sharedTextSubtitle:"Shared"},Md=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Ud=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Fd=function(e){b(r,e);var t=C(r);function r(e){var n;return p(this,r),(n=t.call(this))._files=e,n}return v(r,[{key:"strings",get:function(){return Ld}},{key:"displayName",get:function(){return this.strings.filesSectionTitle}},{key:"clearState",value:function(){Ot(y(r.prototype),"clearState",this).call(this),this._files=null}},{key:"renderIcon",value:function(){return va(pa.Files)}},{key:"renderCompactView",value:function(){var e,t=this;return e=this.isLoadingState?this.renderLoading():this._files&&this._files.length?en(Id||(Id=Bn(["\n        ","\n      "])),this._files.slice(0,3).map((function(e){return t.renderFile(e)}))):this.renderNoData(),en(Ed||(Ed=Bn(['\n      <div class="root compact" dir=',">\n        ","\n      </div>\n    "])),this.direction,e)}},{key:"renderFullView",value:function(){var e,t=this;return e=this.isLoadingState?this.renderLoading():this._files&&this._files.length?en(Ad||(Ad=Bn(["\n        ","\n      "])),this._files.map((function(e){return t.renderFile(e)}))):this.renderNoData(),en(Rd||(Rd=Bn(['\n      <div class="root" dir=','>\n        <div class="title">',"</div>\n        ","\n      </div>\n    "])),this.direction,this.strings.filesSectionTitle,e)}},{key:"renderFile",value:function(e){var t=this,r=e.lastShared?en(Pd||(Pd=Bn(['\n          <div class="file__last-modified">\n            '," ","\n          </div>\n        "])),this.strings.sharedTextSubtitle,Lo(new Date(e.lastShared.sharedDateTime))):null;return en(Od||(Od=Bn(['\n      <div class="file" @click=',' tabindex="0">\n        <div class="file__icon">\n          <img alt="','" src=',' />\n        </div>\n        <div class="file__details">\n          <div class="file__name">',"</div>\n          ","\n        </div>\n      </div>\n    "])),(function(r){return t.handleFileClick(e)}),e.resourceVisualization.title,function(e,t,r){var n=Vc[e]||"genericfile";return"".concat(Kc,"/").concat(t.toString(),"/").concat(n,".").concat(r)}(e.resourceVisualization.type,48,"svg"),e.resourceVisualization.title,r)}},{key:"handleFileClick",value:function(e){e.resourceReference&&e.resourceReference.webUrl&&window.open(e.resourceReference.webUrl,"_blank","noreferrer")}}],[{key:"styles",get:function(){return Dd}}]),r}(fd);Fd=Md([fn("mgt-person-card-files"),Ud("design:paramtypes",[Array])],Fd);var zd,Hd,Bd,qd,jd,Gd,Vd=[xn(Nd||(Nd=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, \"Segoe UI\");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--color,#000);font-size:16px}:host .root .message .message__detail .message__from{font-size:12px;color:var(--color-sub1,#323130)}:host .root .message .message__detail .message__message{font-size:12px;color:var(--color-sub2,#717171)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{font-size:12px;color:var(--color-sub2,#717171);margin-left:10px;white-space:nowrap}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, \"Segoe UI\");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--color,#000);font-size:16px}:host .root .message .message__detail .message__from{font-size:12px;color:var(--color-sub1,#323130)}:host .root .message .message__detail .message__message{font-size:12px;color:var(--color-sub2,#717171)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{font-size:12px;color:var(--color-sub2,#717171);margin-left:10px;white-space:nowrap}\n"])))],Kd={emailsSectionTitle:"Emails"},Qd=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Wd=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Jd=function(e){b(r,e);var t=C(r);function r(e){var n;return p(this,r),(n=t.call(this))._messages=e,n}return v(r,[{key:"strings",get:function(){return Kd}},{key:"displayName",get:function(){return this.strings.emailsSectionTitle}},{key:"clearState",value:function(){Ot(y(r.prototype),"clearState",this).call(this),this._messages=[]}},{key:"renderIcon",value:function(){return va(pa.Messages)}},{key:"renderCompactView",value:function(){var e,t=this;if(this.isLoadingState)e=this.renderLoading();else if(this._messages&&this._messages.length){var r=this._messages?this._messages.slice(0,3).map((function(e){return t.renderMessage(e)})):[];e=en(zd||(zd=Bn(["\n        ","\n      "])),r)}else e=this.renderNoData();return en(Hd||(Hd=Bn(['\n      <div class="root compact">\n        ',"\n      </div>\n    "])),e)}},{key:"renderFullView",value:function(){var e,t=this;return e=this.isLoadingState?this.renderLoading():this._messages&&this._messages.length?en(Bd||(Bd=Bn(["\n        ","\n      "])),this._messages.slice(0,5).map((function(e){return t.renderMessage(e)}))):this.renderNoData(),en(qd||(qd=Bn(['\n      <div class="root">\n        <div class="title" tabindex="0">',"</div>\n        ","\n      </div>\n    "])),this.strings.emailsSectionTitle,e)}},{key:"renderMessage",value:function(e){var t=this;return en(jd||(jd=Bn(['\n      <div class="message" @click=','>\n        <div class="message__detail">\n          <div class="message__subject">','</div>\n          <div class="message__from">','</div>\n          <div class="message__message">','</div>\n        </div>\n        <div class="message__date">',"</div>\n      </div>\n    "])),(function(){return t.handleMessageClick(e)}),e.subject,e.from.emailAddress.name,e.bodyPreview,Lo(new Date(e.receivedDateTime)))}},{key:"handleMessageClick",value:function(e){window.open(e.webLink,"_blank","noreferrer")}}],[{key:"styles",get:function(){return Vd}}]),r}(fd);Jd=Qd([fn("mgt-person-card-messages"),Wd("design:paramtypes",[Array])],Jd);var Yd,Xd,Zd,$d,ep,tp,rp,np,op,ip,ap,sp,cp=[xn(Gd||(Gd=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, \"Segoe UI\");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 20px 20px}:host .root .subtitle{color:var(--title-color-sub2,#717171);font-size:14px;margin:0 20px 8px 20px}:host .root .divider{display:flex;background:var(--line-seperator-color,#edebe9);height:1px;margin-top:26px;margin-bottom:18px;margin-left:20px;margin-right:20px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:var(--background-color-sub2,#f3f2f1);border:1px solid var(--person-card-active-org-member-color,#0078d4)}:host .root .org-member.org-member--direct-report:not(:last-child){border-bottom:none}:host .root .org-member:not(.org-member--target){background-color:var(--background-color-sub1,#faf9f8);border:1px solid var(--line-seperator-color,#edebe9)}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__person mgt-person{--avatar-size:48px;--avatar-size-s:48px;--font-size:16px;--color:#323130;--line2-font-size:14px;--line3-font-size:14px;--line2-text-transform:uppercase;--line2-color:#797775;--line3-color:#797775;--line3-text-transform:uppercase;margin-right:8px;max-width:230px}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--color-sub1,#323130);font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--color-sub2,#717171)}:host .root .org-member__separator{border:1px solid var(--line-seperator-color,#edebe9);box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .coworker .coworker__person{height:46px;width:46px;border-radius:46px;margin-right:8px}:host .root .coworker .coworker__person mgt-person{--font-size:16px;--line2-text-transform:uppercase;--line2-font-size:14px;--line2-color:set-var(color__sub2, $theme-default, $common);--avatar-size:46px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, \"Segoe UI\");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 20px 20px}:host .root .subtitle{color:var(--title-color-sub2,#717171);font-size:14px;margin:0 20px 8px 20px}:host .root .divider{display:flex;background:var(--line-seperator-color,#edebe9);height:1px;margin-top:26px;margin-bottom:18px;margin-left:20px;margin-right:20px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:var(--background-color-sub2,#f3f2f1);border:1px solid var(--person-card-active-org-member-color,#0078d4)}:host .root .org-member.org-member--direct-report:not(:last-child){border-bottom:none}:host .root .org-member:not(.org-member--target){background-color:var(--background-color-sub1,#faf9f8);border:1px solid var(--line-seperator-color,#edebe9)}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__person mgt-person{--avatar-size:48px;--avatar-size-s:48px;--font-size:16px;--color:#323130;--line2-font-size:14px;--line3-font-size:14px;--line2-text-transform:uppercase;--line2-color:#797775;--line3-color:#797775;--line3-text-transform:uppercase;margin-right:8px;max-width:230px}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--color-sub1,#323130);font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--color-sub2,#717171)}:host .root .org-member__separator{border:1px solid var(--line-seperator-color,#edebe9);box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .coworker .coworker__person{height:46px;width:46px;border-radius:46px;margin-right:8px}:host .root .coworker .coworker__person mgt-person{--font-size:16px;--line2-text-transform:uppercase;--line2-font-size:14px;--line2-color:set-var(color__sub2, $theme-default, $common);--avatar-size:46px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"])))],lp={reportsToSectionTitle:"Reports to",directReportsSectionTitle:"Direct reports",organizationSectionTitle:"Organization",youWorkWithSubSectionTitle:"You work with",userWorksWithSubSectionTitle:"works with"},up=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},dp=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},pp=function(e){b(r,e);var t=C(r);function r(e,n){var o;return p(this,r),(o=t.call(this))._state=e,o._me=n,o}return v(r,[{key:"strings",get:function(){return lp}},{key:"clearState",value:function(){Ot(y(r.prototype),"clearState",this).call(this),this._state=null,this._me=null}},{key:"displayName",get:function(){var e=this._state,t=e.person,r=e.directReports;return!t.manager&&r&&r.length?"".concat(this.strings.directReportsSectionTitle," (").concat(r.length,")"):this.strings.reportsToSectionTitle}},{key:"renderIcon",value:function(){return va(pa.Organization)}},{key:"renderCompactView",value:function(){var e;if(!this._state||!this._state.person)return null;var t=this._state,r=t.person,n=t.directReports;return r?(r.manager?e=this.renderCoworker(r.manager):n&&n.length&&(e=this.renderCompactDirectReports()),en(Yd||(Yd=Bn(['\n      <div class="root compact">\n        ',"\n      </div>\n    "])),e)):null}},{key:"renderFullView",value:function(){var e;if(!this._state||!this._state.person)return null;var t=this._state,r=t.person,n=t.directReports,o=t.people;if(!(r||n||o))return null;var i=this.renderManagers(),a=this.renderCurrentUser(),s=this.renderDirectReports(),c=this.renderCoworkers();return e=en(Xd||(Xd=Bn(["\n        "," "," "," ","\n      "])),i,a,s,c),en(Zd||(Zd=Bn(['\n      <div class="root" dir=','>\n        <div class="title" tabindex="0">',"</div>\n        ","\n      </div>\n    "])),this.direction,this.strings.organizationSectionTitle,e)}},{key:"renderManager",value:function(e){var t=this;return en($d||($d=Bn(['\n      <div class="org-member" @keydown='," @click=",'>\n        <div class="org-member__person">\n          <mgt-person\n            .personDetails=',"\n            .line2Property=","\n            .line3Property=","\n            .fetchImage=","\n            .view=",'\n          ></mgt-person>\n        </div>\n        <div tabindex="0" class="org-member__more">\n          ','\n        </div>\n      </div>\n      <div class="org-member__separator"></div>\n    '])),(function(r){"Enter"===r.code&&t.navigateCard(e)}),(function(){return t.navigateCard(e)}),e,"jobTitle","department",!0,Oi.threelines,va(pa.ExpandRight))}},{key:"renderManagers",value:function(){var e=this,t=this._state.person;if(!t||!t.manager)return null;for(var r=[],n=t;n.manager;)r.push(n.manager),n=n.manager;return r.length?r.reverse().map((function(t){return e.renderManager(t)})):null}},{key:"renderDirectReports",value:function(){var e=this,t=this._state.directReports;return t&&t.length?en(ep||(ep=Bn(['\n      <div class="org-member__separator"></div>\n      <div>\n        ',"\n      </div>\n    "])),t.map((function(t){return en(tp||(tp=Bn(['\n            <div class="org-member org-member--direct-report" @keydown='," @click=",'>\n              <div class="org-member__person">\n                <mgt-person\n                  .personDetails=',"\n                  .line2Property=","\n                  .line3Property=","\n                  .fetchImage=","\n                  .view=",'\n                ></mgt-person>\n              </div>\n              <div tabindex="0" class="org-member__more">\n                ',"\n              </div>\n            </div>\n          "])),(function(r){"Enter"===r.code&&e.navigateCard(t)}),(function(){return e.navigateCard(t)}),t,"jobTitle","department",!0,Oi.twolines,va(pa.ExpandRight))}))):null}},{key:"renderCompactDirectReports",value:function(){var e=this,t=this._state.directReports;return en(rp||(rp=Bn(['\n      <div class="direct-report__compact">\n        ',"\n      </div>\n    "])),t.slice(0,6).map((function(t){return en(np||(np=Bn(['\n            <div class="direct-report" @keydown='," @click="," @keydown=",">\n              <mgt-person .personDetails="," .fetchImage=","></mgt-person>\n            </div>\n          "])),(function(r){"Enter"===r.code&&e.navigateCard(t)}),(function(){return e.navigateCard(t)}),(function(r){"Enter"===r.code&&e.navigateCard(t)}),t,!0)})))}},{key:"renderCurrentUser",value:function(){var e=this._state.person;return en(op||(op=Bn(['\n      <div class="org-member org-member--target">\n        <div class="org-member__person">\n          <mgt-person\n            .personDetails=',"\n            .line2Property=","\n            .line3Property=","\n            .fetchImage=","\n            .view=","\n          ></mgt-person>\n        </div>\n      </div>\n    "])),e,"jobTitle","department",!0,Oi.threelines)}},{key:"renderCoworker",value:function(e){var t=this;return en(ip||(ip=Bn(['\n      <div class="coworker" @keydown='," @click=",'>\n        <div class="coworker__person">\n          <mgt-person\n            .personDetails=',"\n            .line2Property=","\n            .fetchImage=","\n            .view=","\n          ></mgt-person>\n        </div>\n      </div>\n    "])),(function(r){"Enter"===r.code&&t.navigateCard(e)}),(function(){return t.navigateCard(e)}),e,"jobTitle",!0,Oi.twolines)}},{key:"renderCoworkers",value:function(){var e=this,t=this._state.people;if(!t||!t.length)return null;var r=this._me.id===this._state.person.id?this.strings.youWorkWithSubSectionTitle:"".concat(this._state.person.givenName," ").concat(this.strings.userWorksWithSubSectionTitle);return en(ap||(ap=Bn(['\n      <div class="divider"></div>\n      <div class="subtitle" tabindex="0">',"</div>\n      <div>\n        ","\n      </div>\n    "])),r,t.slice(0,6).map((function(t){return e.renderCoworker(t)})))}}],[{key:"styles",get:function(){return cp}}]),r}(fd);pp=up([fn("mgt-person-card-organization"),dp("design:paramtypes",[Object,Object])],pp);var fp,hp,gp,vp,mp,bp,yp,kp,wp,xp,Cp,Tp,_p,Sp,Ip,Ep,Ap=[xn(sp||(sp=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, \"Segoe UI\");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:14px;color:var(--title-color-sub2,#717171)}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-direction:row;flex-wrap:wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--background-color-sub2,#f3f2f1);border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item:hover{color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--color-sub2,#717171);margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--title-color-subtitle,#323130)}:host .root .data-list__item .data-list__item__date-range{color:var(--color-sub2,#717171);font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#0078d4}:host .root .work-position .work-position__location{font-size:10px;color:var(--color-sub2,#717171);line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--color-sub3,#727170)}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--color-sub1,#323130)}[dir=rtl] .token-list__item{margin-right:0!important}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, \"Segoe UI\");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:14px;color:var(--title-color-sub2,#717171)}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-direction:row;flex-wrap:wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--background-color-sub2,#f3f2f1);border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item:hover{color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--color-sub2,#717171);margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--title-color-subtitle,#323130)}:host .root .data-list__item .data-list__item__date-range{color:var(--color-sub2,#717171);font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#0078d4}:host .root .work-position .work-position__location{font-size:10px;color:var(--color-sub2,#717171);line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--color-sub3,#727170)}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--color-sub1,#323130)}[dir=rtl] .token-list__item{margin-right:0!important}\n"])))],Rp={SkillsAndExperienceSectionTitle:"Skills & Experience",AboutCompactSectionTitle:"About",SkillsSubSectionTitle:"Skills",LanguagesSubSectionTitle:"Languages",WorkExperienceSubSectionTitle:"Work Experience",EducationSubSectionTitle:"Education",professionalInterestsSubSectionTitle:"Professional Interests",personalInterestsSubSectionTitle:"Personal Interests",birthdaySubSectionTitle:"Birthday",currentYearSubtitle:"Current"},Pp=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Op=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Np=function(e){b(r,e);var t=C(r);function r(e){var n;return p(this,r),(n=t.call(this)).profile=e,n}return v(r,[{key:"strings",get:function(){return Rp}},{key:"displayName",get:function(){return this.strings.SkillsAndExperienceSectionTitle}},{key:"hasData",get:function(){if(!this.profile)return!1;var e=this.profile,t=e.languages,r=e.skills,n=e.positions,o=e.educationalActivities;return[this._birthdayAnniversary,this._personalInterests&&this._personalInterests.length,this._professionalInterests&&this._professionalInterests.length,t&&t.length,r&&r.length,n&&n.length,o&&o.length].filter((function(e){return!!e})).length>0}},{key:"profile",get:function(){return this._profile},set:function(e){e!==this._profile&&(this._profile=e,this._birthdayAnniversary=e&&e.anniversaries?e.anniversaries.find(this.isBirthdayAnniversary):null,this._personalInterests=e&&e.interests?e.interests.filter(this.isPersonalInterest):null,this._professionalInterests=e&&e.interests?e.interests.filter(this.isProfessionalInterest):null)}},{key:"renderIcon",value:function(){return va(pa.Profile)}},{key:"clearState",value:function(){Ot(y(r.prototype),"clearState",this).call(this),this.profile=null}},{key:"renderCompactView",value:function(){return en(fp||(fp=Bn(['\n      <div class="root compact" dir=',">\n        ","\n      </div>\n    "])),this.direction,this.renderSubSections().slice(0,2))}},{key:"renderFullView",value:function(){return this.initPostRenderOperations(),en(hp||(hp=Bn(['\n      <div class="root" dir=','>\n        <div class="title">',"</div>\n        ","\n      </div>\n    "])),this.direction,this.strings.AboutCompactSectionTitle,this.renderSubSections())}},{key:"renderSubSections",value:function(){return[this.renderSkills(),this.renderBirthday(),this.renderLanguages(),this.renderWorkExperience(),this.renderEducation(),this.renderProfessionalInterests(),this.renderPersonalInterests()].filter((function(e){return!!e}))}},{key:"renderLanguages",value:function(){var e=this._profile.languages;if(!e||!e.length)return null;var t,r=[],n=S(e);try{for(n.s();!(t=n.n()).done;){var o=t.value,i=null;o.proficiency&&o.proficiency.length&&(i=en(vp||(vp=Bn(['\n          <span class="language__proficiency" tabindex="0">\n            &nbsp;(',")\n          </span>\n        "])),o.proficiency)),r.push(en(mp||(mp=Bn(['\n        <div class="token-list__item language">\n          <span class="language__title" tabindex="0">',"</span>\n          ","\n        </div>\n      "])),o.displayName,i))}}catch(s){n.e(s)}finally{n.f()}var a=r.length?this.strings.LanguagesSubSectionTitle:"";return en(gp||(gp=Bn(['\n      <section>\n        <div class="section__title" tabindex="0">','</div>\n        <div class="section__content">\n          <div class="token-list">\n            ',"\n          </div>\n        </div>\n      </section>\n    "])),a,r)}},{key:"renderSkills",value:function(){var e=this._profile.skills;if(!e||!e.length)return null;var t,r=[],n=S(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;r.push(en(yp||(yp=Bn(['\n        <div class="token-list__item skill" tabindex="0">\n          ',"\n        </div>\n      "])),o.displayName))}}catch(a){n.e(a)}finally{n.f()}var i=r.length?this.strings.SkillsSubSectionTitle:"";return en(bp||(bp=Bn(['\n      <section>\n        <div class="section__title" tabindex="0">','</div>\n        <div class="section__content">\n          <div class="token-list">\n            ',"\n          </div>\n        </div>\n      </section>\n    "])),i,r)}},{key:"renderWorkExperience",value:function(){var e,t,r,n,o,i,a,s,c,l=this._profile.positions;if(!l||!l.length)return null;var u,d=[],p=S(this._profile.positions);try{for(p.s();!(u=p.n()).done;){var f=u.value;(f.detail.description||""!==f.detail.jobTitle)&&d.push(en(wp||(wp=Bn(['\n          <div class="data-list__item work-position">\n            <div class="data-list__item__header">\n              <div class="data-list__item__title" tabindex="0">','</div>\n              <div class="data-list__item__date-range" tabindex="0">\n                ','\n              </div>\n            </div>\n            <div class="data-list__item__content">\n              <div class="work-position__company" tabindex="0">\n                ','\n              </div>\n              <div class="work-position__location" tabindex="0">\n                ',", ","\n              </div>\n            </div>\n          </div>\n        "])),null===(e=f.detail)||void 0===e?void 0:e.jobTitle,this.getDisplayDateRange(f.detail),null===(r=null===(t=null===f||void 0===f?void 0:f.detail)||void 0===t?void 0:t.company)||void 0===r?void 0:r.displayName,null===(i=null===(o=null===(n=null===f||void 0===f?void 0:f.detail)||void 0===n?void 0:n.company)||void 0===o?void 0:o.address)||void 0===i?void 0:i.city,null===(c=null===(s=null===(a=null===f||void 0===f?void 0:f.detail)||void 0===a?void 0:a.company)||void 0===s?void 0:s.address)||void 0===c?void 0:c.state))}}catch(g){p.e(g)}finally{p.f()}var h=d.length?this.strings.WorkExperienceSubSectionTitle:"";return en(kp||(kp=Bn(['\n      <section>\n        <div class="section__title" tabindex="0">','</div>\n        <div class="section__content">\n          <div class="data-list">\n            ',"\n          </div>\n        </div>\n      </section>\n    "])),h,d)}},{key:"renderEducation",value:function(){var e=this._profile.educationalActivities;if(!e||!e.length)return null;var t,r=[],n=S(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;r.push(en(Cp||(Cp=Bn(['\n        <div class="data-list__item educational-activity">\n          <div class="data-list__item__header">\n            <div class="data-list__item__title" tabindex="0">','</div>\n            <div class="data-list__item__date-range" tabindex="0">\n              ','\n            </div>\n          </div>\n          <div class="data-list__item__content">\n            <div class="educational-activity__degree" tabindex="0">\n              ',"\n            </div>\n          </div>\n        </div>\n      "])),o.institution.displayName,this.getDisplayDateRange(o),o.program.displayName||"Bachelors Degree"))}}catch(a){n.e(a)}finally{n.f()}var i=r.length?this.strings.EducationSubSectionTitle:"";return en(xp||(xp=Bn(['\n      <section>\n        <div class="section__title" tabindex="0">','</div>\n        <div class="section__content">\n          <div class="data-list">\n            ',"\n          </div>\n        </div>\n      </section>\n    "])),i,r)}},{key:"renderProfessionalInterests",value:function(){if(!this._professionalInterests||!this._professionalInterests.length)return null;var e,t=[],r=S(this._professionalInterests);try{for(r.s();!(e=r.n()).done;){var n=e.value;t.push(en(_p||(_p=Bn(['\n        <div class="token-list__item interest interest--professional" tabindex="0">\n          ',"\n        </div>\n      "])),n.displayName))}}catch(i){r.e(i)}finally{r.f()}var o=t.length?this.strings.professionalInterestsSubSectionTitle:"";return en(Tp||(Tp=Bn(['\n      <section>\n        <div class="section__title" tabindex="0">','</div>\n        <div class="section__content">\n          <div class="token-list">\n            ',"\n          </div>\n        </div>\n      </section>\n    "])),o,t)}},{key:"renderPersonalInterests",value:function(){if(!this._personalInterests||!this._personalInterests.length)return null;var e,t=[],r=S(this._personalInterests);try{for(r.s();!(e=r.n()).done;){var n=e.value;t.push(en(Ip||(Ip=Bn(['\n        <div class="token-list__item interest interest--personal" tabindex="0">\n          ',"\n        </div>\n      "])),n.displayName))}}catch(i){r.e(i)}finally{r.f()}var o=t.length?this.strings.personalInterestsSubSectionTitle:"";return en(Sp||(Sp=Bn(['\n      <section>\n        <div class="section__title" tabindex="0">','</div>\n        <div class="section__content">\n          <div class="token-list">\n            ',"\n          </div>\n        </div>\n      </section>\n    "])),o,t)}},{key:"renderBirthday",value:function(){return this._birthdayAnniversary&&this._birthdayAnniversary.date?en(Ep||(Ep=Bn(['\n      <section>\n        <div class="section__title" tabindex="0">Birthday</div>\n        <div class="section__content">\n          <div class="birthday">\n            <div class="birthday__icon">\n              ','\n            </div>\n            <div class="birthday__date" tabindex="0">\n              ',"\n            </div>\n          </div>\n        </div>\n      </section>\n    "])),va(pa.Birthday),this.getDisplayDate(new Date(this._birthdayAnniversary.date))):null}},{key:"isPersonalInterest",value:function(e){return e.categories&&e.categories.includes("personal")}},{key:"isProfessionalInterest",value:function(e){return e.categories&&e.categories.includes("professional")}},{key:"isBirthdayAnniversary",value:function(e){return"birthday"===e.type}},{key:"getDisplayDate",value:function(e){return e.toLocaleString("default",{day:"numeric",month:"long"})}},{key:"getDisplayDateRange",value:function(e){var t=new Date(e.startMonthYear).getFullYear();if(0===t)return null;var r=e.endMonthYear?new Date(e.endMonthYear).getFullYear():this.strings.currentYearSubtitle;return"".concat(t," \u2014 ").concat(r)}},{key:"initPostRenderOperations",value:function(){var e=this;setTimeout((function(){try{e.shadowRoot.querySelectorAll("section").forEach((function(t){e.handleTokenOverflow(t)}))}catch(t){}}),0)}},{key:"handleTokenOverflow",value:function(e){var t=e.querySelectorAll(".token-list");if(t&&t.length)for(var r=function(){var e=o[n],t=e.querySelectorAll(".token-list__item");if(!t||!t.length)return"continue";for(var r=null,i=t[0].getBoundingClientRect(),a=e.getBoundingClientRect(),s=2*i.height+a.top,c=0;c<t.length-1;c++)if((i=t[c].getBoundingClientRect()).top>s){r=Array.from(t).slice(c,t.length);break}if(r){r.forEach((function(e){return e.classList.add("overflow")}));var l=document.createElement("div");l.classList.add("token-list__item"),l.classList.add("token-list__item--show-overflow"),l.tabIndex=0,l.innerText="+ ".concat(r.length," more");var u=function(){l.remove(),r.forEach((function(e){return e.classList.remove("overflow")}))};l.addEventListener("click",(function(e){u()})),l.addEventListener("keydown",(function(e){"Enter"===e.code&&u()})),e.appendChild(l)}},n=0,o=Array.from(t);n<o.length;n++)r()}}],[{key:"styles",get:function(){return Ap}}]),r}(fd);Np=Pp([fn("mgt-person-card-profile"),Op("design:paramtypes",[Object])],Np);var Dp,Lp,Mp,Up,Fp,zp,Hp,Bp,qp,jp,Gp,Vp,Kp,Qp,Wp,Jp,Yp,Xp,Zp,$p,ef,tf,rf,nf={sendEmailLinkSubtitle:"Send email",startChatLinkSubtitle:"Start chat",showMoreSectionButton:"Show more",endOfCard:"End of the card"},of=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},af=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},sf=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},cf=tf=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this))._chatInput="",e._currentSection=null,e._history=[],e.sections=[],e}return v(r,[{key:"strings",get:function(){return nf}},{key:"personDetails",get:function(){return this._personDetails},set:function(e){this._personDetails!==e&&(this._personDetails=e,this.personImage=this.getImage(),this.requestStateUpdate())}},{key:"userId",get:function(){return this._userId},set:function(e){e!==this._userId&&(this._userId=e,this.personDetails=null,this.state=null,this.requestStateUpdate())}},{key:"internalPersonDetails",get:function(){return this.state&&this.state.person||this.personDetails}},{key:"attributeChangedCallback",value:function(e,t,n){if(Ot(y(r.prototype),"attributeChangedCallback",this).call(this,e,t,n),t!==n&&"person-query"===e)this.personDetails=null,this.state=null,this.requestStateUpdate()}},{key:"navigate",value:function(e){this._history.push({personDetails:this.personDetails,personImage:this.getImage(),state:this.state}),this._personDetails=e,this.state=null,this.personImage=null,this._currentSection=null,this.sections=[],this.requestStateUpdate()}},{key:"goBack",value:function(){if(this._history&&this._history.length){var e=this._history.pop();this._currentSection=null,this.state=e.state,this._personDetails=e.state,this.personImage=e.personImage,this.loadSections()}}},{key:"clearHistory",value:function(){if(this._currentSection=null,this._history&&this._history.length){var e=this._history[0];this._history=[],this.state=e.state,this._personDetails=e.state,this.personImage=e.personImage,this.loadSections()}}},{key:"render",value:function(){var e=this;if(!this.internalPersonDetails)return this.renderNoData();var t=this.internalPersonDetails,r=this.getImage();if(this.hasTemplate("default"))return this.renderTemplate("default",{person:this.internalPersonDetails,personImage:r});var n=this._history&&this._history.length?en(Dp||(Dp=Bn(['\n            <div class="nav">\n              <div class="nav__back" tabindex="0" @keydown='," @click=",">","</div>\n            </div>\n          "])),(function(t){"Enter"===t.code&&e.goBack()}),(function(){return e.goBack()}),va(pa.Back)):null,o=this.renderTemplate("person-details",{person:this.internalPersonDetails,personImage:r});if(!o){var i=this.renderPerson(),a=this.renderContactIcons(t);o=en(Lp||(Lp=Bn(["\n        "," ","\n      "])),i,a)}var s=this.isExpanded?this.renderExpandedDetails():this.renderExpandedDetailsButton();this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0);var c=this.lockTabNavigation?en(Mp||(Mp=Bn(["<div @keydown="," aria-label=",' tabindex="0" id="end-of-container"></div>'])),this.handleEndOfCard,this.strings.endOfCard):en(Up||(Up=Bn([""])));return en(Fp||(Fp=Bn(['\n      <div class="root" dir=',">\n      <div class=",">\n          ",'\n          <div class="person-details-container">','</div>\n          <div class="expanded-details-container">',"</div>\n          ","\n        </div>\n      </div>\n    "])),this.direction,this._smallView?"small":"",n,o,s,c)}},{key:"handleEndOfCard",value:function(e){if(e&&"Tab"===e.code){var t=this.renderRoot.querySelector("#end-of-container");if(t){t.blur();var r=this.renderRoot.querySelector("mgt-person");r&&r.focus()}}}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||en(zp||(zp=Bn([""])))}},{key:"renderPerson",value:function(){return en(Hp||(Hp=Bn(['\n      <mgt-person\n        tabindex="0"\n        class="person-image"\n        .personDetails=',"\n        .personImage=","\n        .personPresence=","\n        .showPresence=","\n        .avatarSize=","\n        .view=","\n        .line2Property=","\n        .line3Property=","\n      ></mgt-person>\n    "])),this.internalPersonDetails,this.getImage(),this.personPresence,this.showPresence,"large",Oi.threelines,"jobTitle","department")}},{key:"renderPersonSubtitle",value:function(e){if((e=e||this.internalPersonDetails).department)return en(Bp||(Bp=Bn(['\n      <div class="department">',"</div>\n    "])),e.department)}},{key:"renderContactIcons",value:function(e){var t=this;if(!this.isExpanded){var r,n,o=e=e||this.internalPersonDetails;return ni(e)&&(r=en(qp||(qp=Bn(['\n        <div class="icon" @click='," tabindex=0>\n          ","\n          <span>","</span>\n        </div>\n      "])),(function(){return t.emailUser()}),va(pa.SmallEmail),this.strings.sendEmailLinkSubtitle)),o.userPrincipalName&&(n=en(jp||(jp=Bn(['\n        <div class="icon" @click='," tabindex=0>\n          ","\n          <span>","</span>\n        </div>\n      "])),(function(){return t.chatUser()}),va(pa.SmallChat),this.strings.startChatLinkSubtitle)),en(Gp||(Gp=Bn(['\n      <div class="base-icons">\n        '," ","\n      </div>\n    "])),r,n)}}},{key:"renderExpandedDetailsButton",value:function(){var e=this;return en(Vp||(Vp=Bn(['\n      <div \n        class="expanded-details-button" \n        @click='," \n        @keydown=","\n        tabindex=0>\n          ","\n      </div>\n    "])),(function(){return e.showExpandedDetails()}),this.handleKeyDown,va(pa.ExpandDown))}},{key:"renderExpandedDetails",value:function(e){var t=this;if(!this.state&&this.isStateLoading)return en(Kp||(Kp=Bn(['\n        <div class="loading">\n          <mgt-spinner></mgt-spinner>\n        </div>\n      '])));Pn.globalProvider.state===Sn.SignedOut&&this.loadSections(),e=e||this.internalPersonDetails;var r=this.renderSectionNavigation(),n=this.renderCurrentSection();return en(Qp||(Qp=Bn(['\n      <div class="section-nav">\n        ','\n      </div>\n      <div class="section-host ','" @wheel='," tabindex=0>\n        ","\n      </div>\n    "])),r,this._smallView?"small":"",(function(e){return t.handleSectionScroll(e)}),n)}},{key:"renderSectionNavigation",value:function(){var e=this;if(!(!this.sections||this.sections.length<2&&!this.hasTemplate("additional-details"))){var t=this._currentSection?this.sections.indexOf(this._currentSection):-1,r=this.sections.map((function(r,n){var o=Do({active:n===t,"section-nav__icon":!0}),i=r.tagName,a=i.substring(16,i.length).toLowerCase();return en(Wp||(Wp=Bn(["\n        <button\n          aria-label=","\n          tabindex=0\n          class=","\n          @click=",">\n            ","</button>\n      "])),a,o,(function(){return e.updateCurrentSection(r)}),r.renderIcon())})),n=Do({active:-1===t,"section-nav__icon":!0});return en(Jp||(Jp=Bn(['\n      <button \n        aria-label="overview"\n        tabindex=0 \n        class=',"\n        @click=",">\n          ","\n      </button>\n      ","\n    "])),n,(function(){return e.updateCurrentSection(null)}),va(pa.Overview),r)}}},{key:"renderOverviewSection",value:function(){var e=this;var t=this.sections.map((function(t){return en(Yp||(Yp=Bn(['\n        <div class="section">\n          <div class="section__header">\n            <div class="section__title" tabindex="0">','</div>\n            <a \n              class="section__show-more"\n              tabindex=0\n              @keydown=',"\n              @click=",">\n                ",'</a>\n          </div>\n          <div class="section__content">',"</div>\n        </div>\n      "])),t.displayName,(function(e){return function(e,t){"Enter"===e.code&&this.updateCurrentSection(t)}(e,t)}),(function(){return e.updateCurrentSection(t)}),e.strings.showMoreSectionButton,t.asCompactView())})),r=this.renderTemplate("additional-details",{person:this.internalPersonDetails,personImage:this.getImage(),state:this.state});return r&&t.splice(1,0,en(Xp||(Xp=Bn(['\n          <div class="section">\n            <div class="additional-details">',"</div>\n          </div>\n        "])),r)),en(Zp||(Zp=Bn(['\n      <div class="sections">\n        ',"\n      </div>\n    "])),t)}},{key:"renderCurrentSection",value:function(){if(this.sections&&this.sections.length||this.hasTemplate("additional-details"))return 1!==this.sections.length||this.hasTemplate("additional-details")?this._currentSection?en(ef||(ef=Bn(["\n      ","\n    "])),this._currentSection.asFullView()):this.renderOverviewSection():en($p||($p=Bn(["\n        ","\n      "])),this.sections[0].asFullView())}},{key:"loadState",value:function(){var e;return sf(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i,a,s,c,l,u,d,p=this;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.state){t.next=2;break}return t.abrupt("return");case 2:if(!this.personDetails&&this.inheritDetails){for(r=this.parentElement;r&&"MGT-PERSON"!==r.tagName;)r=r.parentElement;n=r.personDetails||r.personDetailsInternal,r&&n&&(this.personDetails=n,this.personImage=r.personImage)}if((o=Pn.globalProvider)&&o.state===Sn.SignedIn){t.next=6;break}return t.abrupt("return");case 6:if(i=o.graph.forComponent(this),this.isStateLoading=!0,this._me){t.next=12;break}return t.next=11,Pn.me();case 11:this._me=t.sent;case 12:if(!this.personDetails){t.next=23;break}if(a=this.personDetails,!(s=a.userPrincipalName||a.id)||ni(a)){t.next=21;break}return t.next=18,ga(i,s);case 18:c=t.sent,this.personDetails=c,this.personImage=this.getImage();case 21:t.next=36;break;case 23:if(!this.userId&&"me"!==this.personQuery){t.next=31;break}return t.next=26,ga(i,this.userId);case 26:l=t.sent,this.personDetails=l,this.personImage=this.getImage(),t.next=36;break;case 31:if(!this.personQuery){t.next=36;break}return t.next=34,ti(i,this.personQuery,1);case 34:(u=t.sent)&&u.length&&(this.personDetails=u[0],Ci(i,this.personDetails,tf.config.useContactApis).then((function(e){e&&(p.personDetails.personImage=e,p.personImage=e)})));case 36:if(d={activity:"Offline",availability:"Offline",id:null},!this.personPresence&&this.showPresence)try{this.personDetails&&this.personDetails.id?Ri(i,this.personDetails.id).then((function(e){p.personPresence=e})):this.personPresence=d}catch(f){this.personPresence=d}if(!(null===(e=this.personDetails)||void 0===e?void 0:e.id)){t.next=42;break}return t.next=41,td(i,this.personDetails,this._me===this.personDetails.id,tf.config);case 41:this.state=t.sent;case 42:this.loadSections(),this.isStateLoading=!1;case 44:case"end":return t.stop()}}),t,this)})))}},{key:"sendQuickMessage",value:function(){var e=this._chatInput.trim();e&&e.length&&this.chatUser(e)}},{key:"emailUser",value:function(){var e=this.internalPersonDetails;if(e){var t=ni(e);t&&window.open("mailto:"+t,"_blank","noreferrer")}}},{key:"callUser",value:function(){var e=this.personDetails,t=this.personDetails;if(e&&e.businessPhones&&e.businessPhones.length){var r=e.businessPhones[0];r&&window.open("tel:"+r,"_blank","noreferrer")}else if(t&&t.phones&&t.phones.length){var n=this.getPersonBusinessPhones(t)[0];n&&window.open("tel:"+n,"_blank","noreferrer")}}},{key:"chatUser",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.personDetails;if(t&&t.userPrincipalName){var r=t.userPrincipalName,n="https://teams.microsoft.com/l/chat/0/0?users=".concat(r);e&&e.length&&(n+="&message=".concat(e));var o=function(){return window.open(n,"_blank","noreferrer")};vo.isAvailable?vo.executeDeepLink(n,(function(e){e||o()})):o()}}},{key:"showExpandedDetails",value:function(){var e=this.renderRoot.querySelector(".root");e&&e.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this.isExpanded=!0,this.fireCustomEvent("expanded",null,!0)}},{key:"loadSections",value:function(){if(this.sections=[],this.internalPersonDetails){var e=new Sd(this.internalPersonDetails);if(e.hasData&&this.sections.push(e),this.state){var t=this.state,r=t.person,n=t.directReports,o=t.messages,i=t.files,a=t.profile;if(tf.config.sections.organization&&(r&&r.manager||n&&n.length)&&this.sections.push(new pp(this.state,this._me)),tf.config.sections.mailMessages&&o&&o.length&&this.sections.push(new Jd(o)),tf.config.sections.files&&i&&i.length&&this.sections.push(new Fd(i)),tf.config.sections.profile&&a){var s=new Np(a);s.hasData&&this.sections.push(s)}}}}},{key:"getImage",value:function(){if(this.personImage)return this.personImage;var e=this.personDetails;return e&&e.personImage?e.personImage:null}},{key:"getPersonBusinessPhones",value:function(e){var t,r=[],n=S(e.phones);try{for(n.s();!(t=n.n()).done;){var o=t.value;"business"===o.type&&r.push(o.number)}}catch(i){n.e(i)}finally{n.f()}return r}},{key:"updateCurrentSection",value:function(e){this.renderRoot.querySelector(".section-host").scrollTop=0,this._currentSection=e,this.requestUpdate()}},{key:"handleSectionScroll",value:function(e){var t=this.renderRoot.querySelector(".section-host");t&&(e.deltaY<0&&0===t.scrollTop||e.deltaY>0&&t.clientHeight+t.scrollTop>=t.scrollHeight-1||e.stopPropagation())}},{key:"handleKeyDown",value:function(e){e&&13===e.keyCode&&this.showExpandedDetails()}}],[{key:"styles",get:function(){return ud}},{key:"requiredScopes",get:function(){return tf.getScopes()}},{key:"getScopes",value:function(){var e=[];return this.config.sections.files&&e.push("Sites.Read.All"),this.config.sections.mailMessages&&e.push("Mail.ReadBasic"),this.config.sections.organization&&(e.push("User.Read.All"),"boolean"!==typeof this.config.sections.organization&&this.config.sections.organization.showWorksWith&&e.push("People.Read.All")),this.config.sections.profile&&e.push("User.Read.All"),this.config.useContactApis&&e.push("Contacts.Read"),e.indexOf("User.Read.All")<0&&(e.push("User.ReadBasic.All"),e.push("User.Read")),e.indexOf("People.Read.All")<0&&e.push("People.Read"),d(new Set(e))}},{key:"config",get:function(){return this._config}}]),r}(Jn);cf._config={sections:{files:!0,mailMessages:!0,organization:{showWorksWith:!0},profile:!0},useContactApis:!0},of([hn({attribute:"person-details",type:Object}),af("design:type",Object),af("design:paramtypes",[Object])],cf.prototype,"personDetails",null),of([hn({attribute:"person-query"}),af("design:type",String)],cf.prototype,"personQuery",void 0),of([hn({attribute:"lock-tab-navigation",type:Boolean}),af("design:type",Boolean)],cf.prototype,"lockTabNavigation",void 0),of([hn({attribute:"user-id"}),af("design:type",String),af("design:paramtypes",[String])],cf.prototype,"userId",null),of([hn({attribute:"person-image",type:String}),af("design:type",String)],cf.prototype,"personImage",void 0),of([hn({attribute:"fetch-image",type:Boolean}),af("design:type",Boolean)],cf.prototype,"fetchImage",void 0),of([hn({attribute:"is-expanded",type:Boolean}),af("design:type",Boolean)],cf.prototype,"isExpanded",void 0),of([hn({attribute:"inherit-details",type:Boolean}),af("design:type",Boolean)],cf.prototype,"inheritDetails",void 0),of([hn({attribute:"show-presence",type:Boolean}),af("design:type",Boolean)],cf.prototype,"showPresence",void 0),of([hn({attribute:"person-presence",type:Object}),af("design:type",Object)],cf.prototype,"personPresence",void 0),of([gn(),af("design:type",Object)],cf.prototype,"state",void 0),of([gn(),af("design:type",Boolean)],cf.prototype,"isStateLoading",void 0),cf=tf=of([fn("mgt-person-card"),af("design:paramtypes",[])],cf);var lf=[xn(rf||(rf=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;-webkit-appearance:none}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, \"Segoe UI\");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, \"Segoe UI\");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,1px solid #e1dfdd);border-radius:8px}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#717171));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle;color:var(--color-sub2,#717171)}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\ue739'}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\ue73a'}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex;height:32px;padding:2px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, \"Segoe UI\");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{margin-right:28px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-family:var(--default-font-family, \"Segoe UI\");font-size:14px;line-height:20px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130))}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;-webkit-appearance:none}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, \"Segoe UI\");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, \"Segoe UI\");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,1px solid #e1dfdd);border-radius:8px}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#717171));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle;color:var(--color-sub2,#717171)}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\\uE739'}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\\uE73A'}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex;height:32px;padding:2px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, \"Segoe UI\");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{margin-right:28px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-family:var(--default-font-family, \"Segoe UI\");font-size:14px;line-height:20px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130))}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"])))],uf=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function df(e,t){return e.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions($t("Group.ReadWrite.All")).post(t)}function pf(e,t,r,n){return vf(e,t,{assignments:r},n)}function ff(e,t,r){return e.api("/planner/tasks/".concat(t)).header("Cache-Control","no-store").header("If-Match",r).middlewareOptions($t("Group.ReadWrite.All")).delete()}function hf(e,t,r){return vf(e,t,{percentComplete:100},r)}function gf(e,t,r){return vf(e,t,{percentComplete:0},r)}function vf(e,t,r,n){return uf(this,void 0,void 0,Ze().mark((function o(){return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.api("/planner/tasks/".concat(t)).header("Cache-Control","no-store").middlewareOptions($t("Group.ReadWrite.All")).header("If-Match",n).patch(JSON.stringify(r));case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}}),o)})))}function mf(e,t){return uf(this,void 0,void 0,Ze().mark((function r(){var n,o;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return"Group.Read.All",n="/groups/".concat(t,"/planner/plans"),r.next=4,e.api(n).header("Cache-Control","no-store").middlewareOptions($t("Group.Read.All")).get();case 4:return o=r.sent,r.abrupt("return",o?o.value:null);case 6:case"end":return r.stop()}}),r)})))}function bf(e,t){return uf(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api("/planner/plans/".concat(t)).header("Cache-Control","no-store").middlewareOptions($t("Group.Read.All")).get();case 2:return n=r.sent,r.abrupt("return",n);case 4:case"end":return r.stop()}}),r)})))}function yf(e,t){return uf(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api("/planner/plans/".concat(t,"/buckets")).header("Cache-Control","no-store").middlewareOptions($t("Group.Read.All")).get();case 2:return n=r.sent,r.abrupt("return",n&&n.value);case 4:case"end":return r.stop()}}),r)})))}function kf(e){return uf(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions($t("Group.Read.All")).get();case 2:return r=t.sent,t.abrupt("return",r&&r.value);case 4:case"end":return t.stop()}}),t)})))}function wf(e,t){return uf(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api("/planner/buckets/".concat(t,"/tasks")).header("Cache-Control","no-store").middlewareOptions($t("Group.Read.All")).get();case 2:return n=r.sent,r.abrupt("return",n&&n.value);case 4:case"end":return r.stop()}}),r)})))}var xf=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Cf(e,t){return xf(this,void 0,void 0,Ze().mark((function r(){var n,o;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.parentFolderId,!(o=void 0===n?null:n)){r.next=7;break}return r.next=4,e.api("/me/outlook/taskFolders/".concat(o,"/tasks")).header("Cache-Control","no-store").middlewareOptions($t("Tasks.ReadWrite")).post(t);case 4:case 9:return r.abrupt("return",r.sent);case 7:return r.next=9,e.api("/me/outlook/tasks").header("Cache-Control","no-store").middlewareOptions($t("Tasks.ReadWrite")).post(t);case 10:case"end":return r.stop()}}),r)})))}function Tf(e){return xf(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.api("/me/outlook/taskGroups").header("Cache-Control","no-store").middlewareOptions($t("Tasks.Read")).get();case 2:return r=t.sent,t.abrupt("return",r&&r.value);case 4:case"end":return t.stop()}}),t)})))}function _f(e,t){return xf(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api("/me/outlook/taskFolders/".concat(t,"/tasks")).header("Cache-Control","no-store").middlewareOptions($t("Tasks.Read")).get();case 2:return n=r.sent,r.abrupt("return",n&&n.value);case 4:case"end":return r.stop()}}),r)})))}function Sf(e,t){return xf(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api("/me/outlook/taskGroups/".concat(t,"/taskFolders")).header("Cache-Control","no-store").middlewareOptions($t("Tasks.Read")).get();case 2:return n=r.sent,r.abrupt("return",n&&n.value);case 4:case"end":return r.stop()}}),r)})))}function If(e,t){return xf(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api("/me/outlook/taskGroups/".concat(t)).header("Cache-Control","no-store").middlewareOptions($t("Tasks.Read")).get();case 2:return n=r.sent,r.abrupt("return",n);case 4:case"end":return r.stop()}}),r)})))}function Ef(e,t,r){return xf(this,void 0,void 0,Ze().mark((function n(){return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.api("/me/outlook/tasks/".concat(t)).header("Cache-Control","no-store").header("If-Match",r).middlewareOptions($t("Tasks.ReadWrite")).delete();case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))}function Af(e,t,r){return xf(this,void 0,void 0,Ze().mark((function n(){return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Pf(e,t,{isReminderOn:!1,status:"completed"},r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))}function Rf(e,t,r){return xf(this,void 0,void 0,Ze().mark((function n(){return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Pf(e,t,{isReminderOn:!0,status:"notStarted"},r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))}function Pf(e,t,r,n){return xf(this,void 0,void 0,Ze().mark((function o(){return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.api("/me/outlook/tasks/".concat(t)).header("Cache-Control","no-store").header("If-Match",n).middlewareOptions($t("Tasks.ReadWrite")).patch(r);case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}}),o)})))}var Of,Nf,Df,Lf,Mf=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Uf=v((function e(t){p(this,e),this.graph=fr.fromGraph(t)})),Ff=function(e){b(r,e);var t=C(r);function r(){return p(this,r),t.apply(this,arguments)}return v(r,[{key:"getTaskGroups",value:function(){return Mf(this,void 0,void 0,Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kf(this.graph);case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return{id:e.id,title:e.title}})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"getTaskGroupsForGroup",value:function(e){return Mf(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,mf(this.graph,e);case 2:return r=t.sent,t.abrupt("return",r.map((function(e){return{id:e.id,title:e.title}})));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getTaskGroup",value:function(e){return Mf(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,bf(this.graph,e);case 2:return r=t.sent,t.abrupt("return",{id:r.id,title:r.title,_raw:r});case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getTaskFoldersForTaskGroup",value:function(e){return Mf(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yf(this.graph,e);case 2:return r=t.sent,t.abrupt("return",r.map((function(e){return{_raw:e,id:e.id,name:e.name,parentId:e.planId}})));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getTasksForTaskFolder",value:function(e){return Mf(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,wf(this.graph,e);case 2:return r=t.sent,t.abrupt("return",r.map((function(e){return{_raw:e,assignments:e.assignments,completed:100===e.percentComplete,dueDate:e.dueDateTime&&new Date(e.dueDateTime),eTag:e["@odata.etag"],id:e.id,immediateParentId:e.bucketId,name:e.title,topParentId:e.planId}})));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"setTaskComplete",value:function(e,t){return Mf(this,void 0,void 0,Ze().mark((function r(){return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,hf(this.graph,e,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r,this)})))}},{key:"setTaskIncomplete",value:function(e,t){return Mf(this,void 0,void 0,Ze().mark((function r(){return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,gf(this.graph,e,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r,this)})))}},{key:"addTask",value:function(e){return Mf(this,void 0,void 0,Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,df(this.graph,{assignments:e.assignments,bucketId:e.immediateParentId,dueDateTime:e.dueDate&&e.dueDate.toISOString(),planId:e.topParentId,title:e.name});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"assignPeopleToTask",value:function(e,t,r){return Mf(this,void 0,void 0,Ze().mark((function n(){return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,pf(this.graph,e,t,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"removeTask",value:function(e,t){return Mf(this,void 0,void 0,Ze().mark((function r(){return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,ff(this.graph,e,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r,this)})))}},{key:"isAssignedToMe",value:function(e,t){return Object.keys(e.assignments).includes(t)}}]),r}(Uf),zf=function(e){b(r,e);var t=C(r);function r(){return p(this,r),t.apply(this,arguments)}return v(r,[{key:"getTaskGroups",value:function(){return Mf(this,void 0,void 0,Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tf(this.graph);case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return{_raw:e,id:e.id,secondaryId:e.groupKey,title:e.name}})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"getTaskGroup",value:function(e){return Mf(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,If(this.graph,e);case 2:return r=t.sent,t.abrupt("return",{id:r.id,secondaryId:r.groupKey,title:r.name,_raw:r});case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getTaskFoldersForTaskGroup",value:function(e){return Mf(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Sf(this.graph,e);case 2:return r=t.sent,t.abrupt("return",r.map((function(t){return{_raw:t,id:t.id,name:t.name,parentId:e}})));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getTasksForTaskFolder",value:function(e,t){return Mf(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,_f(this.graph,e);case 2:return n=r.sent,r.abrupt("return",n.map((function(r){return{_raw:r,assignments:{},completed:!!r.completedDateTime,dueDate:r.dueDateTime&&new Date(r.dueDateTime.dateTime+"Z"),eTag:r["@odata.etag"],id:r.id,immediateParentId:e,name:r.subject,topParentId:t}})));case 4:case"end":return r.stop()}}),r,this)})))}},{key:"setTaskComplete",value:function(e,t){return Mf(this,void 0,void 0,Ze().mark((function r(){return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Af(this.graph,e,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r,this)})))}},{key:"assignPeopleToTask",value:function(e,t,r){return Mf(this,void 0,void 0,Ze().mark((function n(){return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,pf(this.graph,e,t,r);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"setTaskIncomplete",value:function(e,t){return Mf(this,void 0,void 0,Ze().mark((function r(){return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Rf(this.graph,e,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r,this)})))}},{key:"addTask",value:function(e){return Mf(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={parentFolderId:e.immediateParentId,subject:e.name},e.dueDate&&(r.dueDateTime={dateTime:e.dueDate.toISOString(),timeZone:"UTC"}),t.next=4,Cf(this.graph,r);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"removeTask",value:function(e,t){return Mf(this,void 0,void 0,Ze().mark((function r(){return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ef(this.graph,e,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r,this)})))}},{key:"isAssignedToMe",value:function(e,t){return!0}},{key:"getTaskGroupsForGroup",value:function(e){return Mf(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)})))}}]),r}(Uf),Hf=[xn(Of||(Of=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host,mgt-arrow-options{position:relative;font-family:var(--default-font-family)}:host .ArrowIcon,mgt-arrow-options .ArrowIcon{font-family:FabricMDL2Icons;margin:0 0 0 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Header,mgt-arrow-options .Header{cursor:pointer}:host .Header:hover,mgt-arrow-options .Header:hover{color:var(--theme-primary-color)}:host .Menu,mgt-arrow-options .Menu{position:absolute;left:var(--arrow-options-left,0);box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap}:host .Menu.Open,mgt-arrow-options .Menu.Open{display:block}:host .MenuOption,mgt-arrow-options .MenuOption{padding:20px;cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;display:flex;align-items:center;justify-content:stretch;justify-items:stretch}:host .MenuOption:first,mgt-arrow-options .MenuOption:first{padding:12px 20px 20px 20px}:host .MenuOption:hover,mgt-arrow-options .MenuOption:hover{background-color:var(--background-color--hover,#edebe9)}:host .MenuOption:active,mgt-arrow-options .MenuOption:active{background-color:var(--background-color--active,#e1dfdd)}:host .MenuOptionCheck,mgt-arrow-options .MenuOptionCheck{font-family:FabricMDL2Icons;color:transparent;margin-right:10px}:host .MenuOptionCheck.CurrentValue,mgt-arrow-options .MenuOptionCheck.CurrentValue{color:#0078d4}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host,mgt-arrow-options{position:relative;font-family:var(--default-font-family)}:host .ArrowIcon,mgt-arrow-options .ArrowIcon{font-family:FabricMDL2Icons;margin:0 0 0 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Header,mgt-arrow-options .Header{cursor:pointer}:host .Header:hover,mgt-arrow-options .Header:hover{color:var(--theme-primary-color)}:host .Menu,mgt-arrow-options .Menu{position:absolute;left:var(--arrow-options-left,0);box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap}:host .Menu.Open,mgt-arrow-options .Menu.Open{display:block}:host .MenuOption,mgt-arrow-options .MenuOption{padding:20px;cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;display:flex;align-items:center;justify-content:stretch;justify-items:stretch}:host .MenuOption:first,mgt-arrow-options .MenuOption:first{padding:12px 20px 20px 20px}:host .MenuOption:hover,mgt-arrow-options .MenuOption:hover{background-color:var(--background-color--hover,#edebe9)}:host .MenuOption:active,mgt-arrow-options .MenuOption:active{background-color:var(--background-color--active,#e1dfdd)}:host .MenuOptionCheck,mgt-arrow-options .MenuOptionCheck{font-family:FabricMDL2Icons;color:transparent;margin-right:10px}:host .MenuOptionCheck.CurrentValue,mgt-arrow-options .MenuOptionCheck.CurrentValue{color:#0078d4}\n"])))],Bf=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},qf=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},jf=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this)).value="",e.options={},e._clickHandler=function(t){return e.open=!1},e}return v(r,[{key:"connectedCallback",value:function(){Ot(y(r.prototype),"connectedCallback",this).call(this),window.addEventListener("click",this._clickHandler)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("click",this._clickHandler),Ot(y(r.prototype),"disconnectedCallback",this).call(this)}},{key:"onHeaderClick",value:function(e){Object.keys(this.options).length>1&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)}},{key:"render",value:function(){var e=this;return en(Nf||(Nf=Bn(['\n      <span class="Header" @click=','>\n        <span class="CurrentValue">',"</span>\n      </span>\n      <div class=",">\n        ","\n      </div>\n    "])),(function(t){return e.onHeaderClick(t)}),this.value,Do({Menu:!0,Open:this.open,Closed:!this.open}),this.getMenuOptions())}},{key:"getMenuOptions",value:function(){var e=this,t=Object.keys(this.options),r=this.options;return t.map((function(t){return en(Df||(Df=Bn(['\n        <div\n          class="MenuOption"\n          @click="','"\n        >\n          <span class=','>\n            \ue73e\n          </span>\n          <span class="MenuOptionName">',"</span>\n        </div>\n      "],['\n        <div\n          class="MenuOption"\n          @click="','"\n        >\n          <span class=','>\n            \\uE73E\n          </span>\n          <span class="MenuOptionName">',"</span>\n        </div>\n      "])),(function(n){e.open=!1,r[t](n)}),Do({MenuOptionCheck:!0,CurrentValue:e.value===t}),t)}))}}],[{key:"styles",get:function(){return Hf}}]),r}(Un);Bf([hn({type:Boolean}),qf("design:type",Boolean)],jf.prototype,"open",void 0),Bf([hn({type:String}),qf("design:type",String)],jf.prototype,"value",void 0),Bf([hn({type:Object}),qf("design:type",Object)],jf.prototype,"options",void 0),jf=Bf([fn("mgt-arrow-options"),qf("design:paramtypes",[])],jf);var Gf,Vf,Kf=[xn(Lf||(Lf=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host,mgt-dot-options{font-family:var(--default-font-family)}:host .DotIcon,mgt-dot-options .DotIcon{display:inline-block;font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .Menu,mgt-dot-options .Menu{position:absolute;box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap;transform:var(--dot-options-translateX,translateX(-50px))}:host .DotMenu.Open .Menu,mgt-dot-options .DotMenu.Open .Menu{display:block}:host .DotMenu .DotItem,mgt-dot-options .DotMenu .DotItem{direction:ltr;text-align:left;padding:10px 10px 8px 10px}:host .DotMenu .DotItem:hover,mgt-dot-options .DotMenu .DotItem:hover{background:var(--background-color--hover,#edebe9)}:host .DotMenu .DotItem:active,mgt-dot-options .DotMenu .DotItem:active{background:var(--background-color--active,#e1dfdd)}:host .DotMenu .DotItemName,mgt-dot-options .DotMenu .DotItemName{direction:rtl}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host,mgt-dot-options{font-family:var(--default-font-family)}:host .DotIcon,mgt-dot-options .DotIcon{display:inline-block;font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .Menu,mgt-dot-options .Menu{position:absolute;box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap;transform:var(--dot-options-translateX,translateX(-50px))}:host .DotMenu.Open .Menu,mgt-dot-options .DotMenu.Open .Menu{display:block}:host .DotMenu .DotItem,mgt-dot-options .DotMenu .DotItem{direction:ltr;text-align:left;padding:10px 10px 8px 10px}:host .DotMenu .DotItem:hover,mgt-dot-options .DotMenu .DotItem:hover{background:var(--background-color--hover,#edebe9)}:host .DotMenu .DotItem:active,mgt-dot-options .DotMenu .DotItem:active{background:var(--background-color--active,#e1dfdd)}:host .DotMenu .DotItemName,mgt-dot-options .DotMenu .DotItemName{direction:rtl}\n"])))],Qf=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Wf=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Jf=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this))._clickHandler=null,e._clickHandler=function(t){return e.open=!1},e}return v(r,[{key:"connectedCallback",value:function(){Ot(y(r.prototype),"connectedCallback",this).call(this),window.addEventListener("click",this._clickHandler)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("click",this._clickHandler),Ot(y(r.prototype),"disconnectedCallback",this).call(this)}},{key:"render",value:function(){var e=this;return en(Gf||(Gf=Bn(['\n      <div tabindex="0" class=',"\n        @click=","\n        @keydown=",'>\n        <span class="DotIcon">\ue712</span>\n        <div tabindex="0" class="Menu">\n          ',"\n        </div>\n      </div>\n    "],['\n      <div tabindex="0" class=',"\n        @click=","\n        @keydown=",'>\n        <span class="DotIcon">\\uE712</span>\n        <div tabindex="0" class="Menu">\n          ',"\n        </div>\n      </div>\n    "])),Do({DotMenu:!0,Open:this.open}),(function(t){return e.onDotClick(t)}),(function(t){return e.onDotKeydown(t)}),Object.keys(this.options).map((function(t){return e.getMenuOption(t,e.options[t])})))}},{key:"getMenuOption",value:function(e,t){var r=this;return en(Vf||(Vf=Bn(['\n      <div\n        class="DotItem"\n        @click="','"\n        @keydown="','"\n      >\n        <span class="DotItemName">\n          ',"\n        </span>\n      </div>\n    "])),(function(e){e.preventDefault(),e.stopPropagation(),t(e),r.open=!1}),(function(e){r.handleKeydownMenuOption,t(e),r.open=!1}),e)}},{key:"onDotClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.open=!this.open}},{key:"onDotKeydown",value:function(e){"Enter"===e.code&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)}},{key:"handleKeydownMenuOption",value:function(e){"Enter"===e.code&&(e.preventDefault(),e.stopPropagation())}}],[{key:"styles",get:function(){return Kf}}]),r}(Un);Qf([hn({type:Boolean}),Wf("design:type",Boolean)],Jf.prototype,"open",void 0),Qf([hn({type:Object}),Wf("design:type",Object)],Jf.prototype,"options",void 0),Jf=Qf([fn("mgt-dot-options"),Wf("design:paramtypes",[])],Jf);var Yf,Xf,Zf,$f,eh,th,rh,nh,oh,ih,ah,sh,ch,lh,uh,dh,ph,fh,hh,gh,vh,mh,bh,yh,kh,wh,xh,Ch,Th,_h,Sh,Ih,Eh,Ah,Rh,Ph,Oh,Nh,Dh,Lh,Mh={removeTaskSubtitle:"Delete Task",cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add"},Uh=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Fh=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},zh=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};!function(e){e[e.planner=0]="planner",e[e.todo=1]="todo"}(Lh||(Lh={}));var Hh,Bh={BASE_SELF_ASSIGNED:"All Tasks",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Folder not found",PLANS_SELF_ASSIGNED:"All groups",PLAN_NOT_FOUND:"Group not found"},qh={BASE_SELF_ASSIGNED:"Assigned to Me",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Bucket not found",PLANS_SELF_ASSIGNED:"All Plans",PLAN_NOT_FOUND:"Plan not found"},jh={"@odata.type":"microsoft.graph.plannerAssignment",orderHint:"string !"},Gh=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this)).dataSource=Lh.planner,e._me=null,e.clearState(),e.previousMediaQuery=e.mediaQuery,e.onResize=e.onResize.bind(w(e)),e}return v(r,[{key:"res",get:function(){switch(this.dataSource){case Lh.todo:return Bh;case Lh.planner:default:return qh}}},{key:"strings",get:function(){return Mh}},{key:"isNewTaskVisible",get:function(){return this._isNewTaskVisible},set:function(e){this._isNewTaskVisible=e,e||(this._newTaskDueDate=null,this._newTaskName="",this._newTaskGroupId="")}},{key:"connectedCallback",value:function(){Ot(y(r.prototype),"connectedCallback",this).call(this),window.addEventListener("resize",this.onResize)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("resize",this.onResize),Ot(y(r.prototype),"disconnectedCallback",this).call(this)}},{key:"attributeChangedCallback",value:function(e,t,n){Ot(y(r.prototype),"attributeChangedCallback",this).call(this,e,t,n),"data-source"===e&&(this.dataSource===Lh.planner?(this._currentGroup=this.initialId,this._currentFolder=this.initialBucketId):this.dataSource===Lh.todo&&(this._currentGroup=null,this._currentFolder=this.initialId),this.clearState(),this.requestStateUpdate())}},{key:"clearState",value:function(){this._newTaskFolderId="",this._newTaskGroupId="",this._newTaskDueDate=null,this._newTaskName="",this._newTaskBeingAdded=!1,this._tasks=[],this._folders=[],this._groups=[],this._hiddenTasks=[],this._loadingTasks=[],this._hasDoneInitialLoad=!1,this._inTaskLoad=!1,this._todoDefaultSet=!1}},{key:"firstUpdated",value:function(e){Ot(y(r.prototype),"firstUpdated",this).call(this,e),this.initialId&&!this._currentGroup&&(this.dataSource===Lh.planner?this._currentGroup=this.initialId:this.dataSource===Lh.todo&&(this._currentFolder=this.initialId)),this.dataSource===Lh.planner&&this.initialBucketId&&!this._currentFolder&&(this._currentFolder=this.initialBucketId)}},{key:"render",value:function(){var e=this,t=this._tasks.filter((function(t){return e.isTaskInSelectedGroupFilter(t)})).filter((function(t){return e.isTaskInSelectedFolderFilter(t)})).filter((function(t){return!e._hiddenTasks.includes(t.id)}));this.taskFilter&&(t=t.filter((function(t){return e.taskFilter(t._raw)})));var r,n=this._inTaskLoad&&!this._hasDoneInitialLoad?this.renderLoadingTask():null;return this.hideHeader||(r=en(Yf||(Yf=Bn(['\n        <div class="Header" dir=',">\n          ","\n        </div>\n      "])),this.direction,this.renderPlanOptions())),en(Xf||(Xf=Bn(["\n      ",'\n      <div class="Tasks" dir=',">\n        "," ","\n        ","\n      </div>\n    "])),r,this.direction,this._isNewTaskVisible?this.renderNewTask():null,n,Bs(t,(function(e){return e.id}),(function(t){return e.renderTask(t)})))}},{key:"loadState",value:function(){return zh(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getTaskSource()){e.next=3;break}return e.abrupt("return");case 3:if((r=Pn.globalProvider)&&r.state===Sn.SignedIn){e.next=6;break}return e.abrupt("return");case 6:if(this._inTaskLoad=!0,this._me||(o=r.graph.forComponent(this),n=ui(o)),!this.groupId||this.dataSource!==Lh.planner){e.next=13;break}return e.next=11,this._loadTasksForGroup(t);case 11:e.next=25;break;case 13:if(!this.targetId){e.next=23;break}if(this.dataSource!==Lh.todo){e.next=19;break}return e.next=17,this._loadTargetTodoTasks(t);case 17:e.next=21;break;case 19:return e.next=21,this._loadTargetPlannerTasks(t);case 21:e.next=25;break;case 23:return e.next=25,this._loadAllTasks(t);case 25:if(!n){e.next=29;break}return e.next=28,n;case 28:this._me=e.sent;case 29:this._inTaskLoad=!1,this._hasDoneInitialLoad=!0;case 31:case"end":return e.stop()}}),e,this)})))}},{key:"onResize",value:function(){this.mediaQuery!==this.previousMediaQuery&&(this.previousMediaQuery=this.mediaQuery,this.requestUpdate())}},{key:"_loadTargetTodoTasks",value:function(e){return zh(this,void 0,void 0,Ze().mark((function t(){var r,n,o;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTaskGroups();case 2:return r=t.sent,t.next=5,Promise.all(r.map((function(t){return e.getTaskFoldersForTaskGroup(t.id)})));case 5:return n=t.sent.reduce((function(e,t){return[].concat(d(e),d(t))}),[]),t.next=8,Promise.all(n.map((function(t){return e.getTasksForTaskFolder(t.id,t.parentId)})));case 8:o=t.sent.reduce((function(e,t){return[].concat(d(e),d(t))}),[]),this._tasks=o,this._folders=n,this._groups=r,this._currentGroup=null;case 13:case"end":return t.stop()}}),t,this)})))}},{key:"_loadTargetPlannerTasks",value:function(e){return zh(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i=this;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTaskGroup(this.targetId);case 2:return r=t.sent,t.next=5,e.getTaskFoldersForTaskGroup(r.id);case 5:return n=t.sent,this.targetBucketId&&(n=n.filter((function(e){return e.id===i.targetBucketId}))),t.next=9,Promise.all(n.map((function(t){return e.getTasksForTaskFolder(t.id,t.parentId)})));case 9:o=t.sent.reduce((function(e,t){return[].concat(d(e),d(t))}),[]),this._tasks=o,this._folders=n,this._groups=[r];case 13:case"end":return t.stop()}}),t,this)})))}},{key:"_loadAllTasks",value:function(e){return zh(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTaskGroups();case 2:return r=t.sent,t.next=5,Promise.all(r.map((function(t){return e.getTaskFoldersForTaskGroup(t.id)})));case 5:return n=t.sent.reduce((function(e,t){return[].concat(d(e),d(t))}),[]),this.initialId||this.dataSource!==Lh.todo||this._todoDefaultSet||(this._todoDefaultSet=!0,(o=n.find((function(e){return e._raw.isDefaultFolder})))&&(this._currentFolder=o.id)),t.next=9,Promise.all(n.map((function(t){return e.getTasksForTaskFolder(t.id,t.parentId)})));case 9:i=t.sent.reduce((function(e,t){return[].concat(d(e),d(t))}),[]),this._tasks=i,this._folders=n,this._groups=r;case 13:case"end":return t.stop()}}),t,this)})))}},{key:"_loadTasksForGroup",value:function(e){return zh(this,void 0,void 0,Ze().mark((function t(){var r,n,o;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTaskGroupsForGroup(this.groupId);case 2:return r=t.sent,t.next=5,Promise.all(r.map((function(t){return e.getTaskFoldersForTaskGroup(t.id)})));case 5:return n=t.sent.reduce((function(e,t){return[].concat(d(e),d(t))}),[]),t.next=8,Promise.all(n.map((function(t){return e.getTasksForTaskFolder(t.id,t.parentId)})));case 8:o=t.sent.reduce((function(e,t){return[].concat(d(e),d(t))}),[]),this._tasks=o,this._folders=n,this._groups=r;case 12:case"end":return t.stop()}}),t,this)})))}},{key:"addTask",value:function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return zh(this,void 0,void 0,Ze().mark((function i(){var a,s,c;return Ze().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=this.getTaskSource()){i.next=3;break}return i.abrupt("return");case 3:return s={assignments:o,dueDate:t,immediateParentId:n,name:e,topParentId:r},this._newTaskBeingAdded=!0,i.next=7,a.addTask(s);case 7:return c=i.sent,this.fireCustomEvent("taskAdded",c),i.next=11,this.requestStateUpdate();case 11:this._newTaskBeingAdded=!1,this.isNewTaskVisible=!1;case 13:case"end":return i.stop()}}),i,this)})))}},{key:"completeTask",value:function(e){return zh(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.getTaskSource()){t.next=3;break}return t.abrupt("return");case 3:return this._loadingTasks=[].concat(d(this._loadingTasks),[e.id]),t.next=6,r.setTaskComplete(e.id,e.eTag);case 6:return this.fireCustomEvent("taskChanged",e),t.next=9,this.requestStateUpdate();case 9:this._loadingTasks=this._loadingTasks.filter((function(t){return t!==e.id}));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"uncompleteTask",value:function(e){return zh(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.getTaskSource()){t.next=3;break}return t.abrupt("return");case 3:return this._loadingTasks=[].concat(d(this._loadingTasks),[e.id]),t.next=6,r.setTaskIncomplete(e.id,e.eTag);case 6:return this.fireCustomEvent("taskChanged",e),t.next=9,this.requestStateUpdate();case 9:this._loadingTasks=this._loadingTasks.filter((function(t){return t!==e.id}));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"removeTask",value:function(e){return zh(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.getTaskSource()){t.next=3;break}return t.abrupt("return");case 3:return this._hiddenTasks=[].concat(d(this._hiddenTasks),[e.id]),t.next=6,r.removeTask(e.id,e.eTag);case 6:return this.fireCustomEvent("taskRemoved",e),t.next=9,this.requestStateUpdate();case 9:this._hiddenTasks=this._hiddenTasks.filter((function(t){return t!==e.id}));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"assignPeople",value:function(e,t){return zh(this,void 0,void 0,Ze().mark((function r(){var n,o,i,a,s,c,l,u;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=this.getTaskSource()){r.next=3;break}return r.abrupt("return");case 3:if(o=[],e&&e.assignments&&(o=Object.keys(e.assignments).sort()),i=t.map((function(e){return e.id})),!(i.length===o.length&&i.sort().every((function(e,t){return e===o[t]})))){r.next=9;break}return r.abrupt("return");case 9:if(a={},0===t.length)for(s=0;s<o.length;s++)a[o[s]]=null;if(!t){r.next=29;break}c=0;case 13:if(!(c<o.length)){r.next=28;break}l=0;case 15:if(!(l<t.length)){r.next=25;break}if(o[c]===t[l].id){r.next=21;break}return a[o[c]]=null,r.abrupt("break",25);case 21:a[o[c]]=jh;case 22:l++,r.next=15;break;case 25:c++,r.next=13;break;case 28:for(u=0;u<t.length;u++)a[t[u].id]=jh;case 29:if(!e){r.next=36;break}return this._loadingTasks=[].concat(d(this._loadingTasks),[e.id]),r.next=33,n.assignPeopleToTask(e.id,a,e.eTag);case 33:return r.next=35,this.requestStateUpdate();case 35:this._loadingTasks=this._loadingTasks.filter((function(t){return t!==e.id}));case 36:case"end":return r.stop()}}),r,this)})))}},{key:"onAddTaskClick",value:function(e){var t=this.getPeoplePicker(null),r={};if(t){var n,o=S(t.selectedPeople);try{for(o.s();!(n=o.n()).done;){var i=n.value;t.selectedPeople.length&&(r[i.id]=jh)}}catch(a){o.e(a)}finally{o.f()}}!this._newTaskBeingAdded&&this._newTaskName&&(this._currentGroup||this._newTaskGroupId)&&this.addTask(this._newTaskName,this._newTaskDueDate,this._currentGroup?this._currentGroup:this._newTaskGroupId,this._currentFolder?this._currentFolder:this._newTaskFolderId,r)}},{key:"onAddTaskKeyDown",value:function(e){"Enter"===e.code&&this.onAddTaskClick}},{key:"newTaskButtonKeydown",value:function(e){"Enter"===e.code&&(this.isNewTaskVisible=!this.isNewTaskVisible)}},{key:"newTaskVisible",value:function(e){"Enter"===e.code&&(this.isNewTaskVisible=!1)}},{key:"renderPlanOptions",value:function(){var e=this,t=Pn.globalProvider;if(!t||t.state!==Sn.SignedIn)return null;if(this._inTaskLoad&&!this._hasDoneInitialLoad)return en(Zf||(Zf=Bn(['\n        <span class="LoadingHeader"></span>\n      '])));var r=this.readOnly||this._isNewTaskVisible?null:en($f||($f=Bn(['\n            <div\n              tabindex="0"\n              class="AddBarItem NewTaskButton"\n              @click="','"\n              @keydown="','"\n            >\n              <span class="TaskIcon">\ue710</span>\n              <span>',"</span>\n            </div>\n          "])),(function(){e.isNewTaskVisible=!e.isNewTaskVisible}),this.newTaskButtonKeydown,this.strings.addTaskButtonSubtitle);if(this.dataSource===Lh.planner){var n,o=this._groups.find((function(t){return t.id===e._currentGroup}))||{title:this.res.BASE_SELF_ASSIGNED},i=Je({},this.res.BASE_SELF_ASSIGNED,(function(t){e._currentGroup=null,e._currentFolder=null})),a=S(this._groups);try{var s=function(){var t=n.value;i[t.title]=function(r){e._currentGroup=t.id,e._currentFolder=null}};for(a.s();!(n=a.n()).done;)s()}catch(C){a.e(C)}finally{a.f()}var c,l=en(eh||(eh=Bn(['\n        <mgt-arrow-options .options="','" .value="','"></mgt-arrow-options>\n      '])),i,o.title),u=this._currentGroup?en(th||(th=Bn(['\n            <span class="TaskIcon Divider">/</span>\n          ']))):null,d=this._folders.find((function(t){return t.id===e._currentFolder}))||{name:this.res.BUCKETS_SELF_ASSIGNED},p=Je({},this.res.BUCKETS_SELF_ASSIGNED,(function(t){e._currentFolder=null})),f=S(this._folders.filter((function(t){return t.parentId===e._currentGroup})));try{var h=function(){var t=c.value;p[t.name]=function(r){e._currentFolder=t.id}};for(f.s();!(c=f.n()).done;)h()}catch(C){f.e(C)}finally{f.f()}var g=this.targetBucketId?en(rh||(rh=Bn(['\n            <span class="PlanTitle">\n              ',"\n            </span>\n          "])),this._folders[0]&&this._folders[0].name):en(nh||(nh=Bn(['\n            <mgt-arrow-options .options="','" .value="','"></mgt-arrow-options>\n          '])),p,d.name);return en(oh||(oh=Bn(['\n        <div class="TitleCont">\n          '," "," ","\n        </div>\n        ","\n      "])),l,u,this._currentGroup?g:null,r)}var v,m=this._folders.find((function(t){return t.id===e.targetId}))||{name:this.res.BUCKETS_SELF_ASSIGNED},b=this._folders.find((function(t){return t.id===e._currentFolder}))||{name:this.res.BUCKETS_SELF_ASSIGNED},y={},k=S(this._folders);try{var w=function(){var t=v.value;y[t.name]=function(){e._currentFolder=t.id}};for(k.s();!(v=k.n()).done;)w()}catch(C){k.e(C)}finally{k.f()}y[this.res.BUCKETS_SELF_ASSIGNED]=function(t){e._currentFolder=null};var x=this.targetId?en(ih||(ih=Bn(['\n            <span class="PlanTitle">\n              ',"\n            </span>\n          "])),m.name):en(ah||(ah=Bn(['\n            <mgt-arrow-options .value="','" .options="','"></mgt-arrow-options>\n          '])),b.name,y);return en(sh||(sh=Bn(['\n        <span class="TitleCont">\n          ',"\n        </span>\n        ","\n      "])),x,r)}},{key:"renderNewTask",value:function(){var e=this,t=en(ch||(ch=Bn(['\n      <input\n        type="text"\n        placeholder=','\n        .value="','"\n        label="new-taskName-input"\n        aria-label="new-taskName-input"\n        role="textbox"\n        @input="','"\n      />\n    '])),this.strings.newTaskPlaceholder,this._newTaskName,(function(t){e._newTaskName=t.target.value})),r=this._groups;r.length>0&&!this._newTaskGroupId&&(this._newTaskGroupId=r[0].id);var n=this.dataSource===Lh.todo?null:this._currentGroup?en(lh||(lh=Bn(['\n            <span class="NewTaskGroup">\n              ',"\n              <span>","</span>\n            </span>\n          "])),this.renderPlannerIcon(),this.getPlanTitle(this._currentGroup)):en(uh||(uh=Bn(['\n            <span class="NewTaskGroup">\n              ','\n              <select aria-label="new task group"\n                .value="','"\n                @change="','"\n              >\n                ',"\n              </select>\n            </span>\n          "])),this.renderPlannerIcon(),this._newTaskGroupId,(function(t){e._newTaskGroupId=t.target.value}),this._groups.map((function(e){return en(dh||(dh=Bn(['\n                    <option value="','">',"</option>\n                  "])),e.id,e.title)}))),o=this._folders.filter((function(t){return e._currentGroup&&t.parentId===e._currentGroup||!e._currentGroup&&t.parentId===e._newTaskGroupId}));o.length>0&&!this._newTaskFolderId&&(this._newTaskFolderId=o[0].id);var i=this._currentFolder?en(ph||(ph=Bn(['\n          <span class="NewTaskBucket">\n            ',"\n            <span>","</span>\n          </span>\n        "])),this.renderBucketIcon(),this.getFolderName(this._currentFolder)):en(fh||(fh=Bn(['\n          <span class="NewTaskBucket">\n            ','\n            <select aria-label="new task bucket"\n              .value="','"\n              @change="','"\n            >\n              ',"\n            </select>\n          </span>\n        "])),this.renderBucketIcon(),this._newTaskFolderId,(function(t){e._newTaskFolderId=t.target.value}),o.map((function(e){return en(hh||(hh=Bn(['\n                  <option value="','">',"</option>\n                "])),e.id,e.name)}))),a=en(gh||(gh=Bn(['\n      <span class="NewTaskDue">\n      ','\n        <input\n          type="date"\n          label="new-taskDate-input"\n          aria-label="new-taskDate-input"\n          role="textbox"\n          .value="','"\n          @change="','"\n        />\n      </span>\n    '])),this.renderCalendarIcon(),this.dateToInputValue(this._newTaskDueDate),(function(t){var r=t.target.value;e._newTaskDueDate=r?new Date(r+"T17:00"):null})),s=this.dataSource===Lh.todo?null:this.renderAssignedPeople(null),c=this._newTaskBeingAdded?en(vh||(vh=Bn(['\n          <div class="TaskAddButtonContainer"></div>\n        ']))):en(mh||(mh=Bn(['\n          <div class="TaskAddButtonContainer ','">\n            <div tabindex="0" class="TaskIcon TaskAdd"\n              @click="','"\n              @keydown="','">\n              <span>','</span>\n            </div>\n            <div tabindex="0" class="TaskIcon TaskCancel"\n              @click="','"\n              @keydown="','">\n              <span>',"</span>\n            </div>\n          </div>\n        "])),""===this._newTaskName?"Disabled":"",this.onAddTaskClick,this.onAddTaskKeyDown,this.strings.addTaskButtonSubtitle,(function(){return e.isNewTaskVisible=!1}),this.newTaskVisible,this.strings.cancelNewTaskSubtitle);return en(bh||(bh=Bn(['\n      <div class="Task NewTask Incomplete">\n        <div class="TaskContent">\n          <div class="TaskDetailsContainer">\n            <div class="TaskTitle">\n              ','\n            </div>\n            <div class="TaskDetails">\n              '," "," "," ","\n            </div>\n          </div>\n        </div>\n        ","\n      </div>\n    "])),t,n,i,a,s,c)}},{key:"togglePeoplePicker",value:function(e){var t=this.getPeoplePicker(e),r=this.getMgtPeople(e),n=this.getFlyout(e);t&&r&&n&&(n.isOpen?n.close():(t.selectedPeople=r.people,n.open(),window.requestAnimationFrame((function(){t.focus()}))))}},{key:"updateAssignedPeople",value:function(e){var t=this.getPeoplePicker(e),r=this.getMgtPeople(e);t&&t.selectedPeople!==r.people&&(r.people=t.selectedPeople,this.assignPeople(e,t.selectedPeople))}},{key:"getPeoplePicker",value:function(e){var t=e?e.id:"newTask";return this.renderRoot.querySelector(".picker-".concat(t))}},{key:"getMgtPeople",value:function(e){var t=e?e.id:"newTask";return this.renderRoot.querySelector(".people-".concat(t))}},{key:"getFlyout",value:function(e){var t=e?e.id:"newTask";return this.renderRoot.querySelector(".flyout-".concat(t))}},{key:"renderTask",value:function(e){var t=this,r=e.name,n=void 0===r?"Task":r,o=e.completed,i=void 0!==o&&o,a=e.dueDate,s=this._loadingTasks.includes(e.id),c={Complete:!s&&i,Loading:s,TaskCheck:!0,TaskIcon:!0},l=s?en(yh||(yh=Bn(["\n          \uf16a\n        "]))):i?en(kh||(kh=Bn(["\n          \ue73e\n        "]))):null,u=en(wh||(wh=Bn(['\n      <span tabindex="0" class=','><span class="TaskCheckContent">',"</span></span>\n    "])),Do(c),l),d=this._currentGroup?null:this.getPlanTitle(e.topParentId),p=this._currentFolder?null:this.getFolderName(e.immediateParentId),f={task:Object.assign(Object.assign({},e._raw),{groupTitle:d,folderTitle:p})},h=this.renderTemplate("task",f,e.id);if(h)return h;var g=this.renderTemplate("task-details",f,"task-details-".concat(e.id));if(!g){var v=this.dataSource===Lh.todo||this._currentGroup?null:en(xh||(xh=Bn(['\n              <div class="TaskDetail TaskGroup">\n                ',"\n                <span>","</span>\n              </div>\n            "])),this.renderPlannerIcon(),this.getPlanTitle(e.topParentId)),m=this._currentFolder?null:en(Ch||(Ch=Bn(['\n            <div class="TaskDetail TaskBucket">\n              ',"\n              <span>","</span>\n            </div>\n          "])),this.renderBucketIcon(),this.getFolderName(e.immediateParentId)),b=a?en(Th||(Th=Bn(['\n            <div class="TaskDetail TaskDue">\n              <span>Due ',"</span>\n            </div>\n          "])),Mo(a)):null,y=this.dataSource!==Lh.todo?this.renderAssignedPeople(e):null;g=en(_h||(_h=Bn(['\n        <div class="TaskTitle">\n          ',"\n        </div>\n        "," "," "," ","\n      "])),n,v,m,y,b)}var k=this.readOnly||this.hideOptions?null:en(Sh||(Sh=Bn(['\n            <div class="TaskOptions">\n              <mgt-dot-options\n                .options="','"\n              ></mgt-dot-options>\n            </div>\n          '])),Je({},this.strings.removeTaskSubtitle,(function(){return t.removeTask(e)})));return en(Ih||(Ih=Bn(["\n      <div\n        class=",'\n      >\n        <div\n          class="TaskContent"\n          @click=',"\n        >\n          <span\n            class=",'\n            @click="','"\n            @keydown="','"\n          >\n            ','\n          </span>\n          <div class="TaskDetailsContainer '," ",'">\n            ',"\n          </div>\n          ","\n\n        </div>\n      </div>\n    "])),Do({Complete:i,Incomplete:!i,ReadOnly:this.readOnly,Task:!0}),(function(){t.handleTaskClick(e)}),Do({Complete:i,Incomplete:!i,TaskCheckContainer:!0}),(function(r){t.readOnly||(e.completed?t.uncompleteTask(e):t.completeTask(e),r.stopPropagation(),r.preventDefault())}),(function(r){"Enter"===r.code&&(t.readOnly||(e.completed?t.uncompleteTask(e):t.completeTask(e),r.stopPropagation(),r.preventDefault()))}),u,this.mediaQuery,this._currentGroup?"NoPlan":"",g,k)}},{key:"renderAssignedPeople",value:function(e){var t,r=this,n={NewTaskAssignee:null===e,TaskAssignee:null!==e,TaskDetail:null!==e},o=e?Object.keys(e.assignments).map((function(e){return e})):[],i=en(Eh||(Eh=Bn(['\n      <template data-type="no-data">\n        <i class="login-icon ms-Icon ms-Icon--Contact"></i>\n      </template>\n    ']))),a=e?e.id:"newTask";return n["flyout-".concat(a)]=!0,t=en(Ah||(Ah=Bn(['\n      <mgt-people\n        class="people-','"\n        .userIds="','"\n        .personCardInteraction=',"\n        @click=","\n        @keydown=","\n        >","\n      </mgt-people>\n    "])),a,o,xa.none,(function(t){r.togglePeoplePicker(e),t.stopPropagation()}),(function(t){"Enter"===t.code&&(r.togglePeoplePicker(e),t.stopPropagation())}),i),en(Rh||(Rh=Bn(["\n      <mgt-flyout light-dismiss class="," @closed=",">\n        ",'\n        <div slot="flyout" class=','>\n          <mgt-people-picker\n            class="picker-','"\n            @click=',"\n            @keydown=","\n          ></mgt-people-picker>\n        </div>\n      </mgt-flyout>\n    "])),Do(n),(function(t){return r.updateAssignedPeople(e)}),t,Do({Picker:!0}),a,(function(e){return e.stopPropagation()}),(function(e){"Enter"===e.code&&e.stopPropagation()}))}},{key:"handleTaskClick",value:function(e){e&&this.fireCustomEvent("taskClick",{task:e._raw})}},{key:"renderLoadingTask",value:function(){return en(Ph||(Ph=Bn(['\n      <div class="Task LoadingTask">\n        <div class="TaskContent">\n          <div class="TaskCheckContainer">\n            <div class="TaskCheck"></div>\n          </div>\n          <div class="TaskDetailsContainer">\n            <div class="TaskTitle"></div>\n            <div class="TaskDetails">\n              <span class="TaskDetail">\n                <div class="TaskDetailIcon"></div>\n                <div class="TaskDetailName"></div>\n              </span>\n              <span class="TaskDetail">\n                <div class="TaskDetailIcon"></div>\n                <div class="TaskDetailName"></div>\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    '])))}},{key:"renderPlannerIcon",value:function(){return en(Oh||(Oh=Bn(['\n      <svg width="16" height="18" viewBox="0 0 16 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path\n          fill-rule="evenodd"\n          clip-rule="evenodd"\n          d="M7.223 1.156C6.98 1.26 6.769 1.404 6.586 1.586C6.403 1.768 6.261 1.98 6.157 2.223C6.052 2.465 6 2.724 6 3H2V17H14V3H10C10 2.724 9.948 2.465 9.844 2.223C9.74 1.98 9.596 1.768 9.414 1.586C9.231 1.404 9.02 1.26 8.777 1.156C8.535 1.053 8.276 1 8 1C7.723 1 7.465 1.053 7.223 1.156ZM5 4H7V3C7 2.86 7.026 2.729 7.078 2.609C7.13 2.49 7.202 2.385 7.293 2.293C7.384 2.202 7.49 2.131 7.609 2.079C7.73 2.026 7.859 2 8 2C8.14 2 8.271 2.026 8.39 2.079C8.511 2.131 8.616 2.202 8.707 2.293C8.798 2.385 8.87 2.49 8.922 2.609C8.974 2.729 9 2.86 9 3V4H11V5H5V4ZM12 6V4H13V16H3V4H4V6H12Z"\n          fill="#3C3C3C"\n        />\n        <path\n          fill-rule="evenodd"\n          clip-rule="evenodd"\n          d="M7.35156 12.3517L5.49956 14.2037L4.14856 12.8517L4.85156 12.1487L5.49956 12.7967L6.64856 11.6487L7.35156 12.3517Z"\n          fill="#3C3C3C"\n        />\n        <path\n          fill-rule="evenodd"\n          clip-rule="evenodd"\n          d="M7.35156 8.35168L5.49956 10.2037L4.14856 8.85168L4.85156 8.14868L5.49956 8.79668L6.64856 7.64868L7.35156 8.35168Z"\n          fill="#3C3C3C"\n        />\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 14H12.001V13H8V14Z" fill="#3C3C3C" />\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 10H12.001V9H8V10Z" fill="#3C3C3C" />\n      </svg>\n    '])))}},{key:"renderBucketIcon",value:function(){return en(Nh||(Nh=Bn(['\n      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path\n          fill-rule="evenodd"\n          clip-rule="evenodd"\n          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"\n          fill="#3C3C3C"\n        />\n      </svg>\n    '])))}},{key:"renderCalendarIcon",value:function(){return en(Dh||(Dh=Bn(['\n          <svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M5 11C5.55228 11 6 10.5523 6 10C6 9.44771 5.55228 9 5 9C4.44772 9 4 9.44771 4 10C4 10.5523 4.44772 11 5 11ZM6 13C6 13.5523 5.55228 14 5 14C4.44772 14 4 13.5523 4 13C4 12.4477 4.44772 12 5 12C5.55228 12 6 12.4477 6 13ZM8 11C8.55229 11 9 10.5523 9 10C9 9.44771 8.55229 9 8 9C7.44771 9 7 9.44771 7 10C7 10.5523 7.44771 11 8 11ZM9 13C9 13.5523 8.55229 14 8 14C7.44771 14 7 13.5523 7 13C7 12.4477 7.44771 12 8 12C8.55229 12 9 12.4477 9 13ZM11 11C11.5523 11 12 10.5523 12 10C12 9.44771 11.5523 9 11 9C10.4477 9 10 9.44771 10 10C10 10.5523 10.4477 11 11 11ZM15 5.5C15 4.11929 13.8807 3 12.5 3H3.5C2.11929 3 1 4.11929 1 5.5V14.5C1 15.8807 2.11929 17 3.5 17H12.5C13.8807 17 15 15.8807 15 14.5V5.5ZM2 7H14V14.5C14 15.3284 13.3284 16 12.5 16H3.5C2.67157 16 2 15.3284 2 14.5V7ZM3.5 4H12.5C13.3284 4 14 4.67157 14 5.5V6H2V5.5C2 4.67157 2.67157 4 3.5 4Z" fill="#717171"/>\n          </svg>\n        '])))}},{key:"getTaskSource",value:function(){var e=Pn.globalProvider;if(!e||e.state!==Sn.SignedIn)return null;var t=e.graph.forComponent(this);return this.dataSource===Lh.planner?new Ff(t):this.dataSource===Lh.todo?new zf(t):null}},{key:"getPlanTitle",value:function(e){return e?e===this.res.PLANS_SELF_ASSIGNED?this.res.PLANS_SELF_ASSIGNED:(this._groups.find((function(t){return t.id===e}))||{title:this.res.PLAN_NOT_FOUND}).title:this.res.BASE_SELF_ASSIGNED}},{key:"getFolderName",value:function(e){return e?(this._folders.find((function(t){return t.id===e}))||{name:this.res.BUCKET_NOT_FOUND}).name:this.res.BUCKETS_SELF_ASSIGNED}},{key:"isTaskInSelectedGroupFilter",value:function(e){return e.topParentId===this._currentGroup||!this._currentGroup&&this.getTaskSource().isAssignedToMe(e,this._me.id)}},{key:"isTaskInSelectedFolderFilter",value:function(e){return e.immediateParentId===this._currentFolder||!this._currentFolder}},{key:"dateToInputValue",value:function(e){return e?new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]:null}}],[{key:"styles",get:function(){return lf}},{key:"requiredScopes",get:function(){return d(new Set(["group.read.all","group.readwrite.all","tasks.read","tasks.readwrite"].concat(d(Ks.requiredScopes),d(Ku.requiredScopes))))}}]),r}(Jn);Uh([hn({attribute:"read-only",type:Boolean}),Fh("design:type",Boolean)],Gh.prototype,"readOnly",void 0),Uh([hn({attribute:"data-source",converter:function(e,t){return e=e.toLowerCase(),Lh[e]||Lh.planner}}),Fh("design:type",Number)],Gh.prototype,"dataSource",void 0),Uh([hn({attribute:"target-id",type:String}),Fh("design:type",String)],Gh.prototype,"targetId",void 0),Uh([hn({attribute:"target-bucket-id",type:String}),Fh("design:type",String)],Gh.prototype,"targetBucketId",void 0),Uh([hn({attribute:"initial-id",type:String}),Fh("design:type",String)],Gh.prototype,"initialId",void 0),Uh([hn({attribute:"initial-bucket-id",type:String}),Fh("design:type",String)],Gh.prototype,"initialBucketId",void 0),Uh([hn({attribute:"hide-header",type:Boolean}),Fh("design:type",Boolean)],Gh.prototype,"hideHeader",void 0),Uh([hn({attribute:"hide-options",type:Boolean}),Fh("design:type",Boolean)],Gh.prototype,"hideOptions",void 0),Uh([hn({attribute:"group-id",type:String}),Fh("design:type",String)],Gh.prototype,"groupId",void 0),Uh([hn(),Fh("design:type",Boolean)],Gh.prototype,"_isNewTaskVisible",void 0),Uh([hn(),Fh("design:type",Boolean)],Gh.prototype,"_newTaskBeingAdded",void 0),Uh([hn(),Fh("design:type",String)],Gh.prototype,"_newTaskName",void 0),Uh([hn(),Fh("design:type",Date)],Gh.prototype,"_newTaskDueDate",void 0),Uh([hn(),Fh("design:type",String)],Gh.prototype,"_newTaskGroupId",void 0),Uh([hn(),Fh("design:type",String)],Gh.prototype,"_newTaskFolderId",void 0),Uh([hn(),Fh("design:type",Array)],Gh.prototype,"_groups",void 0),Uh([hn(),Fh("design:type",Array)],Gh.prototype,"_folders",void 0),Uh([hn(),Fh("design:type",Array)],Gh.prototype,"_tasks",void 0),Uh([hn(),Fh("design:type",Array)],Gh.prototype,"_hiddenTasks",void 0),Uh([hn(),Fh("design:type",Array)],Gh.prototype,"_loadingTasks",void 0),Uh([hn(),Fh("design:type",Boolean)],Gh.prototype,"_inTaskLoad",void 0),Uh([hn(),Fh("design:type",Boolean)],Gh.prototype,"_hasDoneInitialLoad",void 0),Uh([hn(),Fh("design:type",Boolean)],Gh.prototype,"_todoDefaultSet",void 0),Uh([hn(),Fh("design:type",String)],Gh.prototype,"_currentGroup",void 0),Uh([hn(),Fh("design:type",String)],Gh.prototype,"_currentFolder",void 0),Gh=Uh([fn("mgt-tasks"),Fh("design:paramtypes",[])],Gh);var Vh=[xn(Hh||(Hh=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}:host{font-family:var(--default-font-family)}.root{position:relative}.root .input-wrapper{font-family:var(--default-font-family);display:flex;flex-wrap:wrap;align-items:center;padding:4px 10px;position:relative;background-color:var(--input-background-color,#fff);font-size:14px;color:var(--color-sub1,#323130);height:29px;line-height:19px;cursor:text;border-top:var(--input-border-top,var(--input-border,2px solid #605e5c));border-right:var(--input-border-right,var(--input-border,2px solid #605e5c));border-bottom:var(--input-border-bottom,var(--input-border,2px solid #605e5c));border-left:var(--input-border-left,var(--input-border,2px solid #605e5c))}.root .input-wrapper:hover{border-color:var(--input-border-color--hover,#323130)}.root .input-wrapper.focused{border-color:var(--input-border-color--focus,#0078d4)}.root .input-wrapper .selected-team{padding-right:10px;border:none;display:flex;position:relative;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;align-items:center;height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.root .input-wrapper .selected-team .arrow{margin-left:8px;margin-right:8px}.root .input-wrapper .selected-team .selected-team-name{font-weight:700}.root .input-wrapper .selected-team .search-wrapper{margin-left:12px;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .search-wrapper{overflow:hidden;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .hide-icon{display:none}.root .input-wrapper .team-chosen-input{display:inline-block;border:none;line-height:normal;outline:0;font-family:var(--default-font-family);font-style:normal;font-weight:400;font-size:14px;line-height:19px;background-color:transparent;color:var(--color-sub1,#323130);padding-left:5px}.root .input-wrapper .team-chosen-input::placeholder{color:var(--placeholder-color,#605e5c)}.root .input-wrapper .team-chosen-input[contenteditable]:empty::after{content:attr(data-placeholder);color:var(--placeholder-color,#605e5c)}.root .input-wrapper .search-icon{margin-top:1px;align-self:flex-start;font-family:FabricMDL2Icons;color:var(--accent-color,#0078d4);line-height:normal}.root .input-wrapper .input-search{height:19px}.root .input-wrapper .input-search-start{white-space:nowrap;line-height:normal;margin-inline-start:0;margin-inline-end:0}.root .input-wrapper::after{content:'';position:absolute;width:100%;height:90%;top:2px;right:2px;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}.root .close-icon{display:inline-block;position:absolute;right:10px;top:12px;line-height:normal;font-family:FabricMDL2Icons;cursor:pointer;color:var(--placeholder-color,#605e5c);background-color:var(--input-background-color,#fff)}.root .close-icon:hover{color:var(--color-sub1,#323130)}.root .dropdown{padding-top:5px;padding-bottom:11px;position:absolute;box-shadow:0 1.3289px 2.65781px rgba(180,180,180,.182),0 1.3289px 2.65781px rgba(68,68,68,.3);border-radius:8px;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));z-index:1;width:100%;text-align:left;list-style-type:none;font-family:var(--default-font-family);font-style:normal;font-weight:400;color:var(--color-sub1,#323130);display:none;max-height:346px;overflow-y:auto}.root .dropdown.visible{display:block}.root .dropdown .item .arrow svg{fill:var(--arrow-fill,#000)}.root .dropdown .item.list-team{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;display:flex;flex-direction:row;align-items:center;padding:5px 12px 6px 14px;margin:6px 4px 4px 4px;border-radius:4px;font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:16px;color:var(--color-sub1,#323130);flex-flow:nowrap;position:relative;overflow:hidden;white-space:nowrap;background-color:transparent}.root .dropdown .item.list-team:after{content:'';position:absolute;width:36px;height:100%;top:0;right:0;background-image:-webkit-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-moz-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-ms-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-o-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:linear-gradient(to left,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0))}.root .dropdown .item.list-team:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .item.list-team .arrow{margin-right:5px;margin-bottom:1px}.root .dropdown .item.selected{background-color:var(--dropdown-item-selected-background,#deecf9)}.root .dropdown .item.focused{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .channel-display{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;cursor:pointer;padding-left:21px;padding-right:10px}.root .dropdown .channel-display .showing{padding-left:10px;padding-top:4px;padding-bottom:4px}.root .dropdown .channel-display .showing .channel-name-text{font-size:14px;font-weight:400;color:var(--color-sub1,#323130);margin:0;padding:0}.root .dropdown .channel-display .showing .channel-name-text.highlight-search-text{font-weight:700}.root .dropdown .channel-display:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .loading-text,.root .dropdown .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;color:var(--color-sub1,#323130);line-height:19px;text-align:center}.root .dropdown .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}.root .dropdown .message-parent .loading-text{margin-top:3px;margin-left:9px;color:#0078d4}[dir=rtl] .input-wrapper::after{content:'';position:absolute;width:99%;height:90%;top:2px;left:0;background-image:linear-gradient(to left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}[dir=rtl] .search-wrapper{margin-right:0!important}[dir=rtl] .search-icon{margin-left:8px!important}[dir=rtl] .channel-display{padding:0 34px 0 10px!important}[dir=rtl] .close-icon{right:auto;left:10px}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}:host{font-family:var(--default-font-family)}.root{position:relative}.root .input-wrapper{font-family:var(--default-font-family);display:flex;flex-wrap:wrap;align-items:center;padding:4px 10px;position:relative;background-color:var(--input-background-color,#fff);font-size:14px;color:var(--color-sub1,#323130);height:29px;line-height:19px;cursor:text;border-top:var(--input-border-top,var(--input-border,2px solid #605e5c));border-right:var(--input-border-right,var(--input-border,2px solid #605e5c));border-bottom:var(--input-border-bottom,var(--input-border,2px solid #605e5c));border-left:var(--input-border-left,var(--input-border,2px solid #605e5c))}.root .input-wrapper:hover{border-color:var(--input-border-color--hover,#323130)}.root .input-wrapper.focused{border-color:var(--input-border-color--focus,#0078d4)}.root .input-wrapper .selected-team{padding-right:10px;border:none;display:flex;position:relative;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;align-items:center;height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.root .input-wrapper .selected-team .arrow{margin-left:8px;margin-right:8px}.root .input-wrapper .selected-team .selected-team-name{font-weight:700}.root .input-wrapper .selected-team .search-wrapper{margin-left:12px;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .search-wrapper{overflow:hidden;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .hide-icon{display:none}.root .input-wrapper .team-chosen-input{display:inline-block;border:none;line-height:normal;outline:0;font-family:var(--default-font-family);font-style:normal;font-weight:400;font-size:14px;line-height:19px;background-color:transparent;color:var(--color-sub1,#323130);padding-left:5px}.root .input-wrapper .team-chosen-input::placeholder{color:var(--placeholder-color,#605e5c)}.root .input-wrapper .team-chosen-input[contenteditable]:empty::after{content:attr(data-placeholder);color:var(--placeholder-color,#605e5c)}.root .input-wrapper .search-icon{margin-top:1px;align-self:flex-start;font-family:FabricMDL2Icons;color:var(--accent-color,#0078d4);line-height:normal}.root .input-wrapper .input-search{height:19px}.root .input-wrapper .input-search-start{white-space:nowrap;line-height:normal;margin-inline-start:0;margin-inline-end:0}.root .input-wrapper::after{content:'';position:absolute;width:100%;height:90%;top:2px;right:2px;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}.root .close-icon{display:inline-block;position:absolute;right:10px;top:12px;line-height:normal;font-family:FabricMDL2Icons;cursor:pointer;color:var(--placeholder-color,#605e5c);background-color:var(--input-background-color,#fff)}.root .close-icon:hover{color:var(--color-sub1,#323130)}.root .dropdown{padding-top:5px;padding-bottom:11px;position:absolute;box-shadow:0 1.3289px 2.65781px rgba(180,180,180,.182),0 1.3289px 2.65781px rgba(68,68,68,.3);border-radius:8px;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));z-index:1;width:100%;text-align:left;list-style-type:none;font-family:var(--default-font-family);font-style:normal;font-weight:400;color:var(--color-sub1,#323130);display:none;max-height:346px;overflow-y:auto}.root .dropdown.visible{display:block}.root .dropdown .item .arrow svg{fill:var(--arrow-fill,#000)}.root .dropdown .item.list-team{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;display:flex;flex-direction:row;align-items:center;padding:5px 12px 6px 14px;margin:6px 4px 4px 4px;border-radius:4px;font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:16px;color:var(--color-sub1,#323130);flex-flow:nowrap;position:relative;overflow:hidden;white-space:nowrap;background-color:transparent}.root .dropdown .item.list-team:after{content:'';position:absolute;width:36px;height:100%;top:0;right:0;background-image:-webkit-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-moz-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-ms-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-o-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:linear-gradient(to left,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0))}.root .dropdown .item.list-team:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .item.list-team .arrow{margin-right:5px;margin-bottom:1px}.root .dropdown .item.selected{background-color:var(--dropdown-item-selected-background,#deecf9)}.root .dropdown .item.focused{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .channel-display{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;cursor:pointer;padding-left:21px;padding-right:10px}.root .dropdown .channel-display .showing{padding-left:10px;padding-top:4px;padding-bottom:4px}.root .dropdown .channel-display .showing .channel-name-text{font-size:14px;font-weight:400;color:var(--color-sub1,#323130);margin:0;padding:0}.root .dropdown .channel-display .showing .channel-name-text.highlight-search-text{font-weight:700}.root .dropdown .channel-display:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .loading-text,.root .dropdown .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;color:var(--color-sub1,#323130);line-height:19px;text-align:center}.root .dropdown .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}.root .dropdown .message-parent .loading-text{margin-top:3px;margin-left:9px;color:#0078d4}[dir=rtl] .input-wrapper::after{content:'';position:absolute;width:99%;height:90%;top:2px;left:0;background-image:linear-gradient(to left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}[dir=rtl] .search-wrapper{margin-right:0!important}[dir=rtl] .search-icon{margin-left:8px!important}[dir=rtl] .channel-display{padding:0 34px 0 10px!important}[dir=rtl] .close-icon{right:auto;left:10px}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n"])))],Kh=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Qh(e){return Kh(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"team.readbasic.all",t.next=3,e.api("/me/joinedTeams").select(["displayName","id","isArchived"]).middlewareOptions($t("team.readbasic.all")).get();case 3:return r=t.sent,t.abrupt("return",r?r.value:null);case 5:case"end":return t.stop()}}),t)})))}var Wh,Jh,Yh,Xh,Zh,$h,eg,tg,rg,ng,og,ig,ag,sg,cg={inputPlaceholderText:"Select a channel",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading..."},lg=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ug=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},dg=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},pg=sg=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this))._inputValue="",e._isFocused=!1,e._treeViewState=[],e._focusList=[],e._focusedIndex=-1,e.handleWindowClick=e.handleWindowClick.bind(w(e)),e.addEventListener("keydown",(function(t){return e.onUserKeyDown(t)})),e.addEventListener("focus",(function(t){return e.loadTeamsIfNotLoaded()})),e.addEventListener("mouseover",(function(t){return e.loadTeamsIfNotLoaded()})),e}return v(r,[{key:"strings",get:function(){return cg}},{key:"selectedItem",get:function(){return this._selectedItemState?{channel:this._selectedItemState.item,team:this._selectedItemState.parent.item}:null}},{key:"items",get:function(){return this._items},set:function(e){this._items!==e&&(this._items=e,this._treeViewState=e?this.generateTreeViewState(e):[],this.resetFocusState())}},{key:"_input",get:function(){return this.renderRoot.querySelector(".team-chosen-input")}},{key:"connectedCallback",value:function(){Ot(y(r.prototype),"connectedCallback",this).call(this),window.addEventListener("click",this.handleWindowClick)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("click",this.handleWindowClick),Ot(y(r.prototype),"disconnectedCallback",this).call(this)}},{key:"selectChannelById",value:function(e){return dg(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i,a,s,c;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=Pn.globalProvider)||r.state!==Sn.SignedIn){t.next=38;break}if(this.items){t.next=5;break}return t.next=5,this.requestStateUpdate();case 5:n=S(this._treeViewState),t.prev=6,n.s();case 8:if((o=n.n()).done){t.next=30;break}i=o.value,a=S(i.channels),t.prev=11,a.s();case 13:if((s=a.n()).done){t.next=20;break}if((c=s.value).item.id!==e){t.next=18;break}return this.selectChannel(c),t.abrupt("return",!0);case 18:t.next=13;break;case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(11),a.e(t.t0);case 25:return t.prev=25,a.f(),t.finish(25);case 28:t.next=8;break;case 30:t.next=35;break;case 32:t.prev=32,t.t1=t.catch(6),n.e(t.t1);case 35:return t.prev=35,n.f(),t.finish(35);case 38:return t.abrupt("return",!1);case 39:case"end":return t.stop()}}),t,this,[[6,32,35,38],[11,22,25,28]])})))}},{key:"render",value:function(){var e={focused:this._isFocused,"input-wrapper":!0},t=(this._isFocused&&this._selectedItemState,{dropdown:!0,visible:this._isDropdownVisible}),r={"hide-icon":!!this._selectedItemState,"search-wrapper":!0};return this.renderTemplate("default",{teams:this.items})||en(Wh||(Wh=Bn(['\n        <div class="root" @blur='," dir=",">\n          <div class="," @click=",">\n            ","\n            <div class=",">"," ","</div>\n          </div>\n          ","\n          <div class=",">","</div>\n        </div>\n      "])),this.lostFocus,this.direction,Do(e),this.gainedFocus,this.renderSelected(),Do(r),this.renderSearchIcon(),this.renderInput(),this.renderCloseButton(),Do(t),this.renderDropdown())}},{key:"renderSelected",value:function(){return this._selectedItemState?en(Yh||(Yh=Bn(['\n      <li class="selected-team" title=','>\n        <div class="selected-team-name">','</div>\n        <div class="arrow">',"</div>\n        ",'\n        <div class="search-wrapper">'," ","</div>\n      </li>\n    "])),this._selectedItemState.item.displayName,this._selectedItemState.parent.item.displayName,va(pa.TeamSeparator,"#B3B0AD"),this._selectedItemState.item.displayName,this.renderSearchIcon(),this.renderInput()):en(Jh||(Jh=Bn([""])))}},{key:"clearState",value:function(){this._items=[],this._inputValue="",this._treeViewState=[],this._focusList=[]}},{key:"renderSearchIcon",value:function(){return en(Xh||(Xh=Bn(['\n      <div class="search-icon">\n        ',"\n      </div>\n    "])),va(pa.Search,"#252424"))}},{key:"renderInput",value:function(){var e=this,t={"input-search":!!this._selectedItemState,"input-search-start":!this._selectedItemState};return en(Zh||(Zh=Bn(['\n      <div class="','">\n        <span\n          id="teams-channel-picker-input"\n          class="team-chosen-input"\n          type="text"\n          label="teams-channel-picker-input"\n          aria-label="Select a channel"\n          data-placeholder="',' "\n          role="searchbox"\n          @keyup=',"\n          contenteditable\n        ></span>\n      </div>\n    "])),Do(t),this._selectedItemState?"":this.strings.inputPlaceholderText,(function(t){return e.handleInputChanged(t)}))}},{key:"renderCloseButton",value:function(){var e=this;return en($h||($h=Bn(['\n      <div tabindex="0" class="close-icon"\n        @keydown="','"\n        @click="','"> \ue711\n      </div>\n    '])),(function(){return e.selectChannel(null)}),(function(){return e.selectChannel(null)}))}},{key:"renderDropdown",value:function(){return this.isLoadingState||!this._treeViewState?this.renderLoading():this._treeViewState?!this.isLoadingState&&0===this._treeViewState.length&&this._inputValue.length>0?this.renderError():this.renderDropdownList(this._treeViewState):en(eg||(eg=Bn([""])))}},{key:"renderDropdownList",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e&&e.length?e.map((function(e,n){var o=!!e.channels&&e.isExpanded;return en(tg||(tg=Bn(["\n          ","\n          ","\n        "])),t.renderItem(e),o?t.renderDropdownList(e.channels,r+1):en(rg||(rg=Bn([""]))))})):null}},{key:"renderItem",value:function(e){var t=this,r=null;e.channels&&(r=e.isExpanded?va(pa.ArrowDown,"#252424"):va(pa.ArrowRight,"#252424"));var n=!1;this.selectedItem&&this.selectedItem.channel===e.item&&(n=!0);var o={focused:this._focusList[this._focusedIndex]===e,item:!0,"list-team":!!e.channels,selected:n},i=this.renderRoot.querySelector(".dropdown");return i.children[this._focusedIndex]&&i.children[this._focusedIndex].scrollIntoView(!1),en(ng||(ng=Bn(["\n      <div @click=",' class="','">\n        <div class="arrow">\n          ',"\n        </div>\n        ","\n      </div>\n    "])),(function(){return t.handleItemClick(e)}),Do(o),r,e.channels?e.item.displayName:this.renderHighlightedText(e.item))}},{key:"renderHighlightedText",value:function(e){var t={},r=e.displayName.toLowerCase().indexOf(this._inputValue.toLowerCase());return-1!==r?0===r?(t.first="",t.highlight=e.displayName.slice(0,this._inputValue.length),t.last=e.displayName.slice(this._inputValue.length,e.displayName.length)):r===e.displayName.length?(t.first=e.displayName.slice(0,r),t.highlight=e.displayName.slice(r,e.displayName.length),t.last=""):(t.first=e.displayName.slice(0,r),t.highlight=e.displayName.slice(r,r+this._inputValue.length),t.last=e.displayName.slice(r+this._inputValue.length,e.displayName.length)):t.last=e.displayName,en(og||(og=Bn(['\n      <div class="channel-display">\n        <div class="showing">\n          <span class="channel-name-text">','</span\n          ><span class="channel-name-text highlight-search-text">','</span\n          ><span class="channel-name-text">',"</span>\n        </div>\n      </div>\n    "])),t.first,t.highlight,t.last)}},{key:"renderError",value:function(){return this.renderTemplate("error",null,"error")||en(ig||(ig=Bn(['\n        <div class="message-parent">\n          <div label="search-error-text" aria-label="We didn\'t find any matches." class="search-error-text">\n            ',"\n          </div>\n        </div>\n      "])),this.strings.noResultsFound)}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null,"loading")||en(ag||(ag=Bn(['\n        <div class="message-parent">\n          <mgt-spinner></mgt-spinner>\n          <div label="loading-text" aria-label="loading" class="loading-text">\n            ',"\n          </div>\n        </div>\n      "])),this.strings.loadingMessage)}},{key:"loadState",value:function(){return dg(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a,s,c,l,u,p,f,h;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=Pn.globalProvider)||t.state!==Sn.SignedIn){e.next=21;break}return n=t.graph.forComponent(this),e.next=5,t.getAccessTokenForScopes.apply(t,d(sg.requiredScopes));case 5:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,Qh(n);case 9:r=(r=e.sent).filter((function(e){return!e.isArchived})),o=n.createBatch(),i=["team.readbasic.all"],a=S(r);try{for(a.s();!(s=a.n()).done;)c=s.value,o.get(c.id,"teams/".concat(c.id,"/channels"),i)}catch(g){a.e(g)}finally{a.f()}return e.next=17,o.executeAll();case 17:l=e.sent,u=S(r);try{for(u.s();!(p=u.n()).done;)f=p.value,(h=l.get(f.id))&&h.content&&h.content.value&&(f.channels=h.content.value.map((function(e){return{item:e}})))}catch(g){u.e(g)}finally{u.f()}this.items=r.map((function(e){return{channels:e.channels,item:e}}));case 21:this.filterList(),this.resetFocusState();case 23:case"end":return e.stop()}}),e,this)})))}},{key:"handleItemClick",value:function(e){e.channels?e.isExpanded=!e.isExpanded:this.selectChannel(e),this._focusedIndex=-1,this.resetFocusState()}},{key:"handleInputChanged",value:function(e){var t=this;this._inputValue!==e.target.textContent&&(this._inputValue=e.target.textContent,this.gainedFocus(),this.debouncedSearch||(this.debouncedSearch=Uo((function(){t.filterList()}),400)),this.debouncedSearch())}},{key:"filterList",value:function(){this.items&&(this._treeViewState=this.generateTreeViewState(this.items,this._inputValue),this._focusedIndex=-1,this.resetFocusState())}},{key:"generateTreeViewState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=[];if(t=t.toLowerCase(),e){var o,i=S(e);try{for(i.s();!(o=i.n()).done;){var a=o.value,s=void 0;if(0===t.length||a.item.displayName.toLowerCase().includes(t))s={item:a.item,parent:r},a.channels&&(s.channels=this.generateTreeViewState(a.channels,"",s),s.isExpanded=t.length>0);else if(a.channels){var c={item:a.item,parent:r},l=this.generateTreeViewState(a.channels,t,c);l.length>0&&((s=c).channels=l,s.isExpanded=!0)}s&&n.push(s)}}catch(u){i.e(u)}finally{i.f()}}return n}},{key:"generateFocusList",value:function(e){if(!e||0===e.length)return[];var t,r=[],n=S(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;r.push(o),o.channels&&o.isExpanded&&(r=[].concat(d(r),d(this.generateFocusList(o.channels))))}}catch(i){n.e(i)}finally{n.f()}return r}},{key:"resetFocusState",value:function(){this._focusList=this.generateFocusList(this._treeViewState),this.requestUpdate()}},{key:"loadTeamsIfNotLoaded",value:function(){this.items||this.isLoadingState||this.requestStateUpdate()}},{key:"handleWindowClick",value:function(e){e.target!==this&&this.lostFocus()}},{key:"onUserKeyDown",value:function(e){if(13===e.keyCode&&e.preventDefault(),0!==this._treeViewState.length){var t=this._focusList[this._focusedIndex];switch(e.keyCode){case 40:this._focusedIndex=(this._focusedIndex+1)%this._focusList.length,this.requestUpdate(),e.preventDefault();break;case 38:-1===this._focusedIndex&&(this._focusedIndex=this._focusList.length),this._focusedIndex=(this._focusedIndex-1+this._focusList.length)%this._focusList.length,this.requestUpdate(),e.preventDefault();break;case 39:t&&t.channels&&!t.isExpanded&&(t.isExpanded=!0,this.resetFocusState(),e.preventDefault());break;case 37:t&&t.channels&&t.isExpanded&&(t.isExpanded=!1,this.resetFocusState(),e.preventDefault());break;case 9:if(!t){this.lostFocus();break}case 13:t&&t.channels?(t.isExpanded=!t.isExpanded,this.resetFocusState(),e.preventDefault()):t&&!t.channels&&(this.selectChannel(t),this.resetFocusState(),this._focusedIndex=-1,e.preventDefault());break;case 8:0===this._inputValue.length&&this._selectedItemState&&(this.selectChannel(null),e.preventDefault());break;case 27:this.selectChannel(this._selectedItemState),this._focusedIndex=-1,this.resetFocusState(),e.preventDefault()}}}},{key:"gainedFocus",value:function(){this._isFocused=!0;var e=this._input;e&&e.focus(),this._isDropdownVisible=!0}},{key:"lostFocus",value:function(){this._isFocused=!1;var e=this._input;e&&(e.textContent=this._inputValue=""),this._isDropdownVisible=!1,this.filterList()}},{key:"selectChannel",value:function(e){this._selectedItemState!==e&&(this._selectedItemState=e,this.fireCustomEvent("selectionChanged",e?[this.selectedItem]:[]));var t=this._input;t&&(t.textContent=this._inputValue=""),this.requestUpdate(),this.lostFocus()}}],[{key:"styles",get:function(){return Vh}},{key:"config",get:function(){return this._config}},{key:"requiredScopes",get:function(){return this.config.useTeamsBasedScopes?["team.readbasic.all","channel.readbasic.all"]:["user.read.all","group.read.all"]}}]),r}(Jn);pg._config={useTeamsBasedScopes:!1},lg([hn({attribute:!1}),ug("design:type",Object)],pg.prototype,"_isDropdownVisible",void 0),pg=sg=lg([fn("mgt-teams-channel-picker"),ug("design:paramtypes",[])],pg);var fg,hg,gg,vg,mg,bg,yg,kg,wg,xg={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"},Cg=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Tg=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},_g=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Sg=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this)).clearState(),e._previousMediaQuery=e.mediaQuery,e.onResize=e.onResize.bind(w(e)),e}return v(r,[{key:"newTaskName",get:function(){return this._newTaskName}},{key:"strings",get:function(){return xg}},{key:"attributeChangedCallback",value:function(e,t,n){switch(Ot(y(r.prototype),"attributeChangedCallback",this).call(this,e,t,n),e){case"target-id":case"initial-id":this.clearState(),this.requestStateUpdate()}}},{key:"connectedCallback",value:function(){Ot(y(r.prototype),"connectedCallback",this).call(this),window.addEventListener("resize",this.onResize)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("resize",this.onResize),Ot(y(r.prototype),"disconnectedCallback",this).call(this)}},{key:"render",value:function(){var e=Pn.globalProvider;if(!e||e.state!==Sn.SignedIn)return en(fg||(fg=Bn([""])));if(this.isLoadingState)return this.renderLoadingTask();var t=this.hideHeader?null:this.renderHeader(),r=this._isNewTaskVisible?this.renderNewTaskPanel():null,n=this.isLoadingState?this.renderLoadingTask():this.renderTasks();return en(hg||(hg=Bn(["\n      "," ",'\n      <div class="Tasks" dir=',">\n        ","\n      </div>\n    "])),t,r,this.direction,n)}},{key:"renderHeader",value:function(){var e=this,t=this.renderHeaderContent(),r=Do({AddBarItem:!0,NewTaskButton:!0,hidden:this.readOnly||this._isNewTaskVisible});return en(gg||(gg=Bn(['\n      <div class="Header" dir=',">\n        ",'\n        <button class="','" @click="','">\n          <span class="TaskIcon">\ue710</span>\n          <span>',"</span>\n        </button>\n      </div>\n    "])),this.direction,t,r,(function(){return e.showNewTaskPanel()}),this.strings.addTaskButtonSubtitle)}},{key:"renderLoadingTask",value:function(){return en(vg||(vg=Bn(['\n      <div class="Task LoadingTask">\n        <div class="TaskContent">\n          <div class="TaskCheckContainer">\n            <div class="TaskCheck"></div>\n          </div>\n          <div class="TaskDetailsContainer">\n            <div class="TaskTitle"></div>\n            <div class="TaskDetails">\n              <span class="TaskDetail">\n                <div class="TaskDetailIcon"></div>\n                <div class="TaskDetailName"></div>\n              </span>\n              <span class="TaskDetail">\n                <div class="TaskDetailIcon"></div>\n                <div class="TaskDetailName"></div>\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    '])))}},{key:"renderNewTaskPanel",value:function(){var e=this,t=this._newTaskName,r=en(mg||(mg=Bn(['\n      <input\n        type="text"\n        placeholder="','"\n        .value="','"\n        label="new-taskName-input"\n        aria-label="new-taskName-input"\n        role="textbox"\n        @input="','"\n      />\n    '])),this.strings.newTaskPlaceholder,t,(function(t){e._newTaskName=t.target.value,e.requestUpdate()})),n=Do({Disabled:!this._isNewTaskBeingAdded&&(!t||!t.length),TaskAddButtonContainer:!0}),o=this._isNewTaskBeingAdded?null:en(bg||(bg=Bn(['\n          <div\n            tabindex=\'0\'\n            class="TaskIcon TaskAdd"\n            @click="','"\n            @keypress="','"\n          >\n          <span>',"</span>\n          </div>\n          <div\n            role='button'\n            tabindex='0'\n            class=\"TaskIcon TaskCancel\"\n            @click=\"",'"\n            @keypress="','">\n            <span>',"</span>\n          </div>\n        "])),(function(){return e.addTask()}),(function(t){"Enter"!==t.key&&" "!==t.key||e.addTask()}),this.strings.addTaskButtonSubtitle,(function(){return e.hideNewTaskPanel()}),(function(t){"Enter"!==t.key&&" "!==t.key||e.hideNewTaskPanel()}),this.strings.cancelNewTaskSubtitle),i=this.renderNewTaskDetails();return en(yg||(yg=Bn(["\n      <div dir=",' class="Task NewTask Incomplete">\n        <div class="TaskContent">\n          <div class="TaskDetailsContainer">\n            <div class="TaskTitle">\n              ','\n            </div>\n            <div class="TaskDetails">\n              ','\n            </div>\n          </div>\n        </div>\n        <div class="','">\n          ',"\n        </div>\n      </div>\n    "])),this.direction,r,i,n,o)}},{key:"renderBucketIcon",value:function(){return en(kg||(kg=Bn(['\n      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path\n          fill-rule="evenodd"\n          clip-rule="evenodd"\n          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"\n          fill="#3C3C3C"\n        />\n      </svg>\n    '])))}},{key:"renderCalendarIcon",value:function(){return en(wg||(wg=Bn(['\n        <svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M5 11C5.55228 11 6 10.5523 6 10C6 9.44771 5.55228 9 5 9C4.44772 9 4 9.44771 4 10C4 10.5523 4.44772 11 5 11ZM6 13C6 13.5523 5.55228 14 5 14C4.44772 14 4 13.5523 4 13C4 12.4477 4.44772 12 5 12C5.55228 12 6 12.4477 6 13ZM8 11C8.55229 11 9 10.5523 9 10C9 9.44771 8.55229 9 8 9C7.44771 9 7 9.44771 7 10C7 10.5523 7.44771 11 8 11ZM9 13C9 13.5523 8.55229 14 8 14C7.44771 14 7 13.5523 7 13C7 12.4477 7.44771 12 8 12C8.55229 12 9 12.4477 9 13ZM11 11C11.5523 11 12 10.5523 12 10C12 9.44771 11.5523 9 11 9C10.4477 9 10 9.44771 10 10C10 10.5523 10.4477 11 11 11ZM15 5.5C15 4.11929 13.8807 3 12.5 3H3.5C2.11929 3 1 4.11929 1 5.5V14.5C1 15.8807 2.11929 17 3.5 17H12.5C13.8807 17 15 15.8807 15 14.5V5.5ZM2 7H14V14.5C14 15.3284 13.3284 16 12.5 16H3.5C2.67157 16 2 15.3284 2 14.5V7ZM3.5 4H12.5C13.3284 4 14 4.67157 14 5.5V6H2V5.5C2 4.67157 2.67157 4 3.5 4Z" fill="#717171"/>\n        </svg>\n      '])))}},{key:"addTask",value:function(){return _g(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isNewTaskBeingAdded&&this.newTaskName){e.next=2;break}return e.abrupt("return");case 2:return this._isNewTaskBeingAdded=!0,e.next=5,this.requestUpdate();case 5:return e.prev=5,e.next=8,this.createNewTask();case 8:return e.prev=8,this._isNewTaskBeingAdded=!1,this._isNewTaskVisible=!1,this.requestUpdate(),e.finish(8);case 13:case"end":return e.stop()}}),e,this,[[5,,8,13]])})))}},{key:"clearNewTaskData",value:function(){this._newTaskName=""}},{key:"clearState",value:function(){this.clearNewTaskData(),this._isNewTaskVisible=!1,this.requestUpdate()}},{key:"handleTaskClick",value:function(e,t){this.fireCustomEvent("taskClick",{task:t})}},{key:"dateToInputValue",value:function(e){return e?new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]:null}},{key:"showNewTaskPanel",value:function(){this._isNewTaskVisible=!0,this.requestUpdate()}},{key:"hideNewTaskPanel",value:function(){this._isNewTaskVisible=!1,this.clearNewTaskData(),this.requestUpdate()}},{key:"onResize",value:function(){this.mediaQuery!==this._previousMediaQuery&&(this._previousMediaQuery=this.mediaQuery,this.requestUpdate())}}]),r}(Jn);Cg([hn({attribute:"read-only",type:Boolean}),Tg("design:type",Boolean)],Sg.prototype,"readOnly",void 0),Cg([hn({attribute:"hide-header",type:Boolean}),Tg("design:type",Boolean)],Sg.prototype,"hideHeader",void 0),Cg([hn({attribute:"hide-options",type:Boolean}),Tg("design:type",Boolean)],Sg.prototype,"hideOptions",void 0),Cg([hn({attribute:"target-id",type:String}),Tg("design:type",String)],Sg.prototype,"targetId",void 0),Cg([hn({attribute:"initial-id",type:String}),Tg("design:type",String)],Sg.prototype,"initialId",void 0);var Ig,Eg,Ag,Rg,Pg=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Og(e,t){return Pg(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api("/me/todo/lists/".concat(t,"/tasks")).header("Cache-Control","no-store").middlewareOptions($t("Tasks.Read")).get();case 2:return n=r.sent,r.abrupt("return",n&&n.value);case 4:case"end":return r.stop()}}),r)})))}function Ng(e){return Pg(this,void 0,void 0,Ze().mark((function t(){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.api("/me/todo/lists").header("Cache-Control","no-store").middlewareOptions($t("Tasks.Read")).get();case 2:return r=t.sent,t.abrupt("return",r&&r.value);case 4:case"end":return t.stop()}}),t)})))}function Dg(e,t){return Pg(this,void 0,void 0,Ze().mark((function r(){var n;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api("/me/todo/lists/".concat(t)).header("Cache-Control","no-store").middlewareOptions($t("Tasks.Read")).get();case 2:return n=r.sent,r.abrupt("return",n);case 4:case"end":return r.stop()}}),r)})))}function Lg(e,t,r){return Pg(this,void 0,void 0,Ze().mark((function n(){var o;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.api("/me/todo/lists/".concat(t,"/tasks")).header("Cache-Control","no-store").middlewareOptions($t("Tasks.ReadWrite")).post(r);case 2:return o=n.sent,n.abrupt("return",o);case 4:case"end":return n.stop()}}),n)})))}function Mg(e,t,r){return Pg(this,void 0,void 0,Ze().mark((function n(){return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.api("/me/todo/lists/".concat(t,"/tasks/").concat(r)).header("Cache-Control","no-store").middlewareOptions($t("Tasks.ReadWrite")).delete();case 2:case"end":return n.stop()}}),n)})))}function Ug(e,t,r,n){return Pg(this,void 0,void 0,Ze().mark((function o(){var i;return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.api("/me/todo/lists/".concat(t,"/tasks/").concat(r)).header("Cache-Control","no-store").middlewareOptions($t("Tasks.ReadWrite")).patch(n);case 2:return i=o.sent,o.abrupt("return",i);case 4:case"end":return o.stop()}}),o)})))}!function(e){e[e.notStarted=0]="notStarted",e[e.inProgress=1]="inProgress",e[e.completed=2]="completed",e[e.deferred=3]="deferred",e[e.waitingOnOthers=4]="waitingOnOthers"}(Ig||(Ig={})),function(e){e[e.low=0]="low",e[e.normal=1]="normal",e[e.high=2]="high"}(Eg||(Eg={})),function(e){e[e.none=0]="none",e[e.default=1]="default",e[e.flaggedEmails=2]="flaggedEmails",e[e.unknownFutureValue=3]="unknownFutureValue"}(Ag||(Ag={}));var Fg,zg,Hg,Bg,qg,jg,Gg,Vg,Kg,Qg,Wg,Jg,Yg,Xg,Zg,$g,ev=[xn(Rg||(Rg=Bn(["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\E70D'}.ms-Icon--ChevronUp::before{content:'\\E70E'}.ms-Icon--Contact::before{content:'\\E77B'}.ms-Icon--AddFriend::before{content:'\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;-webkit-appearance:none}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, \"Segoe UI\");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, \"Segoe UI\");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,1px solid #e1dfdd);border-radius:8px}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#717171));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle;color:var(--color-sub2,#717171)}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .ReadOnly.Task .TaskCheckContainer{cursor:default}:host .Complete.Task{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Complete.Task .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .NewTask.Task{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .NewTask.Task .SelfAssign{display:none}:host .NewTask.Task .AssignTo{border:0;background:0 0}:host .NewTask.Task .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .NewTask.Task .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\ue739'}:host .NewTask.Task .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\ue73a'}:host .NewTask.Task .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .NewTask.Task .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle{display:flex;height:32px;padding:2px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, \"Segoe UI\");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .NewTask.Task .TaskAddButtonContainer{margin-right:28px}:host .NewTask.Task .TaskAddButtonContainer .TaskAdd,:host .NewTask.Task .TaskAddButtonContainer .TaskCancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-family:var(--default-font-family, \"Segoe UI\");font-size:14px;line-height:20px}:host .NewTask.Task .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .NewTask.Task .TaskAddButtonContainer .TaskCancel{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130))}:host .NewTask.Task .TaskAddButtonContainer.Disabled .TaskAdd{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}:host .LoadingTask.Task .TaskCheckContainer{cursor:default}:host .LoadingTask.Task .TaskDetails{display:flex}:host .LoadingTask.Task .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .LoadingTask.Task .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .LoadingTask.Task .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .LoadingTask.Task .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .LoadingTask.Task .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px}:host .Task{border:none}\n"],["\n:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\\\\E70E'}.ms-Icon--Contact::before{content:'\\\\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;-webkit-appearance:none}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, \"Segoe UI\");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, \"Segoe UI\");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,1px solid #e1dfdd);border-radius:8px}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#717171));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle;color:var(--color-sub2,#717171)}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .ReadOnly.Task .TaskCheckContainer{cursor:default}:host .Complete.Task{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Complete.Task .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .NewTask.Task{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .NewTask.Task .SelfAssign{display:none}:host .NewTask.Task .AssignTo{border:0;background:0 0}:host .NewTask.Task .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .NewTask.Task .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\\uE739'}:host .NewTask.Task .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\\uE73A'}:host .NewTask.Task .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .NewTask.Task .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle{display:flex;height:32px;padding:2px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, \"Segoe UI\");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .NewTask.Task .TaskAddButtonContainer{margin-right:28px}:host .NewTask.Task .TaskAddButtonContainer .TaskAdd,:host .NewTask.Task .TaskAddButtonContainer .TaskCancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-family:var(--default-font-family, \"Segoe UI\");font-size:14px;line-height:20px}:host .NewTask.Task .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .NewTask.Task .TaskAddButtonContainer .TaskCancel{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130))}:host .NewTask.Task .TaskAddButtonContainer.Disabled .TaskAdd{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}:host .LoadingTask.Task .TaskCheckContainer{cursor:default}:host .LoadingTask.Task .TaskDetails{display:flex}:host .LoadingTask.Task .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .LoadingTask.Task .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .LoadingTask.Task .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .LoadingTask.Task .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .LoadingTask.Task .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px}:host .Task{border:none}\n"])))],tv={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"},rv=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},nv=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ov=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},iv=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.call(this))._graph=null,e._newTaskDueDate=null,e._newTaskListId="",e._currentList=null,e._lists=[],e._tasks=[],e._loadingTasks=[],e._isLoadingTasks=!1,e}return v(r,[{key:"strings",get:function(){return tv}},{key:"renderTasks",value:function(){var e=this;if(this._isLoadingTasks)return this.renderLoadingTask();var t=this._tasks;t&&this.taskFilter&&(t=t.filter((function(t){return e.taskFilter(t)})));var r=Bs(t,(function(e){return e.id}),(function(t){return e.renderTask(t)}));return en(Fg||(Fg=Bn(["\n      ","\n    "])),r)}},{key:"renderNewTaskDetails",value:function(){var e=this,t=this._lists.filter((function(t){return e._currentList&&t.id===e._currentList.id||!e._currentList&&t.id===e._newTaskListId}));t.length>0&&!this._newTaskListId&&(this._newTaskListId=t[0].id);var r=this._currentList?en(zg||(zg=Bn(['\n          <span class="NewTaskGroup">\n            ',"\n            <span>","</span>\n          </span>\n        "])),this.renderBucketIcon(),this._currentList.displayName):en(Hg||(Hg=Bn(['\n          <span class="NewTaskGroup">\n            ','\n            <select\n              .value="','"\n              @change="','"\n            >\n              ',"\n            </select>\n          </span>\n        "])),this.renderBucketIcon(),this._newTaskListId,(function(t){e._newTaskListId=t.target.value}),t.map((function(e){return en(Bg||(Bg=Bn(['\n                  <option value="','">',"</option>\n                "])),e.id,e.displayName)}))),n=en(qg||(qg=Bn(['\n      <span class="NewTaskDue">\n        ','\n        <input\n          type="date"\n          label="new-taskDate-input"\n          aria-label="new-taskDate-input"\n          role="textbox"\n          .value="','"\n          @change="','"\n        />\n      </span>\n    '])),this.renderCalendarIcon(),this.dateToInputValue(this._newTaskDueDate),(function(t){var r=t.target.value;e._newTaskDueDate=r?new Date(r+"T17:00"):null}));return en(jg||(jg=Bn(["\n      "," ","\n    "])),r,n)}},{key:"renderHeaderContent",value:function(){var e=this;if(this.isLoadingState)return en(Gg||(Gg=Bn(['\n        <div class="header__loading"></div>\n      '])));var t,r=this._lists||[],n=this._currentList,o=this.targetId;if(o&&r.length){var i=r.find((function(e){return e.id===o}));i&&(t=en(Vg||(Vg=Bn(['\n          <span class="PlanTitle">\n            ',"\n          </span>\n        "])),i.displayName))}else if(n){var a,s={},c=S(r);try{var l=function(){var t=a.value;s[t.displayName]=function(){return e.loadTaskList(t)}};for(c.s();!(a=c.n()).done;)l()}catch(u){c.e(u)}finally{c.f()}t=en(Kg||(Kg=Bn(['\n        <mgt-arrow-options .value="','" .options="','"></mgt-arrow-options>\n      '])),n.displayName,s)}return en(Qg||(Qg=Bn(['\n      <span class="TitleCont">\n        ',"\n      </span>\n    "])),t)}},{key:"renderTask",value:function(e){var t=this,r={task:e,list:this._currentList};if(this.hasTemplate("task"))return this.renderTemplate("task",r,e.id);var n=Ig[e.status]===Ig.completed,o=this._loadingTasks.includes(e.id),i={Complete:!o&&n,Loading:o,TaskCheck:!0,TaskIcon:!0},a=o?en(Wg||(Wg=Bn(["\n          \uf16a\n        "]))):n?en(Jg||(Jg=Bn(["\n          \ue73e\n        "]))):null,s=null;if(this.hasTemplate("task-details"))s=this.renderTemplate("task-details",r,"task-details-".concat(e.id));else{var c=e.dueDateTime?en(Yg||(Yg=Bn(['\n            <div class="TaskDetail TaskDue">\n              <span>Due ',"</span>\n            </div>\n          "])),Mo(new Date(e.dueDateTime.dateTime))):null;s=en(Xg||(Xg=Bn(['\n        <div class="TaskTitle">\n          ','\n        </div>\n        <div class="TaskDetail TaskBucket">\n          ',"\n          <span>","</span>\n        </div>\n        ","\n      "])),e.title,this.renderBucketIcon(),this._currentList.displayName,c)}var l=this.readOnly||this.hideOptions?null:en(Zg||(Zg=Bn(['\n            <div class="TaskOptions">\n              <mgt-dot-options\n                .options="','"\n              ></mgt-dot-options>\n            </div>\n          '])),Je({},this.strings.removeTaskSubtitle,(function(r){return t.removeTask(r,e.id)}))),u=Do({Complete:n,Incomplete:!n,ReadOnly:this.readOnly,Task:!0}),d=Do({Complete:n,Incomplete:!n,TaskCheckContainer:!0});return en($g||($g=Bn(["\n      <div class=",'>\n        <div class="TaskContent" @click="','}">\n          <span class=',' @click="','">\n            <span class=','>\n              <span class="TaskCheckContent">','</span>\n            </span>\n          </span>\n          <div class="TaskDetailsContainer ','">\n            ',"\n          </div>\n          ",'\n          <div class="Divider"></div>\n        </div>\n      </div>\n    '])),u,(function(r){return t.handleTaskClick(r,e)}),d,(function(r){return t.handleTaskCheckClick(r,e)}),Do(i),a,this.mediaQuery,s,l)}},{key:"loadState",value:function(){return ov(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=Pn.globalProvider)&&t.state===Sn.SignedIn){e.next=3;break}return e.abrupt("return");case 3:if(this._graph||(r=t.graph.forComponent(this),this._graph=r),(n=this._lists)&&n.length){e.next=19;break}if(!this.targetId){e.next=13;break}return e.next=9,Dg(this._graph,this.targetId);case 9:o=e.sent,n=o?[o]:[],e.next=16;break;case 13:return e.next=15,Ng(this._graph);case 15:n=e.sent;case 16:this._tasks=[],this._currentList=null,this._lists=n;case 19:if(!(i=this._currentList)&&n&&n.length&&(this.initialId&&(i=n.find((function(e){return e.id===a.initialId}))),i||(i=n[0]),this._tasks=[],this._currentList=i),!i){e.next=24;break}return e.next=24,this.loadTaskList(i);case 24:case"end":return e.stop()}}),e,this)})))}},{key:"createNewTask",value:function(){return ov(this,void 0,void 0,Ze().mark((function e(){var t,r,n;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._currentList.id,r={title:this.newTaskName},this._newTaskDueDate&&(r.dueDateTime={dateTime:this._newTaskDueDate.toLocaleDateString(),timeZone:"UTC"}),e.next=5,Lg(this._graph,t,r);case 5:n=e.sent,this._tasks.unshift(n);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"clearNewTaskData",value:function(){Ot(y(r.prototype),"clearNewTaskData",this).call(this),this._newTaskDueDate=null,this._newTaskListId=null}},{key:"clearState",value:function(){Ot(y(r.prototype),"clearState",this).call(this),this._currentList=null,this._lists=[],this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1}},{key:"loadTaskList",value:function(e){return ov(this,void 0,void 0,Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._isLoadingTasks=!0,this._currentList=e,this.requestUpdate(),t.next=5,Og(this._graph,e.id);case 5:this._tasks=t.sent,this._isLoadingTasks=!1,this.requestUpdate();case 8:case"end":return t.stop()}}),t,this)})))}},{key:"updateTaskStatus",value:function(e,t){return ov(this,void 0,void 0,Ze().mark((function r(){var n,o;return Ze().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return this._loadingTasks=[].concat(d(this._loadingTasks),[e.id]),this.requestUpdate(),e.status=t,n=this._currentList.id,r.next=6,Ug(this._graph,n,e.id,e);case 6:e=r.sent,o=this._tasks.findIndex((function(t){return t.id===e.id})),this._tasks[o]=e,this._loadingTasks=this._loadingTasks.filter((function(t){return t!==e.id})),this.requestUpdate();case 11:case"end":return r.stop()}}),r,this)})))}},{key:"removeTask",value:function(e,t){return ov(this,void 0,void 0,Ze().mark((function e(){var r;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._tasks=this._tasks.filter((function(e){return e.id!==t})),this.requestUpdate(),r=this._currentList.id,e.next=5,Mg(this._graph,r,t);case 5:this._tasks=this._tasks.filter((function(e){return e.id!==t}));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"handleTaskCheckClick",value:function(e,t){this.readOnly||(Ig[t.status]===Ig.completed?this.updateTaskStatus(t,Ig.notStarted):this.updateTaskStatus(t,Ig.completed),e.stopPropagation(),e.preventDefault())}}],[{key:"styles",get:function(){return ev}},{key:"requiredScopes",get:function(){return["tasks.read","tasks.readwrite"]}}]),r}(Sg);iv=rv([fn("mgt-todo"),nv("design:paramtypes",[])],iv);var av=function(e,t){return av=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},av(e,t)};function sv(e,t){function r(){this.constructor=e}av(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var cv=function(){return cv=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},cv.apply(this,arguments)};function lv(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function uv(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function dv(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}var pv,fv=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?a+=o[i]:"y"===n[s]?(i&=3,a+=o[i|=8]):a+=n[s];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e}(),hv=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!1,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!1,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(pv||(pv={}));var gv,vv,mv,bv="id_token",yv="token",kv="id_token token";!function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction.status",e.REDIRECT_REQUEST="redirect_request"}(gv||(gv={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(vv||(vv={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(mv||(mv={}));var wv,xv=".well-known/openid-configuration";!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(wv||(wv={}));var Cv,Tv=[wv.SID,wv.LOGIN_HINT],_v="GET",Sv={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},Iv="msalIdTokenFrame",Ev="msalRenewFrame",Av={code:"unexpected_error",desc:"Unexpected error in authentication."},Rv={code:"no_window_object",desc:"No window object available. Details:"},Pv=function(e){function t(r,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=r,o.errorMessage=n,o.name="AuthError",o}return sv(t,e),t.createUnexpectedError=function(e){return new t(Av.code,Av.desc+": "+e)},t.createNoWindowObjectError=function(e){return new t(Rv.code,Rv.desc+" "+e)},t}(Error),Ov=function(){function e(){}return e.isEmpty=function(e){return"undefined"===typeof e||!e||0===e.length},e.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(r){return null}},e}(),Nv={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},Dv={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},Lv={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},Mv={code:"invalid_id_token",desc:"Invalid ID token format."},Uv={code:"invalid_state_error",desc:"Invalid state."},Fv={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},zv={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},Hv={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},Bv={code:"user_cancelled",desc:"User cancelled the flow."},qv={code:"callback_error",desc:"Error occurred in token received callback function."},jv={code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},Gv={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},Vv={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},Kv={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},Qv={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},Wv={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},Jv={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},Yv={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},Xv={code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},Zv={code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"},$v=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return sv(t,e),t.createEndpointResolutionError=function(e){var r=Nv.desc;return e&&!Ov.isEmpty(e)&&(r+=" Details: "+e),new t(Nv.code,r)},t.createPopupWindowError=function(e){var r=Dv.desc;return e&&!Ov.isEmpty(e)&&(r+=" Details: "+e),new t(Dv.code,r)},t.createTokenRenewalTimeoutError=function(){return new t(Lv.code,Lv.desc)},t.createInvalidIdTokenError=function(e){return new t(Mv.code,Mv.desc+" Given token: "+e)},t.createInvalidStateError=function(e,r){return new t(Uv.code,Uv.desc+" "+e+", state expected : "+r+".")},t.createNonceMismatchError=function(e,r){return new t(Fv.code,Fv.desc+" "+e+", nonce expected : "+r+".")},t.createLoginInProgressError=function(){return new t(zv.code,zv.desc)},t.createAcquireTokenInProgressError=function(){return new t(Hv.code,Hv.desc)},t.createUserCancelledError=function(){return new t(Bv.code,Bv.desc)},t.createErrorInCallbackFunction=function(e){return new t(qv.code,qv.desc+" "+e+".")},t.createUserLoginRequiredError=function(){return new t(jv.code,jv.desc)},t.createUserDoesNotExistError=function(){return new t(Gv.code,Gv.desc)},t.createClientInfoDecodingError=function(e){return new t(Vv.code,Vv.desc+" Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t(Kv.code,Kv.desc+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(Qv.code,Qv.desc+" Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t(Wv.code,Wv.desc+" Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t(Jv.code,Jv.desc+" Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t(Yv.code,Yv.desc)},t.createCacheParseError=function(e){var r="invalid key: "+e+", "+Xv.desc;return new t(Xv.code,r)},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t(Zv.code,Zv.desc)},t}(Pv),em={code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},tm={code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},rm={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},nm={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},om={code:"scopes_required",desc:"Scopes are required to obtain an access token."},im={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},am={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},sm={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},cm={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},lm={code:"authority_uri_insecure",desc:"Authority URIs must use https."},um={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},dm={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},pm={code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},fm={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},hm={code:"empty_request_error",desc:"Request object is required."},gm={code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},vm={code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},mm={code:"sso_silent_error",desc:"request must contain either sid or login_hint"},bm={code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."},ym=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return sv(t,e),t.createNoSetConfigurationError=function(){return new t(em.code,""+em.desc)},t.createStorageNotSupportedError=function(e){return new t(tm.code,tm.desc+" Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(rm.code,rm.desc)},t.createInvalidCallbackObjectError=function(e){return new t(nm.code,nm.desc+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(im.code,im.desc+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(am.code,am.desc+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t(om.code,om.desc+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t(sm.code,sm.desc+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(fm.code,fm.desc+" Given value: "+e)},t.createEmptyRequestError=function(){var e=hm;return new t(e.code,e.desc)},t.createInvalidCorrelationIdError=function(){return new t(gm.code,gm.desc)},t.createKnownAuthoritiesNotSetError=function(){return new t(pm.code,pm.desc)},t.createInvalidAuthorityTypeError=function(){return new t(cm.code,cm.desc)},t.createUntrustedAuthorityError=function(e){return new t(dm.code,dm.desc+" Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var r=vm,n=r.code,o=r.desc,i={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(n,o+" mising values: "+Object.keys(i).reduce((function(t,r){return e[r]?t:t.concat([r+" ("+i[r]+")"])}),[]).join(","))},t.createSsoSilentError=function(){return new t(mm.code,mm.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(bm.code,bm.desc)},t}($v),km=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(dv(e)),n=this.trimAndConvertArrayToLowerCase(dv(t)),o=0;o<n.length;o++)if(r.indexOf(n[o].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(dv(e));return this.trimAndConvertArrayToLowerCase(dv(t)).every((function(e){return r.indexOf(e.toString().toLowerCase())>=0}))},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map((function(e){return t.trimAndConvertToLowerCase(e)}))},e.trimScopes=function(e){return e.map((function(e){return e.trim()}))},e.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter((function(e){return e!==r}))},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw ym.createScopesNonArrayError(e);if(e.length<1&&t)throw ym.createEmptyScopesArrayError(e.toString())}else if(t)throw ym.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(hv.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(dv(t)):null,n=this.trimAndConvertArrayToLowerCase(dv(e));return r?dv(n,r):n}return null},e.onlyContainsOidcScopes=function(e){var t=e.length,r=0;return e.indexOf(hv.openidScope)>-1&&(r+=1),e.indexOf(hv.profileScope)>-1&&(r+=1),t>0&&t===r},e.containsAnyOidcScopes=function(e){var t=e.indexOf(hv.openidScope)>-1,r=e.indexOf(hv.profileScope)>-1;return t||r},e.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},e.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(hv.openidScope)&&t.push(hv.openidScope),-1===t.indexOf(hv.profileScope)&&t.push(hv.profileScope),t},e.removeDefaultScopes=function(e){return e.filter((function(e){return e!==hv.openidScope&&e!==hv.profileScope}))},e.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?hv.oidcScopes:e},e}(),wm=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=km.appendDefaultScopes(e.scopes),r=[];return r.push("response_type="+e.responseType),r.push("scope="+encodeURIComponent(km.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){var r=e.toLowerCase(),n=this.GetUrlComponents(r),o=n.PathSegments;return!t||0===o.length||o[0]!==hv.common&&o[0]!==wv.ORGANIZATIONS&&o[0]!==wv.CONSUMERS||(o[0]=t),this.constructAuthorityUriFromObject(n,o)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===hv.common},e.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===wv.ORGANIZATIONS},e.isConsumersAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===wv.CONSUMERS},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter((function(e){return e&&e.length>0})),n.PathSegments=o,r[6]&&(n.Search=r[6]),r[8]&&(n.Hash=r[8]),n},e.CanonicalizeUri=function(t){if(t){var r=t.toLowerCase();return e.endsWith(r,"/")||(r+="/"),r}return t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(Ov.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(pv.ERROR_DESCRIPTION)||r.hasOwnProperty(pv.ERROR)||r.hasOwnProperty(pv.ACCESS_TOKEN)||r.hasOwnProperty(pv.ID_TOKEN)},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return fv.deserialize(r)},e.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e}(),xm=function(e,t,r,n,o){this.authority=wm.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=fv.base64Encode(n)+"."+fv.base64Encode(o)},Cm=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n},Tm="1.4.17",_m=function(){function e(e,t,r,n,o,i,a){this.authorityInstance=e,this.clientId=t,this.nonce=fv.createNewGuid(),this.scopes=o?dv(o):hv.oidcScopes,this.scopes=km.trimScopes(this.scopes),this.state=i,this.correlationId=a,this.xClientSku="MSAL.JS",this.xClientVer=Tm,this.responseType=r,this.redirectUri=n}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!1,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n,o){var i={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(i=this.constructUnifiedCacheQueryParameter(r,null))),n&&(i=this.constructUnifiedCacheQueryParameter(null,n)),i=this.addHintParameters(t,i);var a=r?r.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(a,o)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n,o;if(e)if(e.account){var i=e.account;(null===(r=i.idTokenClaims)||void 0===r?void 0:r.login_hint)?(n=wv.LOGIN_HINT,o=i.idTokenClaims.login_hint):i.sid?(n=wv.SID,o=i.sid):i.userName&&(n=wv.LOGIN_HINT,o=i.userName)}else e.sid?(n=wv.SID,o=e.sid):e.loginHint&&(n=wv.LOGIN_HINT,o=e.loginHint);else t&&t.hasOwnProperty(hv.upn)&&(n=wv.ID_TOKEN,o=t.upn);return this.addSSOParameter(n,o)},e.prototype.addHintParameters=function(e,t){var r,n,o=t;return e&&(o[wv.SID]||o[wv.LOGIN_HINT]||((null===(r=e.idTokenClaims)||void 0===r?void 0:r.login_hint)?o=this.addSSOParameter(wv.LOGIN_HINT,null===(n=e.idTokenClaims)||void 0===n?void 0:n.login_hint,o):e.sid&&this.promptValue===Sv.NONE?o=this.addSSOParameter(wv.SID,e.sid,o):e.userName&&(o=this.addSSOParameter(wv.LOGIN_HINT,e.userName,o)))),o},e.prototype.addSSOParameter=function(e,t,r){var n=r||{};if(!t)return n;switch(e){case wv.SID:n[wv.SID]=t;break;case wv.ID_TOKEN:case wv.LOGIN_HINT:n[wv.LOGIN_HINT]=t}return n},e.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach((function(n){n===hv.domain_hint&&(t||e[wv.SID])||(r?r+="&"+n+"="+encodeURIComponent(e[n]):r=n+"="+encodeURIComponent(e[n]))})),r},e.isSSOParam=function(e){return!(!e||!(e.account||e.sid||e.loginHint))},e.determineResponseType=function(e,t){return km.onlyContainsOidcScopes(t)?bv:e?this.responseTypeForMatchingAccounts(t):kv},e.responseTypeForMatchingAccounts=function(e){return km.containsAnyOidcScopes(e)?kv:yv},e}(),Sm=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(r,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(){var e;(i.status<200||i.status>=300)&&o(n.handleError(i.responseText));try{e=JSON.parse(i.responseText)}catch(a){o(n.handleError(i.responseText))}var t={statusCode:i.status,body:e};r(t)},i.onerror=function(){o(i.status)},t!==_v)throw"not implemented";i.send()}))},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(r){return e}},e}(),Im=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,r){t&&!this.getTrustedHostList().length&&r.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))},e.getAliases=function(e,t,r){return lv(this,void 0,void 0,(function(){var n,o,i,a;return uv(this,(function(s){return n=new Sm,o=_v,i="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize",a=t.createAndStartHttpEvent(r,o,i,"getAliases"),[2,n.sendRequestAsync(i,o,!0).then((function(e){return a.httpResponseStatus=e.statusCode,t.stopEvent(a),e.body.metadata})).catch((function(e){throw a.serverErrorCode=e,t.stopEvent(a),e}))]}))}))},e.setTrustedAuthoritiesFromNetwork=function(t,r,n){return lv(this,void 0,void 0,(function(){var o;return uv(this,(function(i){switch(i.label){case 0:return[4,this.getAliases(t,r,n)];case 1:return i.sent().forEach((function(t){t.aliases.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))})),o=wm.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(o)&&e.TrustedHostList.push(o.toLowerCase()),[2]}}))}))},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(Cv||(Cv={}));var Em,Am=function(){function e(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}return e.isAdfs=function(e){var t=wm.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===hv.ADFS},Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return e.isAdfs(this.canonicalAuthority)?Cv.Adfs:Cv.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=wm.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=wm.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===Cv.Adfs?""+this.CanonicalAuthority+xv:this.CanonicalAuthority+"v2.0/"+xv},enumerable:!1,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(t){throw cm}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw lm;if(!e.PathSegments||e.PathSegments.length<1)throw um},e.prototype.DiscoverEndpoints=function(e,t,r){var n=new Sm,o=_v,i=t.createAndStartHttpEvent(r,o,e,"openIdConfigurationEndpoint");return n.sendRequestAsync(e,o,!0).then((function(e){return i.httpResponseStatus=e.statusCode,t.stopEvent(i),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}})).catch((function(e){throw i.serverErrorCode=e,t.stopEvent(i),e}))},e.prototype.resolveEndpointsAsync=function(e,t){return lv(this,void 0,void 0,(function(){var r,n,o;return uv(this,(function(i){switch(i.label){case 0:return this.IsValidationEnabled?(r=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==Im.getTrustedHostList().length?[3,2]:[4,Im.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:i.sent(),i.label=2;case 2:if(!Im.IsInTrustedHostList(r))throw ym.createUntrustedAuthorityError(r);i.label=3;case 3:return n=this.GetOpenIdConfigurationEndpoint(),o=this,[4,this.DiscoverEndpoints(n,e,t)];case 4:return o.tenantDiscoveryResponse=i.sent(),[2,this.tenantDiscoveryResponse]}}))}))},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}(),Rm=function(){function e(t,r){if(!t||Ov.isEmpty(t))return this.uid="",void(this.utid="");try{var n=fv.base64Decode(t),o=JSON.parse(n);o&&(o.hasOwnProperty("uid")&&(this.uid=r?e.stripPolicyFromUid(o.uid,r):o.uid),o.hasOwnProperty("utid")&&(this.utid=o.utid))}catch(i){throw $v.createClientInfoDecodingError(i)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!1,configurable:!0}),e.createClientInfoFromIdToken=function(t,r){var n={uid:t.subject,utid:""};return new e(fv.base64Encode(JSON.stringify(n)),r)},e.stripPolicyFromUid=function(e,t){var r=e.split("-"),n=t.split("/").reverse(),o="";return Ov.isEmpty(n[0])?n.length>1&&(o=n[1]):o=n[0],r[r.length-1]===o?r.slice(0,r.length-1).join("-"):e},e.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return fv.base64Encode(e)},e}(),Pm=function(){function e(){}return e.parseExpiresIn=function(e){return parseInt(e||"3599",10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}(),Om=function(){function e(){}return e.decodeJwt=function(e){if(Ov.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.validateExpirationIsWithinOffset=function(e,t){var r=t||300;return e&&e>Pm.now()+r},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=fv.base64Decode(r);return n?JSON.parse(n):null}catch(o){}return null},e}(),Nm=function(e){if(Ov.isEmpty(e))throw $v.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=Om.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(t){throw $v.createIdTokenParsingError(t)}},Dm=function(e,t){this.key=e,this.value=t},Lm=function(){function e(e){if(!window)throw Pv.createNoWindowObjectError("Browser storage class could not find window object");if(!("undefined"!==typeof window[e]&&null!==window[e]))throw ym.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),Mm=function(){function e(){}return e.validateRequest=function(e,t,r,n){if(!t&&!e)throw ym.createEmptyRequestError();var o,i;e&&(o=t?km.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,km.validateInputScope(o,!t),o=km.translateClientIdIfSingleScope(o,r),this.validatePromptParameter(e.prompt),i=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var a=this.validateAndGenerateState(e&&e.state,n),s=this.validateAndGenerateCorrelationId(e&&e.correlationId);return cv(cv({},e),{extraQueryParameters:i,scopes:o,state:a,correlationId:s})},e.validatePromptParameter=function(e){if(e&&[Sv.LOGIN,Sv.SELECT_ACCOUNT,Sv.CONSENT,Sv.NONE].indexOf(e)<0)throw ym.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var r=cv({},e);return r?(t&&delete r[hv.claims],Tv.forEach((function(e){r[e]&&delete r[e]})),r):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(t){throw ym.createClaimsRequestParsingError(t)}},e.validateAndGenerateState=function(t,r){return Ov.isEmpty(t)?e.generateLibraryState(r):""+e.generateLibraryState(r)+hv.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:fv.createNewGuid(),ts:Pm.now(),method:e},r=JSON.stringify(t);return fv.base64Encode(r)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(hv.resourceDelimiter)[0];if(fv.isGuid(t))return{id:t,ts:Pm.now(),method:hv.interactionTypeRedirect};try{var r=fv.base64Decode(t);return JSON.parse(r)}catch(n){throw $v.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!fv.isGuid(e))throw ym.createInvalidCorrelationIdError();return fv.isGuid(e)?e:fv.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+hv.resourceDelimiter+e.authority},e}(),Um=function(e){function t(t,r,n){var o=e.call(this,r)||this;return o.temporaryCache=new Lm("sessionStorage"),o.clientId=t,o.rollbackEnabled=!0,o.migrateCacheEntries(n),o}return sv(t,e),t.prototype.migrateCacheEntries=function(t){var r,n=this,o=hv.cachePrefix+"."+vv.IDTOKEN,i=hv.cachePrefix+"."+vv.CLIENT_INFO,a=hv.cachePrefix+"."+mv.ERROR,s=hv.cachePrefix+"."+mv.ERROR_DESC,c=e.prototype.getItem.call(this,o);if(c)try{r=new Nm(c)}catch(u){return}if(r&&r.claims&&r.claims.aud===this.clientId){var l=[c,e.prototype.getItem.call(this,i),e.prototype.getItem.call(this,a),e.prototype.getItem.call(this,s)];[vv.IDTOKEN,vv.CLIENT_INFO,mv.ERROR,mv.ERROR_DESC].forEach((function(e,r){return n.duplicateCacheEntry(e,l[r],t)}))}},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+hv.cachePrefix)||0===e.indexOf(hv.adalIdToken)?e:t?hv.cachePrefix+"."+this.clientId+"."+e:hv.cachePrefix+"."+e}},t.prototype.matchKeyForType=function(e,t,r,n){var o=Ov.validateAndParseJsonCacheKey(e);if(!o)return null;var i=e.match(t)&&e.match(r),a=!1;switch(n){case pv.ACCESS_TOKEN:a=!!e.match(hv.scopes);break;case pv.ID_TOKEN:a=!e.match(hv.scopes)}return i&&a?o:null},t.prototype.setItem=function(t,r,n){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&!n&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},t.prototype.removeItem=function(t){this.temporaryCache.removeItem(this.generateCacheKey(t,!0)),e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.setTemporaryItem=function(e,t,r){this.temporaryCache.setItem(this.generateCacheKey(e,!0),t,r)},t.prototype.getTemporaryItem=function(e,t){return this.temporaryCache.getItem(this.generateCacheKey(e,!0),t)},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(hv.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var r=this,n=t&&Mm.parseLibraryState(t).id,o=this.tokenRenewalInProgress(t),i=window[this.cacheLocation];n&&!o&&Object.keys(i).forEach((function(t){-1!==t.indexOf(n)&&(r.removeItem(t),e.prototype.clearItemCookie.call(r,t))})),this.setInteractionInProgress(!1),this.removeItem(gv.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,r,n){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllTokensByType=function(e,t,r){var n=this;return Object.keys(window[this.cacheLocation]).reduce((function(o,i){var a=n.matchKeyForType(i,e,t,r);if(a){var s=n.getItem(i);if(s)try{var c=new Dm(a,JSON.parse(s));return o.concat([c])}catch(l){return o}}return o}),[])},t.prototype.getAllAccessTokens=function(e,t){return this.getAllTokensByType(e,t,pv.ACCESS_TOKEN)},t.prototype.getAllIdTokens=function(e,t){return this.getAllTokensByType(e,t,pv.ID_TOKEN)},t.prototype.getAllTokens=function(e,t){return dv(this.getAllAccessTokens(e,t),this.getAllIdTokens(e,t))},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){return this.getTemporaryItem(this.generateCacheKey(gv.INTERACTION_STATUS,!1))},t.prototype.setInteractionInProgress=function(e){if(e){if(this.isInteractionInProgress(!1))throw $v.createAcquireTokenInProgressError();this.setTemporaryItem(this.generateCacheKey(gv.INTERACTION_STATUS,!1),this.clientId)}else!e&&this.isInteractionInProgress(!0)&&this.removeItem(this.generateCacheKey(gv.INTERACTION_STATUS,!1))},t.prototype.tokenRenewalInProgress=function(e){var r=this.getItem(t.generateTemporaryCacheKey(gv.RENEW_STATUS,e));return!(!r||r!==hv.inProgress)},t.prototype.clearMsalCookie=function(r){var n=this;r?(this.clearItemCookie(t.generateTemporaryCacheKey(gv.NONCE_IDTOKEN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(gv.STATE_LOGIN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(gv.LOGIN_REQUEST,r)),this.clearItemCookie(t.generateTemporaryCacheKey(gv.STATE_ACQ_TOKEN,r))):document.cookie.split(";").forEach((function(t){var r=t.trim().split("=")[0];r.indexOf(hv.cachePrefix)>-1&&e.prototype.clearItemCookie.call(n,r)}))},t.generateAcquireTokenAccountKey=function(e,t){var r=Mm.parseLibraryState(t).id;return""+gv.ACQUIRE_TOKEN_ACCOUNT+hv.resourceDelimiter+e+hv.resourceDelimiter+r},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(gv.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var r=Mm.parseLibraryState(t).id;return""+e+hv.resourceDelimiter+r},t}(Lm),Fm=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,r){var n,o=t.objectId||t.subject,i=r?r.uid:"",a=r?r.utid:"";return Ov.isEmpty(i)||(n=Ov.isEmpty(a)?fv.base64Encode(i):fv.base64Encode(i)+"."+fv.base64Encode(a)),new e(o,n,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}(),zm=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+hv.resourceDelimiter+t},e.monitorIframeForHash=function(t,r,n,o){return new Promise((function(i,a){var s=Pm.relativeNowMs()+r;o.verbose("monitorWindowForIframe polling started");var c=setInterval((function(){if(Pm.relativeNowMs()>s)return o.error("monitorIframeForHash unable to find hash in url, timing out"),o.errorPii("monitorIframeForHash polling timed out for url: "+n),clearInterval(c),void a($v.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(r){}e&&wm.urlContainsHash(e)&&(o.verbose("monitorIframeForHash found url in hash"),clearInterval(c),i(t.location.hash))}),e.POLLING_INTERVAL_MS)}))},e.monitorPopupForHash=function(t,r,n,o){return new Promise((function(i,a){var s=r/e.POLLING_INTERVAL_MS,c=0;o.verbose("monitorWindowForHash polling started");var l=setInterval((function(){if(t.closed)return o.error("monitorWindowForHash window closed"),clearInterval(l),void a($v.createUserCancelledError());var r;try{r=t.location.href}catch(d){}if(r&&"about:blank"!==r)if(c++,r&&wm.urlContainsHash(r)){o.verbose("monitorPopupForHash found url in hash"),clearInterval(l);var u=t.location.hash;e.clearUrlFragment(t),i(u)}else c>s&&(o.error("monitorPopupForHash unable to find hash in url, timing out"),o.errorPii("monitorPopupForHash polling timed out for url: "+n),clearInterval(l),a($v.createTokenRenewalTimeoutError()))}),e.POLLING_INTERVAL_MS)}))},e.loadFrame=function(e,t,r,n){var o=this;return n.infoPii("LoadFrame: "+t),new Promise((function(i,a){setTimeout((function(){var r=o.loadFrameSync(e,t,n);r?i(r):a("Unable to load iframe with name: "+t)}),r)}))},e.loadFrameSync=function(t,r,n){var o=e.addHiddenIFrame(r,n);return o?(""!==o.src&&"about:blank"!==o.src||(o.src=t,n.infoPii("Frame Name : "+r+" Navigated to: "+t)),o):null},e.addHiddenIFrame=function(e,t){if("undefined"===typeof e)return null;t.info("Add msal iframe to document"),t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(r)t.verbose("Add msal iframe already exists");else{t.verbose("Add msal iframe does not exist");var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n)}return r},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map((function(e,r){return t.item(r)})).filter((function(t){try{return t.contentWindow.location.hash===e}catch(r){return!1}}))[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter((function(e){try{return e.location.hash===t}catch(r){return!1}}))[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach((function(e){return e.close()}))},e.blockReloadInHiddenIframes=function(){if(wm.urlContainsHash(window.location.hash)&&e.isInIframe())throw $v.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(gv.REDIRECT_REQUEST);if(t&&!wm.urlContainsHash(window.location.hash)){var r=t.split(hv.resourceDelimiter);r.shift();var n=r.length>0?r.join(hv.resourceDelimiter):null;e.resetTempCacheItems(n)}},e.clearUrlFragment=function(e){e.location.hash="","function"===typeof e.history.replaceState&&e.history.replaceState(null,null,""+e.location.pathname+e.location.search)},e.POLLING_INTERVAL_MS=50,e}(),Hm=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),cv(cv({},e),{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e.buildAuthResponse=function(t,r,n,o,i,a){switch(n.responseType){case bv:var s=cv(cv({},r),{tokenType:pv.ID_TOKEN,account:o,scopes:i,accountState:a});return(s=e.setResponseIdToken(s,t)).idToken?s:null;case kv:var c=e.setResponseIdToken(r,t);return c&&c.accessToken&&c.idToken?c:null;case yv:return e.setResponseIdToken(r,t);default:return null}},e}(),Bm=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,r){return lv(this,void 0,void 0,(function(){var n;return uv(this,(function(o){switch(o.label){case 0:return[4,e.resolveEndpointsAsync(t,r)];case 1:return n=o.sent(),this.metadataMap.set(e.CanonicalAuthority,n),[2,n]}}))}))},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw ym.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(n){throw ym.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,r){return Ov.isEmpty(e)?null:(r&&this.saveMetadataFromConfig(e,r),new Am(e,t,this.metadataMap.get(e)))},e.metadataMap=new Map,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(Em||(Em={}));var qm=function(){function e(e,t){void 0===t&&(t={}),this.level=Em.Info;var r=t.correlationId,n=void 0===r?"":r,o=t.level,i=void 0===o?Em.Info:o,a=t.piiLoggingEnabled,s=void 0!==a&&a;this.localCallback=e,this.correlationId=n,this.level=i,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var n,o=(new Date).toUTCString();n=Ov.isEmpty(this.correlationId)?o+":"+Tm+"-"+Em[e]+(r?"-pii":"")+" "+t:o+":"+this.correlationId+"-"+Tm+"-"+Em[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,n,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(Em.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(Em.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(Em.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(Em.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(Em.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(Em.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(Em.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(Em.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),jm={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return wm.getCurrentUrl()},postLogoutRedirectUri:function(){return wm.getCurrentUrl()},navigateToLoginRequestUrl:!0},Gm={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},Vm={logger:new qm(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},Km={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};var Qm={code:"server_unavailable",desc:"Server is temporarily unavailable."},Wm={code:"unknown_server_error"},Jm=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return sv(t,e),t.createServerUnavailableError=function(){return new t(Qm.code,Qm.desc)},t.createUnknownServerError=function(e){return new t(Wm.code,e)},t}(Pv),Ym={code:"interaction_required"},Xm={code:"consent_required"},Zm={code:"login_required"},$m=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return sv(t,e),t.isInteractionRequiredError=function(e){var t=[Ym.code,Xm.code,Zm.code];return e&&t.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(Zm.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(Ym.code,e)},t.createConsentRequiredAuthError=function(e){return new t(Xm.code,e)},t}(Jm);function eb(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var tb,rb,nb,ob="event_name",ib="elapsed_time",ab="Microsoft.MSAL.correlation_id",sb="msal.api_telem_id",cb="msal.api_id",lb="Microsoft_MSAL_cache_event_count",ub="Microsoft_MSAL_http_event_count",db="Microsoft_MSAL_ui_event_count",pb=function(e){var t=wm.GetUrlComponents(e);if(Am.isAdfs(e))return e;var r=t.PathSegments;if(r&&r.length>=2){var n="tfp"===r[1]?2:1;n<r.length&&(r[n]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},fb=function(e){return fv.base64Encode(e)},hb=function(e){return"msal."+(e||"")},gb=function(){return!!("undefined"!==typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},vb=function(){function e(e,t,r){var n;this.eventId=fv.createNewGuid(),this.label=r,this.event=((n={})[hb(ob)]=e,n[hb(ib)]=-1,n[""+ab]=t,n)}return e.prototype.setElapsedTime=function(e){this.event[hb(ib)]=e},e.prototype.stop=function(){var e,t,r;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,r=this.perfEndMark,gb()&&(window.performance.mark(r),window.performance.measure(e,t,r),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(r))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[hb("start_time")]=this.startTimestamp,e=this.perfStartMark,gb()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+ab]},set:function(e){this.event[""+ab]=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[hb(ob)]},enumerable:!1,configurable:!0}),e.prototype.get=function(){return cv(cv({},this.event),{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!1,configurable:!0}),e}(),mb=vb,bb=function(e){function t(t,r,n,o){var i=e.call(this,hb("default_event"),r,"DefaultEvent")||this;return i.event[hb("client_id")]=n,i.event[hb("sdk_plaform")]=t.sdk,i.event[hb("sdk_version")]=t.sdkVersion,i.event[hb("application_name")]=t.applicationName,i.event[hb("application_version")]=t.applicationVersion,i.event[hb("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,i.event[""+db]=i.getEventCount(hb("ui_event"),o),i.event[""+ub]=i.getEventCount(hb("http_event"),o),i.event[""+lb]=i.getEventCount(hb("cache_event"),o),i}return sv(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(mb),yb=bb,kb=hb("authority"),wb=hb("authority_type"),xb=hb("ui_behavior"),Cb=hb("tenant_id"),Tb=hb("user_id"),_b=hb("was_successful"),Sb=hb("api_error_code"),Ib=hb("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(rb||(rb={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(nb||(nb={}));var Eb=((tb={})[nb.AcquireTokenSilent]=rb.AcquireTokenSilent,tb[nb.AcquireTokenPopup]=rb.AcquireTokenPopup,tb[nb.AcquireTokenRedirect]=rb.AcquireTokenRedirect,tb[nb.LoginPopup]=rb.LoginPopup,tb[nb.LoginRedirect]=rb.LoginRedirect,tb[nb.Logout]=rb.Logout,tb),Ab=function(e){function t(t,r,n){var o=e.call(this,hb("api_event"),t,n)||this;return n&&(o.apiCode=Eb[n],o.apiEventIdentifier=n),o.piiEnabled=r,o}return sv(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event[sb]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event[cb]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[kb]=pb(e).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[Sb]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[Cb]=this.piiEnabled&&e?fb(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[Tb]=this.piiEnabled&&e?fb(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[_b]},set:function(e){this.event[_b]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[Ib]=this.piiEnabled&&e?fb(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[wb]=e.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[xb]=e.toLowerCase()},enumerable:!1,configurable:!0}),t}(mb),Rb=Ab,Pb=hb("http_path"),Ob=hb("user_agent"),Nb=hb("query_parameters"),Db=hb("api_version"),Lb=hb("response_code"),Mb=hb("oauth_error_code"),Ub=hb("http_method"),Fb=hb("request_id_header"),zb=hb("spe_info"),Hb=hb("server_error_code"),Bb=hb("server_sub_error_code"),qb=hb("url"),jb=function(e){function t(t,r){return e.call(this,hb("http_event"),t,r)||this}return sv(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=pb(e);this.event[qb]=t&&t.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[Pb]=pb(e).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[Ob]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[Nb]=_m.generateQueryParametersString(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[Db]=e.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[Lb]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[Mb]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[Ub]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[Fb]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[zb]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[Hb]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[Bb]=e},enumerable:!1,configurable:!0}),t}(mb),Gb=function(){function e(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=cv({sdk:hv.libraryName,sdkVersion:Tm,networkInformation:{connectionSpeed:"undefined"!==typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},(function(){}),t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=dv(t||[],[e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach((function(e){return t.incrementEventCount(e)}));var n=dv(this.completedEvents[e],r);delete this.completedEvents[e];var o=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],n&&n.length){var i=dv(n,[new yb(this.telemetryPlatform,e,this.clientId,o)]);this.telemetryEmitter(i.map((function(e){return e.get()})))}}},e.prototype.createAndStartApiEvent=function(e,t){var r=new Rb(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},e.prototype.stopAndFlushApiEvent=function(e,t,r,n){t.wasSuccessful=r,n&&(t.apiErrorCode=n),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,r,n){var o=new jb(e,n);return o.url=r,o.httpMethod=t,this.startEvent(o),o},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce((function(r,n){if(-1!==n.indexOf(e)){var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],dv(r,[o])}return r}),[])},e}(),Vb=Gb,Kb=function(){function e(){}return e.filterTokenCacheItemsByScope=function(e,t){return e.filter((function(e){var r=e.key.scopes.split(" "),n=km.removeDefaultScopes(t);return 0===n.length?km.containsScope(r,t):km.containsScope(r,n)}))},e.filterTokenCacheItemsByAuthority=function(e,t){return e.filter((function(e){return wm.CanonicalizeUri(e.key.authority)===t}))},e.filterTokenCacheItemsByDomain=function(e,t){return e.filter((function(e){return wm.GetUrlComponents(e.key.authority).HostNameAndPort===t}))},e}(),Qb=function(){function e(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=function(e){var t=e.auth,r=e.cache,n=void 0===r?{}:r,o=e.system,i=void 0===o?{}:o,a=e.framework,s=void 0===a?{}:a;return{auth:cv(cv({},jm),t),cache:cv(cv({},Gm),n),system:cv(cv({},Vm),i),framework:cv(cv({},Km),s)}}(e),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),Im.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),Bm.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new Um(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals||(window.activeRenewals={}),window.renewStates||(window.renewStates=[]),window.callbackMappedToRenewStates||(window.callbackMappedToRenewStates={}),window.promiseMappedToRenewStates||(window.promiseMappedToRenewStates={}),window.msal=this;var t=window.location.hash,r=wm.urlContainsHash(t);(zm.checkIfBackButtonIsPressed(this.cacheStorage),r&&this.cacheStorage.isInteractionInProgress(!0))&&(this.getResponseState(t).method===hv.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(t))}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=Bm.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!1,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw ym.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(hv.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(hv.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),wm.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,r){if(this.logger.verbose("AuthResponseHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===hv.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==hv.interactionTypePopup)throw $v.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),r(t)}},e.prototype.authErrorHandler=function(e,t,r,n){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===hv.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,r.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,r)}else{if(e!==hv.interactionTypePopup)throw $v.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),n(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=Mm.validateRequest(e,!0,this.clientId,hv.interactionTypeRedirect);this.acquireTokenInteractive(hv.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=Mm.validateRequest(e,!1,this.clientId,hv.interactionTypeRedirect);this.acquireTokenInteractive(hv.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var r=Mm.validateRequest(e,!0,this.clientId,hv.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,nb.LoginPopup);return new Promise((function(e,n){t.acquireTokenInteractive(hv.interactionTypePopup,!0,r,e,n)})).then((function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var r=Mm.validateRequest(e,!1,this.clientId,hv.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,nb.AcquireTokenPopup);return new Promise((function(e,n){t.acquireTokenInteractive(hv.interactionTypePopup,!1,r,e,n)})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.acquireTokenInteractive=function(e,t,r,n,o){var i,a=this;this.logger.verbose("AcquireTokenInteractive has been called"),zm.blockReloadInHiddenIframes();try{this.cacheStorage.setInteractionInProgress(!0)}catch(u){var s=t?$v.createLoginInProgressError():$v.createAcquireTokenInProgressError(),c=eb(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,s,c,o)}if(e===hv.interactionTypeRedirect&&this.cacheStorage.setItem(gv.REDIRECT_REQUEST,""+hv.inProgress+hv.resourceDelimiter+r.state),r&&r.account&&!t?(i=r.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),i||_m.isSSOParam(r))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(i,e,t,r,n,o);else{if(!t){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");c=eb(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,$v.createUserLoginRequiredError(),c,o)}if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var l=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(l).then((function(t){a.silentLogin=!1,a.logger.info("Unified cache call is successful"),a.authResponseHandler(e,t,n)}),(function(i){a.silentLogin=!1,a.logger.error("Error occurred during unified cache ATS: "+i),a.acquireTokenHelper(null,e,t,r,n,o)}))}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,n,o)}},e.prototype.acquireTokenHelper=function(e,t,r,n,o,i){return lv(this,void 0,void 0,(function(){var a,s,c,l,u,d,p,f,h,g;return uv(this,(function(v){switch(v.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+r),a=n.scopes?n.scopes.join(" ").toLowerCase():hv.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+a),c=n&&n.authority?Bm.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance,v.label=1;case 1:return v.trys.push([1,11,,12]),c.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,Bm.saveMetadataFromNetwork(c,this.telemetryManager,n.correlationId)]);case 2:return v.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),v.label=4;case 4:if(u=r?bv:this.getTokenType(e,n.scopes),d=n.redirectStartPage||window.location.href,s=new _m(c,this.clientId,u,this.getRedirectUri(n&&n.redirectUri),n.scopes,n.state,n.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(s,e,r,d),this.logger.verbose("Updating cache entries"),s.populateQueryParams(e,n),this.logger.verbose("Query parameters populated from account"),p=wm.createNavigateUrl(s)+hv.response_mode_fragment,t===hv.interactionTypeRedirect)r?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(Um.generateTemporaryCacheKey(gv.STATE_ACQ_TOKEN,n.state),s.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+s.state));else{if(t!==hv.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),$v.createInvalidInteractionTypeError();window.renewStates.push(s.state),window.requestType=r?hv.login:hv.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+s.state),this.registerCallback(s.state,a,o,i)}if(t!==hv.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{l=this.openPopup(p,"msal",hv.popUpWidth,hv.popUpHeight),zm.trackPopup(l)}catch(m){if(this.logger.info(Dv.code+":"+Dv.desc),this.cacheStorage.setItem(mv.ERROR,Dv.code),this.cacheStorage.setItem(mv.ERROR_DESC,Dv.desc),i)return i($v.createPopupWindowError()),[2]}if(!l)return[3,8];v.label=5;case 5:return v.trys.push([5,7,,8]),[4,zm.monitorPopupForHash(l,this.config.system.loadFrameTimeout,p,this.logger)];case 6:return f=v.sent(),this.handleAuthenticationResponse(f),this.cacheStorage.setInteractionInProgress(!1),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",f),zm.closePopups(),[3,8];case 7:return h=v.sent(),i&&i(h),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",h.errorCode+hv.resourceDelimiter+h.errorMessage):(this.cacheStorage.setInteractionInProgress(!1),l.close()),[3,8];case 8:return[3,10];case 9:n.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==n.onRedirectNavigate(p)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(p)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(p)),v.label=10;case 10:return[3,12];case 11:return g=v.sent(),this.logger.error(g),this.cacheStorage.resetTempCacheItems(n.state),this.authErrorHandler(t,$v.createEndpointResolutionError(g.toString),eb(n.state),i),l&&l.close(),[3,12];case 12:return[2]}}))}))},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw ym.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw ym.createSsoSilentError();return this.acquireTokenSilent(cv(cv({},e),{scopes:hv.oidcScopes}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var r=Mm.validateRequest(e,!1,this.clientId,hv.interactionTypeSilent),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,nb.AcquireTokenSilent),o=Mm.createRequestSignature(r);return new Promise((function(e,n){return lv(t,void 0,void 0,(function(){var t,i,a,s,c,l,u,d,p,f,h;return uv(this,(function(g){switch(g.label){case 0:if(zm.blockReloadInHiddenIframes(),t=r.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),r.account?(i=r.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a=this.cacheStorage.getItem(hv.adalIdToken),!i&&!r.sid&&!r.loginHint&&Ov.isEmpty(a))return this.logger.info("User login is required"),[2,n($v.createUserLoginRequiredError())];if(s=this.getTokenType(i,r.scopes),this.logger.verbose("Response type: "+s),c=new _m(Bm.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata),this.clientId,s,this.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),_m.isSSOParam(r)||i?(c.populateQueryParams(i,r,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):i||Ov.isEmpty(a)?this.logger.verbose("No additional query parameters added"):(l=Om.extractIdToken(a),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),c.populateQueryParams(i,null,l,!0)),!(u=r.claimsRequest||c.claimsValue)&&!r.forceRefresh)try{p=this.getCachedToken(c,i)}catch(v){d=v}return p?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(p.scopes)),e(p),[2,null]):[3,1];case 1:return d?(this.logger.infoPii(d.errorCode+":"+d.errorMessage),n(d),[2,null]):[3,2];case 2:f=void 0,f=u?"Skipped cache lookup since claims were given":r.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(f),c.authorityInstance||(c.authorityInstance=r.authority?Bm.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+c.authority),g.label=3;case 3:return g.trys.push([3,7,,8]),c.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,Bm.saveMetadataFromNetwork(c.authorityInstance,this.telemetryManager,r.correlationId)]);case 4:return g.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),g.label=6;case 6:return window.activeRenewals[o]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[o],o,e,n)):r.scopes&&km.onlyContainsOidcScopes(r.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(o,e,n,i,c)):(this.logger.verbose("Renewing access token"),this.renewToken(o,e,n,i,c)),[3,8];case 7:return h=g.sent(),this.logger.error(h),n($v.createEndpointResolutionError(h.toString())),[2,null];case 8:return[2]}}))}))})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.openPopup=function(e,t,r,n){this.logger.verbose("OpenPopup has been called");try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=a/2-r/2+o,l=s/2-n/2+i,u=window.open(e,t,"width="+r+", height="+n+", top="+l+", left="+c+", scrollbars=yes");if(!u)throw $v.createPopupWindowError();return u.focus&&u.focus(),u}catch(d){throw this.cacheStorage.setInteractionInProgress(!1),$v.createPopupWindowError(d.toString())}},e.prototype.loadIframeTimeout=function(e,t,r){return lv(this,void 0,void 0,(function(){var n,o,i,a,s;return uv(this,(function(c){switch(c.label){case 0:return n=window.activeRenewals[r],this.logger.verbosePii("Set loading state to pending for: "+r+":"+n),this.cacheStorage.setItem(Um.generateTemporaryCacheKey(gv.RENEW_STATUS,n),hv.inProgress),this.config.system.navigateFrameWait?[4,zm.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return i=c.sent(),[3,3];case 2:i=zm.loadFrameSync(e,t,this.logger),c.label=3;case 3:o=i,c.label=4;case 4:return c.trys.push([4,6,,7]),[4,zm.monitorIframeForHash(o.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(a=c.sent())&&this.handleAuthenticationResponse(a),[3,7];case 6:throw s=c.sent(),this.cacheStorage.getItem(Um.generateTemporaryCacheKey(gv.RENEW_STATUS,n))===hv.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+n),n&&window.callbackMappedToRenewStates[n]&&window.callbackMappedToRenewStates[n](null,s),this.cacheStorage.removeItem(Um.generateTemporaryCacheKey(gv.RENEW_STATUS,n))),zm.removeHiddenIframe(o),s;case 7:return zm.removeHiddenIframe(o),[2]}}))}))},e.prototype.navigateWindow=function(e,t){if(!e||Ov.isEmpty(e))throw this.logger.info("Navigate url is empty"),Pv.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){delete window.activeRenewals[t];for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw o.cacheStorage.resetTempCacheItems(e),Pv.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(a){o.logger.warning(a)}delete window.promiseMappedToRenewStates[e],delete window.callbackMappedToRenewStates[e]})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return lv(this,void 0,void 0,(function(){var t,r,n,o,i,a;return uv(this,(function(s){switch(s.label){case 0:t=e||fv.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,nb.Logout),this.clearCache(),this.account=null,s.label=1;case 1:return s.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,Bm.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:return n="client-request-id="+t,o=void 0,this.getPostLogoutRedirectUri()?(o="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(o="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),i=void 0,this.authorityInstance.EndSessionEndpoint?(i=this.authorityInstance.EndSessionEndpoint+"?"+n+o,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(i=this.authority+"oauth2/v2.0/logout?"+n+o,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(i),[3,6];case 5:return a=s.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,a.errorCode),[3,6];case 6:return[2]}}))}))},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(hv.clientId,hv.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(hv.clientId,hv.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(n.key)),this.logger.verbosePii("Access token removed: "+n.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),wm.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,r){this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");var n,o,i=t;i||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),i=this.getResponseState(e));try{n=this.saveTokenFromHash(e,i)}catch(s){o=s}try{this.cacheStorage.clearMsalCookie(i.state);var a=this.getAccountState(i.state);if(n){if(i.requestType===hv.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+pv.ACCESS_TOKEN),n.tokenType=pv.ACCESS_TOKEN):i.requestType===hv.login&&(this.logger.verbose("Response tokenType set to "+pv.ID_TOKEN),n.tokenType=pv.ID_TOKEN),!r)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=n)}else if(!r)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=eb(a),this.redirectError=o,void this.cacheStorage.resetTempCacheItems(i.state);this.logger.verbose("Calling callback provided to processCallback"),r(n,o)}catch(s){throw this.logger.error("Error occurred in token received callback function: "+s),$v.createErrorInCallbackFunction(s.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,r=this.getResponseState(t);this.logger.verbose("Obtained state from response");var n=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,n)},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),zm.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var r=this.cacheStorage.getItem(Um.generateTemporaryCacheKey(gv.LOGIN_REQUEST,t.state),this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var n=wm.removeHashFromUrl(window.location.href),o=wm.removeHashFromUrl(r);if(n!==o)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+n+", finalRedirectUrl: "+o),void window.location.assign(""+o+e);this.logger.verbose("Current url matches login request url");var i=wm.GetUrlComponents(r);i.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=i.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,r=wm.deserializeHash(e);if(!r)throw Pv.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(pv.STATE))throw Pv.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var n=Mm.parseLibraryState(r.state);if((t={requestType:hv.unknown,state:r.state,timestamp:n.ts,method:n.method,stateMatch:!1}).state===this.cacheStorage.getItem(Um.generateTemporaryCacheKey(gv.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=hv.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(Um.generateTemporaryCacheKey(gv.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=hv.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var o=window.renewStates,i=0;i<o.length;i++)if(o[i]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var r=e.scopes,n=this.getCachedIdToken(e,t),o=this.getCachedAccessToken(e,t,r),i=this.getAccountState(e.state);return Hm.buildAuthResponse(n,o,e,t,r,i)},e.prototype.getTokenCacheItemByAuthority=function(e,t,r,n){var o,i=this;return 1===(o=wm.isCommonAuthority(e)||wm.isOrganizationsAuthority(e)||wm.isConsumersAuthority(e)?Kb.filterTokenCacheItemsByDomain(t,wm.GetUrlComponents(e).HostNameAndPort):Kb.filterTokenCacheItemsByAuthority(t,e)).length?o[0]:o.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),o.forEach((function(e){i.cacheStorage.removeItem(JSON.stringify(e.key))})),null):(this.logger.verbose("No matching tokens of type "+n+" found"),null)},e.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var r=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),n=e.authority||this.authority,o=this.getTokenCacheItemByAuthority(n,r,null,pv.ID_TOKEN);if(o){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(o)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var i=o.value;return i?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),i?new Nm(i.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(o.key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getCachedAccessToken=function(e,t,r){this.logger.verbose("Getting all cached tokens of type Access Token");var n=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),o=Kb.filterTokenCacheItemsByScope(n,r),i=e.authority||this.authority,a=this.getTokenCacheItemByAuthority(i,o,r,pv.ACCESS_TOKEN);if(a){if(e.authorityInstance=Bm.CreateInstance(a.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(a)){this.logger.verbose("Access token expiration is within offset, using access token found in cache");var s=t||this.getAccount();if(!s)throw Pv.createUnexpectedError("Account should not be null here.");var c=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:pv.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:a.value.accessToken,scopes:a.key.scopes.split(" "),expiresOn:new Date(1e3*Number(a.value.expiresIn)),account:s,accountState:c,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(a.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},e.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return Om.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(hv.adalIdToken);return Ov.isEmpty(e)?null:Om.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,n,o){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var i=zm.generateFrameName(Ev,e);zm.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbosePii("RenewToken expected state: "+o.state);var a=wm.urlRemoveQueryStringParameter(wm.createNavigateUrl(o),hv.prompt)+hv.prompt_none+hv.response_mode_fragment;window.renewStates.push(o.state),window.requestType=hv.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to: "+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("RenewIdToken has been called");var i=zm.generateFrameName(Iv,e);zm.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbose("RenewIdToken expected state: "+o.state);var a=wm.urlRemoveQueryStringParameter(wm.createNavigateUrl(o),hv.prompt)+hv.prompt_none+hv.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=hv.login,this.silentAuthenticationState=o.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=hv.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,e,t,r),this.logger.infoPii('Navigate to:" '+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},e.prototype.saveToken=function(e,t,r,n,o){var i=new xm(t,this.clientId,r,n.uid,n.utid),a=new Cm(e.accessToken,e.idToken.rawIdToken,o.toString(),n.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(i),JSON.stringify(a)),o?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*o)):this.logger.error("Could not parse expiresIn parameter for access token"),e},e.prototype.saveIdToken=function(e,t,r,n,o){this.logger.verbose("SaveIdToken has been called");var i=cv({},e);i.scopes=hv.oidcScopes,i.accessToken=r[pv.ID_TOKEN];var a=Number(o.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(i,t,undefined,n,a)},e.prototype.saveAccessToken=function(e,t,r,n){this.logger.verbose("SaveAccessToken has been called");var o=cv({},e),i=r[pv.SCOPE],a=i.split(" "),s=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var c=0;c<s.length;c++){var l=s[c];if(l.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var u=l.key.scopes.split(" ");km.isIntersectingScopes(u,a)&&this.cacheStorage.removeItem(JSON.stringify(l.key))}}o.accessToken=r[pv.ACCESS_TOKEN],o.scopes=a;var d=Pm.parseExpiresIn(r[pv.EXPIRES_IN]),p=Mm.parseLibraryState(r[pv.STATE]).ts+d;return this.logger.verbose("Saving access token to cache"),this.saveToken(o,t,i,n,p)},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},o=wm.deserializeHash(e),i="",a="",s=null;if(o.hasOwnProperty(pv.ERROR_DESCRIPTION)||o.hasOwnProperty(pv.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+o[pv.ERROR]+"; Error description: "+o[pv.ERROR_DESCRIPTION]),this.cacheStorage.setItem(mv.ERROR,o[pv.ERROR]),this.cacheStorage.setItem(mv.ERROR_DESC,o[pv.ERROR_DESCRIPTION]),t.requestType===hv.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(mv.LOGIN_ERROR,o[pv.ERROR_DESCRIPTION]+":"+o[pv.ERROR]),i=Um.generateAuthorityKey(t.state)),t.requestType===hv.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),i=Um.generateAuthorityKey(t.state);var c=this.getAccount(),l=void 0;c&&!Ov.isEmpty(c.homeAccountIdentifier)?(l=c.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(l=hv.no_account,this.logger.verbose("AccountId is set as no_account")),a=Um.generateAcquireTokenAccountKey(l,t.state)}var u=o[pv.ERROR],d=o[pv.ERROR_DESCRIPTION];r=$m.isInteractionRequiredError(u)||$m.isInteractionRequiredError(d)?new $m(o[pv.ERROR],o[pv.ERROR_DESCRIPTION]):new Jm(o[pv.ERROR],o[pv.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(pv.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(Um.generateTemporaryCacheKey(gv.SESSION_STATE,t.state),o[pv.SESSION_STATE])),n.accountState=this.getAccountState(t.state);var p=void 0;if(o.hasOwnProperty(pv.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),n.accessToken=o[pv.ACCESS_TOKEN],o.hasOwnProperty(pv.SCOPE)&&(n.scopes=o[pv.SCOPE].split(" ")),o.hasOwnProperty(pv.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),s=new Nm(o[pv.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),s=new Nm(this.cacheStorage.getItem(vv.IDTOKEN))),n=Hm.setResponseIdToken(n,s);var f=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s);this.logger.verbose("Got authority from cache"),o.hasOwnProperty(pv.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),p=new Rm(o[pv.CLIENT_INFO],f)):this.authorityInstance.AuthorityType===Cv.Adfs?p=Rm.createClientInfoFromIdToken(s,f):this.logger.warning("ClientInfo not received in the response from AAD"),n.account=Fm.createAccount(s,p),this.logger.verbose("Account object created from response");var h=void 0;n.account&&!Ov.isEmpty(n.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),h=n.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),h=hv.no_account),a=Um.generateAcquireTokenAccountKey(h,t.state);var g=Um.generateAcquireTokenAccountKey(hv.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var v=this.cacheStorage.getItem(a),m=void 0;Ov.isEmpty(v)?Ov.isEmpty(this.cacheStorage.getItem(g))||(this.logger.verbose("No acquireToken account retrieved from cache"),n=this.saveAccessToken(n,f,o,p)):(m=JSON.parse(v),this.logger.verbose("AcquireToken request account retrieved from cache"),n.account&&m&&Fm.compareAccounts(n.account,m)?(n=this.saveAccessToken(n,f,o,p),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(o.hasOwnProperty(pv.ID_TOKEN)){this.logger.info("Fragment has idToken"),s=new Nm(o[pv.ID_TOKEN]);f=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s);if(n=Hm.setResponseIdToken(n,s),o.hasOwnProperty(pv.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),p=new Rm(o[pv.CLIENT_INFO],f)):this.authorityInstance.AuthorityType===Cv.Adfs?p=Rm.createClientInfoFromIdToken(s,f):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=Fm.createAccount(s,p),n.account=this.account,this.logger.verbose("Account object created from response"),s&&s.nonce){this.logger.verbose("IdToken has nonce");var b=this.cacheStorage.getItem(Um.generateTemporaryCacheKey(gv.NONCE_IDTOKEN,t.state),this.inCookie);s.nonce!==b?(this.account=null,this.cacheStorage.setItem(mv.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+b+",Actual Nonce: "+s.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+b+", Actual Nonce: "+s.nonce),r=$v.createNonceMismatchError(b,s.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(vv.IDTOKEN,o[pv.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(vv.CLIENT_INFO,p.encodeClientInfo(),this.inCookie),this.saveIdToken(n,f,o,p,s))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),r=$v.createInvalidIdTokenError(s),this.cacheStorage.setItem(mv.ERROR,r.errorCode),this.cacheStorage.setItem(mv.ERROR_DESC,r.errorMessage)}}else{this.logger.verbose("State mismatch"),i=t.state,a=t.state;var y=this.cacheStorage.getItem(Um.generateTemporaryCacheKey(gv.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+y+", Actual State: "+t.state),r=$v.createInvalidStateError(t.state,y),this.cacheStorage.setItem(mv.ERROR,r.errorCode),this.cacheStorage.setItem(mv.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(Um.generateTemporaryCacheKey(gv.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!n)throw Pv.createUnexpectedError("Response is null");return n},e.prototype.populateAuthority=function(e,t,r,n){this.logger.verbose("PopulateAuthority has been called");var o=Um.generateAuthorityKey(e),i=r.getItem(o,t);return Ov.isEmpty(i)?i:wm.replaceTenantPath(i,n.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(vv.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(vv.CLIENT_INFO,this.inCookie);if(!Ov.isEmpty(e)&&!Ov.isEmpty(t)){var r=new Nm(e),n=new Rm(t,"");return this.account=Fm.createAccount(r,n),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(hv.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(hv.clientId,hv.homeAccountIdentifier),r=0;r<t.length;r++){var n=new Nm(t[r].value.idToken),o=new Rm(t[r].value.homeAccountIdentifier,""),i=Fm.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:Bm.CreateInstance(this.authority,this.config.auth.validateAuthority),a=this.getTokenType(o,e),s=new _m(i,this.clientId,a,this.getRedirectUri(),e,r,n);return this.getCachedToken(s,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?wm.getHostFromUri(e)===wm.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},e.prototype.setInteractionInProgress=function(e){this.cacheStorage.setInteractionInProgress(e)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"===typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"===typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw ym.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t){var r=Fm.compareAccounts(e,this.getAccount());return _m.determineResponseType(r,t)},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):hv.no_account,n=Um.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=Um.generateAuthorityKey(e);this.cacheStorage.setItem(r,wm.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r,n){n&&this.cacheStorage.setItem(Um.generateTemporaryCacheKey(gv.LOGIN_REQUEST,e.state),n,this.inCookie),r?this.cacheStorage.setItem(Um.generateTemporaryCacheKey(gv.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(Um.generateTemporaryCacheKey(gv.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return Ov.isEmpty(e.homeAccountIdentifier)?hv.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:hv.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return Vb.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw ym.createTelemetryConfigError(e);return new Vb({platform:{applicationName:r,applicationVersion:n},clientId:t},o,this.logger)},e}(),Wb=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Jb=function(e){b(r,e);var t=C(r);function r(e){var n;return p(this,r),(n=t.call(this)).sessionStorageRequestedScopesKey="mgt-requested-scopes",n.sessionStorageDeniedScopesKey="mgt-denied-scopes",n.initProvider(e),n}return v(r,[{key:"userAgentApplication",get:function(){return this._userAgentApplication}},{key:"name",get:function(){return"MgtMsalProvider"}},{key:"trySilentSignIn",value:function(){return Wb(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this._userAgentApplication.isCallback(window.location.hash)){e.next=3;break}return e.abrupt("return");case 3:if(e.t0=this._userAgentApplication.getAccount(),!e.t0){e.next=8;break}return e.next=7,this.getAccessToken(null);case 7:e.t0=e.sent;case 8:if(!e.t0){e.next=12;break}this.setState(Sn.SignedIn),e.next=13;break;case 12:this.setState(Sn.SignedOut);case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(0),this.setState(Sn.SignedOut);case 18:case"end":return e.stop()}}),e,this,[[0,15]])})))}},{key:"login",value:function(e){return Wb(this,void 0,void 0,Ze().mark((function t(){var r,n;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e||{loginHint:this._loginHint,scopes:this.scopes},this._prompt&&(r.prompt=this._prompt),this._domainHint&&(r.extraQueryParameters={domain_hint:this._domainHint}),this._loginType!==_n.Popup){t.next=10;break}return t.next=6,this._userAgentApplication.loginPopup(r);case 6:n=t.sent,this.setState(n.account?Sn.SignedIn:Sn.SignedOut),t.next=11;break;case 10:this._userAgentApplication.loginRedirect(r);case 11:case"end":return t.stop()}}),t,this)})))}},{key:"logout",value:function(){return Wb(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._userAgentApplication.logout(),this.setState(Sn.SignedOut);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"getAccessToken",value:function(e){return Wb(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e&&e.scopes||this.scopes,n={loginHint:this._loginHint,scopes:r},this._domainHint&&(n.extraQueryParameters={domain_hint:this._domainHint}),t.prev=3,t.next=6,this._userAgentApplication.acquireTokenSilent(n);case 6:return o=t.sent,t.abrupt("return",o.accessToken);case 10:if(t.prev=10,t.t0=t.catch(3),!this.requiresInteraction(t.t0)){t.next=34;break}if(this._loginType!==_n.Redirect){t.next=22;break}if(this.areScopesDenied(r)){t.next=19;break}this.setRequestedScopes(r),this._userAgentApplication.acquireTokenRedirect(n),t.next=20;break;case 19:throw t.t0;case 20:t.next=32;break;case 22:return t.prev=22,t.next=25,this._userAgentApplication.acquireTokenPopup(n);case 25:return i=t.sent,t.abrupt("return",i.accessToken);case 29:throw t.prev=29,t.t1=t.catch(22),t.t1;case 32:t.next=36;break;case 34:throw this.setState(Sn.SignedOut),t.t0;case 36:throw null;case 37:case"end":return t.stop()}}),t,this,[[3,10],[22,29]])})))}},{key:"updateScopes",value:function(e){this.scopes=e}},{key:"requiresInteraction",value:function(e){return!(!e||!e.errorCode)&&(-1!==e.errorCode.indexOf("consent_required")||-1!==e.errorCode.indexOf("interaction_required")||-1!==e.errorCode.indexOf("login_required"))}},{key:"setRequestedScopes",value:function(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}},{key:"getRequestedScopes",value:function(){var e=sessionStorage.getItem(this.sessionStorageRequestedScopesKey);return e?JSON.parse(e):null}},{key:"clearRequestedScopes",value:function(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}},{key:"addDeniedScopes",value:function(e){if(e){var t=this.getDeniedScopes()||[],r=(t=t.concat(e)).indexOf("openid");-1!==r&&t.splice(r,1),-1!==(r=t.indexOf("profile"))&&t.splice(r,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}},{key:"getDeniedScopes",value:function(){var e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}},{key:"areScopesDenied",value:function(e){if(e){var t=this.getDeniedScopes();if(t&&t.filter((function(t){return-1!==e.indexOf(t)})).length>0)return!0}return!1}},{key:"initProvider",value:function(e){var t,r,n=this;if(this.scopes="undefined"!==typeof e.scopes?e.scopes:["user.read"],this._loginType="undefined"!==typeof e.loginType?e.loginType:_n.Redirect,this._loginHint=e.loginHint,this._domainHint=e.domainHint,this._prompt="undefined"!==typeof e.prompt?e.prompt:"select_account","clientId"in e){if(!e.clientId)throw new Error("clientId must be provided");var o=e.options||{auth:{clientId:e.clientId}};o.auth.clientId=e.clientId,o.cache=o.cache||{},o.cache.cacheLocation=o.cache.cacheLocation||"localStorage","undefined"!==typeof o.cache.storeAuthStateInCookie&&null!==o.cache.storeAuthStateInCookie||(o.cache.storeAuthStateInCookie=!0),e.authority&&(o.auth.authority=e.authority),e.redirectUri&&(o.auth.redirectUri=e.redirectUri),r=e.clientId,t=new Qb(o)}else{if(!("userAgentApplication"in e))throw new Error("either clientId or userAgentApplication must be provided");if(!e.userAgentApplication)throw new Error("userAgentApplication must be provided");r=(t=e.userAgentApplication).getCurrentConfiguration().auth.clientId}this.clientId=r,this._userAgentApplication=t,this._userAgentApplication.handleRedirectCallback((function(e){return n.tokenReceivedCallback(e)}),(function(e,t){return n.errorReceivedCallback(e,t)})),this.graph=dr(this),this.trySilentSignIn()}},{key:"tokenReceivedCallback",value:function(e){"id_token"===e.tokenType&&this.setState(Sn.SignedIn),this.clearRequestedScopes()}},{key:"errorReceivedCallback",value:function(e,t){var r=this.getRequestedScopes();r&&this.addDeniedScopes(r),this.clearRequestedScopes()}}]),r}(En),Yb=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Xb=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Zb=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.apply(this,arguments)).clientId="",e}return v(r,[{key:"isAvailable",get:function(){return!0}},{key:"initializeProvider",value:function(){if(this.clientId){var e={clientId:this.clientId,domainHint:this.domainHint,prompt:this.prompt};if(this.loginType&&this.loginType.length>1){var t=this.loginType.toLowerCase();t=t[0].toUpperCase()+t.slice(1);var r=_n[t];e.loginType=r}if(this.authority&&(e.authority=this.authority),this.scopes){var n=this.scopes.split(",");n&&n.length>0&&(e.scopes=n)}this.redirectUri&&(e.redirectUri=this.redirectUri),this.provider=new Jb(e),Pn.globalProvider=this.provider}}}]),r}(Hn);Yb([hn({attribute:"client-id",type:String}),Xb("design:type",Object)],Zb.prototype,"clientId",void 0),Yb([hn({attribute:"login-type",type:String}),Xb("design:type",Object)],Zb.prototype,"loginType",void 0),Yb([hn(),Xb("design:type",Object)],Zb.prototype,"authority",void 0),Yb([hn({attribute:"scopes",type:String}),Xb("design:type",Object)],Zb.prototype,"scopes",void 0),Yb([hn({attribute:"redirect-uri",type:String}),Xb("design:type",Object)],Zb.prototype,"redirectUri",void 0),Yb([hn({attribute:"domain-hint",type:String}),Xb("design:type",Object)],Zb.prototype,"domainHint",void 0),Yb([hn({attribute:"prompt",type:String}),Xb("design:type",Object)],Zb.prototype,"prompt",void 0),Zb=Yb([fn("mgt-msal-provider")],Zb);var $b=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},ey=function(e){b(r,e);var t=C(r);function r(e){var n;return p(this,r),(n=t.call(this,{clientId:e.clientId,loginType:_n.Redirect,options:e.msalOptions,scopes:e.scopes}))._msalOptions=e.msalOptions,n._authPopupUrl=e.authPopupUrl,vo.microsoftTeamsLib.initialize(),n}return v(r,[{key:"name",get:function(){return"MgtTeamsProvider"}},{key:"login",value:function(){return $b(this,void 0,void 0,Ze().mark((function e(){var t,n=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState(Sn.Loading),t=vo.microsoftTeamsLib,e.abrupt("return",new Promise((function(e,o){t.getContext((function(i){n.teamsContext=i;var a={clientId:n.clientId,loginHint:i.loginHint,options:n._msalOptions,scopes:n.scopes.join(",")};localStorage.setItem(r._localStorageParametersKey,JSON.stringify(a));var s=new URL(n._authPopupUrl,new URL(window.location.href));t.authentication.authenticate({failureCallback:function(e){n.setState(Sn.SignedOut),o()},successCallback:function(t){n.trySilentSignIn(),e()},url:s.href})}))})));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"logout",value:function(){return $b(this,void 0,void 0,Ze().mark((function e(){var t,r=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=vo.microsoftTeamsLib,e.abrupt("return",new Promise((function(e,n){t.getContext((function(o){r.teamsContext=o;var i=new URL(r._authPopupUrl,new URL(window.location.href));i.searchParams.append("signout","true"),t.authentication.authenticate({failureCallback:function(e){r.trySilentSignIn(),n()},successCallback:function(t){r.trySilentSignIn(),e()},url:i.href})}))})));case 2:case"end":return e.stop()}}),e)})))}},{key:"getAccessToken",value:function(e){return $b(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.teamsContext||!vo.microsoftTeamsLib){t.next=6;break}return(r=vo.microsoftTeamsLib).initialize(),t.next=5,r.getContext();case 5:this.teamsContext=t.sent;case 6:return n=e&&e.scopes||this.scopes,o={scopes:n},this.teamsContext&&this.teamsContext.loginHint&&(o.loginHint=this.teamsContext.loginHint),t.prev=9,t.next=12,this.userAgentApplication.acquireTokenSilent(o);case 12:return i=t.sent,t.abrupt("return",i.accessToken);case 16:if(t.prev=16,t.t0=t.catch(9),!this.requiresInteraction(t.t0)){t.next=22;break}return t.abrupt("return",null);case 22:throw t.t0;case 23:case"end":return t.stop()}}),t,this,[[9,16]])})))}}],[{key:"isAvailable",get:function(){return vo.isAvailable}},{key:"microsoftTeamsLib",get:function(){return vo.microsoftTeamsLib},set:function(e){vo.microsoftTeamsLib=e}},{key:"handleAuth",value:function(){return $b(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a,s,c,l,u=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=vo.microsoftTeamsLib){e.next=4;break}return console.error("Make sure you have referenced the Microsoft Teams sdk before using the TeamsProvider"),e.abrupt("return");case 4:if(t.initialize(),sessionStorage.getItem(this._sessionStorageLogoutInProgress)&&t.authentication.notifySuccess(),r=new URL(window.location.href),n=r.searchParams.get("signout"),o=localStorage.getItem(this._localStorageParametersKey),(i=o?JSON.parse(o):{}).clientId){e.next=13;break}return t.authentication.notifyFailure("no clientId provided"),e.abrupt("return");case 13:if(a=i.scopes?i.scopes.split(","):null,(s=i.options||{auth:{clientId:i.clientId}}).system=s.system||{},s.system.loadFrameTimeout=1e4,!(c=new Jb({clientId:i.clientId,options:s,scopes:a})).userAgentApplication.urlContainsHash(window.location.hash)){e.next=20;break}return e.abrupt("return");case 20:l=function(){return $b(u,void 0,void 0,Ze().mark((function e(){var r;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.state!==Sn.SignedOut){e.next=7;break}if(!n){e.next=4;break}return t.authentication.notifySuccess(),e.abrupt("return");case 4:sessionStorage.getItem(this._sessionStorageLoginInProgress)||(sessionStorage.setItem(this._sessionStorageLoginInProgress,"true"),c.login({loginHint:i.loginHint,scopes:a||c.scopes})),e.next=23;break;case 7:if(c.state!==Sn.SignedIn){e.next=23;break}if(!n){e.next=13;break}return sessionStorage.setItem(this._sessionStorageLogoutInProgress,"true"),e.next=12,c.logout();case 12:return e.abrupt("return");case 13:return e.prev=13,e.next=16,c.getAccessTokenForScopes.apply(c,d(c.scopes));case 16:r=e.sent,t.authentication.notifySuccess(r),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(13),t.authentication.notifyFailure(e.t0);case 23:case"end":return e.stop()}}),e,this,[[13,20]])})))},c.onStateChanged(l),l();case 23:case"end":return e.stop()}}),e,this)})))}}]),r}(Jb);ey._localStorageParametersKey="msg-teamsprovider-auth-parameters",ey._sessionStorageLoginInProgress="msg-teamsprovider-login-in-progress",ey._sessionStorageLogoutInProgress="msg-teamsprovider-logout-in-progress";var ty=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ry=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ny=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.apply(this,arguments)).clientId="",e.authPopupUrl="",e}return v(r,[{key:"isAvailable",get:function(){return ey.isAvailable}},{key:"initializeProvider",value:function(){if(this.clientId&&this.authPopupUrl){var e={authPopupUrl:this.authPopupUrl,clientId:this.clientId};if(this.scopes){var t=this.scopes.split(",");t&&t.length>0&&(e.scopes=t)}if(this.authority){var r={auth:{authority:this.authority,clientId:this.clientId}};e.msalOptions=r}this.provider=new ey(e),Pn.globalProvider=this.provider}}}]),r}(Hn);ty([hn({attribute:"client-id",type:String}),ry("design:type",Object)],ny.prototype,"clientId",void 0),ty([hn({attribute:"auth-popup-url",type:String}),ry("design:type",Object)],ny.prototype,"authPopupUrl",void 0),ty([hn(),ry("design:type",Object)],ny.prototype,"authority",void 0),ty([hn({attribute:"scopes",type:String}),ry("design:type",Object)],ny.prototype,"scopes",void 0),ny=ty([fn("mgt-teams-provider")],ny);var oy=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},iy=function(){function e(t){p(this,e),this._getCustomHeaders=t}return v(e,[{key:"execute",value:function(e){return oy(this,void 0,void 0,Ze().mark((function t(){var r,n;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._getCustomHeaders){t.next=5;break}return t.next=3,this._getCustomHeaders();case 3:for(n in r=t.sent)r.hasOwnProperty(n)&&ht(e.request,e.options,n,r[n]);case 5:return t.next=7,this.nextMiddleware.execute(e);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}(),ay=function(e){b(r,e);var t=C(r);function r(e,n){p(this,r);var o=[new xt(new wt),new At,new sr(cr),new iy(n),new kt];return t.call(this,Yt.initWithMiddleware({baseUrl:e,middleware:er.apply(void 0,o)}))}return v(r)}(ur),sy=function(e){b(r,e);var t=C(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return p(this,r),(n=t.call(this)).graph=new ay(e,o),n.graph.api("me").get().then((function(e){null!=e?n.setState(Sn.SignedIn):n.setState(Sn.SignedOut)}),(function(e){n.setState(Sn.SignedOut)})),n}return v(r,[{key:"name",get:function(){return"MgtProxyProvider"}},{key:"getAccessToken",value:function(){return null}}]),r}(En),cy=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ly=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},uy=function(e){b(r,e);var t=C(r);function r(){return p(this,r),t.apply(this,arguments)}return v(r,[{key:"isAvailable",get:function(){return!0}},{key:"initializeProvider",value:function(){void 0!==this.graphProxyUrl&&(this.provider=new sy(this.graphProxyUrl),Pn.globalProvider=this.provider)}}]),r}(Hn);cy([hn({attribute:"graph-proxy-url"}),ly("design:type",String)],uy.prototype,"graphProxyUrl",void 0),uy=cy([fn("mgt-proxy-provider")],uy);var dy=function(e,t){return dy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},dy(e,t)};function py(e,t){function r(){this.constructor=e}dy(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var fy,hy,gy=function(){return gy=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},gy.apply(this,arguments)};function vy(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function my(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function by(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function yy(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function ky(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(yy(arguments[t]));return e}!function(e){e.AcquireTokenByCode="acquireTokenByCode",e.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",e.AcquireTokenSilent="acquireTokenSilent",e.AcquireTokenSilentAsync="acquireTokenSilentAsync",e.AcquireTokenPopup="acquireTokenPopup",e.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",e.CryptoOptsSignJwt="cryptoOptsSignJwt",e.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",e.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",e.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",e.SsoSilent="ssoSilent",e.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",e.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",e.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",e.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",e.BrokerHandhshake="brokerHandshake",e.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",e.AcquireTokenByBroker="acquireTokenByBroker",e.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",e.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",e.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",e.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",e.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",e.AcquireTokenFromCache="acquireTokenFromCache",e.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",e.InitializeBaseRequest="initializeBaseRequest",e.InitializeSilentRequest="initializeSilentRequest",e.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",e.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",e.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",e.SilentHandlerLoadFrame="silentHandlerLoadFrame",e.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",e.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",e.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",e.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",e.GetAuthCodeUrl="getAuthCodeUrl",e.HandleCodeResponseFromServer="handleCodeResponseFromServer",e.HandleCodeResponseFromHash="handleCodeResponseFromHash",e.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",e.AuthClientAcquireToken="authClientAcquireToken",e.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",e.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",e.AuthClientCreateQueryString="authClientCreateQueryString",e.PopTokenGenerateCnf="popTokenGenerateCnf",e.PopTokenGenerateKid="popTokenGenerateKid",e.HandleServerTokenResponse="handleServerTokenResponse",e.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",e.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",e.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",e.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",e.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",e.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",e.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",e.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",e.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",e.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",e.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",e.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",e.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",e.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",e.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",e.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken"}(fy||(fy={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(hy||(hy={}));var wy=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]),xy=function(e,t){return xy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},xy(e,t)};function Cy(e,t){function r(){this.constructor=e}xy(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Ty=function(){return Ty=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ty.apply(this,arguments)};function _y(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function Sy(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function Iy(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}var Ey,Ay,Ry,Py,Oy,Ny={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},Dy=[Ny.OPENID_SCOPE,Ny.PROFILE_SCOPE,Ny.OFFLINE_ACCESS_SCOPE],Ly=Iy(Dy,[Ny.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info",e.X_MS_REQUEST_ID="x-ms-request-id",e.X_MS_HTTP_VERSION="x-ms-httpver"}(Ey||(Ey={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account",e.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(Ay||(Ay={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(Ry||(Ry={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_APP_NAME="x-app-name",e.X_APP_VER="x-app-ver",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code",e.NATIVE_BROKER="nativebroker",e.LOGOUT_HINT="logout_hint"}(Py||(Py={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(Oy||(Oy={}));var My,Uy={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(My||(My={}));var Fy,zy,Hy,By,qy,jy,Gy,Vy={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(Fy||(Fy={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(zy||(zy={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(Hy||(Hy={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(By||(By={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(qy||(qy={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"}(jy||(jy={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(Gy||(Gy={}));var Ky,Qy="appmetadata",Wy="1",Jy="authority-metadata",Yy=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network",e.HARDCODED_VALUES="hardcoded_values"}(Ky||(Ky={}));var Xy,Zy={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"}(Xy||(Xy={}));var $y,ek,tk,rk,nk,ok,ik=60,ak=3600,sk="throttling",ck="retry-after, h429",lk="invalid_grant",uk="client_mismatch";!function(e){e.username="username",e.password="password"}($y||($y={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(ek||(ek={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(tk||(tk={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(rk||(rk={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}(nk||(nk={})),function(e){e.Jwt="JWT",e.Jwk="JWK"}(ok||(ok={}));var dk,pk,fk,hk,gk,vk,mk,bk,yk={code:"unexpected_error",desc:"Unexpected error in authentication."},kk={code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},wk=function(e){function t(r,n,o){var i=this,a=n?r+": "+n:r;return i=e.call(this,a)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=r||Ny.EMPTY_STRING,i.errorMessage=n||Ny.EMPTY_STRING,i.subError=o||Ny.EMPTY_STRING,i.name="AuthError",i}return Cy(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(yk.code,yk.desc+": "+e)},t.createPostRequestFailed=function(e){return new t(kk.code,kk.desc+": "+e)},t}(Error),xk=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return Cy(t,e),t}(wk),Ck=["interaction_required","consent_required","login_required"],Tk=["message_only","additional_action","basic_action","user_password_expired","consent_required"],_k={code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},Sk={code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."},Ik=function(e){function t(r,n,o,i,a,s,c){var l=e.call(this,r,n,o)||this;return Object.setPrototypeOf(l,t.prototype),l.timestamp=i||Ny.EMPTY_STRING,l.traceId=a||Ny.EMPTY_STRING,l.correlationId=s||Ny.EMPTY_STRING,l.claims=c||Ny.EMPTY_STRING,l.name="InteractionRequiredAuthError",l}return Cy(t,e),t.isInteractionRequiredError=function(e,t,r){var n=!!e&&Ck.indexOf(e)>-1,o=!!r&&Tk.indexOf(r)>-1,i=!!t&&Ck.some((function(e){return t.indexOf(e)>-1}));return n||i||o},t.createNoTokensFoundError=function(){return new t(_k.code,_k.desc)},t.createNativeAccountUnavailableError=function(){return new t(Sk.code,Sk.desc)},t}(wk),Ek="invalid_grant",Ak=483,Rk=600,Pk="msal",Ok=30,Nk="msal.js.browser",Dk="53ee284d-920a-4b59-9d30-a60315b26836",Lk="ppnbnpeolgkicgegkbkbjmhlideopiji",Mk="MATS";!function(e){e.HandshakeRequest="Handshake",e.HandshakeResponse="HandshakeResponse",e.GetToken="GetToken",e.Response="Response"}(dk||(dk={})),function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(pk||(pk={})),function(e){e.GET="GET",e.POST="POST"}(fk||(fk={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId",e.NATIVE_REQUEST="request.native",e.REDIRECT_CONTEXT="request.redirect.context"}(hk||(hk={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(gk||(gk={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(vk||(vk={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(mk||(mk={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(bk||(bk={}));var Uk,Fk={scopes:Dy},zk="jwk";!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(Uk||(Uk={}));var Hk,Bk="msal.db",qk=Bk+".keys";!function(e){e[e.Default=0]="Default",e[e.AccessToken=1]="AccessToken",e[e.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",e[e.RefreshToken=3]="RefreshToken",e[e.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",e[e.Skip=5]="Skip"}(Hk||(Hk={}));var jk,Gk={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},Vk={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},Kk=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="JoseHeaderError",Object.setPrototypeOf(o,t.prototype),o}return Cy(t,e),t.createMissingKidError=function(){return new t(Gk.code,Gk.desc)},t.createMissingAlgError=function(){return new t(Vk.code,Vk.desc)},t}(wk),Qk=function(){function e(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return e.getShrHeaderString=function(t){if(!t.kid)throw Kk.createMissingKidError();if(!t.alg)throw Kk.createMissingAlgError();var r=new e({typ:t.typ||ok.Jwt,kid:t.kid,alg:t.alg});return JSON.stringify(r)},e}(),Wk=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),Jk=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,Wk.decimalToHex(e[0])+Wk.decimalToHex(e[1])+Wk.decimalToHex(e[2])+Wk.decimalToHex(e[3])+"-"+Wk.decimalToHex(e[4])+Wk.decimalToHex(e[5])+"-"+Wk.decimalToHex(e[6])+Wk.decimalToHex(e[7])+"-"+Wk.decimalToHex(e[8])+Wk.decimalToHex(e[9])+"-"+Wk.decimalToHex(e[10])+Wk.decimalToHex(e[11])+Wk.decimalToHex(e[12])+Wk.decimalToHex(e[13])+Wk.decimalToHex(e[14])+Wk.decimalToHex(e[15])}catch(a){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o=Ny.EMPTY_STRING,i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},e.prototype.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),Yk=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),a=0,s=0;a<r;s++)(t=e.charCodeAt(s))<128?i[a++]=t:t<2048?(i[a++]=192+(t>>>6),i[a++]=128+(63&t)):t<65536?(i[a++]=224+(t>>>12),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<2097152?(i[a++]=240+(t>>>18),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<67108864?(i[a++]=248+(t>>>24),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):(i[a++]=252+(t>>>30),i[a++]=128+(t>>>24&63),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t=Ny.EMPTY_STRING,r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},e.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),Xk=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,Ny.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,Ny.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=Yk.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r=Ny.EMPTY_STRING,n=void 0,o=e.length,i=0,a=0;a<o;a++)n=a%3,i|=e[a]<<(16>>>n&24),2!==n&&e.length-a!==1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Zk=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return Yk.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,Ny.EMPTY_STRING),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),a=void 0,s=void 0,c=0,l=0,u=0;u<n;u++)if(s=3&u,c|=this.b64ToUint6(r.charCodeAt(u))<<18-6*s,3===s||n-u===1){for(a=0;a<3&&l<o;a++,l++)i[l]=c>>>(16>>>a&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),$k={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},ew={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tw={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},rw={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},nw={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},ow={code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},iw={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},aw={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},sw={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},cw={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},lw={code:"state_not_found",desc:"State not found"},uw={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},dw={code:"nonce_not_found",desc:"nonce not found"},pw={code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},fw={code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},hw={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},gw={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},vw={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},mw={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},bw={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},yw={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},kw={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},ww={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},xw={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},Cw={code:"device_code_expired",desc:"Device code is expired."},Tw={code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},_w={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},Sw={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},Iw={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},Ew={code:"no_account_found",desc:"No account found in cache for given key."},Aw={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},Rw={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},Pw={code:"invalid_cache_type",desc:"Invalid cache type"},Ow={code:"unexpected_account_type",desc:"Unexpected account type."},Nw={code:"unexpected_credential_type",desc:"Unexpected credential type."},Dw={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},Lw={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},Mw={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},Uw={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},Fw={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},zw={code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},Hw={code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},Bw={code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},qw={code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},jw=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return Cy(t,e),t.createClientInfoDecodingError=function(e){return new t($k.code,$k.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(ew.code,""+ew.desc)},t.createTokenParsingError=function(e){return new t(tw.code,tw.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(rw.code,rw.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(nw.code,nw.desc+" Detail: "+e)},t.createNetworkError=function(e,r){return new t(ow.code,ow.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(iw.code,iw.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(aw.code,aw.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(sw.code,sw.desc+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(cw.code,cw.desc)},t.createStateNotFoundError=function(e){return new t(lw.code,lw.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(uw.code,uw.desc)},t.createAuthTimeNotFoundError=function(){return new t(pw.code,pw.desc)},t.createMaxAgeTranspiredError=function(){return new t(fw.code,fw.desc)},t.createNonceNotFoundError=function(e){return new t(dw.code,dw.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(hw.code,hw.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(gw.code,gw.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(vw.code,vw.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(mw.code,mw.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(bw.code,bw.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(yw.code,yw.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(kw.code,kw.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(ww.code,""+ww.desc)},t.createDeviceCodeCancelledError=function(){return new t(xw.code,""+xw.desc)},t.createDeviceCodeExpiredError=function(){return new t(Cw.code,""+Cw.desc)},t.createDeviceCodeUnknownError=function(){return new t(Tw.code,""+Tw.desc)},t.createNoAccountInSilentRequestError=function(){return new t(_w.code,""+_w.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(Sw.code,Sw.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(Iw.code,Iw.desc)},t.createNoAccountFoundError=function(){return new t(Ew.code,Ew.desc)},t.createCachePluginError=function(){return new t(Aw.code,""+Aw.desc)},t.createNoCryptoObjectError=function(e){return new t(Rw.code,""+Rw.desc+e)},t.createInvalidCacheTypeError=function(){return new t(Pw.code,""+Pw.desc)},t.createUnexpectedAccountTypeError=function(){return new t(Ow.code,""+Ow.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(Nw.code,""+Nw.desc)},t.createInvalidAssertionError=function(){return new t(Dw.code,""+Dw.desc)},t.createInvalidCredentialError=function(){return new t(Lw.code,""+Lw.desc)},t.createRefreshRequiredError=function(){return new t(Mw.code,Mw.desc)},t.createUserTimeoutReachedError=function(){return new t(Uw.code,Uw.desc)},t.createTokenClaimsRequiredError=function(){return new t(Fw.code,Fw.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(zw.code,zw.desc)},t.createBindingKeyNotRemovedError=function(){return new t(Hw.code,Hw.desc)},t.createLogoutNotSupportedError=function(){return new t(Bw.code,Bw.desc)},t.createKeyIdMissingError=function(){return new t(qw.code,qw.desc)},t}(wk),Gw=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw jw.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw jw.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return"undefined"===typeof e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(n){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t={},r=e.split("&"),n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return r.forEach((function(e){if(e.trim()){var r=e.split(/=(.+)/g,2),o=r[0],i=r[1];o&&i&&(t[n(o)]=n(i))}})),t},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(t){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}(),Vw={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},Kw={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},Qw={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},Ww={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},Jw={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},Yw={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},Xw={code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},Zw={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},$w={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},ex={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},tx={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},rx={code:"empty_window_error",desc:"window.open returned null or undefined window object."},nx={code:"user_cancelled",desc:"User cancelled the flow."},ox={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},ix={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},ax={code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},sx={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},cx={code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},lx={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},ux={code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},dx={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},px={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},fx={code:"no_token_request_cache_error",desc:"No token request found in cache."},hx={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},gx={code:"no_cached_authority_error",desc:"No cached authority found."},vx={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},mx={code:"invalid_cache_type",desc:"Invalid cache type"},bx={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},yx={code:"database_not_open",desc:"Database is not open!"},kx={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},wx={code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},xx={code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},Cx={code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},Tx={code:"unable_to_load_token",desc:"Error loading token to cache."},_x={code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},Sx={code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},Ix={code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},Ex={code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},Ax={code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},Rx={code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},Px={code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},Ox={code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},Nx={code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},Dx={code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."},Lx=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return py(t,e),t.createPkceNotGeneratedError=function(e){return new t(Vw.code,Vw.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(Kw.code,Kw.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(Qw.code,Qw.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(Ww.code,Ww.desc)},t.createEmptyHashError=function(e){return new t(Jw.code,Jw.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(Yw.code,Yw.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(Xw.code,Xw.desc)},t.createUnableToParseStateError=function(){return new t(Zw.code,Zw.desc)},t.createStateInteractionTypeMismatchError=function(){return new t($w.code,$w.desc)},t.createInteractionInProgressError=function(){return new t(ex.code,ex.desc)},t.createPopupWindowError=function(e){var r=tx.desc;return r=Gw.isEmpty(e)?r:r+" Details: "+e,new t(tx.code,r)},t.createEmptyWindowCreatedError=function(){return new t(rx.code,rx.desc)},t.createUserCancelledError=function(){return new t(nx.code,nx.desc)},t.createMonitorPopupTimeoutError=function(){return new t(ox.code,ox.desc)},t.createMonitorIframeTimeoutError=function(){return new t(ix.code,ix.desc)},t.createRedirectInIframeError=function(e){return new t(ax.code,ax.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(sx.code,sx.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t(cx.code,cx.desc)},t.createIframeClosedPrematurelyError=function(){return new t(lx.code,lx.desc)},t.createSilentLogoutUnsupportedError=function(){return new t(ux.code,ux.desc)},t.createNoAccountError=function(){return new t(dx.code,dx.desc)},t.createSilentPromptValueError=function(e){return new t(px.code,px.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(hx.code,hx.desc)},t.createNoTokenRequestCacheError=function(){return new t(fx.code,fx.desc)},t.createAuthRequestNotSetError=function(){return new t(vx.code,vx.desc)},t.createNoCachedAuthorityError=function(){return new t(gx.code,gx.desc)},t.createInvalidCacheTypeError=function(){return new t(mx.code,""+mx.desc)},t.createNonBrowserEnvironmentError=function(){return new t(bx.code,bx.desc)},t.createDatabaseNotOpenError=function(){return new t(yx.code,yx.desc)},t.createNoNetworkConnectivityError=function(){return new t(kx.code,kx.desc)},t.createPostRequestFailedError=function(e,r){return new t(wx.code,wx.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t(xx.code,xx.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(Cx.code,Cx.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t(Tx.code,Tx.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t(_x.code,_x.desc+" | No match found for KeyId: "+e)},t.createAuthCodeRequiredError=function(){return new t(Sx.code,Sx.desc)},t.createAuthCodeOrNativeAccountIdRequiredError=function(){return new t(Ix.code,Ix.desc)},t.createDatabaseUnavailableError=function(){return new t(Ex.code,Ex.desc)},t.createUnableToAcquireTokenFromNativePlatformError=function(){return new t(Ax.code,Ax.desc)},t.createNativeHandshakeTimeoutError=function(){return new t(Rx.code,Rx.desc)},t.createNativeExtensionNotInstalledError=function(){return new t(Px.code,Px.desc)},t.createNativeConnectionNotEstablishedError=function(){return new t(Ox.code,Ox.desc)},t.createNativeBrokerCalledBeforeInitialize=function(){return new t(Nx.code,Nx.desc)},t.createNativePromptParameterNotSupportedError=function(){return new t(Dx.code,Dx.desc)},t}(wk),Mx=function(){function e(e){this.base64Encode=new Xk,this.cryptoObj=e}return e.prototype.generateCodes=function(){return my(this,void 0,void 0,(function(){var e,t;return by(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(t){throw Lx.createPkceNotGeneratedError(t)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return my(this,void 0,void 0,(function(){var t,r;return by(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),Lx.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}(),Ux=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return my(this,void 0,void 0,(function(){return by(this,(function(n){return[2,window.crypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return my(this,void 0,void 0,(function(){return by(this,(function(t){return[2,window.crypto.subtle.exportKey(zk,e)]}))}))},e.prototype.importKey=function(e,t,r,n){return my(this,void 0,void 0,(function(){return by(this,(function(o){return[2,window.crypto.subtle.importKey(zk,e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return my(this,void 0,void 0,(function(){return by(this,(function(n){return[2,window.crypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return my(this,void 0,void 0,(function(){return by(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e}(),Fx=function(){function e(){}return e.prototype.initPrng=function(e){return window.msrCrypto.initPrng(ky(e))},e.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return my(this,void 0,void 0,(function(){return by(this,(function(n){return[2,window.msrCrypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return my(this,void 0,void 0,(function(){return by(this,(function(t){return[2,window.msrCrypto.subtle.exportKey(zk,e)]}))}))},e.prototype.importKey=function(e,t,r,n){return my(this,void 0,void 0,(function(){return by(this,(function(o){return[2,window.msrCrypto.subtle.importKey(zk,e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return my(this,void 0,void 0,(function(){return by(this,(function(n){return[2,window.msrCrypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return my(this,void 0,void 0,(function(){return by(this,(function(r){return[2,window.msrCrypto.subtle.digest(e,t)]}))}))},e}(),zx=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return my(this,void 0,void 0,(function(){return by(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.generateKey(e,t,r);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.exportKey=function(e){return my(this,void 0,void 0,(function(){return by(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey(zk,e);n.addEventListener("complete",(function(e){var n=e.target.result,o=Yk.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,Ny.EMPTY_STRING).replace(/\n/g,Ny.EMPTY_STRING).replace(/\t/g,Ny.EMPTY_STRING).split(" ").join(Ny.EMPTY_STRING).replace("\0",Ny.EMPTY_STRING);try{t(JSON.parse(o))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.importKey=function(e,t,r,n){return my(this,void 0,void 0,(function(){var o,i;return by(this,(function(a){return o=Yk.getSortedObjectString(e),i=Yk.stringToArrayBuffer(o),[2,new Promise((function(e,o){var a=window.msCrypto.subtle.importKey(zk,i,t,r,n);a.addEventListener("complete",(function(t){e(t.target.result)})),a.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.sign=function(e,t,r){return my(this,void 0,void 0,(function(){return by(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.sign(e,t,r);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.digest=function(e,t){return my(this,void 0,void 0,(function(){return by(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e}(),Hx={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},Bx={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},qx={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},jx={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},Gx={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},Vx={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},Kx={code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."},Qx=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return py(t,e),t.createRedirectUriEmptyError=function(){return new t(Hx.code,Hx.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(Bx.code,Bx.desc)},t.createStorageNotSupportedError=function(e){return new t(qx.code,qx.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(jx.code,jx.desc)},t.createStubPcaInstanceCalledError=function(){return new t(Gx.code,Gx.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(Vx.code,Vx.desc)},t.createEntropyNotProvided=function(){return new t(Kx.code,Kx.desc)},t}(wk),Wx="SHA-256",Jx=new Uint8Array([1,0,1]),Yx=function(){function e(e,t){var r,n;if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new Ux;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new zx;else{if(!this.hasMsrCrypto()||!(null===(r=this.cryptoOptions)||void 0===r?void 0:r.useMsrCrypto))throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),Lx.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new Fx}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(null===(n=this.cryptoOptions)||void 0===n?void 0:n.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),Qx.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:Wx,modulusLength:2048,publicExponent:Jx}}return e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},e.prototype.sha256Digest=function(e){return my(this,void 0,void 0,(function(){var t;return by(this,(function(r){return t=Yk.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:Wx},t)]}))}))},e.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return my(this,void 0,void 0,(function(){return by(this,(function(r){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return my(this,void 0,void 0,(function(){return by(this,(function(t){return[2,this.subtleCrypto.exportKey(e)]}))}))},e.prototype.importJwk=function(e,t,r){return my(this,void 0,void 0,(function(){return by(this,(function(n){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,r)]}))}))},e.prototype.sign=function(e,t){return my(this,void 0,void 0,(function(){return by(this,(function(r){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]}))}))},e}(),Xx=function(){function e(){this.dbName=Bk,this.version=1,this.tableName=qk,this.dbOpen=!1}return e.prototype.open=function(){return my(this,void 0,void 0,(function(){var e=this;return by(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(){return r(Lx.createDatabaseUnavailableError())}))}))]}))}))},e.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},e.prototype.validateDbIsOpen=function(){return my(this,void 0,void 0,(function(){return by(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getItem=function(e){return my(this,void 0,void 0,(function(){var t=this;return by(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(Lx.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(n.target.result)})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.setItem=function(e,t){return my(this,void 0,void 0,(function(){var r=this;return by(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,o){if(!r.db)return o(Lx.createDatabaseNotOpenError());var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",(function(){r.closeConnection(),n()})),i.addEventListener("error",(function(e){r.closeConnection(),o(e)}))}))]}}))}))},e.prototype.removeItem=function(e){return my(this,void 0,void 0,(function(){var t=this;return by(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(Lx.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);o.addEventListener("success",(function(){t.closeConnection(),r()})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.getKeys=function(){return my(this,void 0,void 0,(function(){var e=this;return by(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,r){if(!e.db)return r(Lx.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();n.addEventListener("success",(function(r){var n=r;e.closeConnection(),t(n.target.result)})),n.addEventListener("error",(function(t){e.closeConnection(),r(t)}))}))]}}))}))},e.prototype.containsKey=function(e){return my(this,void 0,void 0,(function(){var t=this;return by(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(Lx.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);o.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(1===n.target.result)})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.deleteDatabase=function(){return my(this,void 0,void 0,(function(){return by(this,(function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise((function(e,t){var r=window.indexedDB.deleteDatabase(Bk);r.addEventListener("success",(function(){return e(!0)})),r.addEventListener("blocked",(function(){return e(!0)})),r.addEventListener("error",(function(){return t(!1)}))}))]}))}))},e}(),Zx=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),$x=function(){function e(e,t){this.inMemoryCache=new Zx,this.indexedDBCache=new Xx,this.logger=e,this.storeName=t}return e.prototype.handleDatabaseAccessError=function(e){if(!(e instanceof Lx&&e.errorCode===Ex.code))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},e.prototype.getItem=function(e){return my(this,void 0,void 0,(function(){var t,r;return by(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.setItem=function(e,t){return my(this,void 0,void 0,(function(){var r;return by(this,(function(n){switch(n.label){case 0:this.inMemoryCache.setItem(e,t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}}))}))},e.prototype.removeItem=function(e){return my(this,void 0,void 0,(function(){var t;return by(this,(function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},e.prototype.getKeys=function(){return my(this,void 0,void 0,(function(){var e,t;return by(this,(function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},e.prototype.containsKey=function(e){return my(this,void 0,void 0,(function(){var t,r;return by(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},e.prototype.clearPersistent=function(){return my(this,void 0,void 0,(function(){var e,t;return by(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(e=r.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return t=r.sent(),this.handleDatabaseAccessError(t),[2,!1];case 3:return[2]}}))}))},e}();!function(e){e.asymmetricKeys="asymmetricKeys",e.symmetricKeys="symmetricKeys"}(jk||(jk={}));var eC,tC=function(){function e(e){this.logger=e,this.asymmetricKeys=new $x(this.logger,jk.asymmetricKeys),this.symmetricKeys=new $x(this.logger,jk.symmetricKeys)}return e.prototype.clear=function(){return my(this,void 0,void 0,(function(){var e;return by(this,(function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return(e=t.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},e}(),rC=function(){function e(e,t,r){this.logger=e,this.browserCrypto=new Yx(this.logger,r),this.b64Encode=new Xk,this.b64Decode=new Zk,this.guidGenerator=new Jk(this.browserCrypto),this.pkceGenerator=new Mx(this.browserCrypto),this.cache=new tC(this.logger),this.performanceClient=t}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return my(this,void 0,void 0,(function(){return by(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){var r;return my(this,void 0,void 0,(function(){var n,o,i,a,s,c,l,u;return by(this,(function(d){switch(d.label){case 0:return n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(fy.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return o=d.sent(),[4,this.browserCrypto.exportJwk(o.publicKey)];case 2:return i=d.sent(),a={e:i.e,kty:i.kty,n:i.n},s=Yk.getSortedObjectString(a),[4,this.hashString(s)];case 3:return c=d.sent(),[4,this.browserCrypto.exportJwk(o.privateKey)];case 4:return l=d.sent(),[4,this.browserCrypto.importJwk(l,!1,["sign"])];case 5:return u=d.sent(),[4,this.cache.asymmetricKeys.setItem(c,{privateKey:u,publicKey:o.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return d.sent(),n&&n.endMeasurement({success:!0}),[2,c]}}))}))},e.prototype.removeTokenBindingKey=function(e){return my(this,void 0,void 0,(function(){return by(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},e.prototype.clearKeystore=function(){return my(this,void 0,void 0,(function(){return by(this,(function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}}))}))},e.prototype.signJwt=function(e,t,r){var n;return my(this,void 0,void 0,(function(){var o,i,a,s,c,l,u,d,p,f,h,g,v;return by(this,(function(m){switch(m.label){case 0:return o=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(fy.CryptoOptsSignJwt,r),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(i=m.sent()))throw Lx.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return a=m.sent(),s=Yk.getSortedObjectString(a),c=this.b64Encode.urlEncode(JSON.stringify({kid:t})),l=Qk.getShrHeaderString({kid:c,alg:a.alg}),u=this.b64Encode.urlEncode(l),e.cnf={jwk:JSON.parse(s)},d=this.b64Encode.urlEncode(JSON.stringify(e)),p=u+"."+d,f=Yk.stringToArrayBuffer(p),[4,this.browserCrypto.sign(i.privateKey,f)];case 3:return h=m.sent(),g=this.b64Encode.urlEncodeArr(new Uint8Array(h)),v=p+"."+g,o&&o.endMeasurement({success:!0}),[2,v]}}))}))},e.prototype.hashString=function(e){return my(this,void 0,void 0,(function(){var t,r;return by(this,(function(n){switch(n.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=n.sent(),r=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(r)]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(eC||(eC={}));var nC,oC=function(){function e(t,r,n){this.level=eC.Info;var o=t||e.createDefaultLoggerOptions();this.localCallback=o.loggerCallback||function(){},this.piiLoggingEnabled=o.piiLoggingEnabled||!1,this.level="number"===typeof o.logLevel?o.logLevel:eC.Info,this.correlationId=o.correlationId||Ny.EMPTY_STRING,this.packageName=r||Ny.EMPTY_STRING,this.packageVersion=n||Ny.EMPTY_STRING}return e.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:eC.Info}},e.prototype.clone=function(t,r,n){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(Gw.isEmpty(t.correlationId)?Gw.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+eC[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:eC.Error,containsPii:!1,correlationId:t||Ny.EMPTY_STRING})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:eC.Error,containsPii:!0,correlationId:t||Ny.EMPTY_STRING})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:eC.Warning,containsPii:!1,correlationId:t||Ny.EMPTY_STRING})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:eC.Warning,containsPii:!0,correlationId:t||Ny.EMPTY_STRING})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:eC.Info,containsPii:!1,correlationId:t||Ny.EMPTY_STRING})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:eC.Info,containsPii:!0,correlationId:t||Ny.EMPTY_STRING})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:eC.Verbose,containsPii:!1,correlationId:t||Ny.EMPTY_STRING})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:eC.Verbose,containsPii:!0,correlationId:t||Ny.EMPTY_STRING})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:eC.Trace,containsPii:!1,correlationId:t||Ny.EMPTY_STRING})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:eC.Trace,containsPii:!0,correlationId:t||Ny.EMPTY_STRING})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}(),iC=function(){function e(e,t,r,n,o,i){this.authority=t,this.libraryName=n,this.libraryVersion=o,this.applicationTelemetry=i,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.staticFieldsByCorrelationId=new Map,this.measurementsById=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map,this.countersByCorrelationId=new Map}return e.prototype.startPerformanceMeasurement=function(e,t){return{}},e.prototype.startPerformanceMeasuremeant=function(e,t){return{}},e.prototype.getIntFields=function(){return wy},e.prototype.getPreQueueTime=function(e,t){var r=this.preQueueTimeByCorrelationId.get(t);if(r){if(r.get(e))return r.get(e);this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+e+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+t+", unable to add queue measurement")},e.prototype.calculateQueuedTime=function(e,t){return e<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+e),0):t<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+t),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e},e.prototype.addQueueMeasurement=function(e,t,r){if(t){if(0===r)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+e+" is "+r);else if(!r)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+e);var n={eventName:e,queueTime:r},o=this.queueMeasurements.get(t);if(o)o.push(n),this.queueMeasurements.set(t,o);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+t+" to queue measurements");var i=[n];this.queueMeasurements.set(t,i)}}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+e+", cannot add queue measurement")},e.prototype.startMeasurement=function(e,t){var r,n,o,i=this,a=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",a),this.logger.trace("PerformanceClient: Performance measurement started for "+e,a);var s=this.startPerformanceMeasuremeant(e,a);if(s.startMeasurement)s.startMeasurement(),o=s;else{var c=this.startPerformanceMeasurement(e,a);c.startMeasurement(),o=c}var l={eventId:this.generateId(),status:hy.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:a};this.cacheEventByCorrelationId(l);var u={appName:null===(r=this.applicationTelemetry)||void 0===r?void 0:r.appName,appVersion:null===(n=this.applicationTelemetry)||void 0===n?void 0:n.appVersion};return this.addStaticFields(u,a),this.cacheMeasurement(l,o),{endMeasurement:function(e){var t=i.endMeasurement(Ty(Ty({},l),e));return t&&i.cacheEventByCorrelationId(t),t},flushMeasurement:function(){return i.flushMeasurements(l.name,l.correlationId)},discardMeasurement:function(){return i.discardMeasurements(l.correlationId)},addStaticFields:function(e){return i.addStaticFields(e,l.correlationId)},increment:function(e){return i.increment(e,l.correlationId)},measurement:o,event:l}},e.prototype.endMeasurement=function(e){var t=this.measurementsById.get(e.eventId);if(t){this.measurementsById.delete(e.eventId),t.endMeasurement();var r=t.flushMeasurement();if(null!==r)return this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+r+" ms",e.correlationId),Ty(Ty({durationMs:Math.round(r)},e),{status:hy.Completed});this.logger.trace("PerformanceClient: Performance measurement not taken",e.correlationId)}else this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId);return null},e.prototype.addStaticFields=function(e,t){var r=this.staticFieldsByCorrelationId.get(t);r?(this.logger.trace("PerformanceClient: Updating static fields"),this.staticFieldsByCorrelationId.set(t,Ty(Ty({},r),e))):(this.logger.trace("PerformanceClient: Adding static fields"),this.staticFieldsByCorrelationId.set(t,e))},e.prototype.increment=function(e,t){var r=this.countersByCorrelationId.get(t);if(!r)return this.logger.trace("PerformanceClient: Setting counters"),void this.countersByCorrelationId.set(t,Ty({},e));for(var n in this.logger.trace("PerformanceClient: Updating counters"),e)r.hasOwnProperty(n)||(r[n]=0),r[n]+=e[n]},e.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.set(e.eventId,e)):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,(new Map).set(e.eventId,e)))},e.prototype.cacheMeasurement=function(e,t){this.measurementsById.set(e.eventId,t)},e.prototype.flushMeasurements=function(e,t){var r=this;this.logger.trace("PerformanceClient: Performance measurements flushed for "+e,t);var n=this.queueMeasurements.get(t);n||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+t);var o=0,i=0;null===n||void 0===n||n.forEach((function(e){o+=e.queueTime,i++}));var a=this.eventsByCorrelationId.get(t),s=this.staticFieldsByCorrelationId.get(t),c=this.countersByCorrelationId.get(t);if(a){this.discardCache(t);var l=[],u=0;a.forEach((function(n){if(n.name!==e&&n.status!==hy.Completed){r.logger.trace("PerformanceClient: Incomplete submeasurement "+n.name+" found for "+e,t),u++;var o=r.endMeasurement(n);o&&l.push(o)}l.push(n)}));var d=l.sort((function(e,t){return e.startTimeMs-t.startTimeMs})),p=d.filter((function(t){return t.name===e&&t.status===hy.Completed}));if(p.length>0){p.length>1&&this.logger.verbose("PerformanceClient: Multiple distinct top-level performance events found, using the first",t);var f=p[0];this.logger.verbose("PerformanceClient: Measurement found for "+e,t);var h=d.reduce((function(n,o){if(o.name!==e){r.logger.trace("PerformanceClient: Complete submeasurement found for "+o.name,t);var i=o.name+"DurationMs";n[i]?r.logger.verbose("PerformanceClient: Submeasurement for "+e+" already exists for "+o.name+", ignoring",t):n[i]=o.durationMs}return n}),f),g=Ty(Ty(Ty(Ty({},h),s),c),{queuedTimeMs:o,queuedCount:i,incompleteSubsCount:u});this.truncateIntegralFields(g,this.getIntFields()),this.emitEvents([g],h.correlationId)}else this.logger.verbose("PerformanceClient: No completed top-level measurements found for "+e,t)}else this.logger.verbose("PerformanceClient: No measurements found",t)},e.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},e.prototype.discardCache=function(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: Static fields discarded",e),this.staticFieldsByCorrelationId.delete(e),this.logger.trace("PerformanceClient: Counters discarded",e),this.countersByCorrelationId.delete(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)},e.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},e.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},e.prototype.emitEvents=function(e,t){var r=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach((function(n,o){r.logger.trace("PerformanceClient: Emitting event to callback "+o,t),n.apply(null,[e])}))},e.prototype.truncateIntegralFields=function(e,t){t.forEach((function(t){t in e&&"number"===typeof e[t]&&(e[t]=Math.floor(e[t]))}))},e}(),aC=function(){function e(){}return e.prototype.startMeasurement=function(){},e.prototype.endMeasurement=function(){},e.prototype.flushMeasurement=function(){return null},e}(),sC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Cy(t,e),t.prototype.generateId=function(){return"callback-id"},t.prototype.startPerformanceMeasuremeant=function(){return new aC},t.prototype.startPerformanceMeasurement=function(){return new aC},t.prototype.calculateQueuedTime=function(e,t){return 0},t.prototype.addQueueMeasurement=function(e,t,r){},t.prototype.setPreQueueTime=function(e,t){},t}(iC),cC={createNewGuid:function(){throw wk.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw wk.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw wk.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return _y(this,void 0,void 0,(function(){return Sy(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",wk.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return _y(this,void 0,void 0,(function(){return Sy(this,(function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",wk.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return _y(this,void 0,void 0,(function(){return Sy(this,(function(e){throw"Crypto interface - removeTokenBindingKey() has not been implemented",wk.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return _y(this,void 0,void 0,(function(){return Sy(this,(function(e){throw"Crypto interface - clearKeystore() has not been implemented",wk.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return _y(this,void 0,void 0,(function(){return Sy(this,(function(e){throw"Crypto interface - signJwt() has not been implemented",wk.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return _y(this,void 0,void 0,(function(){return Sy(this,(function(e){throw"Crypto interface - hashString() has not been implemented",wk.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}};function lC(e,t){if(Gw.isEmpty(e))throw jw.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(n){throw jw.createClientInfoDecodingError(n.message)}}function uC(e){if(Gw.isEmpty(e))throw jw.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(By.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?Ny.EMPTY_STRING:t[1]}}!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs",e[e.Dsts=2]="Dsts"}(nC||(nC={}));var dC=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(By.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case Hy.ADFS_ACCOUNT_TYPE:return Gy.ADFS;case Hy.MSAV1_ACCOUNT_TYPE:return Gy.MSA;case Hy.MSSTS_ACCOUNT_TYPE:return Gy.MSSTS;case Hy.GENERIC_ACCOUNT_TYPE:return Gy.GENERIC;default:throw jw.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||Ny.EMPTY_STRING,e.tenantId||Ny.EMPTY_STRING].join(By.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,o,i,a,s,c){var l,u,d,p,f,h,g=new e;g.authorityType=Hy.MSSTS_ACCOUNT_TYPE,g.clientInfo=t,g.homeAccountId=r,g.nativeAccountId=c;var v=s||o&&o.getPreferredCache();if(!v)throw jw.createInvalidCacheEnvironmentError();if(g.environment=v,g.realm=(null===(l=null===n||void 0===n?void 0:n.claims)||void 0===l?void 0:l.tid)||Ny.EMPTY_STRING,n){g.idTokenClaims=n.claims,g.localAccountId=(null===(u=null===n||void 0===n?void 0:n.claims)||void 0===u?void 0:u.oid)||(null===(d=null===n||void 0===n?void 0:n.claims)||void 0===d?void 0:d.sub)||Ny.EMPTY_STRING;var m=null===(p=null===n||void 0===n?void 0:n.claims)||void 0===p?void 0:p.preferred_username,b=(null===(f=null===n||void 0===n?void 0:n.claims)||void 0===f?void 0:f.emails)?n.claims.emails[0]:null;g.username=m||b||Ny.EMPTY_STRING,g.name=null===(h=null===n||void 0===n?void 0:n.claims)||void 0===h?void 0:h.name}return g.cloudGraphHostName=i,g.msGraphHost=a,g},e.createGenericAccount=function(t,r,n,o,i,a){var s,c,l,u,d=new e;d.authorityType=n&&n.authorityType===nC.Adfs?Hy.ADFS_ACCOUNT_TYPE:Hy.GENERIC_ACCOUNT_TYPE,d.homeAccountId=t,d.realm=Ny.EMPTY_STRING;var p=a||n&&n.getPreferredCache();if(!p)throw jw.createInvalidCacheEnvironmentError();return r&&(d.localAccountId=(null===(s=null===r||void 0===r?void 0:r.claims)||void 0===s?void 0:s.oid)||(null===(c=null===r||void 0===r?void 0:r.claims)||void 0===c?void 0:c.sub)||Ny.EMPTY_STRING,d.username=(null===(l=null===r||void 0===r?void 0:r.claims)||void 0===l?void 0:l.upn)||Ny.EMPTY_STRING,d.name=(null===(u=null===r||void 0===r?void 0:r.claims)||void 0===u?void 0:u.name)||Ny.EMPTY_STRING,d.idTokenClaims=null===r||void 0===r?void 0:r.claims),d.environment=p,d.cloudGraphHostName=o,d.msGraphHost=i,d},e.generateHomeAccountId=function(e,t,r,n,o){var i,a=(null===(i=null===o||void 0===o?void 0:o.claims)||void 0===i?void 0:i.sub)?o.claims.sub:Ny.EMPTY_STRING;if(t===nC.Adfs||t===nC.Dsts)return a;if(e)try{var s=lC(e,n);if(!Gw.isEmpty(s.uid)&&!Gw.isEmpty(s.utid))return""+s.uid+By.CLIENT_INFO_SEPARATOR+s.utid}catch(c){}return r.verbose("No client info in response"),a},e.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},e.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var n=!0;if(r){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};n=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n},e}(),pC=function(){function e(){}return e._initRegex=function(){var t=By.CACHE_KEY_SEPARATOR;e.credentialRegexMap=new Map;for(var r=0,n=Object.keys(qy);r<n.length;r++){var o=n[r],i=qy[o].toLowerCase();try{e.credentialRegexMap.set(qy[o],new RegExp("(?<="+t+e.credentialDomainRegex+")"+t+i+t))}catch(a){e.credentialRegexMap.set(qy[o],new RegExp(""+t+e.credentialDomainRegex+t+i+t))}}},e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},e.prototype.generateType=function(){switch(this.credentialType){case qy.ID_TOKEN:return Gy.ID_TOKEN;case qy.ACCESS_TOKEN:case qy.ACCESS_TOKEN_WITH_AUTH_SCHEME:return Gy.ACCESS_TOKEN;case qy.REFRESH_TOKEN:return Gy.REFRESH_TOKEN;default:throw jw.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(e){for(var t,r=0,n=Object.keys(qy);r<n.length;r++){var o=n[r];if(null===(t=this.credentialRegexMap.get(qy[o]))||void 0===t?void 0:t.test(e.toLowerCase()))return qy[o]}return Ny.NOT_DEFINED},e.generateCredentialCacheKey=function(e,t,r,n,o,i,a,s,c){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,a),this.generateTargetForCacheKey(i),this.generateClaimsHashForCacheKey(c),this.generateSchemeForCacheKey(s)].join(By.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(By.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===qy.REFRESH_TOKEN&&n||t,r||Ny.EMPTY_STRING].join(By.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||Ny.EMPTY_STRING).toLowerCase()},e.generateClaimsHashForCacheKey=function(e){return(e||Ny.EMPTY_STRING).toLowerCase()},e.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==Xy.BEARER.toLowerCase()?e.toLowerCase():Ny.EMPTY_STRING},e.credentialDomainRegex="(https?:\\/\\/)?((([\\w-]+\\.)*([\\w-]{1,63})(\\.(\\w{2,63})))|(localhost))(\\:[0-9]{4,5})?",e}();pC._initRegex();var fC,hC={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},gC={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},vC={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},mC={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},bC={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},yC={code:"empty_url_error",desc:"URL was empty or null."},kC={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},wC={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},xC={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},CC={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},TC={code:"token_request_empty",desc:"Token request was empty and not found in cache."},_C={code:"logout_request_empty",desc:"The logout request was null or undefined."},SC={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},IC={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},EC={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},AC={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},RC={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},PC={code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},OC={code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},NC={code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},DC={code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},LC={code:"invalid_authentication_header",desc:"Invalid authentication header provided"},MC=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return Cy(t,e),t.createRedirectUriEmptyError=function(){return new t(hC.code,hC.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(gC.code,gC.desc)},t.createClaimsRequestParsingError=function(e){return new t(vC.code,vC.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(mC.code,mC.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(bC.code,bC.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(yC.code,yC.desc)},t.createEmptyScopesArrayError=function(){return new t(kC.code,""+kC.desc)},t.createClientIdSingleScopeError=function(e){return new t(wC.code,wC.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(xC.code,xC.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(CC.code,CC.desc)},t.createEmptyLogoutRequestError=function(){return new t(_C.code,_C.desc)},t.createEmptyTokenRequestError=function(){return new t(TC.code,TC.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(SC.code,SC.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(IC.code,IC.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(EC.code,EC.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(AC.code,AC.desc)},t.createUntrustedAuthorityError=function(){return new t(RC.code,RC.desc)},t.createInvalidAzureCloudInstanceError=function(){return new t(PC.code,PC.desc)},t.createMissingSshJwkError=function(){return new t(OC.code,OC.desc)},t.createMissingSshKidError=function(){return new t(NC.code,NC.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(DC.code,DC.desc)},t.createInvalidAuthenticationHeaderError=function(e,r){return new t(LC.code,LC.desc+". Invalid header: "+e+". Details: "+r)},t}(jw),UC=function(){function e(e){var t=this,r=e?Gw.trimArrayEntries(Iy(e)):[],n=r?Gw.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||Ny.EMPTY_STRING).split(" "))},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw MC.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!Gw.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return Ly.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){Gw.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(r){throw jw.createAppendScopeSetError(r)}},e.prototype.removeScope=function(e){if(Gw.isEmpty(e))throw jw.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;Ly.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw jw.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw jw.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):Ny.EMPTY_STRING},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}(),FC=function(){function e(t,r){if(Gw.isEmpty(t))throw jw.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=Gw.decodeAuthToken(e);try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(i){throw jw.createTokenParsingError(i)}},e.checkMaxAge=function(e,t){if(0===t||Date.now()-3e5>e+t)throw jw.createMaxAgeTranspiredError()},e}(),zC=function(){function e(e,t){this.clientId=e,this.cryptoImpl=t}return e.prototype.getAllAccounts=function(){var t=this,r=this.getAccountsFilteredBy(),n=Object.keys(r).map((function(e){return r[e]}));return n.length<1?[]:n.map((function(r){var n=e.toObject(new dC,r).getAccountInfo(),o=t.readIdTokenFromCache(t.clientId,n);return o&&!n.idTokenClaims&&(n.idToken=o.secret,n.idTokenClaims=new FC(o.secret,t.cryptoImpl).claims),n}))},e.prototype.saveCacheRecord=function(e){return _y(this,void 0,void 0,(function(){return Sy(this,(function(t){switch(t.label){case 0:if(!e)throw jw.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},e.prototype.saveAccessToken=function(e){return _y(this,void 0,void 0,(function(){var t,r,n,o,i=this;return Sy(this,(function(a){switch(a.label){case 0:return t=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash}),r=UC.fromString(e.target),(n=Object.keys(t.accessTokens).map((function(e){return t.accessTokens[e]})))?(o=[],n.forEach((function(e){UC.fromString(e.target).intersectingScopeSets(r)&&o.push(i.removeCredential(e))})),[4,Promise.all(o)]):[3,2];case 1:a.sent(),a.label=2;case 2:return this.setAccessTokenCredential(e),[2]}}))}))},e.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:Ny.EMPTY_STRING,e?e.environment:Ny.EMPTY_STRING,e?e.realm:Ny.EMPTY_STRING,e?e.nativeAccountId:Ny.EMPTY_STRING)},e.prototype.getAccountsFilteredByInternal=function(e,t,r,n){var o=this,i=this.getKeys(),a={};return i.forEach((function(i){var s=o.getAccount(i);s&&(e&&!o.matchHomeAccountId(s,e)||t&&!o.matchEnvironment(s,t)||r&&!o.matchRealm(s,r)||n&&!o.matchNativeAccountId(s,n)||(a[i]=s))})),a},e.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.userAssertionHash,e.tokenType,e.keyId,e.requestedClaimsHash)},e.prototype.getCredentialsFilteredByInternal=function(e,t,r,n,o,i,a,s,c,l,u){var d=this,p=this.getKeys(),f={idTokens:{},accessTokens:{},refreshTokens:{}};return p.forEach((function(p){var h=pC.getCredentialType(p);if(h!==Ny.NOT_DEFINED){var g=d.getSpecificCredential(p,h);if(g&&(!s||d.matchUserAssertionHash(g,s))&&("string"!==typeof e||d.matchHomeAccountId(g,e))&&(!t||d.matchEnvironment(g,t))&&(!i||d.matchRealm(g,i))&&(!r||d.matchCredentialType(g,r))&&(!n||d.matchClientId(g,n))&&(!o||d.matchFamilyId(g,o))&&(!a||d.matchTarget(g,a))&&(!u&&!g.requestedClaimsHash||g.requestedClaimsHash===u)){if(r===qy.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(c&&!d.matchTokenType(g,c))return;if(c===Xy.SSH&&l&&!d.matchKeyId(g,l))return}var v=d.updateCredentialCacheKey(p,g);switch(h){case qy.ID_TOKEN:f.idTokens[v]=g;break;case qy.ACCESS_TOKEN:case qy.ACCESS_TOKEN_WITH_AUTH_SCHEME:f.accessTokens[v]=g;break;case qy.REFRESH_TOKEN:f.refreshTokens[v]=g}}}})),f},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),o={};return n.forEach((function(n){if(r.isAppMetadata(n)){var i=r.getAppMetadata(n);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(o[n]=i))}})),o},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var o=t.getAuthorityMetadata(r);o&&-1!==o.aliases.indexOf(e)&&(n=o)}})),n},e.prototype.removeAllAccounts=function(){return _y(this,void 0,void 0,(function(){var e,t,r=this;return Sy(this,(function(n){switch(n.label){case 0:return e=this.getKeys(),t=[],e.forEach((function(e){r.getAccount(e)&&t.push(r.removeAccount(e))})),[4,Promise.all(t)];case 1:return n.sent(),[2,!0]}}))}))},e.prototype.removeAccount=function(e){return _y(this,void 0,void 0,(function(){var t;return Sy(this,(function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw jw.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return[2,r.sent()&&this.removeItem(e,jy.ACCOUNT)]}}))}))},e.prototype.removeAccountContext=function(e){return _y(this,void 0,void 0,(function(){var t,r,n,o=this;return Sy(this,(function(i){switch(i.label){case 0:return t=this.getKeys(),r=e.generateAccountId(),n=[],t.forEach((function(e){var t=pC.getCredentialType(e);if(t!==Ny.NOT_DEFINED){var i=o.getSpecificCredential(e,t);i&&r===i.generateAccountId()&&n.push(o.removeCredential(i))}})),[4,Promise.all(n)];case 1:return i.sent(),[2,!0]}}))}))},e.prototype.removeCredential=function(e){return _y(this,void 0,void 0,(function(){var t,r;return Sy(this,(function(n){switch(n.label){case 0:if(t=e.generateCredentialKey(),e.credentialType.toLowerCase()!==qy.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(e.tokenType!==Xy.POP)return[3,4];if(!(r=e.keyId))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(r)];case 2:return n.sent(),[3,4];case 3:throw n.sent(),jw.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t,jy.CREDENTIAL)]}}))}))},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,jy.APP_METADATA)})),!0},e.prototype.readCacheRecord=function(e,t,r,n){var o=this.readAccountFromCache(e),i=this.readIdTokenFromCache(t,e),a=this.readAccessTokenFromCache(t,e,r),s=this.readRefreshTokenFromCache(t,e,!1),c=this.readAppMetadataFromCache(n,t);return o&&i&&(o.idTokenClaims=new FC(i.secret,this.cryptoImpl).claims),{account:o,idToken:i,accessToken:a,refreshToken:s,appMetadata:c}},e.prototype.readAccountFromCache=function(e){var t=dC.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.readAccountFromCacheWithNativeAccountId=function(e){var t={nativeAccountId:e},r=this.getAccountsFilteredBy(t),n=Object.keys(r).map((function(e){return r[e]}));if(n.length<1)return null;if(n.length>1)throw jw.createMultipleMatchingAccountsInCacheError();return r[0]},e.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:qy.ID_TOKEN,clientId:e,realm:t.tenantId},n=this.getCredentialsFilteredBy(r),o=Object.keys(n.idTokens).map((function(e){return n.idTokens[e]})),i=o.length;if(i<1)return null;if(i>1)throw jw.createMultipleMatchingTokensInCacheError();return o[0]},e.prototype.readAccessTokenFromCache=function(e,t,r){var n=new UC(r.scopes||[]),o=r.authenticationScheme||Xy.BEARER,i=o&&o.toLowerCase()!==Xy.BEARER.toLowerCase()?qy.ACCESS_TOKEN_WITH_AUTH_SCHEME:qy.ACCESS_TOKEN,a={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:i,clientId:e,realm:t.tenantId,target:n.printScopesLowerCase(),tokenType:o,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash},s=this.getCredentialsFilteredBy(a),c=Object.keys(s.accessTokens).map((function(e){return s.accessTokens[e]})),l=c.length;if(l<1)return null;if(l>1)throw jw.createMultipleMatchingTokensInCacheError();return c[0]},e.prototype.readRefreshTokenFromCache=function(e,t,r){var n=r?Wy:void 0,o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:qy.REFRESH_TOKEN,clientId:e,familyId:n},i=this.getCredentialsFilteredBy(o),a=Object.keys(i.refreshTokens).map((function(e){return i.refreshTokens[e]}));return a.length<1?null:a[0]},e.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t},n=this.getAppMetadataFilteredBy(r),o=Object.keys(n).map((function(e){return n[e]})),i=o.length;if(i<1)return null;if(i>1)throw jw.createMultipleMatchingAppMetadataInCacheError();return o[0]},e.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||r.familyId!==Wy)},e.prototype.matchHomeAccountId=function(e,t){return!("string"!==typeof e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchUserAssertionHash=function(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchNativeAccountId=function(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)},e.prototype.matchTarget=function(e,t){if(e.credentialType!==qy.ACCESS_TOKEN&&e.credentialType!==qy.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;var r=UC.fromString(e.target),n=UC.fromString(t);return n.containsOnlyOIDCScopes()?n.removeScope(Ny.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),r.containsScopeSet(n)},e.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},e.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(Qy)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(Jy)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return Jy+"-"+this.clientId+"-"+e},e.prototype.getSpecificCredential=function(e,t){switch(t){case qy.ID_TOKEN:return this.getIdTokenCredential(e);case qy.ACCESS_TOKEN:case qy.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case qy.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),HC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Cy(t,e),t.prototype.setAccount=function(){throw wk.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw wk.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw wk.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw wk.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw wk.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw wk.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw wk.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw wk.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw wk.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw wk.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw wk.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw wk.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw wk.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw wk.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw wk.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw wk.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw wk.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw wk.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw wk.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw wk.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return _y(this,void 0,void 0,(function(){return Sy(this,(function(e){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",wk.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t.prototype.updateCredentialCacheKey=function(){throw wk.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},t}(zC),BC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Cy(t,e),t.createIdTokenEntity=function(e,r,n,o,i){var a=new t;return a.credentialType=qy.ID_TOKEN,a.homeAccountId=e,a.environment=r,a.clientId=o,a.secret=n,a.realm=i,a},t.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===qy.ID_TOKEN)},t}(pC),qC=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},e}(),jC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Cy(t,e),t.createAccessTokenEntity=function(e,r,n,o,i,a,s,c,l,u,d,p,f,h,g){var v,m,b=new t;b.homeAccountId=e,b.credentialType=qy.ACCESS_TOKEN,b.secret=n;var y=qC.nowSeconds();if(b.cachedAt=y.toString(),b.expiresOn=s.toString(),b.extendedExpiresOn=c.toString(),u&&(b.refreshOn=u.toString()),b.environment=r,b.clientId=o,b.realm=i,b.target=a,b.userAssertionHash=p,b.tokenType=Gw.isEmpty(d)?Xy.BEARER:d,h&&(b.requestedClaims=h,b.requestedClaimsHash=g),(null===(v=b.tokenType)||void 0===v?void 0:v.toLowerCase())!==Xy.BEARER.toLowerCase())switch(b.credentialType=qy.ACCESS_TOKEN_WITH_AUTH_SCHEME,b.tokenType){case Xy.POP:var k=FC.extractTokenClaims(n,l);if(!(null===(m=null===k||void 0===k?void 0:k.cnf)||void 0===m?void 0:m.kid))throw jw.createTokenClaimsRequiredError();b.keyId=k.cnf.kid;break;case Xy.SSH:b.keyId=f}return b},t.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===qy.ACCESS_TOKEN||e.credentialType===qy.ACCESS_TOKEN_WITH_AUTH_SCHEME))},t}(pC),GC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Cy(t,e),t.createRefreshTokenEntity=function(e,r,n,o,i,a){var s=new t;return s.clientId=o,s.credentialType=qy.REFRESH_TOKEN,s.environment=r,s.homeAccountId=e,s.secret=n,s.userAssertionHash=a,i&&(s.familyId=i),s},t.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===qy.REFRESH_TOKEN)},t}(pC),VC=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[Qy,e,t].join(By.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var o=new e;return o.clientId=t,o.environment=r,n&&(o.familyId=n),o},e.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(Qy)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},e}(),KC=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(Zy.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},e}(),QC=function(){function e(){this.expiresAt=qC.nowSeconds()+Yy}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=qC.nowSeconds()+Yy},e.prototype.isExpired=function(){return this.expiresAt<=qC.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(Jy)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"))},e}(),WC=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(sk));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},e}(),JC=function(){function e(){}return e.setRequestState=function(t,r,n){var o=e.generateLibraryState(t,n);return Gw.isEmpty(r)?o:""+o+Ny.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){if(!e)throw jw.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw jw.createNoCryptoObjectError("parseRequestState");if(Gw.isEmpty(t))throw jw.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(Ny.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(Ny.RESOURCE_DELIM):Ny.EMPTY_STRING,i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:Gw.isEmpty(o)?Ny.EMPTY_STRING:o,libraryState:a}}catch(s){throw jw.createInvalidStateError(t,s)}},e}();!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(fC||(fC={}));var YC,XC,ZC=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==pk.LocalStorage&&e!==pk.SessionStorage)throw Qx.createStorageNotSupportedError(e);if(!!!window[e])throw Qx.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),$C=function(){function e(t){if(this._urlString=t,Gw.isEmpty(this._urlString))throw MC.createUrlEmptyError();Gw.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return Gw.endsWith(t,"?")?t=t.slice(0,-1):Gw.endsWith(t,"?/")&&(t=t.slice(0,-2)),Gw.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(t){throw MC.createUrlParseError(t)}if(!e.HostNameAndPort||!e.PathSegments)throw MC.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw MC.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return Gw.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==Ry.COMMON&&n[0]!==Ry.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw MC.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,!Gw.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw MC.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===Ny.FORWARD_SLASH){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):Ny.EMPTY_STRING},e.parseQueryString=function(e){var t=e.indexOf("?"),r=e.indexOf("/?");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):Ny.EMPTY_STRING},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(Gw.isEmpty(t))return{};var r=e.parseHash(t),n=Gw.queryStringToObject(Gw.isEmpty(r)?t:r);if(!n)throw jw.createHashNotDeserializedError(JSON.stringify(n));return n},e.getDeserializedQueryString=function(t){if(Gw.isEmpty(t))return{};var r=e.parseQueryString(t),n=Gw.queryStringToObject(Gw.isEmpty(r)?t:r);if(!n)throw jw.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(Gw.isEmpty(t)||t.indexOf("=")<0)return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}(),eT=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(Gw.isEmpty(t))return null;try{return JC.parseRequestState(e,t).libraryState.meta}catch(r){throw jw.createInvalidStateError(t,r)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new $C(e);return $C.getDeserializedHash(t.getHash())},e}(),tT=function(e){function t(t,r,n,o){var i=e.call(this,t,n)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=o,i.internalStorage=new Zx,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),i.migrateCacheEntries(),i}return py(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case pk.LocalStorage:case pk.SessionStorage:try{return new ZC(e)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=pk.MemoryStorage,new Zx},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case pk.LocalStorage:case pk.SessionStorage:try{return new ZC(pk.SessionStorage)}catch(t){return this.logger.verbose(t),this.internalStorage}case pk.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=Ny.CACHE_PREFIX+"."+Ay.ID_TOKEN,r=Ny.CACHE_PREFIX+"."+Ay.CLIENT_INFO,n=Ny.CACHE_PREFIX+"."+Ay.ERROR,o=Ny.CACHE_PREFIX+"."+Ay.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[Ay.ID_TOKEN,Ay.CLIENT_INFO,Ay.ERROR,Ay.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,i[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(r){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);return r&&dC.isAccountEntity(r)?zC.toObject(new dC,r):null},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&BC.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),zC.toObject(new BC,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&jC.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),zC.toObject(new jC,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&GC.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),zC.toObject(new GC,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&VC.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),zC.toObject(new VC,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&KC.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),zC.toObject(new KC,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&QC.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),zC.toObject(new QC,r)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(gk.WRAPPER_SKU,e),this.internalStorage.setItem(gk.WRAPPER_VER,t)},t.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(gk.WRAPPER_SKU)||Ny.EMPTY_STRING,this.internalStorage.getItem(gk.WRAPPER_VER)||Ny.EMPTY_STRING]},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(Ay.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var r=this.generateCacheKey(Ay.ACTIVE_ACCOUNT),n=this.getItem(r);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var o=this.getAccountInfoByFilter({localAccountId:n})[0]||null;return o?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(o),o):null}var i=this.validateAndParseJson(t);return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},t.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(Ay.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(Ay.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");var n={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId};this.browserStorage.setItem(t,JSON.stringify(n)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(r)},t.prototype.getAccountInfoByFilter=function(e){var t=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+t.length+" accounts found"),t.filter((function(t){return(!e.username||e.username.toLowerCase()===t.username.toLowerCase())&&((!e.homeAccountId||e.homeAccountId===t.homeAccountId)&&((!e.localAccountId||e.localAccountId===t.localAccountId)&&((!e.tenantId||e.tenantId===t.tenantId)&&(!e.environment||e.environment===t.environment))))}))},t.prototype.getAccountInfoByHints=function(e,t){var r=this.getAllAccounts().filter((function(r){if(t){var n=r.idTokenClaims&&r.idTokenClaims.sid;return t===n}return!!e&&e===r.username}));if(1===r.length)return r[0];if(r.length>1)throw jw.createMultipleMatchingAccountsInCacheError();return null},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&WC.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),zC.toObject(new WC,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===pk.LocalStorage){var i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o},t.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))},t.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e)),!0},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return ky(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return my(this,void 0,void 0,(function(){var e=this;return by(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(Ny.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},t.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;SameSite=Lax;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return Ny.EMPTY_STRING},t.prototype.clearMsalCookies=function(){var e=this,t=Ny.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var n=r.split("=")[0];e.clearItemCookie(n)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,Ny.EMPTY_STRING,-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):Gw.startsWith(e,Ny.CACHE_PREFIX)||Gw.startsWith(e,Ay.ADAL_ID_TOKEN)?e:Ny.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=JC.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(hk.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=JC.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(hk.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=JC.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(hk.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},t.prototype.updateCacheEntries=function(e,t,r,n,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);var s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,r,!1),o){var c={credential:o.homeAccountId,type:fC.HOME_ACCOUNT_ID};this.setTemporaryCache(hk.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(!Gw.isEmpty(n)){c={credential:n,type:fC.UPN};this.setTemporaryCache(hk.CCS_CREDENTIAL,JSON.stringify(c),!0)}},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),Gw.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(hk.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(hk.ORIGIN_URI)),this.removeItem(this.generateCacheKey(hk.URL_HASH)),this.removeItem(this.generateCacheKey(hk.CORRELATION_ID)),this.removeItem(this.generateCacheKey(hk.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(hk.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||Ny.EMPTY_STRING)}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){if(-1!==r.indexOf(hk.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var o=eT.extractBrowserRequestState(t.cryptoImpl,n);o&&o.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(hk.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(hk.REQUEST_PARAMS,!0);if(!r)throw Lx.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw Lx.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(hk.REQUEST_PARAMS)),Gw.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw Lx.createNoCachedAuthorityError();n.authority=i}return n},t.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var e=this.getTemporaryCache(hk.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){var e=Ny.CACHE_PREFIX+"."+hk.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},t.prototype.setInteractionInProgress=function(e){var t=Ny.CACHE_PREFIX+"."+hk.INTERACTION_STATUS_KEY;if(e){if(this.getInteractionInProgress())throw Lx.createInteractionInProgressError();this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeItem(t)},t.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(Ay.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(Ay.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(Ay.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(Ay.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=t||e;if(r){var n=new FC(r,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t.prototype.updateCredentialCacheKey=function(e,t){var r=t.generateCredentialKey();if(e!==r){var n=this.getItem(e);if(n)return this.removeItem(e),this.setItem(r,n),this.logger.verbose("Updated an outdated "+t.credentialType+" cache key"),r;this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}return e},t.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(hk.REDIRECT_CONTEXT,!0)},t.prototype.setRedirectRequestContext=function(e){this.setTemporaryCache(hk.REDIRECT_CONTEXT,e,!0)},t}(zC);!function(e){e.AAD="AAD",e.OIDC="OIDC"}(YC||(YC={})),function(e){e[e.None=0]="None",e.AzurePublic="https://login.microsoftonline.com",e.AzurePpe="https://login.windows-ppe.net",e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureUsGovernment="https://login.microsoftonline.us"}(XC||(XC={}));var rT="10.0.0",nT={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},oT={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:eC.Info,correlationId:Ny.EMPTY_STRING},iT={sendGetRequestAsync:function(){return _y(this,void 0,void 0,(function(){return Sy(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",wk.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return _y(this,void 0,void 0,(function(){return Sy(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",wk.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},aT={sku:Ny.SKU,version:rT,cpu:Ny.EMPTY_STRING,os:Ny.EMPTY_STRING},sT={clientSecret:Ny.EMPTY_STRING,clientAssertion:void 0},cT={azureCloudInstance:XC.None,tenant:""+Ny.DEFAULT_COMMON_TENANT},lT={application:{appName:"",appVersion:""}};var uT={sendGetRequestAsync:function(){return Promise.reject(wk.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(wk.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},dT=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return my(this,void 0,void 0,(function(){var r,n,o;return by(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:fk.GET,headers:this.getFetchHeaders(t)})];case 1:return r=i.sent(),[3,3];case 2:throw n=i.sent(),window.navigator.onLine?Lx.createGetRequestFailedError(n,e):Lx.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),o={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(o.body=i.sent(),o.status=r.status,o)];case 5:throw i.sent(),Lx.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return my(this,void 0,void 0,(function(){var r,n,o,i;return by(this,(function(a){switch(a.label){case 0:r=t&&t.body||Ny.EMPTY_STRING,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fetch(e,{method:fk.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return n=a.sent(),[3,4];case 3:throw o=a.sent(),window.navigator.onLine?Lx.createPostRequestFailedError(o,e):Lx.createNoNetworkConnectivityError();case 4:return a.trys.push([4,6,,7]),i={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 5:return[2,(i.body=a.sent(),i.status=n.status,i)];case 6:throw a.sent(),Lx.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),pT=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return my(this,void 0,void 0,(function(){return by(this,(function(r){return[2,this.sendRequestAsync(e,fk.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return my(this,void 0,void 0,(function(){return by(this,(function(r){return[2,this.sendRequestAsync(e,fk.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(o,i){var a=new XMLHttpRequest;if(a.open(t,e,!0),n.setXhrHeaders(a,r),a.onload=function(){(a.status<200||a.status>=300)&&(t===fk.POST?i(Lx.createPostRequestFailedError("Failed with status "+a.status,e)):i(Lx.createGetRequestFailedError("Failed with status "+a.status,e)));try{var r=JSON.parse(a.responseText),s={headers:n.getHeaderDict(a),body:r,status:a.status};o(s)}catch(c){i(Lx.createFailedToParseNetworkResponseError(e))}},a.onerror=function(){window.navigator.onLine?t===fk.POST?i(Lx.createPostRequestFailedError("Failed with status "+a.status,e)):i(Lx.createGetRequestFailedError("Failed with status "+a.status,e)):i(Lx.createNoNetworkConnectivityError())},t===fk.POST&&r&&r.body)a.send(r.body);else{if(t!==fk.GET)throw Lx.createHttpMethodNotImplementedError(t);a.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");n&&o&&(r[n]=o)})),r},e}(),fT=function(){function e(){}return e.clearHash=function(e){e.location.hash=Ny.EMPTY_STRING,"function"===typeof e.history.replaceState&&e.history.replaceState(null,Ny.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):Ny.EMPTY_STRING},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!==typeof window&&!!window.opener&&window.opener!==window&&"string"===typeof window.name&&0===window.name.indexOf(Pk+".")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new $C(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new dT:new pT},e.blockReloadInHiddenIframes=function(){if($C.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw Lx.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===mk.Redirect&&n&&!r)throw Lx.createRedirectInIframeError(n)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw Lx.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw Lx.createNonBrowserEnvironmentError()},e.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw Lx.createNativeBrokerCalledBeforeInitialize()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e}(),hT=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),gT=6e3;var vT,mT="@azure/msal-browser",bT="2.33.0";!function(e){e.INITIALIZE_START="msal:initializeStart",e.INITIALIZE_END="msal:initializeEnd",e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(vT||(vT={}));var yT,kT=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(e){if("undefined"!==typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.enableAccountStorageEvents=function(){"undefined"!==typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){"undefined"!==typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(e,t,r,n){var o=this;if("undefined"!==typeof window){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])}))}},e.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var r=JSON.parse(t);if("object"!==typeof r||!dC.isAccountEntity(r))return;var n=zC.toObject(new dC,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(vT.ACCOUNT_ADDED,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(vT.ACCOUNT_REMOVED,void 0,n))}catch(e){return}},e}(),wT=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return sk+"."+JSON.stringify(e)},e.preProcess=function(t,r){var n,o=e.generateThrottlingStorageKey(r),i=t.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void t.removeItem(o,jy.THROTTLING);throw new xk((null===(n=i.errorCodes)||void 0===n?void 0:n.join(" "))||Ny.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var o={throttleTime:e.calculateThrottleTime(parseInt(n.headers[Ey.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),o)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(Ey.RETRY_AFTER)&&(e.status<200||e.status>=300))},e.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||ik),r+ak))},e.removeThrottle=function(e,t,r,n){var o={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},i=this.generateThrottlingStorageKey(o);return e.removeItem(i,jy.THROTTLING)},e}(),xT=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return _y(this,void 0,void 0,(function(){var n,o;return Sy(this,(function(i){switch(i.label){case 0:wT.preProcess(this.cacheManager,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return n=i.sent(),[3,4];case 3:throw(o=i.sent())instanceof wk?o:jw.createNetworkError(t,o);case 4:return wT.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}(),CT=function(){function e(){}return e.validateRedirectUri=function(e){if(Gw.isEmpty(e))throw MC.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in Uy)t.push(Uy[r]);if(t.indexOf(e)<0)throw MC.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(t){throw MC.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(Gw.isEmpty(e)||Gw.isEmpty(t))throw MC.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([Vy.PLAIN,Vy.S256].indexOf(e)<0)throw MC.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),Object.fromEntries(Object.entries(e).filter((function(e){return""!==e[1]})))):{}},e}(),TT=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(Py.RESPONSE_TYPE,encodeURIComponent(Ny.CODE_RESPONSE_TYPE))},e.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(Py.RESPONSE_TYPE,encodeURIComponent(Ny.TOKEN_RESPONSE_TYPE+" "+Ny.ID_TOKEN_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(Py.RESPONSE_MODE,encodeURIComponent(e||Fy.QUERY))},e.prototype.addNativeBroker=function(){this.parameters.set(Py.NATIVE_BROKER,encodeURIComponent("1"))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?Iy(e||[],Dy):e||[],n=new UC(r);this.parameters.set(Py.SCOPE,encodeURIComponent(n.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(Py.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){CT.validateRedirectUri(e),this.parameters.set(Py.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){CT.validateRedirectUri(e),this.parameters.set(Py.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(Py.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(My.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(My.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(Ey.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(Ey.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(My.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);CT.validateClaims(r),this.parameters.set(Py.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(Py.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(Py.X_CLIENT_SKU,e.sku),this.parameters.set(Py.X_CLIENT_VER,e.version),e.os&&this.parameters.set(Py.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(Py.X_CLIENT_CPU,e.cpu)},e.prototype.addApplicationTelemetry=function(e){(null===e||void 0===e?void 0:e.appName)&&this.parameters.set(Py.X_APP_NAME,e.appName),(null===e||void 0===e?void 0:e.appVersion)&&this.parameters.set(Py.X_APP_VER,e.appVersion)},e.prototype.addPrompt=function(e){CT.validatePrompt(e),this.parameters.set(""+Py.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){Gw.isEmpty(e)||this.parameters.set(Py.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(Py.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(CT.validateCodeChallengeParams(e,t),!e||!t)throw MC.createInvalidCodeChallengeParamsError();this.parameters.set(Py.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(Py.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(Py.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(Py.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(Py.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(Py.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(Py.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){Gw.isEmpty(e)||this.parameters.set(Py.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){Gw.isEmpty(e)||this.parameters.set(Py.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(Py.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(Py.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(Py.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this,r=CT.sanitizeEQParams(e,this.parameters);Object.keys(r).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(n){throw MC.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(Oy.ACCESS_TOKEN)||(r[Oy.ACCESS_TOKEN]={}),r[Oy.ACCESS_TOKEN][Oy.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set($y.username,encodeURIComponent(e))},e.prototype.addPassword=function(e){this.parameters.set($y.password,encodeURIComponent(e))},e.prototype.addPopToken=function(e){Gw.isEmpty(e)||(this.parameters.set(Py.TOKEN_TYPE,Xy.POP),this.parameters.set(Py.REQ_CNF,encodeURIComponent(e)))},e.prototype.addSshJwk=function(e){Gw.isEmpty(e)||(this.parameters.set(Py.TOKEN_TYPE,Xy.SSH),this.parameters.set(Py.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(Py.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(Py.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(Py.X_MS_LIB_CAPABILITY,ck)},e.prototype.addLogoutHint=function(e){this.parameters.set(Py.LOGOUT_HINT,encodeURIComponent(e))},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),_T=function(){function e(e,t){this.config=function(e){var t,r=e.authOptions,n=e.systemOptions,o=e.loggerOptions,i=e.storageInterface,a=e.networkInterface,s=e.cryptoInterface,c=e.clientCredentials,l=e.libraryInfo,u=e.telemetry,d=e.serverTelemetryManager,p=e.persistencePlugin,f=e.serializableCache,h=Ty(Ty({},oT),o);return{authOptions:(t=r,Ty({clientCapabilities:[],azureCloudOptions:cT,skipAuthorityMetadataCache:!1},t)),systemOptions:Ty(Ty({},nT),n),loggerOptions:h,storageInterface:i||new HC(r.clientId,cC),networkInterface:a||iT,cryptoInterface:s||cC,clientCredentials:c||sT,libraryInfo:Ty(Ty({},aT),l),telemetry:Ty(Ty({},lT),u),serverTelemetryManager:d||null,persistencePlugin:p||null,serializableCache:f||null}}(e),this.logger=new oC(this.config.loggerOptions,"@azure/msal-common",rT),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new xT(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[Ey.CONTENT_TYPE]=Ny.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case fC.HOME_ACCOUNT_ID:try{var r=uC(e.credential);t[Ey.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case fC.UPN:t[Ey.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return _y(this,void 0,void 0,(function(){var o;return Sy(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return o=i.sent(),this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,o]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw jw.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e.prototype.createTokenQueryParameters=function(e){var t=new TT;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},e}(),ST=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null};!function(e){e.SW="sw",e.UHW="uhw"}(yT||(yT={}));var IT=function(){function e(e,t){this.cryptoUtils=e,this.performanceClient=t}return e.prototype.generateCnf=function(e){var t,r;return _y(this,void 0,void 0,(function(){var n,o,i;return Sy(this,(function(a){switch(a.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.PopTokenGenerateCnf,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(fy.PopTokenGenerateKid,e.correlationId),[4,this.generateKid(e)];case 1:return n=a.sent(),o=this.cryptoUtils.base64Encode(JSON.stringify(n)),i={kid:n.kid,reqCnfString:o},[4,this.cryptoUtils.hashString(o)];case 2:return[2,(i.reqCnfHash=a.sent(),i)]}}))}))},e.prototype.generateKid=function(e){var t;return _y(this,void 0,void 0,(function(){return Sy(this,(function(r){switch(r.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.PopTokenGenerateKid,e.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:r.sent(),xms_ksl:yT.SW}]}}))}))},e.prototype.signPopToken=function(e,t,r){return _y(this,void 0,void 0,(function(){return Sy(this,(function(n){return[2,this.signPayload(e,t,r)]}))}))},e.prototype.signPayload=function(e,t,r,n){return _y(this,void 0,void 0,(function(){var o,i,a,s,c,l;return Sy(this,(function(u){switch(u.label){case 0:return o=r.resourceRequestMethod,i=r.resourceRequestUri,a=r.shrClaims,s=r.shrNonce,c=i?new $C(i):void 0,l=null===c||void 0===c?void 0:c.getUrlComponents(),[4,this.cryptoUtils.signJwt(Ty({at:e,ts:qC.nowSeconds(),m:null===o||void 0===o?void 0:o.toUpperCase(),u:null===l||void 0===l?void 0:l.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:null===l||void 0===l?void 0:l.AbsolutePath,q:(null===l||void 0===l?void 0:l.QueryString)?[[],l.QueryString]:void 0,client_claims:a||void 0},n),t,r.correlationId)];case 1:return[2,u.sent()]}}))}))},e}(),ET=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),AT=function(){function e(e,t,r,n,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?jw.createStateNotFoundError("Cached State"):jw.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw jw.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(Ik.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ik(e.error||Ny.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||Ny.EMPTY_STRING,e.trace_id||Ny.EMPTY_STRING,e.correlation_id||Ny.EMPTY_STRING,e.claims||Ny.EMPTY_STRING);throw new xk(e.error||Ny.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&lC(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Ik.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ik(e.error,e.error_description,e.suberror,e.timestamp||Ny.EMPTY_STRING,e.trace_id||Ny.EMPTY_STRING,e.correlation_id||Ny.EMPTY_STRING,e.claims||Ny.EMPTY_STRING);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new xk(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,n,o,i,a,s,c,l){var u;return _y(this,void 0,void 0,(function(){var d,p,f,h,g,v;return Sy(this,(function(m){switch(m.label){case 0:if(null===(u=this.performanceClient)||void 0===u||u.addQueueMeasurement(fy.HandleServerTokenResponse,t.correlation_id),t.id_token){if(d=new FC(t.id_token||Ny.EMPTY_STRING,this.cryptoObj),i&&!Gw.isEmpty(i.nonce)&&d.claims.nonce!==i.nonce)throw jw.createNonceMismatchError();if(o.maxAge||0===o.maxAge){if(!(p=d.claims.auth_time))throw jw.createAuthTimeNotFoundError();FC.checkMaxAge(p,o.maxAge)}}this.homeAccountIdentifier=dC.generateHomeAccountId(t.client_info||Ny.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,d),i&&i.state&&(f=JC.parseRequestState(this.cryptoObj,i.state)),t.key_id=t.key_id||o.sshKid||void 0,h=this.generateCacheRecord(t,r,n,o,d,a,i),m.label=1;case 1:return m.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new ET(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(g)]):[3,3];case 2:m.sent(),m.label=3;case 3:return!s||c||!h.account||(v=h.account.generateAccountKey(),this.cacheStorage.getAccount(v))?[4,this.cacheStorage.saveCacheRecord(h)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,h,!1,o,d,f,void 0,l)]);case 4:return m.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&g?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(g)]):[3,7];case 6:m.sent(),m.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,r,h,!1,o,d,f,t.spa_code,l)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,o,i,a){var s,c,l=t.getPreferredCache();if(Gw.isEmpty(l))throw jw.createInvalidCacheEnvironmentError();!Gw.isEmpty(e.id_token)&&o&&(s=BC.createIdTokenEntity(this.homeAccountIdentifier,l,e.id_token||Ny.EMPTY_STRING,this.clientId,o.claims.tid||Ny.EMPTY_STRING),c=this.generateAccountEntity(e,o,t,a));var u=null;if(!Gw.isEmpty(e.access_token)){var d=e.scope?UC.fromString(e.scope):new UC(n.scopes||[]),p=("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,f=("string"===typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,h=("string"===typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,g=r+p,v=g+f,m=h&&h>0?r+h:void 0;u=jC.createAccessTokenEntity(this.homeAccountIdentifier,l,e.access_token||Ny.EMPTY_STRING,this.clientId,o?o.claims.tid||Ny.EMPTY_STRING:t.tenant,d.printScopes(),g,v,this.cryptoObj,m,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}var b=null;Gw.isEmpty(e.refresh_token)||(b=GC.createRefreshTokenEntity(this.homeAccountIdentifier,l,e.refresh_token||Ny.EMPTY_STRING,this.clientId,e.foci,i));var y=null;return Gw.isEmpty(e.foci)||(y=VC.createAppMetadataEntity(this.clientId,l,e.foci)),new ST(c,s,u,b,y)},e.prototype.generateAccountEntity=function(e,t,r,n){var o=r.authorityType,i=n?n.cloud_graph_host_name:Ny.EMPTY_STRING,a=n?n.msgraph_host:Ny.EMPTY_STRING;if(o===nC.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),dC.createGenericAccount(this.homeAccountIdentifier,t,r,i,a);if(Gw.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw jw.createClientInfoEmptyError();return e.client_info?dC.createAccount(e.client_info,this.homeAccountIdentifier,t,r,i,a):dC.createGenericAccount(this.homeAccountIdentifier,t,r,i,a)},e.generateAuthenticationResult=function(e,t,r,n,o,i,a,s,c){var l,u,d;return _y(this,void 0,void 0,(function(){var p,f,h,g,v,m,b,y,k,w,x;return Sy(this,(function(C){switch(C.label){case 0:if(p=Ny.EMPTY_STRING,f=[],h=null,v=Ny.EMPTY_STRING,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==Xy.POP)return[3,2];if(m=new IT(e),b=r.accessToken,y=b.secret,!(k=b.keyId))throw jw.createKeyIdMissingError();return[4,m.signPopToken(y,k,o)];case 1:return p=C.sent(),[3,3];case 2:p=r.accessToken.secret,C.label=3;case 3:f=UC.fromString(r.accessToken.target).asArray(),h=new Date(1e3*Number(r.accessToken.expiresOn)),g=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),C.label=4;case 4:return r.appMetadata&&(v=r.appMetadata.familyId===Wy?Wy:Ny.EMPTY_STRING),w=(null===i||void 0===i?void 0:i.claims.oid)||(null===i||void 0===i?void 0:i.claims.sub)||Ny.EMPTY_STRING,x=(null===i||void 0===i?void 0:i.claims.tid)||Ny.EMPTY_STRING,[2,{authority:t.canonicalAuthority,uniqueId:w,tenantId:x,scopes:f,account:r.account?r.account.getAccountInfo():null,idToken:i?i.rawToken:Ny.EMPTY_STRING,idTokenClaims:i?i.claims:{},accessToken:p,fromCache:n,expiresOn:h,correlationId:o.correlationId,requestId:c||Ny.EMPTY_STRING,extExpiresOn:g,familyId:v,tokenType:(null===(l=r.accessToken)||void 0===l?void 0:l.tokenType)||Ny.EMPTY_STRING,state:a?a.userRequestState:Ny.EMPTY_STRING,cloudGraphHostName:(null===(u=r.account)||void 0===u?void 0:u.cloudGraphHostName)||Ny.EMPTY_STRING,msGraphHost:(null===(d=r.account)||void 0===d?void 0:d.msGraphHost)||Ny.EMPTY_STRING,code:s,fromNativeBroker:!1}]}}))}))},e}(),RT=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.includeRedirectUri=!0,n}return Cy(t,e),t.prototype.getAuthCodeUrl=function(e){var t,r;return _y(this,void 0,void 0,(function(){var n;return Sy(this,(function(o){switch(o.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.GetAuthCodeUrl,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(fy.AuthClientCreateQueryString,e.correlationId),[4,this.createAuthCodeUrlQueryString(e)];case 1:return n=o.sent(),[2,$C.appendQueryString(this.authority.authorizationEndpoint,n)]}}))}))},t.prototype.acquireToken=function(e,t){var r,n,o,i,a,s;return _y(this,void 0,void 0,(function(){var c,l,u,d,p,f,h=this;return Sy(this,(function(g){switch(g.label){case 0:if(!e||!e.code)throw jw.createTokenRequestCannotBeMadeError();return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(fy.AuthClientAcquireToken,e.correlationId),c=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement("AuthCodeClientAcquireToken",e.correlationId),this.logger.info("in acquireToken call in auth-code client"),l=qC.nowSeconds(),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(fy.AuthClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(this.authority,e)];case 1:return u=g.sent(),d=null===(i=u.headers)||void 0===i?void 0:i[Ey.X_MS_REQUEST_ID],(p=null===(a=u.headers)||void 0===a?void 0:a[Ey.X_MS_HTTP_VERSION])&&(null===c||void 0===c||c.addStaticFields({httpVerAuthority:p})),(f=new AT(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(u.body),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(fy.HandleServerTokenResponse,e.correlationId),[2,f.handleServerTokenResponse(u.body,this.authority,l,e,t,void 0,void 0,void 0,d).then((function(e){return null===c||void 0===c||c.endMeasurement({success:!0}),e})).catch((function(t){throw h.logger.verbose("Error in fetching token in ACC",e.correlationId),null===c||void 0===c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var r=new AT(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new $C(e),o=$C.getDeserializedHash(n.getHash());if(r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),!o.code)throw jw.createNoAuthCodeInServerResponseError();return Ty(Ty({},o),{code:o.code})},t.prototype.getLogoutUri=function(e){if(!e)throw MC.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return $C.appendQueryString(this.authority.endSessionEndpoint,t)},t.prototype.executeTokenRequest=function(e,t){var r,n;return _y(this,void 0,void 0,(function(){var o,i,a,s,c,l,u;return Sy(this,(function(d){switch(d.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(fy.AuthClientExecuteTokenRequest,t.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(fy.AuthClientCreateTokenRequestBody,t.correlationId),o=this.createTokenQueryParameters(t),i=$C.appendQueryString(e.tokenEndpoint,o),[4,this.createTokenRequestBody(t)];case 1:if(a=d.sent(),s=void 0,t.clientInfo)try{c=lC(t.clientInfo,this.cryptoUtils),s={credential:""+c.uid+By.CLIENT_INFO_SEPARATOR+c.utid,type:fC.HOME_ACCOUNT_ID}}catch(p){this.logger.verbose("Could not parse client info for CCS Header: "+p)}return l=this.createTokenRequestHeaders(s||t.ccsCredential),u={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(i,a,l,u)]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,r;return _y(this,void 0,void 0,(function(){var n,o,i,a,s,c,l,u;return Sy(this,(function(d){switch(d.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.AuthClientCreateTokenRequestBody,e.correlationId),(n=new TT).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(e.redirectUri):CT.validateRedirectUri(e.redirectUri),n.addScopes(e.scopes),n.addAuthorizationCode(e.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&n.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(o=this.config.clientCredentials.clientAssertion,n.addClientAssertion(o.assertion),n.addClientAssertionType(o.assertionType)),n.addGrantType(zy.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),e.authenticationScheme!==Xy.POP?[3,2]:(i=new IT(this.cryptoUtils,this.performanceClient),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(fy.PopTokenGenerateCnf,e.correlationId),[4,i.generateCnf(e)]);case 1:return a=d.sent(),n.addPopToken(a.reqCnfString),[3,3];case 2:if(e.authenticationScheme===Xy.SSH){if(!e.sshJwk)throw MC.createMissingSshJwkError();n.addSshJwk(e.sshJwk)}d.label=3;case 3:if(s=e.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(s),(!Gw.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),c=void 0,e.clientInfo)try{l=lC(e.clientInfo,this.cryptoUtils),c={credential:""+l.uid+By.CLIENT_INFO_SEPARATOR+l.utid,type:fC.HOME_ACCOUNT_ID}}catch(p){this.logger.verbose("Could not parse client info for CCS Header: "+p)}else c=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&c)switch(c.type){case fC.HOME_ACCOUNT_ID:try{l=uC(c.credential),n.addCcsOid(l)}catch(p){this.logger.verbose("Could not parse home account ID for CCS Header: "+p)}break;case fC.UPN:n.addCcsUpn(c.credential)}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Py.RETURN_SPA_CODE]||n.addExtraQueryParameters(((u={})[Py.RETURN_SPA_CODE]="1",u)),[2,n.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t;return _y(this,void 0,void 0,(function(){var r,n,o,i,a,s,c;return Sy(this,(function(l){switch(l.label){case 0:if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.AuthClientCreateQueryString,e.correlationId),(r=new TT).addClientId(this.config.authOptions.clientId),n=Iy(e.scopes||[],e.extraScopesToConsent||[]),r.addScopes(n),r.addRedirectUri(e.redirectUri),o=e.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(o),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==Uy.SELECT_ACCOUNT)if(e.sid&&e.prompt===Uy.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){if(i=this.extractAccountSid(e.account),a=this.extractLoginHint(e.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(a);try{s=uC(e.account.homeAccountId),r.addCcsOid(s)}catch(u){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(i&&e.prompt===Uy.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(i);try{s=uC(e.account.homeAccountId),r.addCcsOid(s)}catch(u){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{s=uC(e.account.homeAccountId),r.addCcsOid(s)}catch(u){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(!Gw.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&r.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker?(r.addNativeBroker(),e.authenticationScheme!==Xy.POP?[3,2]:[4,new IT(this.cryptoUtils).generateCnf(e)]):[3,2];case 1:c=l.sent(),r.addPopToken(c.reqCnfHash),l.label=2;case 2:return[2,r.createQueryString()]}}))}))},t.prototype.createLogoutUrlQueryString=function(e){var t=new TT;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.extractAccountSid=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null},t.prototype.extractLoginHint=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null},t}(_T);function PT(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}var OT={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},NT={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}};var DT,LT=function(){function e(e,t,r){this.networkInterface=e,this.performanceClient=t,this.correlationId=r}return e.prototype.detectRegion=function(t,r){var n,o,i,a;return _y(this,void 0,void 0,(function(){var s,c,l,u,d;return Sy(this,(function(p){switch(p.label){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(fy.RegionDiscoveryDetectRegion,this.correlationId),s=t)return[3,8];c=e.IMDS_OPTIONS,p.label=1;case 1:return p.trys.push([1,6,,7]),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(fy.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(Ny.IMDS_VERSION,c)];case 2:return(l=p.sent()).status===ek.httpSuccess&&(s=l.body,r.region_source=tk.IMDS),l.status!==ek.httpBadRequest?[3,5]:(null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(fy.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(c)]);case 3:return(u=p.sent())?(null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(fy.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(u,c)]):(r.region_source=tk.FAILED_AUTO_DETECTION,[2,null]);case 4:(d=p.sent()).status===ek.httpSuccess&&(s=d.body,r.region_source=tk.IMDS),p.label=5;case 5:return[3,7];case 6:return p.sent(),r.region_source=tk.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:r.region_source=tk.ENVIRONMENT_VARIABLE,p.label=9;case 9:return s||(r.region_source=tk.FAILED_AUTO_DETECTION),[2,s||null]}}))}))},e.prototype.getRegionFromIMDS=function(e,t){var r;return _y(this,void 0,void 0,(function(){return Sy(this,(function(n){return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(fy.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(Ny.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,Ny.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(e){var t;return _y(this,void 0,void 0,(function(){var r;return Sy(this,(function(n){switch(n.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.RegionDiscoveryGetCurrentVersion,this.correlationId),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(Ny.IMDS_ENDPOINT+"?format=json",e)];case 2:return(r=n.sent()).status===ek.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?[2,r.body["newest-versions"][0]]:[2,null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),MT=function(){function e(e,t,r,n,o,i,a){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=i,this.correlationId=a,this.regionDiscovery=new LT(t,this.performanceClient,this.correlationId)}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;if(e.length)switch(e[0].toLowerCase()){case Ny.ADFS:return nC.Adfs;case Ny.DSTS:return nC.Dsts}return nC.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new $C(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw jw.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw jw.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw jw.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw jw.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw jw.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw jw.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"jwksUri",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.jwks_uri);return this.replaceTenant(e)}throw jw.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,r=new $C(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,n){var o=r[n];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===nC.Adfs||this.authorityType===nC.Dsts||this.protocolMode===YC.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){var e,t,r;return _y(this,void 0,void 0,(function(){var n,o,i,a;return Sy(this,(function(s){switch(s.label){case 0:return null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(fy.AuthorityResolveEndpointsAsync,this.correlationId),(n=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(n=new QC).updateCanonicalAuthority(this.canonicalAuthority),null===(t=this.performanceClient)||void 0===t||t.setPreQueueTime(fy.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(n)];case 1:return o=s.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,n.preferred_network),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(fy.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(n)];case 2:return i=s.sent(),o!==Ky.CACHE&&i!==Ky.CACHE&&(n.resetExpiresAt(),n.updateCanonicalAuthority(this.canonicalAuthority)),a=this.cacheManager.generateAuthorityMetadataCacheKey(n.preferred_cache),this.cacheManager.setAuthorityMetadata(a,n),this.metadata=n,[2]}}))}))},e.prototype.updateEndpointMetadata=function(e){var t,r,n,o,i,a;return _y(this,void 0,void 0,(function(){var s,c;return Sy(this,(function(l){switch(l.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.AuthorityUpdateEndpointMetadata,this.correlationId),(s=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(s,!1),[2,Ky.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,Ky.CACHE]:(c=this.getEndpointMetadataFromHardcodedValues(),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(fy.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(s=l.sent())?(null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion)?(null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(fy.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(s)]):[3,3]:[3,4];case 2:s=l.sent(),l.label=3;case 3:return e.updateEndpointMetadata(s,!0),[2,Ky.NETWORK];case 4:return!c||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)?(null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(fy.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(c)]):[3,6];case 5:c=l.sent(),l.label=6;case 6:return e.updateEndpointMetadata(c,!1),[2,Ky.HARDCODED_VALUES];case 7:throw jw.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new $C(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw MC.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){var e;return _y(this,void 0,void 0,(function(){var t,r;return Sy(this,(function(n){switch(n.label){case 0:null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(fy.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return[2,PT((r=n.sent()).body)?r.body:null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in OT?OT[this.canonicalAuthority]:null},e.prototype.updateMetadataWithRegionalInformation=function(t){var r,n,o,i,a,s,c;return _y(this,void 0,void 0,(function(){var l,u;return Sy(this,(function(d){switch(d.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(fy.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(fy.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.environmentRegion,this.regionDiscoveryMetadata)];case 1:return l=d.sent(),u=(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)===Ny.AZURE_REGION_AUTO_DISCOVER_FLAG?l:null===(a=this.authorityOptions.azureRegionConfiguration)||void 0===a?void 0:a.azureRegion,(null===(s=this.authorityOptions.azureRegionConfiguration)||void 0===s?void 0:s.azureRegion)===Ny.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=l?rk.AUTO_DETECTION_REQUESTED_SUCCESSFUL:rk.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=l?(null===(c=this.authorityOptions.azureRegionConfiguration)||void 0===c?void 0:c.azureRegion)===l?rk.CONFIGURED_MATCHES_DETECTED:rk.CONFIGURED_NOT_DETECTED:rk.CONFIGURED_NO_AUTO_DETECTION,u?(this.regionDiscoveryMetadata.region_used=u,[2,e.replaceWithRegionalInformation(t,u)]):[2,t]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){var t,r;return _y(this,void 0,void 0,(function(){var n,o,i;return Sy(this,(function(a){switch(a.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||Ny.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||Ny.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||Ny.NOT_APPLICABLE)),(n=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(n,!1),[2,Ky.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),o=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!o?(this.logger.verbose("Found metadata in the cache."),[2,Ky.CACHE]):(o&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(fy.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(n=a.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(n,!0),[2,Ky.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(i=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(i,!1),[2,Ky.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),MC.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(n){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),MC.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var t;return _y(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,l;return Sy(this,(function(u){switch(u.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),r=""+Ny.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",n={},o=null,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(r,n)];case 2:if(i=u.sent(),a=void 0,s=void 0,function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(i.body))a=i.body,s=a.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+a.tenant_discovery_endpoint);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(i.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+i.status),(a=i.body).error===Ny.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+a.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+a.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),s=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),o=e.getCloudDiscoveryMetadataFromNetworkResponse(s,this.hostnameAndPort),[3,4];case 3:return(c=u.sent())instanceof wk?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+c.errorCode+"\nError Description: "+c.errorMessage):(l=c,this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+l.name+"\nError Description: "+l.message)),[2,null];case 4:return o||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),o=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,o]}}))}))},e.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in NT?NT[this.canonicalAuthority]:null},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return $C.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.generateAuthority=function(e,t){var r;if(t&&t.azureCloudInstance!==XC.None){var n=t.tenant?t.tenant:Ny.DEFAULT_COMMON_TENANT;r=t.azureCloudInstance+"/"+n+"/"}return r||e},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw jw.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return Ny.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,r){var n=new $C(e);n.validateAsUri();var o=n.getUrlComponents(),i=t+"."+o.HostNameAndPort;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=t+"."+Ny.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var a=$C.constructAuthorityUriFromObject(Ty(Ty({},n.getUrlComponents()),{HostNameAndPort:i})).urlString;return r?a+"?"+r:a},e.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,r,Ny.REGIONAL_AUTH_NON_MSI_QUERY_STRING),t.end_session_endpoint&&(t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,r)),t},e}(),UT=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,o,i,a,s){return _y(this,void 0,void 0,(function(){var c,l;return Sy(this,(function(u){switch(u.label){case 0:null===a||void 0===a||a.addQueueMeasurement(fy.AuthorityFactoryCreateDiscoveredInstance,s),c=e.createInstance(t,r,n,o,i,a,s),u.label=1;case 1:return u.trys.push([1,3,,4]),null===a||void 0===a||a.setPreQueueTime(fy.AuthorityResolveEndpointsAsync,s),[4,c.resolveEndpointsAsync()];case 2:return u.sent(),[2,c];case 3:throw l=u.sent(),jw.createEndpointDiscoveryIncompleteError(l);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n,o,i,a){if(Gw.isEmpty(e))throw MC.createUrlEmptyError();return new MT(e,t,r,n,o,i,a)},e}(),FT=function(){function e(e,t){this.cacheOutcome=nk.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||Ny.EMPTY_STRING,this.wrapperVer=e.wrapperVer||Ny.EMPTY_STRING,this.telemetryCacheKey=Zy.CACHE_KEY+By.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+Zy.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(Zy.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(Zy.VALUE_SEPARATOR);return[Zy.SCHEMA_VERSION,r,t].join(Zy.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(Zy.VALUE_SEPARATOR),o=t.errors.slice(0,r).join(Zy.VALUE_SEPARATOR),i=t.errors.length,a=[i,r<i?Zy.OVERFLOW_TRUE:Zy.OVERFLOW_FALSE].join(Zy.VALUE_SEPARATOR);return[Zy.SCHEMA_VERSION,t.cacheHits,n,o,a].join(Zy.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=Zy.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),Gw.isEmpty(e.subError)?Gw.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(Zy.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new KC;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new KC;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||Ny.EMPTY_STRING,a=e.failedRequests[2*t+1]||Ny.EMPTY_STRING,s=e.errors[t]||Ny.EMPTY_STRING;if(!((n+=i.toString().length+a.toString().length+s.length+3)<Zy.MAX_LAST_HEADER_BYTES))break;r+=1}return r},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||Ny.EMPTY_STRING),e.push(this.regionSource||Ny.EMPTY_STRING),e.push(this.regionOutcome||Ny.EMPTY_STRING),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}(),zT=function(){function e(e,t,r,n,o,i,a,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=c||this.browserCrypto.createNewGuid(),this.logger=n.clone(Nk,bT,this.correlationId),this.performanceClient=a}return e.prototype.clearCacheOnLogout=function(e){return my(this,void 0,void 0,(function(){return by(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];dC.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(dC.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},e.prototype.initializeBaseRequest=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o;return by(this,(function(i){switch(i.label){case 0:if(this.performanceClient.addQueueMeasurement(fy.InitializeBaseRequest,e.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),t=e.authority||this.config.auth.authority,r=ky(e&&e.scopes||[]),(n=gy(gy({},e),{correlationId:this.correlationId,authority:t,scopes:r})).authenticationScheme){if(n.authenticationScheme===Xy.SSH){if(!e.sshJwk)throw MC.createMissingSshJwkError();if(!e.sshKid)throw MC.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+n.authenticationScheme+'" as configured in Auth request')}else n.authenticationScheme=Xy.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!e.claims||Gw.isEmpty(e.claims)?[3,2]:(o=n,[4,this.browserCrypto.hashString(e.claims)]);case 1:o.requestedClaimsHash=i.sent(),i.label=2;case 2:return[2,n]}}))}))},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||fT.getCurrentUri();return $C.getAbsoluteUrl(t,fT.getCurrentUri())},e.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new FT(r,this.browserStorage)},e.prototype.getDiscoveredAuthority=function(e){return my(this,void 0,void 0,(function(){var t;return by(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,UT.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:case 3:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,UT.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)]}}))}))},e}(),HT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return py(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return my(this,void 0,void 0,(function(){var t,r;return by(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(fy.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=gy(gy({},e),{redirectUri:e.redirectUri,code:Ny.EMPTY_STRING,codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=Ny.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},t.prototype.initializeLogoutRequest=function(e){this.logger.verbose("initializeLogoutRequest called",null===e||void 0===e?void 0:e.correlationId);var t=gy({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){var r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=$C.getAbsoluteUrl(e.postLogoutRedirectUri,fT.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=$C.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,fT.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=$C.getAbsoluteUrl(fT.getCurrentUri(),fT.getCurrentUri())),t},t.prototype.getLogoutHintFromIdTokenClaims=function(e){var t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},t.prototype.createAuthCodeClient=function(e,t,r){return my(this,void 0,void 0,(function(){var n;return by(this,(function(o){switch(o.label){case 0:return this.performanceClient.addQueueMeasurement(fy.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(fy.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new RT(n,this.performanceClient)]}}))}))},t.prototype.getClientConfiguration=function(e,t,r){return my(this,void 0,void 0,(function(){var n,o;return by(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(fy.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(fy.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(t,r)];case 1:return n=i.sent(),o=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:o.loggerCallback,piiLoggingEnabled:o.piiLoggingEnabled,logLevel:o.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Nk,version:bT,cpu:Ny.EMPTY_STRING,os:Ny.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,r){if(this.logger.verbose("validateAndExtractStateFromHash called",r),!e.state)throw Lx.createHashDoesNotContainStateError();var n=eT.extractBrowserRequestState(this.browserCrypto,e.state);if(!n)throw Lx.createUnableToParseStateError();if(n.interactionType!==t)throw Lx.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),e.state},t.prototype.getDiscoveredAuthority=function(e,t){var r;return my(this,void 0,void 0,(function(){var n,o,i,a;return by(this,(function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(fy.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(fy.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e||this.config.auth.authority,a=MT.generateAuthority(i,t||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(fy.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,UT.createDiscoveredInstance(a,this.config.system.networkClient,this.browserStorage,o,this.logger,this.performanceClient,this.correlationId).then((function(e){return n.endMeasurement({success:!0}),e})).catch((function(e){throw n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))];case 1:return[2,s.sent()]}}))}))},t.prototype.initializeAuthorizationRequest=function(e,t){return my(this,void 0,void 0,(function(){var r,n,o,i,a,s,c;return by(this,(function(l){switch(l.label){case 0:return this.performanceClient.addQueueMeasurement(fy.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=JC.setRequestState(this.browserCrypto,e&&e.state||Ny.EMPTY_STRING,n),this.performanceClient.setPreQueueTime(fy.InitializeBaseRequest,this.correlationId),a=[{}],[4,this.initializeBaseRequest(e)];case 1:return i=gy.apply(void 0,[gy.apply(void 0,a.concat([l.sent()])),{redirectUri:r,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:Fy.FRAGMENT}]),(s=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+s.homeAccountId,this.correlationId),i.account=s),Gw.isEmpty(i.loginHint)&&!s&&(c=this.browserStorage.getLegacyLoginHint())&&(i.loginHint=c),[2,i]}}))}))},t}(zT);!function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED",e.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(DT||(DT={}));var BT,qT={code:"ContentError"},jT={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},GT={code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"},VT=function(e){function t(r,n,o){var i=e.call(this,r,n)||this;return Object.setPrototypeOf(i,t.prototype),i.name="NativeAuthError",i.ext=o,i}return py(t,e),t.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==DT.PERSISTENT_ERROR&&this.ext.status!==DT.DISABLED)||this.errorCode===qT.code},t.createError=function(e,r,n){if(n&&n.status)switch(n.status){case DT.ACCOUNT_UNAVAILABLE:return Ik.createNativeAccountUnavailableError();case DT.USER_INTERACTION_REQUIRED:return new Ik(e,r);case DT.USER_CANCEL:return Lx.createUserCancelledError();case DT.NO_NETWORK:return Lx.createNoNetworkConnectivityError()}return new t(e,r,n)},t.createUserSwitchError=function(){return new t(jT.code,jT.desc)},t.createTokensNotFoundInCacheError=function(){return new t(GT.code,GT.desc)},t}(wk),KT=function(e){function t(t,r){return e.call(this,t,r)||this}return Cy(t,e),t.prototype.acquireToken=function(e){var t,r,n,o,i,a,s;return _y(this,void 0,void 0,(function(){var c,l,u,d,p,f,h=this;return Sy(this,(function(g){switch(g.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.RefreshTokenClientAcquireToken,e.correlationId),c=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(fy.RefreshTokenClientAcquireToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",e.correlationId),l=qC.nowSeconds(),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(fy.RefreshTokenClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(e,this.authority)];case 1:return u=g.sent(),d=null===(o=u.headers)||void 0===o?void 0:o[Ey.X_MS_HTTP_VERSION],null===c||void 0===c||c.addStaticFields({refreshTokenSize:(null===(i=u.body.refresh_token)||void 0===i?void 0:i.length)||0}),d&&(null===c||void 0===c||c.addStaticFields({httpVerToken:d})),p=null===(a=u.headers)||void 0===a?void 0:a[Ey.X_MS_REQUEST_ID],(f=new AT(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(u.body),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(fy.HandleServerTokenResponse,e.correlationId),[2,f.handleServerTokenResponse(u.body,this.authority,l,e,void 0,void 0,!0,e.forceCache,p).then((function(e){return null===c||void 0===c||c.endMeasurement({success:!0}),e})).catch((function(t){throw h.logger.verbose("Error in fetching refresh token",e.correlationId),null===c||void 0===c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){var t,r,n,o;return _y(this,void 0,void 0,(function(){var i,a;return Sy(this,(function(s){if(!e)throw MC.createEmptyTokenRequestError();if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw jw.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId))try{return null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(fy.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(c){if(i=c instanceof Ik&&c.errorCode===_k.code,a=c instanceof xk&&c.errorCode===lk&&c.subError===uk,i||a)return null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(fy.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw c}return null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(fy.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){var r,n,o;return _y(this,void 0,void 0,(function(){var i,a,s;return Sy(this,(function(c){if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(fy.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),i=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(fy.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",e.correlationId),!(a=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,e.account,t)))throw null===i||void 0===i||i.discardMeasurement(),Ik.createNoTokensFoundError();return null===i||void 0===i||i.endMeasurement({success:!0}),s=Ty(Ty({},e),{refreshToken:a.secret,authenticationScheme:e.authenticationScheme||Xy.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:fC.HOME_ACCOUNT_ID}}),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(fy.RefreshTokenClientAcquireToken,e.correlationId),[2,this.acquireToken(s)]}))}))},t.prototype.executeTokenRequest=function(e,t){var r,n,o;return _y(this,void 0,void 0,(function(){var i,a,s,c,l,u;return Sy(this,(function(d){switch(d.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(fy.RefreshTokenClientExecuteTokenRequest,e.correlationId),i=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(fy.RefreshTokenClientExecuteTokenRequest,e.correlationId),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(fy.RefreshTokenClientCreateTokenRequestBody,e.correlationId),a=this.createTokenQueryParameters(e),s=$C.appendQueryString(t.tokenEndpoint,a),[4,this.createTokenRequestBody(e)];case 1:return c=d.sent(),l=this.createTokenRequestHeaders(e.ccsCredential),u={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},[2,this.executePostToTokenEndpoint(s,c,l,u).then((function(e){return null===i||void 0===i||i.endMeasurement({success:!0}),e})).catch((function(e){throw null===i||void 0===i||i.endMeasurement({success:!1}),e}))]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,r,n;return _y(this,void 0,void 0,(function(){var o,i,a,s,c,l,u;return Sy(this,(function(d){switch(d.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(fy.RefreshTokenClientCreateTokenRequestBody,e.correlationId),o=e.correlationId,i=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(fy.BaseClientCreateTokenRequestHeaders,o),(a=new TT).addClientId(this.config.authOptions.clientId),a.addScopes(e.scopes),a.addGrantType(zy.REFRESH_TOKEN_GRANT),a.addClientInfo(),a.addLibraryInfo(this.config.libraryInfo),a.addApplicationTelemetry(this.config.telemetry.application),a.addThrottling(),this.serverTelemetryManager&&a.addServerTelemetry(this.serverTelemetryManager),a.addCorrelationId(o),a.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&a.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(s=this.config.clientCredentials.clientAssertion,a.addClientAssertion(s.assertion),a.addClientAssertionType(s.assertionType)),e.authenticationScheme!==Xy.POP?[3,2]:(c=new IT(this.cryptoUtils,this.performanceClient),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(fy.PopTokenGenerateCnf,e.correlationId),[4,c.generateCnf(e)]);case 1:return l=d.sent(),a.addPopToken(l.reqCnfString),[3,3];case 2:if(e.authenticationScheme===Xy.SSH){if(!e.sshJwk)throw null===i||void 0===i||i.endMeasurement({success:!1}),MC.createMissingSshJwkError();a.addSshJwk(e.sshJwk)}d.label=3;case 3:if((!Gw.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&a.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case fC.HOME_ACCOUNT_ID:try{u=uC(e.ccsCredential.credential),a.addCcsOid(u)}catch(p){this.logger.verbose("Could not parse home account ID for CCS Header: "+p)}break;case fC.UPN:a.addCcsUpn(e.ccsCredential.credential)}return null===i||void 0===i||i.endMeasurement({success:!0}),[2,a.createQueryString()]}}))}))},t}(_T),QT=function(e){function t(t,r){return e.call(this,t,r)||this}return Cy(t,e),t.prototype.acquireToken=function(e){return _y(this,void 0,void 0,(function(){var t;return Sy(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof jw&&t.errorCode===Mw.code)return[2,new KT(this.config,this.performanceClient).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,r,n,o;return _y(this,void 0,void 0,(function(){var i,a;return Sy(this,(function(s){switch(s.label){case 0:if(!e)throw MC.createEmptyTokenRequestError();if(e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(nk.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),jw.createRefreshRequiredError();if(!e.account)throw jw.createNoAccountInSilentRequestError();if(i=e.authority||this.authority.getPreferredCache(),!(a=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,e,i)).accessToken)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(nk.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),jw.createRefreshRequiredError();if(qC.wasClockTurnedBack(a.accessToken.cachedAt)||qC.isTokenExpired(a.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(nk.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),jw.createRefreshRequiredError();if(a.accessToken.refreshOn&&qC.isTokenExpired(a.accessToken.refreshOn,0))throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(nk.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),jw.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(a,e)];case 1:return[2,s.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return _y(this,void 0,void 0,(function(){var r,n;return Sy(this,(function(o){switch(o.label){case 0:if(e.idToken&&(r=new FC(e.idToken.secret,this.config.cryptoInterface)),t.maxAge||0===t.maxAge){if(!(n=null===r||void 0===r?void 0:r.claims.auth_time))throw jw.createAuthTimeNotFoundError();FC.checkMaxAge(n,t.maxAge)}return[4,AT.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,o.sent()]}}))}))},t}(_T),WT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return py(t,e),t.prototype.acquireToken=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i;return by(this,(function(a){switch(a.label){case 0:return t=this.performanceClient.startMeasurement(fy.SilentCacheClientAcquireToken,e.correlationId),r=this.initializeServerTelemetryManager(vk.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(r,e.authority,e.azureCloudOptions)];case 1:n=a.sent(),this.logger.verbose("Silent auth client created"),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,n.acquireCachedToken(e)];case 3:return o=a.sent(),t.endMeasurement({success:!0,fromCache:!0}),[2,o];case 4:throw(i=a.sent())instanceof Lx&&i.errorCode===_x.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),t.endMeasurement({errorCode:i instanceof wk&&i.errorCode||void 0,subErrorCode:i instanceof wk&&i.subError||void 0,success:!1}),i;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(Lx.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(e,t,r){return my(this,void 0,void 0,(function(){var n;return by(this,(function(o){switch(o.label){case 0:return this.performanceClient.setPreQueueTime(fy.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new QT(n,this.performanceClient)]}}))}))},t.prototype.initializeSilentRequest=function(e,t){return my(this,void 0,void 0,(function(){var r;return by(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(fy.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(fy.InitializeBaseRequest,this.correlationId),r=[gy({},e)],[4,this.initializeBaseRequest(e)];case 1:return[2,gy.apply(void 0,[gy.apply(void 0,r.concat([n.sent()])),{account:t,forceRefresh:e.forceRefresh||!1}])]}}))}))},t}(HT),JT=function(e){function t(t,r,n,o,i,a,s,c,l,u,d,p){var f=e.call(this,t,r,n,o,i,a,c,l,p)||this;return f.apiId=s,f.accountId=u,f.nativeMessageHandler=l,f.nativeStorageManager=d,f.silentCacheClient=new WT(t,f.nativeStorageManager,n,o,i,a,c,l,p),f}return py(t,e),t.prototype.acquireToken=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i,a,s;return by(this,(function(c){switch(c.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),t=this.performanceClient.startMeasurement(fy.NativeInteractionClientAcquireToken,e.correlationId),r=qC.nowSeconds(),[4,this.initializeNativeRequest(e)];case 1:n=c.sent(),c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,n)];case 3:return o=c.sent(),t.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,o];case 4:return c.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return i={method:dk.GetToken,request:n},[4,this.nativeMessageHandler.sendMessage(i)];case 6:return a=c.sent(),s=this.validateNativeResponse(a),[2,this.handleNativeResponse(s,n,r).then((function(e){return t.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(e){throw t.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))]}}))}))},t.prototype.createSilentCacheRequest=function(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:UC.fromString(e.scope).asArray(),account:t,forceRefresh:!1}},t.prototype.acquireTokensFromCache=function(e,t){return my(this,void 0,void 0,(function(){var r,n,o;return by(this,(function(i){switch(i.label){case 0:if(!(r=this.browserStorage.readAccountFromCacheWithNativeAccountId(e)))throw jw.createNoAccountFoundError();n=r.getAccountInfo(),i.label=1;case 1:return i.trys.push([1,3,,4]),o=this.createSilentCacheRequest(t,n),[4,this.silentCacheClient.acquireToken(o)];case 2:return[2,i.sent()];case 3:throw i.sent();case 4:return[2]}}))}))},t.prototype.acquireTokenRedirect=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i,a;return by(this,(function(s){switch(s.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(e)];case 1:t=s.sent(),r={method:dk.GetToken,request:t},s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(r)];case 3:return n=s.sent(),this.validateNativeResponse(n),[3,5];case 4:if((o=s.sent())instanceof VT&&o.isFatal())throw o;return[3,5];case 5:return this.browserStorage.setTemporaryCache(hk.NATIVE_REQUEST,JSON.stringify(t),!0),i={apiId:vk.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri),[4,this.navigationClient.navigateExternal(a,i)];case 6:return s.sent(),[2]}}))}))},t.prototype.handleRedirectPromise=function(){return my(this,void 0,void 0,(function(){var e,t,r,n,o,i,a,s;return by(this,(function(c){switch(c.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(e=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];t=e.prompt,r=vy(e,["prompt"]),t&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(hk.NATIVE_REQUEST)),n={method:dk.GetToken,request:r},o=qC.nowSeconds(),c.label=1;case 1:return c.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(n)];case 2:return i=c.sent(),this.validateNativeResponse(i),a=this.handleNativeResponse(i,r,o),this.browserStorage.setInteractionInProgress(!1),[2,a];case 3:throw s=c.sent(),this.browserStorage.setInteractionInProgress(!1),s;case 4:return[2]}}))}))},t.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},t.prototype.handleNativeResponse=function(e,t,r){return my(this,void 0,void 0,(function(){var n,o,i,a,s,c,l,u,d,p,f,h,g,v,m,b,y,k,w,x=this;return by(this,(function(C){switch(C.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),n=this.getMATSFromResponse(e),this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:n?n.broker_version:void 0,matsAccountJoinOnStart:n?n.account_join_on_start:void 0,matsAccountJoinOnEnd:n?n.account_join_on_end:void 0,matsDeviceJoin:n?n.device_join:void 0,matsPromptBehavior:n?n.prompt_behavior:void 0,matsApiErrorCode:n?n.api_error_code:void 0,matsUiVisible:n?n.ui_visible:void 0,matsSilentCode:n?n.silent_code:void 0,matsSilentBiSubCode:n?n.silent_bi_sub_code:void 0,matsSilentMessage:n?n.silent_message:void 0,matsSilentStatus:n?n.silent_status:void 0,matsHttpStatus:n?n.http_status:void 0,matsHttpEventCount:n?n.http_event_count:void 0},this.correlationId),e.account.id!==t.accountId)throw VT.createUserSwitchError();return o=new FC(e.id_token||Ny.EMPTY_STRING,this.browserCrypto),[4,this.getDiscoveredAuthority(t.authority)];case 1:return i=C.sent(),a=i.getPreferredCache(),s=dC.generateHomeAccountId(e.client_info||Ny.EMPTY_STRING,nC.Default,this.logger,this.browserCrypto,o),c=dC.createAccount(e.client_info,s,o,void 0,void 0,void 0,a,e.account.id),this.browserStorage.setAccount(c),l=e.scope?UC.fromString(e.scope):UC.fromString(t.scope),u=e.account.properties||{},d=u.UID||o.claims.oid||o.claims.sub||Ny.EMPTY_STRING,p=u.TenantId||o.claims.tid||Ny.EMPTY_STRING,h=Xy.BEARER,t.tokenType===Xy.POP?[3,2]:[3,4];case 2:if(h=Xy.POP,e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),f=e.shr,[3,5];if(g=new IT(this.browserCrypto),v={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce},!t.keyId)throw jw.createKeyIdMissingError();return[4,g.signPopToken(e.access_token,t.keyId,v)];case 3:return f=C.sent(),[3,5];case 4:f=e.access_token,C.label=5;case 5:return m={authority:i.canonicalAuthority,uniqueId:d,tenantId:p,scopes:l.asArray(),account:c.getAccountInfo(),idToken:e.id_token,idTokenClaims:o.claims,accessToken:f,fromCache:!!n&&this.isResponseFromCache(n),expiresOn:new Date(1e3*Number(r+e.expires_in)),tokenType:h,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0},b=BC.createIdTokenEntity(s,t.authority,e.id_token||Ny.EMPTY_STRING,t.clientId,o.claims.tid||Ny.EMPTY_STRING),this.nativeStorageManager.setIdTokenCredential(b),y=h===Xy.POP?Ny.SHR_NONCE_VALIDITY:("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,k=r+y,w=jC.createAccessTokenEntity(s,t.authority,f,t.clientId,p,l.printScopes(),k,0,this.browserCrypto),this.nativeStorageManager.setAccessTokenCredential(w),this.browserStorage.removeAccountContext(c).catch((function(e){x.logger.error("Error occurred while removing account context from browser storage. "+e)})),[2,m]}}))}))},t.prototype.validateNativeResponse=function(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw VT.createUnexpectedError("Response missing expected properties.")},t.prototype.getMATSFromResponse=function(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},t.prototype.isResponseFromCache=function(e){return"undefined"===typeof e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached},t.prototype.initializeNativeRequest=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,l,u=this;return by(this,(function(d){switch(d.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),t=e.authority||this.config.auth.authority,(r=new $C(t)).validateAsUri(),n=e.scopes,o=vy(e,["scopes"]),(i=new UC(n||[])).appendScopes(Dy),a=function(){switch(u.apiId){case vk.ssoSilent:case vk.acquireTokenSilent_silentFlow:return u.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Uy.NONE}if(e.prompt)switch(e.prompt){case Uy.NONE:case Uy.CONSENT:case Uy.LOGIN:return u.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw u.logger.trace("initializeNativeRequest: prompt = "+e.prompt+" is not compatible with native flow"),Lx.createNativePromptParameterNotSupportedError()}else u.logger.trace("initializeNativeRequest: prompt was not provided")},s=gy(gy({},o),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:a(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:gy(gy(gy({},e.extraQueryParameters),e.tokenQueryParameters),{telemetry:Mk}),extendedExpiryToken:!1}),e.authenticationScheme!==Xy.POP?[3,2]:(c={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},[4,new IT(this.browserCrypto).generateCnf(c)]);case 1:l=d.sent(),s.reqCnf=l.reqCnfHash,s.keyId=l.kid,d.label=2;case 2:return[2,s]}}))}))},t}(zT),YT=function(){function e(e,t,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this)}return e.prototype.sendMessage=function(e){return my(this,void 0,void 0,(function(){var t,r=this;return by(this,(function(n){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:Dk,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise((function(e,n){r.resolvers.set(t.responseId,{resolve:e,reject:n})}))]}))}))},e.createProvider=function(t,r){return my(this,void 0,void 0,(function(){var n,o;return by(this,(function(i){switch(i.label){case 0:t.trace("NativeMessageHandler - createProvider called."),i.label=1;case 1:return i.trys.push([1,3,,5]),[4,(n=new e(t,r,Lk)).sendHandshakeRequest()];case 2:return i.sent(),[2,n];case 3:return i.sent(),[4,(o=new e(t,r)).sendHandshakeRequest()];case 4:return i.sent(),[2,o];case 5:return[2]}}))}))},e.prototype.sendHandshakeRequest=function(){return my(this,void 0,void 0,(function(){var e,t=this;return by(this,(function(r){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:Dk,extensionId:this.extensionId,responseId:this.responseId++,body:{method:dk.HandshakeRequest}},this.messageChannel.port1.onmessage=function(e){t.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise((function(r,n){t.handshakeResolvers.set(e.responseId,{resolve:r,reject:n}),t.timeoutId=window.setTimeout((function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),n(Lx.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)}),t.handshakeTimeoutMs)}))]}))}))},e.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===Dk&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===dk.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var r=this.handshakeResolvers.get(t.responseId);r&&r.reject(Lx.createNativeExtensionNotInstalledError())}}},e.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{var o=t.body.method;if(o===dk.Response){if(!r)return;var i=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(i)),"Success"!==i.status)r.reject(VT.createError(i.code,i.description,i.ext));else{if(!i.result)throw wk.createUnexpectedError("Event does not contain result.");i.result.code&&i.result.description?r.reject(VT.createError(i.result.code,i.result.description,i.result.ext)):r.resolve(i.result)}this.resolvers.delete(t.responseId)}else if(o===dk.HandshakeResponse){if(!n)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(a){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+a.toString()),this.logger.errorPii("Unable to parse "+e),r?r.reject(a):n&&n.reject(a)}},e.prototype.getExtensionId=function(){return this.extensionId},e.prototype.getExtensionVersion=function(){return this.extensionVersion},e.isNativeAvailable=function(e,t,r,n){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(n)switch(n){case Xy.BEARER:case Xy.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},e}(),XT=function(){function e(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}return e.prototype.handleCodeResponseFromHash=function(e,t,r,n){return my(this,void 0,void 0,(function(){var o,i,a;return by(this,(function(s){if(this.performanceClient.addQueueMeasurement(fy.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),Gw.isEmpty(e))throw Lx.createEmptyHashError(e);if(o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw jw.createStateNotFoundError("Cached State");try{a=this.authModule.handleFragmentResponse(e,i)}catch(c){throw c instanceof xk&&c.subError===nx.code?Lx.createUserCancelledError():c}return this.performanceClient.setPreQueueTime(fy.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(a,t,r,n)]}))}))},e.prototype.handleCodeResponseFromServer=function(e,t,r,n,o){return void 0===o&&(o=!0),my(this,void 0,void 0,(function(){var i,a,s,c,l,u;return by(this,(function(d){switch(d.label){case 0:if(this.performanceClient.addQueueMeasurement(fy.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),i=this.browserStorage.generateStateKey(t),!(a=this.browserStorage.getTemporaryCache(i)))throw jw.createStateNotFoundError("Cached State");return s=this.browserStorage.generateNonceKey(a),c=this.browserStorage.getTemporaryCache(s),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(fy.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,n)]):[3,2];case 1:d.sent(),d.label=2;case 2:return o&&(e.nonce=c||void 0),e.state=a,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(l=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=l),this.performanceClient.setPreQueueTime(fy.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return u=d.sent(),this.browserStorage.cleanRequestByState(t),[2,u]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return my(this,void 0,void 0,(function(){var n,o;return by(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(fy.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),n="https://"+e+"/"+t.tenant+"/",[4,UT.createDiscoveredInstance(n,r,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return o=i.sent(),this.authModule.updateAuthority(o),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(hk.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),ZT=function(e){function t(t,r,n,o,i,a,s,c,l,u){var d=e.call(this,t,r,n,o,i,a,s,l,u)||this;return d.unloadWindow=d.unloadWindow.bind(d),d.nativeStorage=c,d}return py(t,e),t.prototype.acquireToken=function(e){try{var t=this.generatePopupName(e.scopes||Dy,e.authority||this.config.auth.authority),r=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var n=this.openSizedPopup("about:blank",t,r);return this.acquireTokenPopupAsync(e,t,r,n)}catch(o){return Promise.reject(o)}},t.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),r=this.generateLogoutPopupName(t),n=e&&e.authority,o=e&&e.mainWindowRedirectUri,i=(null===e||void 0===e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,i,n,void 0,o);this.logger.verbose("asyncPopup set to false, opening popup");var a=this.openSizedPopup("about:blank",r,i);return this.logoutPopupAsync(t,r,i,n,a,o)}catch(s){return Promise.reject(s)}},t.prototype.acquireTokenPopupAsync=function(e,t,r,n){return my(this,void 0,void 0,(function(){var o,i,a,s,c,l,u,d,p,f,h,g,v,m,b,y,k=this;return by(this,(function(w){switch(w.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),o=this.initializeServerTelemetryManager(vk.acquireTokenPopup),this.performanceClient.setPreQueueTime(fy.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,mk.Popup)];case 1:i=w.sent(),this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||Ny.EMPTY_STRING,i.account||null),w.label=2;case 2:return w.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(fy.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(i)];case 3:return a=w.sent(),this.performanceClient.setPreQueueTime(fy.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(o,i.authority,i.azureCloudOptions)];case 4:return s=w.sent(),this.logger.verbose("Auth code client created"),c=YT.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme),l=void 0,c&&(l=this.performanceClient.startMeasurement(fy.FetchAccountIdWithNativeBroker,e.correlationId)),[4,s.getAuthCodeUrl(gy(gy({},i),{nativeBroker:c}))];case 5:return u=w.sent(),d=new XT(s,this.browserStorage,a,this.logger,this.performanceClient),p={popup:n,popupName:t,popupWindowAttributes:r},f=this.initiateAuthRequest(u,p),this.eventHandler.emitEvent(vT.POPUP_OPENED,mk.Popup,{popupWindow:f},null),[4,this.monitorPopupForHash(f)];case 6:if(h=w.sent(),g=$C.getDeserializedHash(h),v=this.validateAndExtractStateFromHash(g,mk.Popup,i.correlationId),wT.removeThrottle(this.browserStorage,this.config.auth.clientId,a),g.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),l&&l.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Lx.createNativeConnectionNotEstablishedError();return m=new JT(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,vk.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,g.accountId,this.nativeStorage,i.correlationId),b=JC.parseRequestState(this.browserCrypto,v).userRequestState,[2,m.acquireToken(gy(gy({},i),{state:b,prompt:void 0})).finally((function(){k.browserStorage.cleanRequestByState(v)}))]}return[4,d.handleCodeResponseFromHash(h,v,s.authority,this.networkClient)];case 7:return[2,w.sent()];case 8:throw y=w.sent(),n&&n.close(),y instanceof wk&&y.setCorrelationId(this.correlationId),o.cacheFailedRequest(y),this.browserStorage.cleanRequestByState(i.state),y;case 9:return[2]}}))}))},t.prototype.logoutPopupAsync=function(e,t,r,n,o,i){return my(this,void 0,void 0,(function(){var a,s,c,l,u,d,p;return by(this,(function(f){switch(f.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(vT.LOGOUT_START,mk.Popup,e),a=this.initializeServerTelemetryManager(vk.logoutPopup),f.label=1;case 1:return f.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(e.account)];case 2:return f.sent(),this.performanceClient.setPreQueueTime(fy.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(a,n)];case 3:return s=f.sent(),this.logger.verbose("Auth code client created"),c=s.getLogoutUri(e),this.eventHandler.emitEvent(vT.LOGOUT_SUCCESS,mk.Popup,e),l=this.openPopup(c,{popupName:t,popupWindowAttributes:r,popup:o}),this.eventHandler.emitEvent(vT.POPUP_OPENED,mk.Popup,{popupWindow:l},null),[4,this.waitForLogoutPopup(l)];case 4:return f.sent(),i?(u={apiId:vk.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},d=$C.getAbsoluteUrl(i,fT.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+d),this.navigationClient.navigateInternal(d,u)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw p=f.sent(),o&&o.close(),p instanceof wk&&p.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(vT.LOGOUT_FAILURE,mk.Popup,null,p),this.eventHandler.emitEvent(vT.LOGOUT_END,mk.Popup),a.cacheFailedRequest(p),p;case 6:return this.eventHandler.emitEvent(vT.LOGOUT_END,mk.Popup),[2]}}))}))},t.prototype.initiateAuthRequest=function(e,t){if(Gw.isEmpty(e))throw this.logger.error("Navigate url is empty"),Lx.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+e),this.openPopup(e,t)},t.prototype.monitorPopupForHash=function(e){var t=this;return new Promise((function(r,n){var o=t.config.system.windowHashTimeout/t.config.system.pollIntervalMilliseconds,i=0;t.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var a=setInterval((function(){if(e.closed)return t.logger.error("PopupHandler.monitorPopupForHash - window closed"),t.cleanPopup(),clearInterval(a),void n(Lx.createUserCancelledError());var s=Ny.EMPTY_STRING,c=Ny.EMPTY_STRING;try{s=e.location.href,c=e.location.hash}catch(l){}Gw.isEmpty(s)||"about:blank"===s||(t.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),i++,c?(t.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(a),t.cleanPopup(e),$C.hashContainsKnownProperties(c)?(t.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),r(c)):(t.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),t.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+c),n(Lx.createHashDoesNotContainKnownPropertiesError()))):i>o&&(t.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(a),n(Lx.createMonitorPopupTimeoutError())))}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.waitForLogoutPopup=function(e){var t=this;return new Promise((function(r){t.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var n=setInterval((function(){e.closed&&(t.logger.error("PopupHandler.waitForLogoutPopup - window closed"),t.cleanPopup(),clearInterval(n),r());var o=Ny.EMPTY_STRING;try{o=e.location.href}catch(i){}Gw.isEmpty(o)||"about:blank"===o||(t.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),t.cleanPopup(e),r())}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.openPopup=function(e,t){try{var r=void 0;if(t.popup?(r=t.popup,this.logger.verbosePii("Navigating popup window to: "+e),r.location.assign(e)):"undefined"===typeof t.popup&&(this.logger.verbosePii("Opening popup window to: "+e),r=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!r)throw Lx.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),Lx.createPopupWindowError(n.toString())}},t.prototype.openSizedPopup=function(e,t,r){var n,o,i,a,s=window.screenLeft?window.screenLeft:window.screenX,c=window.screenTop?window.screenTop:window.screenY,l=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,u=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,d=null===(n=r.popupSize)||void 0===n?void 0:n.width,p=null===(o=r.popupSize)||void 0===o?void 0:o.height,f=null===(i=r.popupPosition)||void 0===i?void 0:i.top,h=null===(a=r.popupPosition)||void 0===a?void 0:a.left;return(!d||d<0||d>l)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),d=Ak),(!p||p<0||p>u)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),p=Rk),(!f||f<0||f>u)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),f=Math.max(0,u/2-Rk/2+c)),(!h||h<0||h>l)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),h=Math.max(0,l/2-Ak/2+s)),window.open(e,t,"width="+d+", height="+p+", top="+f+", left="+h+", scrollbars=yes")},t.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(mk.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},t.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},t.prototype.generatePopupName=function(e,t){return Pk+"."+this.config.auth.clientId+"."+e.join("-")+"."+t+"."+this.correlationId},t.prototype.generateLogoutPopupName=function(e){var t=e.account&&e.account.homeAccountId;return Pk+"."+this.config.auth.clientId+"."+t+"."+this.correlationId},t}(HT),$T=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t,r,n,o,a)||this;return s.browserCrypto=i,s}return py(t,e),t.prototype.initiateAuthRequest=function(e,t){return my(this,void 0,void 0,(function(){var r;return by(this,(function(n){switch(n.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),Gw.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(hk.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(hk.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:vk.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!==typeof t.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:case 5:return n.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Lx.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponseFromHash=function(e,t,r,n){return my(this,void 0,void 0,(function(){var o,i,a,s,c,l,u;return by(this,(function(d){switch(d.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),Gw.isEmpty(e))throw Lx.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw jw.createStateNotFoundError("Cached State");try{a=this.authModule.handleFragmentResponse(e,i)}catch(p){throw p instanceof xk&&p.subError===nx.code?Lx.createUserCancelledError():p}return s=this.browserStorage.generateNonceKey(i),c=this.browserStorage.getTemporaryCache(s),this.authCodeRequest.code=a.code,a.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(a.cloud_instance_host_name,r,n)]:[3,2];case 1:d.sent(),d.label=2;case 2:return a.nonce=c||void 0,a.state=i,a.client_info?this.authCodeRequest.clientInfo=a.client_info:(l=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=l),[4,this.authModule.acquireToken(this.authCodeRequest,a)];case 3:return u=d.sent(),this.browserStorage.cleanRequestByState(t),[2,u]}}))}))},t}(XT),e_=function(e){function t(t,r,n,o,i,a,s,c,l,u){var d=e.call(this,t,r,n,o,i,a,s,l,u)||this;return d.nativeStorage=c,d}return py(t,e),t.prototype.acquireToken=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,l,u=this;return by(this,(function(d){switch(d.label){case 0:return this.performanceClient.setPreQueueTime(fy.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,mk.Redirect)];case 1:t=d.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||Ny.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(vk.acquireTokenRedirect),n=function(e){e.persisted&&(u.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),u.browserStorage.cleanRequestByState(t.state))},d.label=2;case 2:return d.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(fy.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return o=d.sent(),this.performanceClient.setPreQueueTime(fy.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(r,t.authority,t.azureCloudOptions)];case 4:return i=d.sent(),this.logger.verbose("Auth code client created"),a=new $T(i,this.browserStorage,o,this.logger,this.browserCrypto,this.performanceClient),[4,i.getAuthCodeUrl(gy(gy({},t),{nativeBroker:YT.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}))];case 5:return s=d.sent(),c=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+c),window.addEventListener("pageshow",n),[4,a.initiateAuthRequest(s,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate})];case 6:return[2,d.sent()];case 7:throw(l=d.sent())instanceof wk&&l.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),r.cacheFailedRequest(l),this.browserStorage.cleanRequestByState(t.state),l;case 8:return[2]}}))}))},t.prototype.handleRedirectPromise=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,l,u,d,p;return by(this,(function(f){switch(f.label){case 0:t=this.initializeServerTelemetryManager(vk.handleRedirectPromise),f.label=1;case 1:if(f.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(r=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(mk.Redirect),[2,null];n=void 0;try{o=$C.getDeserializedHash(r),n=this.validateAndExtractStateFromHash(o,mk.Redirect),this.logger.verbose("State extracted from hash")}catch(h){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+h),this.browserStorage.cleanRequestByInteractionType(mk.Redirect),[2,null]}return i=this.browserStorage.getTemporaryCache(hk.ORIGIN_URI,!0)||Ny.EMPTY_STRING,a=$C.removeHashFromUrl(i),s=$C.removeHashFromUrl(window.location.href),a===s&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,n,t)]):[3,3];case 2:return c=f.sent(),i.indexOf("#")>-1&&fT.replaceHash(i),[2,c];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,n,t)]);case 4:return fT.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(hk.URL_HASH,r,!0),l={apiId:vk.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},u=!0,i&&"null"!==i?[3,6]:(d=fT.getHomepage(),this.browserStorage.setTemporaryCache(hk.ORIGIN_URI,d,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(d,l)]));case 5:return u=f.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+i),[4,this.navigationClient.navigateInternal(i,l)];case 7:u=f.sent(),f.label=8;case 8:if(!u)return[2,this.handleHash(r,n,t)];f.label=9;case 9:return[2,null];case 10:throw(p=f.sent())instanceof wk&&p.setCorrelationId(this.correlationId),t.cacheFailedRequest(p),this.browserStorage.cleanRequestByInteractionType(mk.Redirect),p;case 11:return[2]}}))}))},t.prototype.getRedirectResponseHash=function(e){if(this.logger.verbose("getRedirectResponseHash called"),$C.hashContainsKnownProperties(e))return fT.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),e;var t=this.browserStorage.getTemporaryCache(hk.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(hk.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),t},t.prototype.handleHash=function(e,t,r){return my(this,void 0,void 0,(function(){var n,o,i,a,s,c,l=this;return by(this,(function(u){switch(u.label){case 0:if(n=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(o=$C.getDeserializedHash(e)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Lx.createNativeConnectionNotEstablishedError();return i=new JT(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,vk.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,o.accountId,this.browserStorage,n.correlationId),a=JC.parseRequestState(this.browserCrypto,t).userRequestState,[2,i.acquireToken(gy(gy({},n),{state:a,prompt:void 0})).finally((function(){l.browserStorage.cleanRequestByState(t)}))]}if(!(s=this.browserStorage.getCachedAuthority(t)))throw Lx.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime(fy.StandardInteractionClientCreateAuthCodeClient,n.correlationId),[4,this.createAuthCodeClient(r,s)];case 1:return c=u.sent(),this.logger.verbose("Auth code client created"),wT.removeThrottle(this.browserStorage,this.config.auth.clientId,n),[4,new $T(c,this.browserStorage,n,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(e,t,c.authority,this.networkClient)];case 2:return[2,u.sent()]}}))}))},t.prototype.logout=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i,a;return by(this,(function(s){switch(s.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(vk.logout),s.label=1;case 1:return s.trys.push([1,10,,11]),this.eventHandler.emitEvent(vT.LOGOUT_START,mk.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return s.sent(),n={apiId:vk.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(fy.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(r,e&&e.authority)];case 3:return o=s.sent(),this.logger.verbose("Auth code client created"),i=o.getLogoutUri(t),this.eventHandler.emitEvent(vT.LOGOUT_SUCCESS,mk.Redirect,t),e&&"function"===typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(i)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,n)]):[3,7];case 4:return s.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),s.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,n)];case 8:return s.sent(),[2];case 9:return[3,11];case 10:throw(a=s.sent())instanceof wk&&a.setCorrelationId(this.correlationId),r.cacheFailedRequest(a),this.eventHandler.emitEvent(vT.LOGOUT_FAILURE,mk.Redirect,null,a),this.eventHandler.emitEvent(vT.LOGOUT_END,mk.Redirect),a;case 11:return this.eventHandler.emitEvent(vT.LOGOUT_END,mk.Redirect),[2]}}))}))},t.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return $C.getAbsoluteUrl(t,fT.getCurrentUri())},t}(HT),t_=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t,r,n,o,a)||this;return s.navigateFrameWait=i.navigateFrameWait,s.pollIntervalMilliseconds=i.pollIntervalMilliseconds,s}return py(t,e),t.prototype.initiateAuthRequest=function(e){return my(this,void 0,void 0,(function(){return by(this,(function(t){switch(t.label){case 0:if(this.performanceClient.addQueueMeasurement(fy.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),Gw.isEmpty(e))throw this.logger.info("Navigate url is empty"),Lx.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(fy.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(e)]):[3,2];case 1:return[2,t.sent()];case 2:return[2,this.loadFrameSync(e)]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return this.performanceClient.addQueueMeasurement(fy.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise((function(n,o){t<gT&&r.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+gT+"ms). This may result in timeouts.");var i=window.performance.now()+t,a=setInterval((function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(a),void o(Lx.createMonitorIframeTimeoutError());var t=Ny.EMPTY_STRING,s=e.contentWindow;try{t=s?s.location.href:Ny.EMPTY_STRING}catch(l){}if(!Gw.isEmpty(t)){var c=s?s.location.hash:Ny.EMPTY_STRING;return $C.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(a),void n(c)):void 0}}),r.pollIntervalMilliseconds)}))},t.prototype.loadFrame=function(e){var t=this;return this.performanceClient.addQueueMeasurement(fy.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise((function(r,n){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,r(o)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(XT),r_=function(e){function t(t,r,n,o,i,a,s,c,l,u,d){var p=e.call(this,t,r,n,o,i,a,c,u,d)||this;return p.apiId=s,p.nativeStorage=l,p}return py(t,e),t.prototype.acquireToken=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i;return by(this,(function(a){switch(a.label){case 0:if(this.performanceClient.addQueueMeasurement(fy.SilentIframeClientAcquireToken,e.correlationId),this.logger.verbose("acquireTokenByIframe called"),t=this.performanceClient.startMeasurement(fy.SilentIframeClientAcquireToken,e.correlationId),Gw.isEmpty(e.loginHint)&&Gw.isEmpty(e.sid)&&(!e.account||Gw.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==Uy.NONE&&e.prompt!==Uy.NO_SESSION)throw t.endMeasurement({success:!1}),Lx.createSilentPromptValueError(e.prompt);return this.performanceClient.setPreQueueTime(fy.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(gy(gy({},e),{prompt:e.prompt||Uy.NONE}),mk.Silent)];case 1:r=a.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||Ny.EMPTY_STRING,r.account||null),n=this.initializeServerTelemetryManager(this.apiId),a.label=2;case 2:return a.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(fy.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(n,r.authority,r.azureCloudOptions)];case 3:return o=a.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(fy.SilentIframeClientTokenHelper,e.correlationId),[4,this.silentTokenHelper(o,r).then((function(e){return t.endMeasurement({success:!0,fromCache:!1,requestId:e.requestId}),e}))];case 4:return[2,a.sent()];case 5:throw(i=a.sent())instanceof wk&&i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i),this.browserStorage.cleanRequestByState(r.state),t.endMeasurement({errorCode:i instanceof wk&&i.errorCode||void 0,subErrorCode:i instanceof wk&&i.subError||void 0,success:!1}),i;case 6:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(Lx.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(e,t){return my(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,l,u,d=this;return by(this,(function(p){switch(p.label){case 0:return this.performanceClient.addQueueMeasurement(fy.SilentIframeClientTokenHelper,t.correlationId),this.performanceClient.setPreQueueTime(fy.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 1:return r=p.sent(),this.performanceClient.setPreQueueTime(fy.GetAuthCodeUrl,t.correlationId),[4,e.getAuthCodeUrl(gy(gy({},t),{nativeBroker:YT.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 2:return n=p.sent(),o=new t_(e,this.browserStorage,r,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(fy.SilentHandlerInitiateAuthRequest,t.correlationId),[4,o.initiateAuthRequest(n)];case 3:return i=p.sent(),this.performanceClient.setPreQueueTime(fy.SilentHandlerMonitorIframeForHash,t.correlationId),[4,o.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 4:if(a=p.sent(),s=$C.getDeserializedHash(a),c=this.validateAndExtractStateFromHash(s,mk.Silent,r.correlationId),s.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Lx.createNativeConnectionNotEstablishedError();return l=new JT(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,s.accountId,this.browserStorage,this.correlationId),u=JC.parseRequestState(this.browserCrypto,c).userRequestState,[2,l.acquireToken(gy(gy({},t),{state:u,prompt:t.prompt||Uy.NONE})).finally((function(){d.browserStorage.cleanRequestByState(c)}))]}return this.performanceClient.setPreQueueTime(fy.HandleCodeResponseFromHash,t.correlationId),[2,o.handleCodeResponseFromHash(a,c,e.authority,this.networkClient)]}}))}))},t}(HT),n_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return py(t,e),t.prototype.acquireToken=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i,a=this;return by(this,(function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(fy.SilentRefreshClientAcquireToken,e.correlationId),this.performanceClient.setPreQueueTime(fy.InitializeBaseRequest,e.correlationId),r=[gy({},e)],[4,this.initializeBaseRequest(e)];case 1:return t=gy.apply(void 0,r.concat([s.sent()])),n=this.performanceClient.startMeasurement(fy.SilentRefreshClientAcquireToken,t.correlationId),o=this.initializeServerTelemetryManager(vk.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(o,t.authority,t.azureCloudOptions)];case 2:return i=s.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(fy.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),[2,i.acquireTokenByRefreshToken(t).then((function(e){return n.endMeasurement({success:!0,fromCache:e.fromCache,requestId:e.requestId}),e})).catch((function(e){throw e instanceof wk&&e.setCorrelationId(a.correlationId),o.cacheFailedRequest(e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))]}}))}))},t.prototype.logout=function(){return Promise.reject(Lx.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(e,t,r){return my(this,void 0,void 0,(function(){var n;return by(this,(function(o){switch(o.label){case 0:return this.performanceClient.setPreQueueTime(fy.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new KT(n,this.performanceClient)]}}))}))},t}(HT),o_=function(){function e(e,t,r,n){this.isBrowserEnvironment="undefined"!==typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}return e.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw Lx.createUnableToLoadTokenError("Please ensure server response includes id token.");var n,o,i=new FC(t.id_token,this.cryptoObj);if(e.account){var a=this.loadAccount(i,e.account.environment,void 0,void 0,e.account.homeAccountId);n=new ST(a,this.loadIdToken(i,a.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,a.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadRefreshToken(e,t,a.homeAccountId,e.account.environment))}else{if(!e.authority)throw Lx.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var s=MT.generateAuthority(e.authority,e.azureCloudOptions),c={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(o=new MT(s,this.config.system.networkClient,this.storage,c,this.logger),r.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");a=this.loadAccount(i,o.hostnameAndPort,r.clientInfo,o.authorityType);n=new ST(a,this.loadIdToken(i,a.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,a.homeAccountId,o.hostnameAndPort,o.tenant,r),this.loadRefreshToken(e,t,a.homeAccountId,o.hostnameAndPort))}else{if(!t.client_info)throw Lx.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response");a=this.loadAccount(i,o.hostnameAndPort,t.client_info,o.authorityType);n=new ST(a,this.loadIdToken(i,a.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,a.homeAccountId,o.hostnameAndPort,o.tenant,r),this.loadRefreshToken(e,t,a.homeAccountId,o.hostnameAndPort))}}return this.generateAuthenticationResult(e,i,n,o)},e.prototype.loadAccount=function(e,t,r,n,o){var i;if(o?i=o:void 0!==n&&r&&(i=dC.generateHomeAccountId(r,n,this.logger,this.cryptoObj,e)),!i)throw Lx.createUnableToLoadTokenError("Unexpected missing homeAccountId");var a=r?dC.createAccount(r,i,e,void 0,void 0,void 0,t):dC.createGenericAccount(i,e,void 0,void 0,void 0,t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(a),a;throw Lx.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadIdToken=function(e,t,r,n){var o=BC.createIdTokenEntity(t,r,e.rawToken,this.config.auth.clientId,n);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(o),o;throw Lx.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadAccessToken=function(e,t,r,n,o,i){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw Lx.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!i.extendedExpiresOn)throw Lx.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var a=new UC(e.scopes).printScopes(),s=i.expiresOn||t.expires_in+(new Date).getTime()/1e3,c=i.extendedExpiresOn,l=jC.createAccessTokenEntity(r,n,t.access_token,this.config.auth.clientId,o,a,s,c,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(l),l;throw Lx.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadRefreshToken=function(e,t,r,n){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var o=GC.createRefreshTokenEntity(r,n,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(o),o;throw Lx.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.generateAuthenticationResult=function(e,t,r,n){var o,i,a,s,c=Ny.EMPTY_STRING,l=[],u=null;(null===r||void 0===r?void 0:r.accessToken)&&(c=r.accessToken.secret,l=UC.fromString(r.accessToken.target).asArray(),u=new Date(1e3*Number(r.accessToken.expiresOn)),s=new Date(1e3*Number(r.accessToken.extendedExpiresOn)));var d=(null===t||void 0===t?void 0:t.claims.oid)||(null===t||void 0===t?void 0:t.claims.sub)||Ny.EMPTY_STRING,p=(null===t||void 0===t?void 0:t.claims.tid)||Ny.EMPTY_STRING;return{authority:n?n.canonicalAuthority:Ny.EMPTY_STRING,uniqueId:d,tenantId:p,scopes:l,account:(null===r||void 0===r?void 0:r.account)?r.account.getAccountInfo():null,idToken:t?t.rawToken:Ny.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:c,fromCache:!0,expiresOn:u,correlationId:e.correlationId||Ny.EMPTY_STRING,requestId:Ny.EMPTY_STRING,extExpiresOn:s,familyId:Ny.EMPTY_STRING,tokenType:(null===(o=null===r||void 0===r?void 0:r.accessToken)||void 0===o?void 0:o.tokenType)||Ny.EMPTY_STRING,state:Ny.EMPTY_STRING,cloudGraphHostName:(null===(i=null===r||void 0===r?void 0:r.account)||void 0===i?void 0:i.cloudGraphHostName)||Ny.EMPTY_STRING,msGraphHost:(null===(a=null===r||void 0===r?void 0:r.account)||void 0===a?void 0:a.msGraphHost)||Ny.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},e}(),i_=function(e){function t(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!1,r}return py(t,e),t}(RT),a_=function(e){function t(t,r,n,o,i,a,s,c,l,u){var d=e.call(this,t,r,n,o,i,a,c,l,u)||this;return d.apiId=s,d}return py(t,e),t.prototype.acquireToken=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i,a;return by(this,(function(s){switch(s.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!e.code)throw Lx.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime(fy.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,mk.Silent)];case 1:t=s.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||Ny.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(this.apiId),s.label=2;case 2:return s.trys.push([2,4,,5]),n=gy(gy({},t),{code:e.code}),this.performanceClient.setPreQueueTime(fy.StandardInteractionClientGetClientConfiguration,e.correlationId),[4,this.getClientConfiguration(r,t.authority)];case 3:return o=s.sent(),i=new i_(o),this.logger.verbose("Auth code client created"),[2,new t_(i,this.browserStorage,n,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,i.authority,this.networkClient,!1)];case 4:throw(a=s.sent())instanceof wk&&a.setCorrelationId(this.correlationId),r.cacheFailedRequest(a),this.browserStorage.cleanRequestByState(t.state),a;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(Lx.createSilentLogoutUnsupportedError())},t}(HT),s_=function(){function e(e,t){this.correlationId=t,this.measureName="msal.measure."+e+"."+this.correlationId,this.startMark="msal.start."+e+"."+this.correlationId,this.endMark="msal.end."+e+"."+this.correlationId}return e.supportsBrowserPerformance=function(){return"undefined"!==typeof window&&"undefined"!==typeof window.performance&&"function"===typeof window.performance.mark&&"function"===typeof window.performance.measure&&"function"===typeof window.performance.clearMarks&&"function"===typeof window.performance.clearMeasures&&"function"===typeof window.performance.getEntriesByName},e.prototype.startMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(t){}},e.prototype.endMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(t){}},e.prototype.flushMeasurement=function(){if(e.supportsBrowserPerformance())try{var t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){var r=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),r}}catch(n){}return null},e}(),c_=function(e){function t(t,r,n,o,i,a,s){var c=e.call(this,t,r,n,o,i,a)||this;return c.browserCrypto=new Yx(c.logger,s),c.guidGenerator=new Jk(c.browserCrypto),c}return py(t,e),t.prototype.startPerformanceMeasuremeant=function(e,t){return new s_(e,t)},t.prototype.generateId=function(){return this.guidGenerator.generateGuid()},t.prototype.getPageVisibility=function(){var e;return(null===(e=document.visibilityState)||void 0===e?void 0:e.toString())||null},t.prototype.supportsBrowserPerformanceNow=function(){return"undefined"!==typeof window&&"undefined"!==typeof window.performance&&"function"===typeof window.performance.now},t.prototype.startMeasurement=function(t,r){var n=this,o=this.getPageVisibility(),i=e.prototype.startMeasurement.call(this,t,r);return gy(gy({},i),{endMeasurement:function(e){return i.endMeasurement(gy({startPageVisibility:o,endPageVisibility:n.getPageVisibility()},e))}})},t.prototype.setPreQueueTime=function(e,t){if(this.supportsBrowserPerformanceNow())if(t){var r=this.preQueueTimeByCorrelationId.get(t);if(r)r.set(e,window.performance.now()),this.preQueueTimeByCorrelationId.set(t,r);else{var n=new Map;n.set(e,window.performance.now()),this.preQueueTimeByCorrelationId.set(t,n)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+e+" not provided, unable to set telemetry queue time");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+e)},t.prototype.addQueueMeasurement=function(t,r){if(this.supportsBrowserPerformanceNow())if(r){var n=e.prototype.getPreQueueTime.call(this,t,r);if(n){var o=window.performance.now(),i=e.prototype.calculateQueuedTime.call(this,n,o);return e.prototype.addQueueMeasurement.call(this,t,r,i)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+t)},t}(iC),l_=function(){function e(e){this.isBrowserEnvironment="undefined"!==typeof window,this.config=function(e,t){var r=e.auth,n=e.cache,o=e.system,i=e.telemetry,a={clientId:Ny.EMPTY_STRING,authority:""+Ny.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:Ny.EMPTY_STRING,authorityMetadata:Ny.EMPTY_STRING,redirectUri:Ny.EMPTY_STRING,postLogoutRedirectUri:Ny.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:YC.AAD,azureCloudOptions:{azureCloudInstance:XC.None,tenant:Ny.EMPTY_STRING},skipAuthorityMetadataCache:!1},s={cacheLocation:pk.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},c={loggerCallback:function(){},logLevel:eC.Info,piiLoggingEnabled:!1},l=gy(gy({},nT),{loggerOptions:c,networkClient:t?fT.getBrowserNetworkClient():uT,navigationClient:new hT,loadFrameTimeout:0,windowHashTimeout:(null===o||void 0===o?void 0:o.loadFrameTimeout)||6e4,iframeHashTimeout:(null===o||void 0===o?void 0:o.loadFrameTimeout)||gT,navigateFrameWait:t&&fT.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null===o||void 0===o?void 0:o.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:Ok,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),u=gy(gy({},o),{loggerOptions:(null===o||void 0===o?void 0:o.loggerOptions)||c}),d={application:{appName:Ny.EMPTY_STRING,appVersion:Ny.EMPTY_STRING}};return{auth:gy(gy({},a),r),cache:gy(gy({},s),n),system:gy(gy({},l),u),telemetry:gy(gy({},d),i)}}(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new oC(this.config.system.loggerOptions,mT,bT),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new c_(this.config.auth.clientId,this.config.auth.authority,this.logger,mT,bT,this.config.telemetry.application,this.config.system.cryptoOptions):new sC(this.config.auth.clientId,this.config.auth.authority,this.logger,mT,bT,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new rC(this.logger,this.performanceClient,this.config.system.cryptoOptions):cC,this.eventHandler=new kT(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new tT(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):function(e,t){var r={cacheLocation:pk.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1};return new tT(e,r,cC,t)}(this.config.auth.clientId,this.logger);var t={cacheLocation:pk.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1};this.nativeInternalStorage=new tT(this.config.auth.clientId,t,this.browserCrypto,this.logger),this.tokenCache=new o_(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return e.prototype.initialize=function(){return my(this,void 0,void 0,(function(){var e,t;return by(this,(function(r){switch(r.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(this.eventHandler.emitEvent(vT.INITIALIZE_START),!this.config.system.allowNativeBroker)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this,[4,YT.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout)];case 2:return e.nativeExtensionProvider=r.sent(),[3,4];case 3:return t=r.sent(),this.logger.verbose(t),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(vT.INITIALIZE_END),[2]}}))}))},e.prototype.handleRedirectPromise=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,l=this;return by(this,(function(u){return this.logger.verbose("handleRedirectPromise called"),fT.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||Ny.EMPTY_STRING,"undefined"===typeof(n=this.redirectResponse.get(r))?(this.eventHandler.emitEvent(vT.HANDLE_REDIRECT_START,mk.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),o=this.browserStorage.getCachedNativeRequest(),i=void 0,o&&YT.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),a=new JT(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,vk.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,o.accountId,this.nativeInternalStorage,o.correlationId),i=a.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),s=this.browserStorage.getTemporaryCache(hk.CORRELATION_ID,!0)||Ny.EMPTY_STRING,c=this.createRedirectClient(s),i=c.handleRedirectPromise(e)),n=i.then((function(e){e&&(t.length<l.getAllAccounts().length?(l.eventHandler.emitEvent(vT.LOGIN_SUCCESS,mk.Redirect,e),l.logger.verbose("handleRedirectResponse returned result, login success")):(l.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_SUCCESS,mk.Redirect,e),l.logger.verbose("handleRedirectResponse returned result, acquire token success")));return l.eventHandler.emitEvent(vT.HANDLE_REDIRECT_END,mk.Redirect),e})).catch((function(e){throw t.length>0?l.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_FAILURE,mk.Redirect,null,e):l.eventHandler.emitEvent(vT.LOGIN_FAILURE,mk.Redirect,null,e),l.eventHandler.emitEvent(vT.HANDLE_REDIRECT_END,mk.Redirect),e})),this.redirectResponse.set(r,n)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,n]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.acquireTokenRedirect=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i,a=this;return by(this,(function(s){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(mk.Redirect),(r=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_START,mk.Redirect,e):this.eventHandler.emitEvent(vT.LOGIN_START,mk.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(o=new JT(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,vk.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),n=o.acquireTokenRedirect(e).catch((function(t){if(t instanceof VT&&t.isFatal())return a.nativeExtensionProvider=void 0,a.createRedirectClient(e.correlationId).acquireToken(e);if(t instanceof Ik)return a.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),a.createRedirectClient(e.correlationId).acquireToken(e);throw a.browserStorage.setInteractionInProgress(!1),t}))):(i=this.createRedirectClient(e.correlationId),n=i.acquireToken(e)),[2,n.catch((function(e){throw r?a.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_FAILURE,mk.Redirect,null,e):a.eventHandler.emitEvent(vT.LOGIN_FAILURE,mk.Redirect,null,e),e}))]}))}))},e.prototype.acquireTokenPopup=function(e){var t=this,r=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(fy.AcquireTokenPopup,r);try{this.logger.verbose("acquireTokenPopup called",r),this.preflightBrowserEnvironmentCheck(mk.Popup)}catch(a){return Promise.reject(a)}var o,i=this.getAllAccounts();(i.length>0?this.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_START,mk.Popup,e):this.eventHandler.emitEvent(vT.LOGIN_START,mk.Popup,e),this.canUseNative(e))?o=this.acquireTokenNative(e,vk.acquireTokenPopup).then((function(e){return t.browserStorage.setInteractionInProgress(!1),n.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),n.flushMeasurement(),e})).catch((function(r){if(r instanceof VT&&r.isFatal())return t.nativeExtensionProvider=void 0,t.createPopupClient(e.correlationId).acquireToken(e);if(r instanceof Ik)return t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),t.createPopupClient(e.correlationId).acquireToken(e);throw t.browserStorage.setInteractionInProgress(!1),r})):o=this.createPopupClient(e.correlationId).acquireToken(e);return o.then((function(e){return i.length<t.getAllAccounts().length?t.eventHandler.emitEvent(vT.LOGIN_SUCCESS,mk.Popup,e):t.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_SUCCESS,mk.Popup,e),n.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),n.endMeasurement({success:!0,requestId:e.requestId}),n.flushMeasurement(),e})).catch((function(e){return i.length>0?t.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_FAILURE,mk.Popup,null,e):t.eventHandler.emitEvent(vT.LOGIN_FAILURE,mk.Popup,null,e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),n.flushMeasurement(),Promise.reject(e)}))},e.prototype.trackPageVisibilityWithMeasurement=function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))},e.prototype.ssoSilent=function(e){var t;return my(this,void 0,void 0,(function(){var r,n,o,i,a=this;return by(this,(function(s){return r=this.getRequestCorrelationId(e),n=gy(gy({},e),{prompt:e.prompt,correlationId:r}),this.preflightBrowserEnvironmentCheck(mk.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(fy.SsoSilent,r),null===(t=this.ssoSilentMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(vT.SSO_SILENT_START,mk.Silent,n),this.canUseNative(n)?o=this.acquireTokenNative(n,vk.ssoSilent).catch((function(e){if(e instanceof VT&&e.isFatal())return a.nativeExtensionProvider=void 0,a.createSilentIframeClient(n.correlationId).acquireToken(n);throw e})):(i=this.createSilentIframeClient(n.correlationId),o=i.acquireToken(n)),[2,o.then((function(e){var t,r,n;return a.eventHandler.emitEvent(vT.SSO_SILENT_SUCCESS,mk.Silent,e),null===(t=a.ssoSilentMeasurement)||void 0===t||t.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),null===(r=a.ssoSilentMeasurement)||void 0===r||r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),null===(n=a.ssoSilentMeasurement)||void 0===n||n.flushMeasurement(),e})).catch((function(e){var t,r;throw a.eventHandler.emitEvent(vT.SSO_SILENT_FAILURE,mk.Silent,null,e),null===(t=a.ssoSilentMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),null===(r=a.ssoSilentMeasurement)||void 0===r||r.flushMeasurement(),e})).finally((function(){document.removeEventListener("visibilitychange",a.trackPageVisibilityWithMeasurement)}))]}))}))},e.prototype.acquireTokenByCode=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i=this;return by(this,(function(a){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(mk.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_BY_CODE_START,mk.Silent,e),r=this.performanceClient.startMeasurement(fy.AcquireTokenByCode,e.correlationId);try{if(e.code)return n=e.code,(o=this.hybridAuthCodeResponses.get(n))?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),r.endMeasurement({success:!0}),r.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync(gy(gy({},e),{correlationId:t})).then((function(e){return i.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_BY_CODE_SUCCESS,mk.Silent,e),i.hybridAuthCodeResponses.delete(n),r.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),r.flushMeasurement(),e})).catch((function(e){throw i.hybridAuthCodeResponses.delete(n),i.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_BY_CODE_FAILURE,mk.Silent,null,e),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),r.flushMeasurement(),e})),this.hybridAuthCodeResponses.set(n,o)),[2,o];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,vk.acquireTokenByCode,e.nativeAccountId).catch((function(e){throw e instanceof VT&&e.isFatal()&&(i.nativeExtensionProvider=void 0),e}))];throw Lx.createUnableToAcquireTokenFromNativePlatformError()}throw Lx.createAuthCodeOrNativeAccountIdRequiredError()}catch(s){throw this.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_BY_CODE_FAILURE,mk.Silent,null,s),r.endMeasurement({errorCode:s instanceof wk&&s.errorCode||void 0,subErrorCode:s instanceof wk&&s.subError||void 0,success:!1}),s}return[2]}))}))},e.prototype.acquireTokenByCodeAsync=function(e){var t;return my(this,void 0,void 0,(function(){var r=this;return by(this,(function(n){switch(n.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(fy.AcquireTokenByCodeAsync,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then((function(e){var t;return null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",r.trackPageVisibilityWithMeasurement)}))];case 1:return[2,n.sent()]}}))}))},e.prototype.acquireTokenFromCache=function(e,t,r){return my(this,void 0,void 0,(function(){return by(this,(function(n){switch(this.performanceClient.addQueueMeasurement(fy.AcquireTokenFromCache,t.correlationId),r.cacheLookupPolicy){case Hk.Default:case Hk.AccessToken:case Hk.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw jw.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenByRefreshToken=function(e,t){return my(this,void 0,void 0,(function(){var r;return by(this,(function(n){switch(this.performanceClient.addQueueMeasurement(fy.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case Hk.Default:case Hk.AccessTokenAndRefreshToken:case Hk.RefreshToken:case Hk.RefreshTokenAndNetwork:return r=this.createSilentRefreshClient(e.correlationId),this.performanceClient.setPreQueueTime(fy.SilentRefreshClientAcquireToken,e.correlationId),[2,r.acquireToken(e)];default:throw jw.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenBySilentIframe=function(e){return my(this,void 0,void 0,(function(){var t;return by(this,(function(r){return this.performanceClient.addQueueMeasurement(fy.AcquireTokenBySilentIframe,e.correlationId),t=this.createSilentIframeClient(e.correlationId),this.performanceClient.setPreQueueTime(fy.SilentIframeClientAcquireToken,e.correlationId),[2,t.acquireToken(e)]}))}))},e.prototype.logout=function(e){return my(this,void 0,void 0,(function(){var t;return by(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(gy({correlationId:t},e))]}))}))},e.prototype.logoutRedirect=function(e){return my(this,void 0,void 0,(function(){var t;return by(this,(function(r){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(mk.Redirect),[2,this.createRedirectClient(t).logout(e)]}))}))},e.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(mk.Popup),this.createPopupClient(t).logout(e)}catch(r){return Promise.reject(r)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!Gw.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!Gw.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter((function(t){return t.homeAccountId===e}))[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!Gw.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter((function(t){return t.localAccountId===e}))[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(void 0===t&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),fT.blockNonBrowserEnvironment(this.isBrowserEnvironment),fT.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),fT.blockReloadInHiddenIframes(),fT.blockAcquireTokenInPopups(),fT.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===mk.Redirect&&this.config.cache.cacheLocation===pk.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Qx.createInMemoryRedirectUnavailableError();e!==mk.Redirect&&e!==mk.Popup||this.preflightInteractiveRequest(t)},e.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),fT.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},e.prototype.acquireTokenNative=function(e,t,r){return my(this,void 0,void 0,(function(){return by(this,(function(n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Lx.createNativeConnectionNotEstablishedError();return[2,new JT(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)]}))}))},e.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!YT.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Uy.NONE:case Uy.CONSENT:case Uy.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},e.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},e.prototype.createPopupClient=function(e){return new ZT(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createRedirectClient=function(e){return new e_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentIframeClient=function(e){return new r_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,vk.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentCacheClient=function(e){return new WT(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentRefreshClient=function(e){return new n_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentAuthCodeClient=function(e){return new a_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,vk.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},e.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e.prototype.getConfiguration=function(){return this.config},e.prototype.getRequestCorrelationId=function(e){return(null===e||void 0===e?void 0:e.correlationId)?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():Ny.EMPTY_STRING},e}(),u_=function(e){function t(t){var r=e.call(this,t)||this;return r.astsAsyncMeasurement=void 0,r.activeSilentTokenRequests=new Map,r.trackPageVisibility=r.trackPageVisibility.bind(r),r}return py(t,e),t.prototype.loginRedirect=function(e){return my(this,void 0,void 0,(function(){var t;return by(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.verbose("loginRedirect called",t),[2,this.acquireTokenRedirect(gy({correlationId:t},e||Fk))]}))}))},t.prototype.loginPopup=function(e){var t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(gy({correlationId:t},e||Fk))},t.prototype.acquireTokenSilent=function(e){return my(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c=this;return by(this,(function(l){if(t=this.getRequestCorrelationId(e),(r=this.performanceClient.startMeasurement(fy.AcquireTokenSilent,t)).addStaticFields({cacheLookupPolicy:e.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(mk.Silent),this.logger.verbose("acquireTokenSilent called",t),!(n=e.account||this.getActiveAccount()))throw Lx.createNoAccountError();return o={clientId:this.config.auth.clientId,authority:e.authority||Ny.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:n.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},i=JSON.stringify(o),"undefined"===typeof(a=this.activeSilentTokenRequests.get(i))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t),this.performanceClient.setPreQueueTime(fy.AcquireTokenSilentAsync,t),s=this.acquireTokenSilentAsync(gy(gy({},e),{correlationId:t}),n).then((function(t){return c.activeSilentTokenRequests.delete(i),r.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),r.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:t.requestId}),r.flushMeasurement(),t})).catch((function(e){throw c.activeSilentTokenRequests.delete(i),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),r.flushMeasurement(),e})),this.activeSilentTokenRequests.set(i,s),[2,s]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.endMeasurement({success:!0}),r.discardMeasurement(),[2,a])}))}))},t.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},t.prototype.acquireTokenSilentAsync=function(e,t){var r;return my(this,void 0,void 0,(function(){var n,o,i,a,s,c=this;return by(this,(function(l){switch(l.label){case 0:return this.performanceClient.addQueueMeasurement(fy.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_START,mk.Silent,e),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(fy.AcquireTokenSilentAsync,e.correlationId),null===(r=this.astsAsyncMeasurement)||void 0===r||r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),YT.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&t.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),o=gy(gy({},e),{account:t}),n=this.acquireTokenNative(o,vk.acquireTokenSilent_silentFlow).catch((function(t){return my(c,void 0,void 0,(function(){return by(this,(function(r){if(t instanceof VT&&t.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(e.correlationId).acquireToken(e)];throw t}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),i=this.createSilentCacheClient(e.correlationId),this.performanceClient.setPreQueueTime(fy.InitializeSilentRequest,e.correlationId),[4,i.initializeSilentRequest(e,t)];case 2:a=l.sent(),s=gy(gy({},e),{cacheLookupPolicy:e.cacheLookupPolicy||Hk.Default}),this.performanceClient.setPreQueueTime(fy.AcquireTokenFromCache,a.correlationId),n=this.acquireTokenFromCache(i,a,s).catch((function(t){if(s.cacheLookupPolicy===Hk.AccessToken)throw t;return fT.blockReloadInHiddenIframes(),c.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_NETWORK_START,mk.Silent,a),c.performanceClient.setPreQueueTime(fy.AcquireTokenByRefreshToken,a.correlationId),c.acquireTokenByRefreshToken(a,s).catch((function(t){var r=t instanceof xk,n=t instanceof Ik,o=t.errorCode===Ek;if((!r||!o||n||s.cacheLookupPolicy===Hk.AccessTokenAndRefreshToken||s.cacheLookupPolicy===Hk.RefreshToken)&&s.cacheLookupPolicy!==Hk.Skip)throw t;return c.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",e.correlationId),c.performanceClient.setPreQueueTime(fy.AcquireTokenBySilentIframe,a.correlationId),c.acquireTokenBySilentIframe(a)}))})),l.label=3;case 3:return[2,n.then((function(e){var t;return c.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_SUCCESS,mk.Silent,e),null===(t=c.astsAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw c.eventHandler.emitEvent(vT.ACQUIRE_TOKEN_FAILURE,mk.Silent,null,e),null===(t=c.astsAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",c.trackPageVisibility)}))]}}))}))},t}(l_),d_=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};!function(e){e.SELECT_ACCOUNT="select_account",e.LOGIN="login",e.CONSENT="consent"}(BT||(BT={}));var p_=function(e){b(r,e);var t=C(r);function r(e){var n;return p(this,r),(n=t.call(this)).sessionStorageRequestedScopesKey="mgt-requested-scopes",n.sessionStorageDeniedScopesKey="mgt-denied-scopes",n.homeAccountKey="275f3731-e4a4-468a-bf9c-baca24b31e26",n.initProvider(e),n}return v(r,[{key:"publicClientApplication",get:function(){return this._publicClientApplication}},{key:"name",get:function(){return"MgtMsal2Provider"}},{key:"initProvider",value:function(e){return d_(this,void 0,void 0,Ze().mark((function t(){var r,n;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.options||{auth:{clientId:""}},this.ms_config=r,this.ms_config.cache=r.cache||{},this.ms_config.cache.cacheLocation=r.cache.cacheLocation||"localStorage","undefined"!==typeof this.ms_config.cache.storeAuthStateInCookie&&null!==this.ms_config.cache.storeAuthStateInCookie||(this.ms_config.cache.storeAuthStateInCookie=!0),this.ms_config.system=r.system||{},this.ms_config.system.iframeHashTimeout=r.system.iframeHashTimeout||1e4,e.authority&&(this.ms_config.auth.authority=e.authority),e.redirectUri&&(this.ms_config.auth.redirectUri=e.redirectUri),!("clientId"in e)){t.next=18;break}if(!e.clientId){t.next=15;break}this.ms_config.auth.clientId=e.clientId,this._publicClientApplication=new u_(this.ms_config),t.next=16;break;case 15:throw new Error("clientId must be provided");case 16:case 24:t.next=27;break;case 18:if(!("publicClientApplication"in e)){t.next=26;break}if(!e.publicClientApplication){t.next=23;break}this._publicClientApplication=e.publicClientApplication,t.next=24;break;case 23:throw new Error("publicClientApplication must be provided");case 26:throw new Error("either clientId or publicClientApplication must be provided");case 27:return this._loginType="undefined"!==typeof e.loginType?e.loginType:_n.Redirect,this._loginHint="undefined"!==typeof e.loginHint?e.loginHint:null,this._sid="undefined"!==typeof e.sid?e.sid:null,this.isIncrementalConsentDisabled="undefined"!==typeof e.isIncrementalConsentDisabled&&e.isIncrementalConsentDisabled,this._domainHint="undefined"!==typeof e.domainHint?e.domainHint:null,this.scopes="undefined"!==typeof e.scopes?e.scopes:["user.read"],this._prompt="undefined"!==typeof e.prompt?e.prompt:BT.SELECT_ACCOUNT,this.graph=dr(this),t.prev=35,t.next=38,this._publicClientApplication.handleRedirectPromise();case 38:null!==(n=t.sent)?this.handleResponse(null===n||void 0===n?void 0:n.account):this.trySilentSignIn(),t.next=45;break;case 42:throw t.prev=42,t.t0=t.catch(35),t.t0;case 45:case"end":return t.stop()}}),t,this,[[35,42]])})))}},{key:"trySilentSignIn",value:function(){return d_(this,void 0,void 0,Ze().mark((function e(){var t,r,n;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={scopes:this.scopes,domainHint:this._domainHint},!this._sid&&!this._loginHint){e.next=17;break}return t.sid=this._sid,t.loginHint=this._loginHint,e.prev=4,this.setState(Sn.Loading),e.next=8,this._publicClientApplication.ssoSilent(t);case 8:(r=e.sent)&&this.handleResponse(null===r||void 0===r?void 0:r.account),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),this.setState(Sn.SignedOut);case 15:e.next=25;break;case 17:if(!(n=this.getAccount())){e.next=24;break}return e.next=21,this.getAccessToken(null);case 21:if(!e.sent){e.next=24;break}return this.handleResponse(n),e.abrupt("return");case 24:this.setState(Sn.SignedOut);case 25:case"end":return e.stop()}}),e,this,[[4,12]])})))}},{key:"login",value:function(){return d_(this,void 0,void 0,Ze().mark((function e(){var t,r,n;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint},this._loginType!=_n.Popup){e.next=8;break}return e.next=4,this._publicClientApplication.loginPopup(t);case 4:r=e.sent,this.handleResponse(null===r||void 0===r?void 0:r.account),e.next=10;break;case 8:n=Object.assign({},t),this._publicClientApplication.loginRedirect(n);case 10:case"end":return e.stop()}}),e,this)})))}},{key:"getAllAccounts",value:function(){var e=[];return this._publicClientApplication.getAllAccounts().forEach((function(t){e.push({username:t.username,id:t.homeAccountId})})),e}},{key:"setActiveAccount",value:function(e){this._publicClientApplication.setActiveAccount(this._publicClientApplication.getAccountByHomeId(e.id)),this.setStoredAccount(),Ot(y(r.prototype),"setActiveAccount",this).call(this,e)}},{key:"handleResponse",value:function(e){null!==e?(this.setActiveAccount({username:e.name,id:e.homeAccountId}),this.setState(Sn.SignedIn)):this.setState(Sn.SignedOut),this.clearRequestedScopes()}},{key:"setStoredAccount",value:function(){this.clearStoredAccount(),window[this.ms_config.cache.cacheLocation].setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}},{key:"getStoredAccount",value:function(){var e;return e=window[this.ms_config.cache.cacheLocation].getItem(this.homeAccountKey),this._publicClientApplication.getAccountByHomeId(e)}},{key:"clearStoredAccount",value:function(){window[this.ms_config.cache.cacheLocation].removeItem(this.homeAccountKey)}},{key:"setRequestedScopes",value:function(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}},{key:"addDeniedScopes",value:function(e){if(e){var t=this.getDeniedScopes()||[],r=(t=t.concat(e)).indexOf("openid");-1!==r&&t.splice(r,1),-1!==(r=t.indexOf("profile"))&&t.splice(r,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}},{key:"getDeniedScopes",value:function(){var e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}},{key:"areScopesDenied",value:function(e){if(e){var t=this.getDeniedScopes();if(t&&t.filter((function(t){return-1!==e.indexOf(t)})).length>0)return!0}return!1}},{key:"clearRequestedScopes",value:function(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}},{key:"getAccount",value:function(){var e=this.getStoredAccount();return e||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}},{key:"logout",value:function(){return d_(this,void 0,void 0,Ze().mark((function e(){var t,r;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._publicClientApplication.getActiveAccount(),r={account:t},this.clearStoredAccount(),this._loginType!=_n.Redirect){e.next=8;break}this._publicClientApplication.logoutRedirect(r),this.setState(Sn.SignedOut),e.next=11;break;case 8:return e.next=10,this._publicClientApplication.logoutPopup(Object.assign({},r));case 10:this.setState(Sn.SignedOut);case 11:case"end":return e.stop()}}),e,this)})))}},{key:"getAccessToken",value:function(e){return d_(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i,a;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e&&e.scopes||this.scopes,n={scopes:r,account:this.getAccount()},t.prev=2,o=n,t.next=6,this._publicClientApplication.acquireTokenSilent(o);case 6:return i=t.sent,t.abrupt("return",i.accessToken);case 10:if(t.prev=10,t.t0=t.catch(2),!(t.t0 instanceof Ik)){t.next=36;break}if(!this.isIncrementalConsentDisabled){t.next=15;break}return t.abrupt("return",null);case 15:if(this._loginType!==_n.Redirect){t.next=24;break}if(this.areScopesDenied(r)){t.next=21;break}this.setRequestedScopes(r),this._publicClientApplication.acquireTokenRedirect(n),t.next=22;break;case 21:throw t.t0;case 22:t.next=34;break;case 24:return t.prev=24,t.next=27,this._publicClientApplication.acquireTokenPopup(n);case 27:return a=t.sent,t.abrupt("return",a.accessToken);case 31:throw t.prev=31,t.t1=t.catch(24),t.t1;case 34:t.next=37;break;case 36:this.setState(Sn.SignedOut);case 37:throw null;case 38:case"end":return t.stop()}}),t,this,[[2,10],[24,31]])})))}}]),r}(En),f_=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},h_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g_=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.apply(this,arguments)).clientId="",e}return v(r,[{key:"isAvailable",get:function(){return!0}},{key:"initializeProvider",value:function(){if(this.clientId){var e={clientId:this.clientId};if(this.loginType&&this.loginType.length>1){var t=this.loginType.toLowerCase();t=t[0].toUpperCase()+t.slice(1);var r=_n[t];e.loginType=r}if(this.authority&&(e.authority=this.authority),this.scopes){var n=this.scopes.split(",");n&&n.length>0&&(e.scopes=n)}if(this.redirectUri&&(e.redirectUri=this.redirectUri),this.prompt){var o=this.prompt.toUpperCase(),i=BT[o];e.prompt=i}this.isIncrementalConsentDisabled&&(e.isIncrementalConsentDisabled=!0),this.provider=new p_(e),Pn.globalProvider=this.provider}}}]),r}(Hn);f_([hn({attribute:"client-id",type:String}),h_("design:type",Object)],g_.prototype,"clientId",void 0),f_([hn({attribute:"login-type",type:String}),h_("design:type",Object)],g_.prototype,"loginType",void 0),f_([hn(),h_("design:type",Object)],g_.prototype,"authority",void 0),f_([hn({attribute:"scopes",type:String}),h_("design:type",Object)],g_.prototype,"scopes",void 0),f_([hn({attribute:"redirect-uri",type:String}),h_("design:type",Object)],g_.prototype,"redirectUri",void 0),f_([hn({attribute:"prompt",type:String}),h_("design:type",String)],g_.prototype,"prompt",void 0),f_([hn({attribute:"incremental-consent-disabled",type:Boolean}),h_("design:type",Boolean)],g_.prototype,"isIncrementalConsentDisabled",void 0),g_=f_([fn("mgt-msal2-provider")],g_);var v_,m_=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};!function(e){e.GET="GET",e.POST="POST"}(v_||(v_={}));var b_=function(e){b(r,e);var t=C(r);function r(e){var n;return p(this,r),(n=t.call(this,{clientId:e.clientId,loginType:_n.Redirect,options:e.msalOptions,scopes:e.scopes})).clientId=e.clientId,n._msalOptions=e.msalOptions,n._authPopupUrl=e.authPopupUrl,n._ssoUrl=e.ssoUrl,n._autoConsent="undefined"===typeof e.autoConsent||e.autoConsent,n._httpMethod="undefined"!==typeof e.httpMethod?e.httpMethod:v_.GET,vo.microsoftTeamsLib.initialize(),n._ssoUrl&&n.internalLogin(),n}return v(r,[{key:"name",get:function(){return"MgtTeamsMsal2Provider"}},{key:"login",value:function(){return m_(this,void 0,void 0,Ze().mark((function e(){var t,n=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._ssoUrl||this._needsConsent){e.next=2;break}return e.abrupt("return");case 2:return this.setState(Sn.Loading),t=vo.microsoftTeamsLib,e.abrupt("return",new Promise((function(e,o){t.getContext((function(i){n.teamsContext=i;var a={clientId:n.clientId,loginHint:i.loginHint,options:n._msalOptions,scopes:n.scopes.join(","),isConsent:n._autoConsent};localStorage.setItem(r._localStorageParametersKey,JSON.stringify(a));var s=new URL(n._authPopupUrl,new URL(window.location.href));t.authentication.authenticate({failureCallback:function(e){n.setState(Sn.SignedOut),o()},successCallback:function(t){n._ssoUrl?(n.setState(Sn.SignedIn),e()):(n.trySilentSignIn(),e())},url:s.href})}))})));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"logout",value:function(){return m_(this,void 0,void 0,Ze().mark((function e(){var t,r=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._ssoUrl){e.next=2;break}return e.abrupt("return");case 2:return t=vo.microsoftTeamsLib,e.abrupt("return",new Promise((function(e,n){t.getContext((function(o){r.teamsContext=o;var i=new URL(r._authPopupUrl,new URL(window.location.href));i.searchParams.append("signout","true"),t.authentication.authenticate({failureCallback:function(e){r.trySilentSignIn(),n()},successCallback:function(t){r.trySilentSignIn(),e()},url:i.href})}))})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"getAccessToken",value:function(e){return m_(this,void 0,void 0,Ze().mark((function t(){var r,n,o,i,a,s,c=this;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.teamsContext||!vo.microsoftTeamsLib){t.next=6;break}return vo.microsoftTeamsLib.initialize(),t.next=5,this.getTeamsContext();case 5:this.teamsContext=t.sent;case 6:if(r=e&&e.scopes||this.scopes,!this._ssoUrl){t.next=37;break}return t.next=10,this.getClientToken();case 10:if(n=t.sent,o=new URL(this._ssoUrl,new URL(window.location.href)),this._httpMethod!==v_.GET){t.next=19;break}return a=new URLSearchParams({ssoToken:n,scopes:r.join(","),clientId:this.clientId}),t.next=16,fetch("".concat(o.href,"?").concat(a),{method:"GET",mode:"cors",cache:"default"});case 16:i=t.sent,t.next=22;break;case 19:return t.next=21,fetch(o.href,{method:"POST",headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(n)},body:JSON.stringify({scopes:r,clientid:this.clientId}),mode:"cors",cache:"default"});case 21:i=t.sent;case 22:return t.next=24,i.json().catch(this.unhandledFetchError);case 24:if(s=t.sent,i.ok||"consent_required"!==s.error){t.next=29;break}this._needsConsent=!0,t.next=35;break;case 29:if(i.ok){t.next=33;break}throw s;case 33:return this._needsConsent=!1,t.abrupt("return",s.access_token);case 35:t.next=38;break;case 37:return t.abrupt("return",new Promise((function(e,t){return m_(c,void 0,void 0,Ze().mark((function n(){var o,i;return Ze().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o={scopes:r,account:this.getAccount()},n.prev=1,n.next=4,this.publicClientApplication.acquireTokenSilent(o);case 4:i=n.sent,e(i.accessToken),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),n.t0 instanceof Ik?e(null):t(n.t0);case 11:case"end":return n.stop()}}),n,this,[[1,8]])})))})));case 38:case"end":return t.stop()}}),t,this)})))}},{key:"internalLogin",value:function(){return m_(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAccessToken(null);case 2:if(!e.sent){e.next=7;break}this.setState(Sn.SignedIn),e.next=18;break;case 7:if(!this._needsConsent){e.next=18;break}if(!this._autoConsent){e.next=17;break}if(this.scopes){e.next=13;break}throw new Error("For auto consent, scopes must be provided");case 13:return this.login(),e.abrupt("return");case 15:e.next=18;break;case 17:throw new Error("Auto consent is not configured. You need to consent to additional scopes");case 18:case"end":return e.stop()}}),e,this)})))}},{key:"getClientToken",value:function(){return m_(this,void 0,void 0,Ze().mark((function e(){var t,r=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=vo.microsoftTeamsLib,e.abrupt("return",new Promise((function(e,n){t.authentication.getAuthToken({successCallback:function(t){e(t)},failureCallback:function(e){r.setState(Sn.SignedOut),n()}})})));case 2:case"end":return e.stop()}}),e)})))}},{key:"getTeamsContext",value:function(){return m_(this,void 0,void 0,Ze().mark((function e(){return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var t=vo.microsoftTeamsLib;t.initialize(),t.getContext((function(t){e(t)}))})));case 1:case"end":return e.stop()}}),e)})))}},{key:"unhandledFetchError",value:function(e){console.error("There was an error during the server side token exchange:\xa0".concat(e))}}],[{key:"isAvailable",get:function(){return vo.isAvailable}},{key:"microsoftTeamsLib",get:function(){return vo.microsoftTeamsLib},set:function(e){vo.microsoftTeamsLib=e}},{key:"handleAuth",value:function(){return m_(this,void 0,void 0,Ze().mark((function e(){var t,r,n,o,i,a,s,c,l,u,p=this;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=vo.microsoftTeamsLib){e.next=4;break}return console.error("Make sure you have referenced the Microsoft Teams sdk before using the TeamsMsal2Provider"),e.abrupt("return");case 4:if(t.initialize(),sessionStorage.getItem(this._sessionStorageLogoutInProgress)&&t.authentication.notifySuccess(),r=new URL(window.location.href),n=r.searchParams.get("signout"),o=localStorage.getItem(this._localStorageParametersKey),(i=o?JSON.parse(o):{}).clientId){e.next=13;break}return t.authentication.notifyFailure("no clientId provided"),e.abrupt("return");case 13:a=i.scopes?i.scopes.split(","):null,s=i.isConsent?BT.CONSENT:BT.SELECT_ACCOUNT,(c=i.options||{auth:{clientId:i.clientId}}).system=c.system||{},c.system.loadFrameTimeout=1e4,l=new p_({clientId:i.clientId,options:c,scopes:a,loginHint:i.loginHint,prompt:s}),u=function(){return m_(p,void 0,void 0,Ze().mark((function e(){var r;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.state!==Sn.SignedOut){e.next=7;break}if(!n){e.next=4;break}return t.authentication.notifySuccess(),e.abrupt("return");case 4:sessionStorage.getItem(this._sessionStorageLoginInProgress)||(window.parent!==window?console.warn("handleProviderState - Is in iframe... will try to login anyway... but will not set session storage variable"):sessionStorage.setItem(this._sessionStorageLoginInProgress,"true"),l.login()),e.next=23;break;case 7:if(l.state!==Sn.SignedIn){e.next=23;break}if(!n){e.next=13;break}return sessionStorage.setItem(this._sessionStorageLogoutInProgress,"true"),e.next=12,l.logout();case 12:return e.abrupt("return");case 13:return e.prev=13,e.next=16,l.getAccessTokenForScopes.apply(l,d(l.scopes));case 16:r=e.sent,t.authentication.notifySuccess(r),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(13),t.authentication.notifyFailure(e.t0);case 23:case"end":return e.stop()}}),e,this,[[13,20]])})))},l.onStateChanged(u),u();case 22:case"end":return e.stop()}}),e,this)})))}}]),r}(p_);b_._localStorageParametersKey="msg-TeamsMsal2Provider-auth-parameters",b_._sessionStorageLoginInProgress="msg-TeamsMsal2Provider-login-in-progress",b_._sessionStorageLogoutInProgress="msg-TeamsMsal2Provider-logout-in-progress";var y_=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},k_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},w_=function(e){b(r,e);var t=C(r);function r(){var e;return p(this,r),(e=t.apply(this,arguments)).clientId="",e.authPopupUrl="",e.ssoUrl="",e}return v(r,[{key:"isAvailable",get:function(){return b_.isAvailable}},{key:"initializeProvider",value:function(){if(this.clientId&&this.authPopupUrl){var e={authPopupUrl:this.authPopupUrl,clientId:this.clientId};if(this.scopes){var t=this.scopes.split(",");t&&t.length>0&&(e.scopes=t)}if(this.authority){var r={auth:{authority:this.authority,clientId:this.clientId}};e.msalOptions=r}if(this.ssoUrl&&(e.ssoUrl=this.ssoUrl),this.isAutoConsentDisabled&&(e.autoConsent=!1),this.httpMethod){var n=this.httpMethod.toUpperCase(),o=v_[n];e.httpMethod=o}this.provider=new b_(e),Pn.globalProvider=this.provider}}}]),r}(Hn);y_([hn({attribute:"client-id",type:String}),k_("design:type",Object)],w_.prototype,"clientId",void 0),y_([hn({attribute:"auth-popup-url",type:String}),k_("design:type",Object)],w_.prototype,"authPopupUrl",void 0),y_([hn({attribute:"sso-url",type:String}),k_("design:type",Object)],w_.prototype,"ssoUrl",void 0),y_([hn(),k_("design:type",Object)],w_.prototype,"authority",void 0),y_([hn({attribute:"scopes",type:String}),k_("design:type",Object)],w_.prototype,"scopes",void 0),y_([hn({attribute:"auto-consent-disabled",type:Boolean}),k_("design:type",Object)],w_.prototype,"isAutoConsentDisabled",void 0),y_([hn({attribute:"http-method",type:String}),k_("design:type",Object)],w_.prototype,"httpMethod",void 0),w_=y_([fn("mgt-teams-msal2-provider")],w_);var x_="http://localhost:3080/sharepoint";function C_(){return T_.apply(this,arguments)}function T_(){return(T_=et(Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(x_,"/consultants"),{method:"GET"});case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function __(){return S_.apply(this,arguments)}function S_(){return(S_=et(Ze().mark((function e(){var t;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(x_,"/businessunits"),{method:"GET"});case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I_(e,t){return E_.apply(this,arguments)}function E_(){return(E_=et(Ze().mark((function e(t,r){var n;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(x_,"/consultant/").concat(t,"/").concat(r),{method:"GET"});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A_(e,t){return R_.apply(this,arguments)}function R_(){return(R_=et(Ze().mark((function e(t,r){var n;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(x_,"/business/").concat(t,"/").concat(r),{method:"GET"});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P_="listTable_table__dkp4T",O_="listTable_tableHeader__rFjaB",N_="listTable_tableHeaderRow__O11oR",D_="listTable_tableHeaderRowItem__udXn3",L_="listTable_tableArrow__N9E3A",M_="listTable_tableBody__qSp0e",U_="listTable_tableBodyRow__sRut3",F_="listTable_tableBodyCell__3CwAN",z_="listTable_center__W1bjb",H_=r(358),B_="loader_container__wCWZ2",q_="loader_spinner__sjmF5",j_="loader_text__sdq3I",G_="loader_shadow__u+5Sz",V_=r(75),K_=r.n(V_);var Q_=function(e){var t=e.text;return(0,Ve.jsx)(K_(),{up:!0,duration:700,distance:"2em",children:(0,Ve.jsxs)("div",{className:B_,children:[(0,Ve.jsx)("img",{className:q_,src:r(897)}),(0,Ve.jsx)("div",{className:G_}),(0,Ve.jsx)("div",{className:j_,children:t})]})})};var W_=function(e){var t=e.disableLinks,r=e.loading,n=e.columns,o=e.data,i=e.loadText,a=(0,H_.useTable)({columns:n,data:o},H_.useSortBy),s=a.getTableProps,c=a.getTableBodyProps,l=a.headerGroups,u=a.rows,d=a.prepareRow,p=u;return(0,Ve.jsxs)(Ve.Fragment,{children:[(0,Ve.jsxs)("table",Xe(Xe({},s()),{},{className:P_,children:[(0,Ve.jsx)("thead",{className:O_,children:l.map((function(e){return(0,Ve.jsx)("tr",Xe(Xe({},e.getHeaderGroupProps()),{},{className:N_,children:e.headers.map((function(e){return(0,Ve.jsxs)("th",Xe(Xe({},e.getHeaderProps(e.getSortByToggleProps())),{},{className:D_,children:[e.render("Header"),(0,Ve.jsx)("span",{className:L_,children:e.isSorted?e.isSortedDesc?" \u25bc":" \u25b2":""})]}))}))}))}))}),r?(0,Ve.jsx)("tbody",{className:z_,children:(0,Ve.jsx)("tr",{children:(0,Ve.jsx)("td",{children:(0,Ve.jsx)(Q_,{text:i})})})}):(0,Ve.jsx)("tbody",Xe(Xe({},c()),{},{className:M_,children:p.map((function(e,r){return d(e),(0,Ve.jsx)("tr",Xe(Xe({},e.getRowProps()),{},{className:U_,children:e.cells.map((function(r,n){var o=r.render("Cell");"Total Job Amount"!==r.column.Header&&"Average Job Amount"!==r.column.Header||(o=parseFloat(r.value).toLocaleString());return(0,Ve.jsx)("td",Xe(Xe({className:F_},r.getCellProps()),{},{children:0!==n||t?o:(0,Ve.jsx)(qe,{to:"".concat(e.cells[0].value,"/").concat(e.original._id),children:o})}))}))}))}))}))]})),(0,Ve.jsx)("br",{})]})},J_={header:"listTableHeader_header__yS9ir",searchLabel:"listTableHeader_searchLabel__25dWh",inputSearch:"listTableHeader_inputSearch__UbVLY",searchImage:"listTableHeader_searchImage__FwiWF",filtersContainer:"listTableHeader_filtersContainer__8TyYD",filterButton:"listTableHeader_filterButton__pqVm3",filterOverlay:"listTableHeader_filterOverlay__3a6Zf",filterOpen:"listTableHeader_filterOpen__GTmrc",rowSplitter:"listTableHeader_rowSplitter__jkqz0",applyButton:"listTableHeader_applyButton__3QPBv",radioContainer:"listTableHeader_radioContainer__4dq0m",radioLabel:"listTableHeader_radioLabel__j0L+C"};var Y_=function(e,r){(0,t.useEffect)((function(){var t=function(t){e.current&&!e.current.contains(t.target)&&r((function(){return!1}))};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),function(){document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}}),[e,r])},X_=r(394),Z_=r(643),$_=r.n(Z_);var eS=function(e,t){var r=864e5*e,n=(new Date).getTime(),o=t.filter((function(e){var t=new Date(e.Order_Date).getTime();if(n-t<r)return e}));return o.sort((function(e,t){return e.Order_Date-t.Order_Date})),o};var tS=function(e){var n=e.business,o=e.cleanConsulantList,i=e.setConsultantList,a=e.searchTerm1,s=e.searchTerm2,c=n?"IntertekFiltersUnits":"IntertekFiltersConsultants",u=l((0,t.useState)(!1),2),d=u[0],p=u[1],f=l((0,t.useState)(""),2),h=f[0],g=f[1],v=(0,t.useRef)(null);Y_(v,p);var m={days:2,unit:-1,industry:-1},b=m,y=$_().get(c);y&&(b=y);var k=l((0,t.useState)(b),2),w=k[0],x=k[1];function C(e,t){var r=Xe({},w);r[t]=e,x((function(){return r})),T(r),$_().set(c,r)}function T(e){var t=[];Object.keys(e).map((function(r,n){var o=e[r];if(o>-1){var i=null;"days"===r&&(i=_[o]),"unit"===r&&(i=S[o]),"industry"===r&&(i=I[o]),t.push(i)}}));var r=t.find((function(e){return"day"===e.type})),n=eS(parseInt(r.value),o);i((function(){return n}))}var _=[{name:"7",value:"7",type:"day"},{name:"30",value:"30",type:"day"},{name:"120",value:"120",type:"day"},{name:"Any Time",value:"9999",type:"day"}],S=[{name:"Barnes BU",value:"barnes",type:"unit"},{name:"Bronson BU",value:"bronson",type:"unit"},{name:"Roman BU",value:"roman",type:"unit"},{name:"Reynard BU",value:"reynard",type:"unit"},{name:"Xander BU",value:"xander",type:"unit"}],I=[{name:"Engineering",value:"engineering",type:"industry"},{name:"Electrical",value:"electrical",type:"industry"},{name:"Healthcare",value:"healthcare",type:"industry"},{name:"Digital",value:"digital",type:"industry"},{name:"Cyber",value:"cyber",type:"industry"}];return(0,Ve.jsxs)("div",{className:J_.header,children:[(0,Ve.jsxs)("label",{className:J_.searchLabel,children:[(0,Ve.jsx)("img",{src:r(11),className:J_.searchImage}),(0,Ve.jsx)("input",{maxLength:50,type:"search",value:h,onChange:function(e){g((function(){return e.target.value}));var t=e.target.value.toLowerCase(),r=o.filter((function(e){var r=e[a].toLowerCase(),n=e[s].toLowerCase();if(r.includes(t)||n.includes(t))return e}));i((function(){return r}))},placeholder:n?"Search Business Units":"Search Consultants",className:J_.inputSearch})]}),(0,Ve.jsxs)("div",{className:J_.filtersContainer,ref:v,children:[(0,Ve.jsx)("div",{className:J_.filterButton,onClick:function(){return p((function(e){return!e}))},children:"Filter By"}),(0,Ve.jsx)(X_.pT,{up:!0,distance:"1em",duration:200,when:d,children:(0,Ve.jsxs)("div",{className:"".concat(J_.filterOverlay," ").concat(d?J_.nothing:J_.filterOpen),children:[(0,Ve.jsx)("div",{className:J_.rowSplitter,children:"Time"}),(0,Ve.jsx)("div",{className:J_.radioContainer,children:_.map((function(e,t){return(0,Ve.jsxs)("label",{className:J_.radioLabel,children:[e.value<9e3?(0,Ve.jsxs)(Ve.Fragment,{children:["Last ",e.name," days"]}):e.name,(0,Ve.jsx)("input",{type:"radio",value:e,onChange:function(){return C(t,"days")},checked:w.days===t,className:J_.radioButton}),(0,Ve.jsx)("span",{className:J_.radioCircle})]},t)}))}),(0,Ve.jsx)("div",{className:J_.rowSplitter,children:"Business Unit"}),(0,Ve.jsx)("div",{className:J_.radioContainer,children:S.map((function(e,t){return(0,Ve.jsxs)("label",{className:J_.radioLabel,children:[e.name,(0,Ve.jsx)("input",{type:"radio",value:e,onChange:function(){return C(t,"unit")},checked:w.unit===t}),(0,Ve.jsx)("span",{className:J_.radioCircle})]},t)}))}),(0,Ve.jsx)("div",{className:J_.rowSplitter,children:"Industry"}),(0,Ve.jsx)("div",{className:J_.radioContainer,children:I.map((function(e,t){return(0,Ve.jsxs)("label",{className:J_.radioLabel,children:[e.name,(0,Ve.jsx)("input",{type:"radio",value:e,onChange:function(){return C(t,"industry")},checked:w.industry===t}),(0,Ve.jsx)("span",{className:J_.radioCircle})]},t)}))}),(0,Ve.jsx)("div",{className:"".concat(J_.filterButton," ").concat(J_.applyButton),onClick:function(){x((function(){return m})),T(m),$_().set(c,m)},children:"Clear"})]})})]})]})};var rS=function(){var e=Qe().user,n=l((0,t.useState)(!1),2),o=n[0],i=n[1],a=l((0,t.useState)([]),2),s=a[0],c=a[1],u=l((0,t.useState)([]),2),d=u[0],p=u[1];function f(){return h.apply(this,arguments)}function h(){return(h=et(Ze().mark((function e(){var t,r,n,o,a,s;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i((function(){return!0})),e.next=3,C_();case 3:t=e.sent,r=t.filter((function(e,t){return 0!==t})),n=[],r.forEach((function(e){var t=Xe({_id:e._id,rowIndex:e.rowIndex},e.rowData);n.push(t)})),n.sort((function(e,t){return e.Order_Date-t.Order_Date})),o=$_().get("IntertekFiltersConsultants")||2,console.log(o),a=0===o.days?7:1===o.days?30:2===o.days?120:9999,s=eS(a,n),c((function(){return s})),p((function(){return n})),i((function(){return!1}));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,t.useEffect)((function(){e&&f()}),[e]),(0,Ve.jsxs)("div",{className:tt,children:[(0,Ve.jsxs)("div",{className:rt,children:[(0,Ve.jsx)("div",{className:nt,children:"All Consultants"}),(0,Ve.jsxs)("div",{className:ot,onClick:f,children:[(0,Ve.jsx)("img",{className:it,src:r(914)}),(0,Ve.jsx)("div",{children:"Refresh"})]})]}),(0,Ve.jsx)("div",{children:(0,Ve.jsx)("hr",{})}),(0,Ve.jsx)(tS,{setConsultantList:c,cleanConsulantList:d,searchTerm1:"Primary_Consultant",searchTerm2:"Secondary_Consultant"}),(0,Ve.jsx)(W_,{loadText:"Retrieving consultants...",loading:o,columns:[{Header:"Consultants",columns:[{Header:"Primary Consultant",accessor:"Primary_Consultant"},{Header:"Secondary Consultant",accessor:"Secondary_Consultant"},{Header:"Project Status",accessor:"Project_Status"},{Header:"Total Job Amount",accessor:"Total_Job_Amount"},{Header:"Order Date",accessor:"Order_Date"}]}],data:s})]})},nS="dashboard_container__unk50",oS="dashboard_overlay__Wndhb",iS="dashboard_activeOverlay__o83zV",aS="dashboard_inactiveOverlay__quWBy",sS="dashboard_header__q3rhJ",cS="dashboard_h1__BGht6",lS="dashboard_headerButton__433Oh";var uS=function(){var e=ke(),r=function(){var e=t.useContext(me).matches,r=e[e.length-1];return r?r.params:{}}(),n=l((0,t.useState)([]),2),o=n[0],i=n[1],a=l((0,t.useState)([]),2),s=a[0],c=a[1],u=l((0,t.useState)([]),2),d=u[0],p=u[1],f=l((0,t.useState)([]),2),h=f[0],g=f[1],v=l((0,t.useState)(!1),2),m=v[0],b=v[1];function y(){return(y=et(Ze().mark((function t(){var n,o,a;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(b((function(){return!0})),n=[],!e.pathname.includes("businessunit")){t.next=8;break}return t.next=5,A_(r.id,r.name);case 5:n=t.sent,t.next=11;break;case 8:return t.next=10,I_(r.id,r.name);case 10:n=t.sent;case 11:o=[],n.forEach((function(e){var t=Xe({_id:e._id,rowIndex:e.rowIndex},e.rowData);o.push(t)})),a=_(120,o),i((function(){return a})),c((function(){return o})),k(a),w(o),b((function(){return!1}));case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function k(e){var t=[],n={Primary_Consultant:r.name,Secondary_Consultant:"",Project_Status:"",Total_Job_Amount:null,Order_Date:""},o=0,i=e.length;e.forEach((function(e){var t=e.Total_Job_Amount;t>0&&(o+=parseInt(t))}));var a=o/i;n.Total_Job_Amount=a.toFixed(0),t.push(n),p((function(){return t}))}function w(e){var t=[];e.forEach((function(e,r){"ongoing"===e.Project_Status.toLowerCase()&&t.push(e)})),t.sort((function(e,t){return e.Order_Date-t.Order_Date})),g((function(){return t}))}(0,t.useEffect)((function(){!function(){y.apply(this,arguments)}()}),[]);var x=l((0,t.useState)(120),2),C=x[0],T=x[1];function _(e,t){var r=864e5*e,n=(new Date).getTime(),o=t.filter((function(e){var t=new Date(e.Order_Date).getTime();if(n-t<r)return e}));return o.sort((function(e,t){return e.Order_Date-t.Order_Date})),o}var S=[{Header:"".concat(C," day summary"),columns:[{Header:"Primary Consultant",accessor:"Primary_Consultant"},{Header:"Job Manager",accessor:"Job_Manager"},{Header:"Job Billing Status",accessor:"Job_Billing_Status"},{Header:"Average Job Amount",accessor:"Total_Job_Amount"},{Header:"Order Date",accessor:"Order_Date"}]}],I=[{Header:"Projects from the last ".concat(C," days"),columns:[{Header:"Primary Consultant",accessor:"Primary_Consultant"},{Header:"Job Manager",accessor:"Job_Manager"},{Header:"Job Billing Status",accessor:"Job_Billing_Status"},{Header:"Total Job Amount",accessor:"Total_Job_Amount"},{Header:"Order Date",accessor:"Order_Date"}]}];return(0,Ve.jsxs)("div",{className:nS,children:[(0,Ve.jsx)(K_(),{when:m,children:(0,Ve.jsx)("div",{className:"".concat(oS," ").concat(m?iS:aS)})}),(0,Ve.jsxs)("div",{className:sS,children:[(0,Ve.jsx)("div",{className:cS,children:r.name}),(0,Ve.jsxs)("div",{className:lS,onClick:function(){var e=C;e=7===C?30:e,e=30===C?120:e,e=120===C?7:e,T((function(){return e}));var t=_(e,s);i((function(){return t}))},children:["Last ",C," days"]})]}),(0,Ve.jsx)("div",{children:(0,Ve.jsx)("hr",{})}),(0,Ve.jsx)(W_,{loadText:"Retrieving data for ".concat(r.name,"..."),loading:m,columns:S,data:d,disableLinks:!0}),(0,Ve.jsx)(W_,{loading:!1,columns:I,data:o,disableLinks:!0}),(0,Ve.jsx)(W_,{loading:!1,columns:[{Header:"Active projects",columns:[{Header:"Primary Consultant",accessor:"Primary_Consultant"},{Header:"Secondary Consultant",accessor:"Secondary_Consultant"},{Header:"Project Status",accessor:"Project_Status"},{Header:"Total Job Amount",accessor:"Total_Job_Amount"},{Header:"Order Date",accessor:"Order_Date"}]}],data:h,disableLinks:!0})]})},dS={dropdownContainer:"dropdown_dropdownContainer__WvQoO",dropButton:"dropdown_dropButton__8vQJj",dropButtonOpen:"dropdown_dropButtonOpen__745un",arrow:"dropdown_arrow__EN0CB",dropList:"dropdown_dropList__1t9R2",openList:"dropdown_openList__cupDg",listItemBox:"dropdown_listItemBox__BxSIU",dropListItem:"dropdown_dropListItem__rY0mH"};var pS=function(e){var r=e.item,n=l((0,t.useState)(!1),2),o=n[0],i=n[1],a=(0,t.useRef)();return Y_(a,i),(0,Ve.jsxs)("div",{className:dS.dropdownContainer,ref:a,children:[(0,Ve.jsxs)("div",{className:"".concat(dS.dropButton," ").concat(o?dS.dropButtonOpen:dS.nothing),onClick:function(){return i((function(e){return!e}))},children:[r.default," ",(0,Ve.jsx)("i",{className:dS.arrow,children:"\u25bc"})]}),(0,Ve.jsx)(X_.pT,{up:!0,distance:"1em",duration:300,when:o,children:(0,Ve.jsx)("div",{className:"".concat(dS.dropList," ").concat(o?dS.nothing:dS.openList),children:r.list.map((function(e,t){return(0,Ve.jsx)(qe,{onClick:function(){return i((function(){return!1}))},to:e.route,className:dS.listItemBox,children:(0,Ve.jsx)("div",{className:dS.dropListItem,children:e.name})},t)}))})})]})},fS="header_container__q02WP",hS="header_header__azjvS",gS="header_logoBox__7YnGK",vS="header_logo__wrqEb",mS="header_login__afwv+",bS=r(164),yS=new Set(["children","wcType"]),kS=function(e){b(n,e);var r=C(n);function n(){return p(this,n),r.apply(this,arguments)}return v(n,[{key:"element",get:function(){return this._element}},{key:"getTag",value:function(){var e;return"function"===typeof this.props.wcType?e=this.props.wcType.name.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase():"string"===typeof this.props.wcType&&(e=this.props.wcType),e}},{key:"render",value:function(){var e=this,r=this.getTag();if(!r)throw'"wcType" must be set!';for(var n={},o=0,i=Object.keys(this.props);o<i.length;o++){var a=i[o];a&&!0===this.props[a]&&(n[a]=!0)}return t.createElement(r,Object.assign(Object.assign({},n),{ref:function(t){return e.setRef(t)}}),this.props.children)}},{key:"setRef",value:function(e){e?(e!==this._element&&this.cleanUp(),this._element=e,this.syncProps(this.props)):this.cleanUp(),this.props.innerRef&&("function"===typeof this.props.innerRef?this.props.innerRef(e):this.props.innerRef.current=e)}},{key:"cleanUp",value:function(){if(this._element){for(var e in this.props)this.props.hasOwnProperty(e)&&this.isEventProp(e,this.props[e])&&this.removeEventListener(e,this.props[e]);this._element=null}}},{key:"componentDidUpdate",value:function(e){var t={};for(var r in this.props)this.props.hasOwnProperty(r)&&(e[r]&&e[r]===this.props[r]||(t[r]=this.props[r],e[r]&&this.isEventProp(r,e[r])&&this.removeEventListener(r,e[r])));for(var n in e)e.hasOwnProperty(n)&&!this.props[n]&&this.isEventProp(n,e[n])&&this.removeEventListener(n,e[n]);this.syncProps(t)}},{key:"syncProps",value:function(e){if(this._element)for(var t in e)yS.has(t)||(this.isEventProp(t,e[t])&&this.addEventListener(t,e[t]),this._element[t]=e[t])}},{key:"isEventProp",value:function(e,t){return e&&"function"===typeof t}},{key:"addEventListener",value:function(e,t){var r=e;r.match(/^on[A-Z]/gm)&&(r=r.substring(2).toLowerCase()),this._element.addEventListener(r,t)}},{key:"removeEventListener",value:function(e,t){var r=e;r.match(/^on[A-Z]/gm)&&(r=r.substring(2).toLowerCase()),this._element.removeEventListener(r,t)}}]),n}(t.Component),wS=function(e){b(n,e);var r=C(n);function n(e){var t;return p(this,n),(t=r.call(this,e)).handleTemplateRendered=t.handleTemplateRendered.bind(w(t)),t}return v(n,[{key:"getTag",value:function(){var e=Ot(y(n.prototype),"getTag",this).call(this);return e.startsWith("mgt-")||(e="mgt-"+e),e}},{key:"render",value:function(){var e=this,r=this.getTag();if(!r)throw'"wcType" must be set!';this.processTemplates(this.props.children);var n=[];if(this._templates)for(var o in this._templates)if(this._templates.hasOwnProperty(o)){var i=t.createElement("template",{key:o,"data-type":o},null);n.push(i)}return t.createElement(r,{ref:function(t){return e.setRef(t)}},n)}},{key:"setRef",value:function(e){e&&e.addEventListener("templateRendered",this.handleTemplateRendered),Ot(y(n.prototype),"setRef",this).call(this,e)}},{key:"cleanUp",value:function(){this.element&&(this.element.removeEventListener("templateRendered",this.handleTemplateRendered),Ot(y(n.prototype),"cleanUp",this).call(this))}},{key:"handleTemplateRendered",value:function(e){if(this._templates){var r=e.detail.templateType,n=e.detail.context,o=e.detail.element,i=this._templates[r];i&&(i=t.cloneElement(i,{dataContext:n}),bS.render(i,o))}}},{key:"processTemplates",value:function(e){if(e){var r={};t.Children.forEach(e,(function(e){var t=e;t&&t.props&&t.props.template?r[t.props.template]=t:r.default=t})),this._templates=r}}}]),n}(kS),xS=function(e){return t.forwardRef((function(r,n){return t.createElement(wS,Object.assign({wcType:e,innerRef:n},r))}))},CS=(xS("mgt-agenda"),xS("mgt-file-list"),xS("mgt-file"),xS("mgt-get"),xS("mgt-login"));xS("mgt-people-picker"),xS("mgt-people"),xS("mgt-person-card"),xS("mgt-person"),xS("mgt-tasks"),xS("mgt-teams-channel-picker"),xS("mgt-todo");var TS=function(){return(0,Ve.jsx)("div",{className:fS,children:(0,Ve.jsxs)("div",{className:hS,children:[(0,Ve.jsx)("div",{className:gS,children:(0,Ve.jsx)("img",{src:r(354),className:vS})}),[{default:"Dashboard",list:[{name:"Consultants",route:"consultants"},{name:"Business Units",route:"businessunits"}]}].map((function(e,t){return(0,Ve.jsx)(pS,{item:e},t)})),(0,Ve.jsx)("div",{className:mS,children:(0,Ve.jsx)(CS,{})})]})})},_S="Router_routesContainer__uiBkD",SS="sideMenu_bgOverlay__IP+K9",IS="sideMenu_container__L5AkG",ES="sideMenu_listContainer__zRlL0",AS="sideMenu_navItemContainer__G8tVd",RS="sideMenu_rowHeader__vGEG7",PS="sideMenu_imgBox__fVvWc",OS="sideMenu_rowImage__gGh63",NS={listItemBox:"sideMenuItem_listItemBox__yK7ek",listItemActive:"sideMenuItem_listItemActive__j0VAh"};var DS=function(e){var t=e.item,r=ke(),n=t.route.toLowerCase(),o=!!r.pathname.slice(1,30).toLowerCase().includes(n);return(0,Ve.jsx)(qe,{to:t.route,className:"".concat(NS.listItemBox," ").concat(o?NS.listItemActive:NS.nothing),children:(0,Ve.jsx)("div",{className:NS.listItem,children:t.name})})};var LS=function(){var e=[{title:"Dashboard",image:r(424),links:[{name:"Consultants",route:"consultants"},{name:"Business Units",route:"businessunits"}]},{title:"Tools",image:r(367),links:[{name:"Sharepoint Data Tool",route:"SharepointDataTool"}]}];return(0,Ve.jsxs)(Ve.Fragment,{children:[(0,Ve.jsx)("div",{className:SS}),(0,Ve.jsx)("div",{className:IS,children:(0,Ve.jsx)("div",{className:ES,children:e.map((function(e,t){return(0,Ve.jsxs)("div",{className:AS,children:[(0,Ve.jsxs)("div",{className:RS,children:[(0,Ve.jsx)("div",{className:PS,children:(0,Ve.jsx)("img",{src:e.image,className:OS})}),(0,Ve.jsx)("div",{children:e.title})]}),e.links.map((function(e,t){return(0,Ve.jsx)(DS,{item:e},t)}))]},t)}))})})]})};function MS(e){var r=e.component,n=ke().pathname;return(0,t.useEffect)((function(){r.current.scrollTop=0}),[n]),null}var US="businessUnits_container__w7Ykd",FS="businessUnits_header__PQIdC",zS="businessUnits_h1__-nxPg",HS="businessUnits_refresh__ZJKGs",BS="businessUnits_refreshIcon__odNA0";var qS=function(){var e=Qe().user,n=l((0,t.useState)(!1),2),o=n[0],i=n[1],a=l((0,t.useState)([]),2),s=a[0],c=a[1],u=l((0,t.useState)([]),2),d=u[0],p=u[1];function f(){return h.apply(this,arguments)}function h(){return(h=et(Ze().mark((function e(){var t,r,n,o,a,s;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i((function(){return!0})),e.next=3,__();case 3:t=e.sent,r=t.filter((function(e,t){return 0!==t})),n=[],r.forEach((function(e){var t=Xe({_id:e._id,rowIndex:e.rowIndex},e.rowData);n.push(t)})),n.sort((function(e,t){return e.Order_Date-t.Order_Date})),o=$_().get("IntertekFiltersUnits")||2,a=0===o.days?7:1===o.days?30:120,s=eS(a,n),c((function(){return s})),p((function(){return n})),i((function(){return!1}));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,t.useEffect)((function(){e&&f()}),[e]),(0,Ve.jsxs)("div",{className:US,children:[(0,Ve.jsxs)("div",{className:FS,children:[(0,Ve.jsx)("div",{className:zS,children:"All Business Units"}),(0,Ve.jsxs)("div",{className:HS,onClick:f,children:[(0,Ve.jsx)("img",{className:BS,src:r(914)}),(0,Ve.jsx)("div",{children:"Refresh"})]})]}),(0,Ve.jsx)("div",{children:(0,Ve.jsx)("hr",{})}),(0,Ve.jsx)(tS,{business:!0,setConsultantList:c,cleanConsulantList:d,searchTerm1:"Primary_Consultant",searchTerm2:"Secondary_Consultant"}),(0,Ve.jsx)(W_,{loadText:"Retrieving business units...",loading:o,columns:[{Header:"Business Units",columns:[{Header:"Primary Consultant",accessor:"Primary_Consultant"},{Header:"Secondary Consultant",accessor:"Secondary_Consultant"},{Header:"Project Status",accessor:"Project_Status"},{Header:"Total Job Amount",accessor:"Total_Job_Amount"},{Header:"Order Date",accessor:"Order_Date"}]}],data:s})]})};var jS=function(){return(0,Ve.jsx)(Ve.Fragment,{})};var GS=function(){return(0,Ve.jsxs)("div",{children:[(0,Ve.jsx)("button",{onClick:function(){return setCurrentTab((function(){return 0}))},children:"Add Tab"}),(0,Ve.jsx)("button",{onClick:function(){return setCurrentTab((function(){return 1}))},children:"Update Tab"}),(0,Ve.jsx)("button",{onClick:function(){return setCurrentTab((function(){return 2}))},children:"Delete Tab"}),(0,Ve.jsx)(jS,{})]})};var VS=function(){var e=Qe().setUser,r=(0,t.useRef)(null);return(0,t.useEffect)((function(){setTimeout((function(){var t=Pn.globalProvider.state===Sn.SignedIn;e((function(){return t}))}),300)}),[]),(0,Ve.jsxs)(Ve.Fragment,{children:[(0,Ve.jsx)(TS,{}),(0,Ve.jsx)(LS,{}),(0,Ve.jsx)(MS,{component:r}),(0,Ve.jsx)("div",{className:_S,ref:r,children:(0,Ve.jsxs)(De,{children:[(0,Ve.jsx)(Oe,{path:"/consultants/:name/:id",element:(0,Ve.jsx)(uS,{})}),(0,Ve.jsx)(Oe,{path:"/businessunits/:name/:id",element:(0,Ve.jsx)(uS,{})}),(0,Ve.jsx)(Oe,{path:"/consultants",element:(0,Ve.jsx)(rS,{})}),(0,Ve.jsx)(Oe,{path:"/businessunits",element:(0,Ve.jsx)(qS,{})}),(0,Ve.jsx)(Oe,{path:"/sharepointdatatool",element:(0,Ve.jsx)(GS,{})})]})})]})};var KS=function(){return(0,Ve.jsx)(We,{children:(0,Ve.jsx)(He,{basename:"",children:(0,Ve.jsx)(VS,{})})})};Pn.globalProvider=new p_({clientId:"37dd0407-2dca-47af-894c-3c2017b60a9e"}),o.createRoot(document.getElementById("root")).render((0,Ve.jsx)(KS,{}))}()}();
//# sourceMappingURL=main.c1f670f6.js.map